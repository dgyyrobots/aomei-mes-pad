/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{_ as R}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DPMk4m5L.js";import{d as $,r as c,f as F,u as P,Y as h,g as i,h as E,c as L,o as g,F as M,j as e,m as l,v as b,K as U,w as j,a,k as V,t as Y,M as q}from"./index-DMg0mq0e.js";import{_ as K,g as O}from"./BusinessForm.vue_vue_type_script_setup_true_lang-n7dWQ6A5.js";import{B as Q}from"./index-BFbycqhq.js";import{f as W}from"./formatter-GKBODKYc.js";const ee=$({name:"CrmBusinessList",__name:"BusinessList",props:{bizType:{},bizId:{}},setup(y){const p=y,m=c(!0),_=c(0),f=c([]),t=F({pageNo:1,pageSize:10,customerId:void 0}),u=async()=>{m.value=!0;try{t.customerId=void 0;let o={list:[],total:0};switch(p.bizType){case Q.CRM_CUSTOMER:t.customerId=p.bizId,o=await O(t);break;default:return}f.value=o.list,_.value=o.total}finally{m.value=!1}},v=()=>{t.pageNo=1,u()},d=c(),w=()=>{d.value.open("create")},{push:C}=P(),k=o=>{C({name:"CrmBusinessDetail",params:{id:o}})};return h(()=>[p.bizId,p.bizType],()=>{v()},{immediate:!0,deep:!0}),(o,n)=>{const z=U,B=i("el-button"),N=i("el-row"),T=i("el-link"),r=i("el-table-column"),x=i("el-table"),I=q,S=R,D=E("loading");return g(),L(M,null,[e(N,{justify:"end"},{default:l(()=>[e(B,{onClick:w},{default:l(()=>[e(z,{class:"mr-5px",icon:"ep:opportunity"}),n[2]||(n[2]=b(" 创建商机 "))]),_:1})]),_:1}),e(S,{class:"mt-10px"},{default:l(()=>[j((g(),V(x,{data:a(f),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(r,{align:"center",fixed:"left",label:"商机名称",prop:"name"},{default:l(s=>[e(T,{type:"primary",underline:!1,onClick:A=>k(s.row.id)},{default:l(()=>[b(Y(s.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{align:"center",formatter:a(W),label:"商机金额",prop:"price"},null,8,["formatter"]),e(r,{align:"center",label:"客户名称",prop:"customerName"}),e(r,{align:"center",label:"商机组",prop:"statusTypeName"}),e(r,{align:"center",label:"商机阶段",prop:"statusName"})]),_:1},8,["data"])),[[D,a(m)]]),e(I,{limit:a(t).pageSize,"onUpdate:limit":n[0]||(n[0]=s=>a(t).pageSize=s),page:a(t).pageNo,"onUpdate:page":n[1]||(n[1]=s=>a(t).pageNo=s),total:a(_),onPagination:u},null,8,["limit","page","total"])]),_:1}),e(K,{ref_key:"formRef",ref:d,onSuccess:u},null,512)],64)}}});export{ee as _};

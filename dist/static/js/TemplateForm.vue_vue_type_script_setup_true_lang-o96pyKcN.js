/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{d as J,r as m,f as K,g as s,h as W,k as _,o as p,_ as X,a as t,y as S,m as o,w as Z,j as l,c as N,F as q,n as I,v as T,N as h,z as ee,t as te}from"./index-BdC40rFX.js";import{a as R,D as le}from"./dict-D4wjFrBa.js";import{c as ae,e as oe,u as ne}from"./index-BxEvKQWX.js";import{_ as se}from"./TemplateIndexForm.vue_vue_type_script_setup_true_lang-DjHGLouF.js";import{_ as re}from"./TemplateProductForm.vue_vue_type_script_setup_true_lang-93OZmge9.js";const fe=J({__name:"TemplateForm",emits:["success"],setup(me,{expose:U,emit:P}){const{t:f}=h(),k=ee(),d=m(!1),w=m(""),u=m(!1),C=m(""),n=m({id:void 0,templateCode:void 0,templateName:void 0,qcTypes:void 0,enableFlag:void 0,remark:void 0,attr1:void 0,attr2:void 0,attr3:void 0,attr4:void 0}),E=K({templateCode:[{required:!0,message:"检测模板编号不能为空",trigger:"change"}],qcTypes:[{required:!0,message:"检测种类不能为空",trigger:"change"}]}),v=m(),i=m("templateIndex"),b=m(),g=m();U({open:async(r,e)=>{if(d.value=!0,w.value=f("action."+r),C.value=r,$(),e){u.value=!0;try{n.value=await ae(e)}finally{u.value=!1}}}});const M=P,O=async()=>{await v.value.validate();try{await b.value.validate()}catch{i.value="templateIndex";return}try{await g.value.validate()}catch{i.value="templateProduct";return}u.value=!0;try{const r=n.value;r.templateIndexs=b.value.getData(),r.templateProducts=g.value.getData(),C.value==="create"?(await oe(r),k.success(f("common.createSuccess"))):(await ne(r),k.success(f("common.updateSuccess"))),d.value=!1,M("success")}finally{u.value=!1}},$=()=>{n.value={id:void 0,templateCode:void 0,templateName:void 0,qcTypes:void 0,enableFlag:void 0,remark:void 0,attr1:void 0,attr2:void 0,attr3:void 0,attr4:void 0},v.value?.resetFields()};return(r,e)=>{const j=s("SwitchS"),y=s("el-input"),c=s("el-form-item"),V=s("el-col"),F=s("el-row"),B=s("el-option"),L=s("el-select"),A=s("el-radio"),z=s("el-radio-group"),Q=s("el-form"),x=s("el-tab-pane"),Y=s("el-tabs"),D=s("el-button"),G=X,H=W("loading");return p(),_(G,{title:t(w),modelValue:t(d),"onUpdate:modelValue":e[7]||(e[7]=a=>S(d)?d.value=a:null),width:"90%"},{footer:o(()=>[l(D,{onClick:O,type:"primary",disabled:t(u)},{default:o(()=>e[8]||(e[8]=[T("确 定")])),_:1},8,["disabled"]),l(D,{onClick:e[6]||(e[6]=a=>d.value=!1)},{default:o(()=>e[9]||(e[9]=[T("取 消")])),_:1})]),default:o(()=>[Z((p(),_(Q,{ref_key:"formRef",ref:v,model:t(n),rules:t(E),"label-width":"120px"},{default:o(()=>[l(F,null,{default:o(()=>[l(V,{span:12},{default:o(()=>[l(c,{label:"检测模板编号",prop:"templateCode"},{default:o(()=>[l(y,{modelValue:t(n).templateCode,"onUpdate:modelValue":e[0]||(e[0]=a=>t(n).templateCode=a),placeholder:"请输入检测模板编号"},{append:o(()=>[l(j,{name:"QMS_TEMPLATE_CODE",obj:t(n),val:"templateCode"},null,8,["obj"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(F,null,{default:o(()=>[l(V,{span:8},{default:o(()=>[l(c,{label:"检测模板名称",prop:"templateName"},{default:o(()=>[l(y,{modelValue:t(n).templateName,"onUpdate:modelValue":e[1]||(e[1]=a=>t(n).templateName=a),placeholder:"请输入检测模板名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(V,{span:8},{default:o(()=>[l(c,{label:"检测种类",prop:"qcTypes"},{default:o(()=>[l(L,{modelValue:t(n).qcTypes,"onUpdate:modelValue":e[2]||(e[2]=a=>t(n).qcTypes=a),placeholder:"请选择检测种类"},{default:o(()=>[(p(!0),N(q,null,I(t(R)("mes_qc_type"),a=>(p(),_(B,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,{label:"是否启用",prop:"enableFlag"},{default:o(()=>[l(z,{modelValue:t(n).enableFlag,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).enableFlag=a)},{default:o(()=>[(p(!0),N(q,null,I(t(R)(t(le).COMMON_STATUS),a=>(p(),_(A,{key:a.value,label:a.value},{default:o(()=>[T(te(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(c,{label:"备注",prop:"remark"},{default:o(()=>[l(y,{modelValue:t(n).remark,"onUpdate:modelValue":e[4]||(e[4]=a=>t(n).remark=a),placeholder:"请输入备注",rows:2,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[H,t(u)]]),l(Y,{modelValue:t(i),"onUpdate:modelValue":e[5]||(e[5]=a=>S(i)?i.value=a:null)},{default:o(()=>[l(x,{label:"检测模板项",name:"templateIndex"},{default:o(()=>[l(se,{ref_key:"templateIndexFormRef",ref:b,"template-id":t(n).id},null,8,["template-id"])]),_:1}),l(x,{label:"检测模板产品",name:"templateProduct"},{default:o(()=>[l(re,{ref_key:"templateProductFormRef",ref:g,"template-id":t(n).id},null,8,["template-id"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"])}}});export{fe as _};

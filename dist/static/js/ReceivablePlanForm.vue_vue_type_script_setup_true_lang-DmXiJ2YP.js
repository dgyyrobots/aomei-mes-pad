/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{V as u,d as j,r as i,f as z,g as s,h as E,k as g,o as b,m as r,w as M,a as l,j as t,c as A,F as G,n as H,v as x,y as J,_ as K,N as O,z as Q}from"./index-DMg0mq0e.js";import{g as W}from"./index-DsEIKZmm.js";const ae=async n=>await u.get({url:"/crm/receivable-plan/page",params:n}),oe=async n=>await u.get({url:"/crm/receivable-plan/page-by-customer",params:n}),X=async n=>await u.get({url:`/crm/receivable-plan/get?id=${n}`}),Y=async n=>await u.post({url:"/crm/receivable-plan/create",data:n}),Z=async n=>await u.put({url:"/crm/receivable-plan/update",data:n}),te=async n=>await u.delete({url:`/crm/receivable-plan/delete?id=${n}`}),re=async n=>await u.download({url:"/crm/receivable-plan/export-excel",params:n}),ne=j({__name:"ReceivablePlanForm",emits:["success"],setup(n,{expose:R,emit:P}){const{t:V}=O(),y=Q(),w=i([]),m=i(!1),I=i(""),c=i(!1),k=i(""),o=i({id:void 0,period:void 0,receivableId:void 0,status:void 0,checkStatus:void 0,processInstanceId:void 0,price:void 0,returnTime:void 0,remindDays:void 0,remindTime:void 0,customerId:void 0,contractId:void 0,ownerUserId:void 0,sort:void 0,remark:void 0}),D=z({status:[{required:!0,message:"完成状态不能为空",trigger:"change"}]}),p=i();R({open:async(v,e)=>{if(m.value=!0,I.value=V(`action.${v}`),k.value=v,S(),e){c.value=!0;try{o.value=await X(e)}finally{c.value=!1}}w.value=await W()}});const C=P,F=async()=>{if(!(!p||!await p.value.validate())){c.value=!0;try{const e=o.value;k.value==="create"?(await Y(e),y.success(V("common.createSuccess"))):(await Z(e),y.success(V("common.updateSuccess"))),m.value=!1,C("success")}finally{c.value=!1}}},S=()=>{o.value={id:void 0,period:void 0,receivableId:void 0,status:void 0,checkStatus:void 0,processInstanceId:void 0,price:void 0,returnTime:void 0,remindDays:void 0,remindTime:void 0,customerId:void 0,contractId:void 0,ownerUserId:void 0,sort:void 0,remark:void 0},p.value?.resetFields()};return(v,e)=>{const _=s("el-input"),d=s("el-form-item"),$=s("el-option"),B=s("el-select"),f=s("el-input-number"),U=s("el-date-picker"),L=s("el-form"),T=s("el-button"),N=K,q=E("loading");return b(),g(N,{modelValue:l(m),"onUpdate:modelValue":e[11]||(e[11]=a=>J(m)?m.value=a:null),title:l(I)},{footer:r(()=>[t(T,{disabled:l(c),type:"primary",onClick:F},{default:r(()=>e[12]||(e[12]=[x("确 定")])),_:1},8,["disabled"]),t(T,{onClick:e[10]||(e[10]=a=>m.value=!1)},{default:r(()=>e[13]||(e[13]=[x("取 消")])),_:1})]),default:r(()=>[M((b(),g(L,{ref_key:"formRef",ref:p,"label-width":"100px",model:l(o),rules:l(D)},{default:r(()=>[t(d,{label:"客户名称",prop:"customerId"},{default:r(()=>[t(_,{modelValue:l(o).customerId,"onUpdate:modelValue":e[0]||(e[0]=a=>l(o).customerId=a),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"合同名称",prop:"contractId"},{default:r(()=>[t(_,{modelValue:l(o).contractId,"onUpdate:modelValue":e[1]||(e[1]=a=>l(o).contractId=a),placeholder:"请输入合同名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"负责人",prop:"ownerUserId"},{default:r(()=>[t(B,{modelValue:l(o).ownerUserId,"onUpdate:modelValue":e[2]||(e[2]=a=>l(o).ownerUserId=a),clearable:"",placeholder:"请输入负责人"},{default:r(()=>[(b(!0),A(G,null,H(l(w),a=>(b(),g($,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"期数",prop:"period"},{default:r(()=>[t(f,{modelValue:l(o).period,"onUpdate:modelValue":e[3]||(e[3]=a=>l(o).period=a),placeholder:"请输入期数"},null,8,["modelValue"])]),_:1}),t(d,{label:"计划回款金额",prop:"price"},{default:r(()=>[t(f,{modelValue:l(o).price,"onUpdate:modelValue":e[4]||(e[4]=a=>l(o).price=a),placeholder:"请输入计划回款金额"},null,8,["modelValue"])]),_:1}),t(d,{label:"计划回款日期",prop:"returnTime"},{default:r(()=>[t(U,{modelValue:l(o).returnTime,"onUpdate:modelValue":e[5]||(e[5]=a=>l(o).returnTime=a),placeholder:"选择计划回款日期",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1}),t(d,{label:"提前几天提醒",prop:"remindDays"},{default:r(()=>[t(f,{modelValue:l(o).remindDays,"onUpdate:modelValue":e[6]||(e[6]=a=>l(o).remindDays=a),placeholder:"请输入提前几天提醒"},null,8,["modelValue"])]),_:1}),t(d,{label:"提醒日期",prop:"remindTime"},{default:r(()=>[t(U,{modelValue:l(o).remindTime,"onUpdate:modelValue":e[7]||(e[7]=a=>l(o).remindTime=a),placeholder:"选择提醒日期",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1}),t(d,{label:"显示排序",prop:"sort"},{default:r(()=>[t(f,{modelValue:l(o).sort,"onUpdate:modelValue":e[8]||(e[8]=a=>l(o).sort=a),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),t(d,{label:"备注",prop:"remark"},{default:r(()=>[t(_,{modelValue:l(o).remark,"onUpdate:modelValue":e[9]||(e[9]=a=>l(o).remark=a),placeholder:"请输入备注",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[q,l(c)]])]),_:1},8,["modelValue","title"])}}});export{ne as _,ae as a,te as d,re as e,oe as g};

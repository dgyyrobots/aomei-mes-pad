/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{V as M,d as G,r as p,f as H,b as O,g as i,h as N,c as Q,o as _,j as e,m as a,a as l,J as Y,w as b,v as f,K as j,k as x,L as A,M as J,F as W,z as X}from"./index-BdC40rFX.js";import{_ as Z}from"./DictTag.vue_vue_type_script_lang-BKaaD_BY.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{_ as te}from"./index-Cen3Pl2s.js";import{_ as le}from"./LoginLogDetail.vue_vue_type_script_setup_true_lang-ezVZw6cW.js";import{D as E}from"./dict-D4wjFrBa.js";import{d as oe}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";const ae=u=>M.get({url:"/system/login-log/page",params:u}),ne=u=>M.download({url:"/system/login-log/export",params:u}),fe=G({name:"SystemLoginLog",__name:"index",setup(u){const P=X(),g=p(!0),k=p(0),T=p([]),n=H({pageNo:1,pageSize:10,username:void 0,userIp:void 0,createTime:[]}),L=p(),y=p(!1),v=async()=>{g.value=!0;try{const r=await ae(n);T.value=r.list,k.value=r.total}finally{g.value=!1}},m=()=>{n.pageNo=1,v()},F=()=>{L.value.resetFields(),m()},V=p(),U=r=>{V.value.open(r)},$=async()=>{try{await P.exportConfirm(),y.value=!0;const r=await ne(n);oe.excel(r,"登录日志.xls")}catch(r){console.log(r)}finally{y.value=!1}};return O(()=>{v()}),(r,t)=>{const q=te,C=i("el-input"),c=i("el-form-item"),R=i("el-date-picker"),w=j,d=i("el-button"),z=i("el-form"),D=ee,s=i("el-table-column"),S=Z,K=i("el-table"),h=J,I=N("hasPermi"),B=N("loading");return _(),Q(W,null,[e(q,{title:"系统日志",url:"https://doc.iocoder.cn/system-log/"}),e(D,null,{default:a(()=>[e(z,{ref_key:"queryFormRef",ref:L,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(n)},{default:a(()=>[e(c,{label:"用户名称",prop:"username"},{default:a(()=>[e(C,{modelValue:l(n).username,"onUpdate:modelValue":t[0]||(t[0]=o=>l(n).username=o),class:"!w-240px",clearable:"",placeholder:"请输入用户名称",onKeyup:Y(m,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"登录地址",prop:"userIp"},{default:a(()=>[e(C,{modelValue:l(n).userIp,"onUpdate:modelValue":t[1]||(t[1]=o=>l(n).userIp=o),class:"!w-240px",clearable:"",placeholder:"请输入登录地址",onKeyup:Y(m,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"登录日期",prop:"createTime"},{default:a(()=>[e(R,{modelValue:l(n).createTime,"onUpdate:modelValue":t[2]||(t[2]=o=>l(n).createTime=o),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(c,null,{default:a(()=>[e(d,{onClick:m},{default:a(()=>[e(w,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=f(" 搜索 "))]),_:1}),e(d,{onClick:F},{default:a(()=>[e(w,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=f(" 重置 "))]),_:1}),b((_(),x(d,{loading:l(y),plain:"",type:"success",onClick:$},{default:a(()=>[e(w,{class:"mr-5px",icon:"ep:download"}),t[7]||(t[7]=f(" 导出 "))]),_:1},8,["loading"])),[[I,["infra:config:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(D,null,{default:a(()=>[b((_(),x(K,{data:l(T)},{default:a(()=>[e(s,{align:"center",label:"日志编号",prop:"id"}),e(s,{align:"center",label:"操作类型",prop:"logType"},{default:a(o=>[e(S,{type:l(E).SYSTEM_LOGIN_TYPE,value:o.row.logType},null,8,["type","value"])]),_:1}),e(s,{align:"center",label:"用户名称",prop:"username",width:"180"}),e(s,{align:"center",label:"登录地址",prop:"userIp",width:"180"}),e(s,{align:"center",label:"浏览器",prop:"userAgent"}),e(s,{align:"center",label:"登陆结果",prop:"result"},{default:a(o=>[e(S,{type:l(E).SYSTEM_LOGIN_RESULT,value:o.row.result},null,8,["type","value"])]),_:1}),e(s,{align:"center",formatter:l(A),label:"登录日期",prop:"createTime",width:"180"},null,8,["formatter"]),e(s,{align:"center",label:"操作"},{default:a(o=>[b((_(),x(d,{link:"",type:"primary",onClick:re=>U(o.row)},{default:a(()=>t[8]||(t[8]=[f("详情")])),_:2},1032,["onClick"])),[[I,["infra:config:query"]]])]),_:1})]),_:1},8,["data"])),[[B,l(g)]]),e(h,{limit:l(n).pageSize,"onUpdate:limit":t[3]||(t[3]=o=>l(n).pageSize=o),page:l(n).pageNo,"onUpdate:page":t[4]||(t[4]=o=>l(n).pageNo=o),total:l(k),onPagination:v},null,8,["limit","page","total"])]),_:1}),e(le,{ref_key:"detailRef",ref:V},null,512)],64)}}});export{fe as default};

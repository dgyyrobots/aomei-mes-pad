/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{_ as T}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CIA3YA7G.js";import{V as D,d as I,r as c,f as L,b as W,g as r,h as V,k as v,o as u,m as o,w as C,a,j as t,c as E,l as x,v as s,i as $,z as A,N as F}from"./index-BdmDrM2Y.js";import{C as G}from"./CardTitle-COaObGEl.js";const H=async()=>await D.get({url:"/crm/customer-pool-config/get"}),J=async _=>await D.put({url:"/crm/customer-pool-config/save",data:_}),K={class:"flex items-center justify-between"},O={key:0},Q={key:0},h=I({name:"CrmCustomerPoolConfig",__name:"index",setup(_){const w=A(),{t:k}=F(),i=c(!1),l=c({enabled:!1,contactExpireDays:0,dealExpireDays:0,notifyEnabled:!1,notifyDays:0}),N=L({enabled:[{required:!0,message:"是否启用客户公海不能为空",trigger:"blur"}]}),p=c(),b=async()=>{try{i.value=!0;const d=await H();if(d===null)return;l.value=d}finally{i.value=!1}},z=async()=>{if(!(!p||!await p.value.validate())){i.value=!0;try{const e=l.value;await J(e),w.success(k("common.updateSuccess")),await b(),i.value=!1}finally{i.value=!1}}},P=()=>{l.value.enabled||(l.value.contactExpireDays=void 0,l.value.dealExpireDays=void 0,l.value.notifyEnabled=!1,l.value.notifyDays=void 0)},U=()=>{l.value.notifyEnabled||(l.value.notifyDays=void 0)};return W(()=>{b()}),(d,e)=>{const B=r("el-button"),m=r("el-radio"),g=r("el-radio-group"),f=r("el-form-item"),y=r("el-input-number"),R=r("el-card"),j=r("el-form"),q=T,M=V("hasPermi"),S=V("loading");return u(),v(q,null,{default:o(()=>[C((u(),v(j,{ref_key:"formRef",ref:p,"label-width":"160px",model:a(l),rules:a(N)},{default:o(()=>[t(R,{shadow:"never"},{header:o(()=>[$("div",K,[t(a(G),{title:"客户公海规则设置"}),C((u(),v(B,{type:"primary",onClick:z},{default:o(()=>e[5]||(e[5]=[s("保存")])),_:1})),[[M,["crm:customer-pool-config:update"]]])])]),default:o(()=>[t(f,{label:"客户公海规则设置",prop:"enabled"},{default:o(()=>[t(g,{modelValue:a(l).enabled,"onUpdate:modelValue":e[0]||(e[0]=n=>a(l).enabled=n),class:"ml-4",onChange:P},{default:o(()=>[t(m,{label:!1,size:"large"},{default:o(()=>e[6]||(e[6]=[s("不启用")])),_:1}),t(m,{label:!0,size:"large"},{default:o(()=>e[7]||(e[7]=[s("启用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(l).enabled?(u(),E("div",O,[t(f,null,{default:o(()=>[t(y,{modelValue:a(l).contactExpireDays,"onUpdate:modelValue":e[1]||(e[1]=n=>a(l).contactExpireDays=n),class:"mr-2"},null,8,["modelValue"]),e[8]||(e[8]=s(" 天不跟进或 ")),t(y,{modelValue:a(l).dealExpireDays,"onUpdate:modelValue":e[2]||(e[2]=n=>a(l).dealExpireDays=n),class:"mx-2"},null,8,["modelValue"]),e[9]||(e[9]=s(" 天未成交 "))]),_:1}),t(f,{label:"提前提醒设置",prop:"notifyEnabled"},{default:o(()=>[t(g,{modelValue:a(l).notifyEnabled,"onUpdate:modelValue":e[3]||(e[3]=n=>a(l).notifyEnabled=n),class:"ml-4",onChange:U},{default:o(()=>[t(m,{label:!1,size:"large"},{default:o(()=>e[10]||(e[10]=[s("不提醒")])),_:1}),t(m,{label:!0,size:"large"},{default:o(()=>e[11]||(e[11]=[s("提醒")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(l).notifyEnabled?(u(),E("div",Q,[t(f,null,{default:o(()=>[e[12]||(e[12]=s(" 提前 ")),t(y,{modelValue:a(l).notifyDays,"onUpdate:modelValue":e[4]||(e[4]=n=>a(l).notifyDays=n),class:"mx-2"},null,8,["modelValue"]),e[13]||(e[13]=s(" 天提醒 "))]),_:1})])):x("",!0)])):x("",!0)]),_:1})]),_:1},8,["model","rules"])),[[S,a(i)]])]),_:1})}}});export{h as default};

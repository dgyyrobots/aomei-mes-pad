/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 13:49:10 
 */
import{_ as C}from"./Echart.vue_vue_type_script_setup_true_lang-Bc04n2D5.js";import{_ as k}from"./index-hVfLpCoZ.js";import{V as D,d as z,r as A,f as b,b as E,g as i,c as R,o as B,j as e,m as o,v as l,t as s,a as n,F as L}from"./index-BW9ifGp0.js";import"./install-DNIeUnSy.js";const p=()=>D.get({url:"/infra/redis/get-monitor-info"}),O=z({__name:"index",setup(I){const t=A(),g=async()=>{const r=await p();t.value=r},c=b({title:{text:"内存使用情况",left:"center",show:!0,offsetCenter:[0,"20%"],color:"yellow",fontSize:20},toolbox:{show:!1,feature:{restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"峰值",type:"gauge",min:0,max:50,splitNumber:10,color:"#F5C74E",radius:"85%",center:["50%","50%"],startAngle:225,endAngle:-45,axisLine:{lineStyle:{color:[[.2,"#7FFF00"],[.8,"#00FFFF"],[1,"#FF0000"]],width:10}},axisTick:{length:5,lineStyle:{color:"#76D9D7"}},splitLine:{length:20,lineStyle:{color:"#76D9D7"}},axisLabel:{color:"#76D9D7",distance:15,fontSize:15},pointer:{width:7,show:!0},detail:{textStyle:{fontWeight:"normal",fontSize:15,color:"#FFFFFF"},valueAnimation:!0},progress:{show:!0}}]}),u=b({title:{text:"命令统计",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:30,top:10,bottom:20,data:[],textStyle:{color:"#a1a1a1"}},series:[{name:"命令",type:"pie",radius:[20,120],center:["40%","60%"],data:[],roseType:"radius",label:{show:!0},emphasis:{label:{show:!0},itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}),y=()=>{w(),v()},w=async()=>{c.series[0].data=[];try{const r=await p();t.value=r;const _=[],d=[];r.commandStats.forEach(a=>{_.push({name:a.command,value:a.calls}),d.push(a.command)}),u.legend.data=d,u.series[0].data=_}catch(r){console.log(r)}},v=async()=>{try{const r=await p();t.value=r,c.series[0].detail={show:!0,offsetCenter:[0,"50%"],color:"auto",fontSize:30,formatter:t.value.info.used_memory_human},c.series[0].data[0]={value:t.value.info.used_memory_human,name:"内存消耗"},console.log(t.value.info),c.tooltip={formatter:`{b} <br/>{a} : ${t.value.info.used_memory_human}`}}catch(r){console.log(r)}};return E(()=>{g(),y()}),(r,_)=>{const d=k,a=i("el-descriptions-item"),F=i("el-descriptions"),m=i("el-card"),f=i("el-col"),h=C,x=i("el-row"),S=i("el-scrollbar");return B(),R(L,null,[e(d,{title:"Redis 缓存",url:"https://doc.iocoder.cn/redis-cache/"}),e(d,{title:"本地缓存",url:"https://doc.iocoder.cn/local-cache/"}),e(S,{height:"calc(100vh - 88px - 40px - 50px)"},{default:o(()=>[e(x,null,{default:o(()=>[e(f,{class:"card-box",shadow:"hover",span:24},{default:o(()=>[e(m,null,{default:o(()=>[e(F,{border:"",column:6,title:"基本信息"},{default:o(()=>[e(a,{label:"Redis版本 :"},{default:o(()=>[l(s(n(t)?.info?.redis_version),1)]),_:1}),e(a,{label:"运行模式 :"},{default:o(()=>[l(s(n(t)?.info?.redis_mode=="standalone"?"单机":"集群"),1)]),_:1}),e(a,{label:"端口 :"},{default:o(()=>[l(s(n(t)?.info?.tcp_port),1)]),_:1}),e(a,{label:"客户端数 :"},{default:o(()=>[l(s(n(t)?.info?.connected_clients),1)]),_:1}),e(a,{label:"运行时间(天) :"},{default:o(()=>[l(s(n(t)?.info?.uptime_in_days),1)]),_:1}),e(a,{label:"使用内存 :"},{default:o(()=>[l(s(n(t)?.info?.used_memory_human),1)]),_:1}),e(a,{label:"使用CPU :"},{default:o(()=>[l(s(n(t)?.info?parseFloat(n(t)?.info?.used_cpu_user_children).toFixed(2):""),1)]),_:1}),e(a,{label:"内存配置 :"},{default:o(()=>[l(s(n(t)?.info?.maxmemory_human),1)]),_:1}),e(a,{label:"AOF是否开启 :"},{default:o(()=>[l(s(n(t)?.info?.aof_enabled=="0"?"否":"是"),1)]),_:1}),e(a,{label:"RDB是否成功 :"},{default:o(()=>[l(s(n(t)?.info?.rdb_last_bgsave_status),1)]),_:1}),e(a,{label:"Key数量 :"},{default:o(()=>[l(s(n(t)?.dbSize),1)]),_:1}),e(a,{label:"网络入口/出口 :"},{default:o(()=>[l(s(n(t)?.info?.instantaneous_input_kbps)+"kps/ "+s(n(t)?.info?.instantaneous_output_kbps)+"kps ",1)]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{class:"mt-3",span:12},{default:o(()=>[e(m,{gutter:12,shadow:"hover"},{default:o(()=>[e(h,{height:420,options:n(u)},null,8,["options"])]),_:1})]),_:1}),e(f,{class:"mt-3",span:12},{default:o(()=>[e(m,{class:"ml-3",gutter:12,shadow:"hover"},{default:o(()=>[e(h,{height:420,options:n(c)},null,8,["options"])]),_:1})]),_:1})]),_:1})]),_:1})],64)}}});export{O as default};

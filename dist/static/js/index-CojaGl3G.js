/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as ce,u as me,r as y,Y as fe,b as _e,g as u,h as K,c as L,o as i,j as e,m as a,a as o,J as ye,w as g,v as r,K as ge,k as d,F as N,n as be,i as S,t as w,c5 as U,L as ve,M as Ce,z as ke,N as we,A as xe}from"./index-lcC3l4R2.js";import{_ as Se}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C6z1f3RI.js";import{g as Ve}from"./category-C1vxv8tw.js";import{a as Te,d as $e,e as j,f as Pe,h as he}from"./spu-Cs5jL4YR.js";import{c as De}from"./index-Bn4cwl4J.js";import{d as x}from"./constants-BPQb3nxh.js";import{d as Ee}from"./download-U6qaYcnP.js";import{h as Ie,d as Le,t as Ne}from"./tree-vSlcEeQq.js";const Ue=ce({name:"ProductSpu",__name:"index",setup(Be){const b=ke(),{t:H}=we(),{currentRoute:Q,push:P}=me(),h=y(!1),D=y(!1),B=y(0),Y=y([]),F=y([{count:0,name:"出售中商品",type:0},{count:0,name:"仓库中商品",type:1},{count:0,name:"已售罄商品",type:2},{count:0,name:"警戒库存",type:3},{count:0,name:"商品回收站",type:4}]),V=async()=>{const n=await Te();for(const t in n)F.value[Number(t)].count=n[t]},s=y({pageNo:1,pageSize:10,tabType:0,name:"",categoryId:void 0,createTime:void 0}),A=y(),J=n=>{s.value.tabType=n.paneName,f()},f=async()=>{h.value=!0;try{const n=await $e(s.value);Y.value=n.list,B.value=n.total}finally{h.value=!1}},R=async(n,t)=>{try{const k=t===x.RECYCLE.status?"加入到回收站":"恢复到仓库";await b.confirm(`确认要"${n.name}"${k}吗？`),await j({id:n.id,status:t}),b.success(`${k}成功`),await V(),await f()}catch(k){console.log(k)}},W=async n=>{try{const t=n.status?"上架":"下架";await b.confirm(`确认要${t}"${n.name}"吗？`),await j({id:n.id,status:n.status}),b.success(`${t}成功`),await V(),await f()}catch{n.status=n.status===x.DISABLE.status?x.ENABLE.status:x.DISABLE.status}},G=async n=>{try{await b.delConfirm(),await Pe(n),b.success(H("common.delSuccess")),await V(),await f()}catch(t){console.log(t)}},O=n=>{De({urlList:[n]})},E=()=>{f()},X=()=>{A.value.resetFields(),E()},M=n=>{if(typeof n=="number"){P({name:"ProductSpuEdit",params:{id:n}});return}P({name:"ProductSpuAdd"})},Z=n=>{P({name:"ProductSpuDetail",params:{id:n}})},ee=async()=>{try{await b.exportConfirm(),D.value=!0;const n=await he(s);Ee.excel(n,"商品列表.xls")}catch(n){console.log(n)}finally{D.value=!1}},I=y(),te=n=>Ne(I.value,n);return fe(()=>Q.value,()=>{f()}),_e(async()=>{await V(),await f();const n=await Ve({});I.value=Ie(n,"id","parentId")}),(n,t)=>{const k=u("el-input"),c=u("el-form-item"),ae=u("el-cascader"),le=u("el-date-picker"),T=ge,m=u("el-button"),z=u("el-form"),q=Se,ne=u("el-tab-pane"),oe=u("el-tabs"),v=u("el-col"),$=u("el-row"),p=u("el-table-column"),se=u("el-image"),ue=u("el-switch"),ie=u("el-tag"),pe=u("el-table"),re=Ce,C=K("hasPermi"),de=K("loading");return i(),L(N,null,[e(q,null,{default:a(()=>[e(z,{ref_key:"queryFormRef",ref:A,class:"-mb-15px",inline:!0,"label-width":"68px",model:o(s)},{default:a(()=>[e(c,{label:"商品名称",prop:"name"},{default:a(()=>[e(k,{modelValue:o(s).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(s).name=l),class:"!w-240px",clearable:"",placeholder:"请输入商品名称",onKeyup:ye(E,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"商品分类",prop:"categoryId"},{default:a(()=>[e(ae,{modelValue:o(s).categoryId,"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).categoryId=l),class:"w-1/1",clearable:"",filterable:"",options:o(I),placeholder:"请选择商品分类",props:o(Le)},null,8,["modelValue","options","props"])]),_:1}),e(c,{label:"创建时间",prop:"createTime"},{default:a(()=>[e(le,{modelValue:o(s).createTime,"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).createTime=l),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(c,null,{default:a(()=>[e(m,{onClick:E},{default:a(()=>[e(T,{class:"mr-5px",icon:"ep:search"}),t[7]||(t[7]=r(" 搜索 "))]),_:1}),e(m,{onClick:X},{default:a(()=>[e(T,{class:"mr-5px",icon:"ep:refresh"}),t[8]||(t[8]=r(" 重置 "))]),_:1}),g((i(),d(m,{plain:"",type:"primary",onClick:t[3]||(t[3]=l=>M(void 0))},{default:a(()=>[e(T,{class:"mr-5px",icon:"ep:plus"}),t[9]||(t[9]=r(" 新增 "))]),_:1})),[[C,["product:spu:create"]]]),g((i(),d(m,{loading:o(D),plain:"",type:"success",onClick:ee},{default:a(()=>[e(T,{class:"mr-5px",icon:"ep:download"}),t[10]||(t[10]=r(" 导出 "))]),_:1},8,["loading"])),[[C,["product:spu:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(q,null,{default:a(()=>[e(oe,{modelValue:o(s).tabType,"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).tabType=l),onTabClick:J},{default:a(()=>[(i(!0),L(N,null,be(o(F),l=>(i(),d(ne,{key:l.type,label:l.name+"("+l.count+")",name:l.type},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),g((i(),d(pe,{data:o(Y)},{default:a(()=>[e(p,{type:"expand"},{default:a(({row:l})=>[e(z,{class:"spu-table-expand","label-position":"left"},{default:a(()=>[e($,null,{default:a(()=>[e(v,{span:24},{default:a(()=>[e($,null,{default:a(()=>[e(v,{span:8},{default:a(()=>[e(c,{label:"商品分类:"},{default:a(()=>[S("span",null,w(te(l.categoryId)),1)]),_:2},1024)]),_:2},1024),e(v,{span:8},{default:a(()=>[e(c,{label:"市场价:"},{default:a(()=>[S("span",null,w(o(U)(l.marketPrice)),1)]),_:2},1024)]),_:2},1024),e(v,{span:8},{default:a(()=>[e(c,{label:"成本价:"},{default:a(()=>[S("span",null,w(o(U)(l.costPrice)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e($,null,{default:a(()=>[e(v,{span:24},{default:a(()=>[e($,null,{default:a(()=>[e(v,{span:8},{default:a(()=>[e(c,{label:"浏览量:"},{default:a(()=>[S("span",null,w(l.browseCount),1)]),_:2},1024)]),_:2},1024),e(v,{span:8},{default:a(()=>[e(c,{label:"虚拟销量:"},{default:a(()=>[S("span",null,w(l.virtualSalesCount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1}),e(p,{align:"center",label:"商品编号","min-width":"60",prop:"id"}),e(p,{label:"商品图","min-width":"80"},{default:a(({row:l})=>[e(se,{class:"h-30px w-30px",src:l.picUrl,onClick:_=>O(l.picUrl)},null,8,["src","onClick"])]),_:1}),e(p,{label:"商品名称","min-width":"300",prop:"name","show-overflow-tooltip":!0}),e(p,{align:"center",label:"商品售价","min-width":"90",prop:"price"},{default:a(({row:l})=>[r(w(o(U)(l.price))+"元",1)]),_:1}),e(p,{align:"center",label:"销量","min-width":"90",prop:"salesCount"}),e(p,{align:"center",label:"库存","min-width":"90",prop:"stock"}),e(p,{align:"center",label:"排序","min-width":"70",prop:"sort"}),e(p,{align:"center",formatter:o(ve),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),e(p,{align:"center",label:"状态","min-width":"80"},{default:a(({row:l})=>[l.status>=0?(i(),d(ue,{key:0,modelValue:l.status,"onUpdate:modelValue":_=>l.status=_,"active-text":"上架","active-value":1,"inactive-text":"下架","inactive-value":0,"inline-prompt":"",onChange:_=>W(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])):(i(),d(ie,{key:1,type:"info"},{default:a(()=>t[11]||(t[11]=[r("回收站")])),_:1}))]),_:1}),e(p,{align:"center",fixed:"right",label:"操作","min-width":"200"},{default:a(({row:l})=>[g((i(),d(m,{link:"",type:"primary",onClick:_=>Z(l.id)},{default:a(()=>t[12]||(t[12]=[r("详情")])),_:2},1032,["onClick"])),[[C,["product:spu:update"]]]),g((i(),d(m,{link:"",type:"primary",onClick:_=>M(l.id)},{default:a(()=>t[13]||(t[13]=[r("修改")])),_:2},1032,["onClick"])),[[C,["product:spu:update"]]]),o(s).tabType===4?(i(),L(N,{key:0},[g((i(),d(m,{link:"",type:"danger",onClick:_=>G(l.id)},{default:a(()=>t[14]||(t[14]=[r("删除")])),_:2},1032,["onClick"])),[[C,["product:spu:delete"]]]),g((i(),d(m,{link:"",type:"primary",onClick:_=>R(l,o(x).DISABLE.status)},{default:a(()=>t[15]||(t[15]=[r(" 恢复到仓库 ")])),_:2},1032,["onClick"])),[[C,["product:spu:update"]]])],64)):g((i(),d(m,{key:1,link:"",type:"primary",onClick:_=>R(l,o(x).RECYCLE.status)},{default:a(()=>t[16]||(t[16]=[r(" 加入回收站 ")])),_:2},1032,["onClick"])),[[C,["product:spu:update"]]])]),_:1})]),_:1},8,["data"])),[[de,o(h)]]),e(re,{limit:o(s).pageSize,"onUpdate:limit":t[5]||(t[5]=l=>o(s).pageSize=l),page:o(s).pageNo,"onUpdate:page":t[6]||(t[6]=l=>o(s).pageNo=l),total:o(B),onPagination:f},null,8,["limit","page","total"])]),_:1})],64)}}}),je=xe(Ue,[["__scopeId","data-v-d093e76f"]]);export{je as default};

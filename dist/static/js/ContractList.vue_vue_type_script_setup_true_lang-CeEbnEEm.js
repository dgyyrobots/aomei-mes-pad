/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{_ as h}from"./ContentWrap.vue_vue_type_script_setup_true_lang-fpmIiri3.js";import{d as F,r as m,f as P,u as U,Y as E,g as i,h as L,c as M,o as g,F as Y,j as t,m as r,v as b,K as j,w as A,a as e,k as V,t as q,L as v,M as K}from"./index-5TqN_QR1.js";import{_ as O}from"./DictTag.vue_vue_type_script_lang-cZQMmgs8.js";import{_ as Q,g as W}from"./ContractForm.vue_vue_type_script_setup_true_lang-S0CzCXej.js";import{B as G}from"./index-CVGMdpad.js";import{f as H}from"./formatter-CPCKR4oB.js";import{D as J}from"./dict-B2yk4gHf.js";const lt=F({name:"CrmContractList",__name:"ContractList",props:{bizType:{},bizId:{}},setup(y){const c=y,p=m(!0),_=m(0),f=m([]),a=P({pageNo:1,pageSize:10,customerId:void 0}),u=async()=>{p.value=!0;try{a.customerId=void 0;let l={list:[],total:0};switch(c.bizType){case G.CRM_CUSTOMER:a.customerId=c.bizId,l=await W(a);break;default:return}f.value=l.list,_.value=l.total}finally{p.value=!1}},C=()=>{a.pageNo=1,u()},d=m(),w=()=>{d.value.open("create")},{push:T}=U(),k=l=>{T({name:"CrmContractDetail",params:{id:l}})};return E(()=>[c.bizId,c.bizType],()=>{C()},{immediate:!0,deep:!0}),(l,s)=>{const z=j,S=i("el-button"),x=i("el-row"),I=i("el-link"),n=i("el-table-column"),D=O,N=i("el-table"),B=K,R=h,$=L("loading");return g(),M(Y,null,[t(x,{justify:"end"},{default:r(()=>[t(S,{onClick:w},{default:r(()=>[t(z,{class:"mr-5px",icon:"clarity:contract-line"}),s[2]||(s[2]=b(" 创建合同 "))]),_:1})]),_:1}),t(R,{class:"mt-10px"},{default:r(()=>[A((g(),V(N,{data:e(f),"show-overflow-tooltip":!0,stripe:!0},{default:r(()=>[t(n,{align:"center",fixed:"left",label:"合同名称",prop:"name"},{default:r(o=>[t(I,{type:"primary",underline:!1,onClick:X=>k(o.row.id)},{default:r(()=>[b(q(o.row.name),1)]),_:2},1032,["onClick"])]),_:1}),t(n,{align:"center",label:"合同编号",prop:"no"}),t(n,{align:"center",label:"客户名称",prop:"customerName"}),t(n,{align:"center",formatter:e(H),label:"合同金额（元）",prop:"price"},null,8,["formatter"]),t(n,{align:"center",formatter:e(v),label:"开始时间",prop:"startTime",width:"180px"},null,8,["formatter"]),t(n,{align:"center",formatter:e(v),label:"结束时间",prop:"endTime",width:"180px"},null,8,["formatter"]),t(n,{align:"center",label:"状态",prop:"auditStatus"},{default:r(o=>[t(D,{type:e(J).CRM_AUDIT_STATUS,value:o.row.auditStatus},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[$,e(p)]]),t(B,{limit:e(a).pageSize,"onUpdate:limit":s[0]||(s[0]=o=>e(a).pageSize=o),page:e(a).pageNo,"onUpdate:page":s[1]||(s[1]=o=>e(a).pageNo=o),total:e(_),onPagination:u},null,8,["limit","page","total"])]),_:1}),t(Q,{ref_key:"formRef",ref:d,onSuccess:u},null,512)],64)}}});export{lt as _};

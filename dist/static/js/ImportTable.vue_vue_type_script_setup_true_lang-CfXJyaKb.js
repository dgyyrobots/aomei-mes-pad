/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{d as z,r,f as J,g as s,h as M,k as w,o as _,m as a,j as o,a as l,c as P,F as Q,n as A,J as x,v as b,K as G,w as H,aT as O,y as W,_ as X,z as Y}from"./index-BdmDrM2Y.js";import{b as Z,c as ee}from"./index-BVlvSJof.js";import{g as oe}from"./index-BQ4_Be9u.js";const re=z({name:"InfraCodegenImportTable",__name:"ImportTable",emits:["success"],setup(ae,{expose:I,emit:L}){const T=Y(),i=r(!1),g=r(!0),C=r([]),t=J({name:void 0,comment:void 0,dataSourceConfigId:0}),h=r(),m=r([]),d=async()=>{g.value=!0;try{C.value=await Z(t)}finally{g.value=!1}},R=async()=>{t.name=void 0,t.comment=void 0,t.dataSourceConfigId=m.value[0].id,await d()};I({open:async()=>{m.value=await oe(),t.dataSourceConfigId=m.value[0].id,i.value=!0,await d()}});const y=()=>{i.value=!1,u.value=[]},V=r(),u=r([]),D=c=>{l(V)?.toggleRowSelection(c)},F=c=>{u.value=c.map(e=>e.name)},K=async()=>{await ee({dataSourceConfigId:t.dataSourceConfigId,tableNames:u.value}),T.success("导入成功"),U("success"),y()},U=L;return(c,e)=>{const q=s("el-option"),B=s("el-select"),p=s("el-form-item"),S=s("el-input"),k=G,f=s("el-button"),N=s("el-form"),v=s("el-table-column"),E=s("el-row"),$=X,j=M("loading");return _(),w($,{modelValue:l(i),"onUpdate:modelValue":e[3]||(e[3]=n=>W(i)?i.value=n:null),title:"导入表",width:"800px"},{footer:a(()=>[o(f,{disabled:l(u).length===0,type:"primary",onClick:K},{default:a(()=>e[6]||(e[6]=[b("导入")])),_:1},8,["disabled"]),o(f,{onClick:y},{default:a(()=>e[7]||(e[7]=[b("关闭")])),_:1})]),default:a(()=>[o(N,{ref_key:"queryFormRef",ref:h,inline:!0,"label-width":"68px",model:l(t)},{default:a(()=>[o(p,{label:"数据源",prop:"dataSourceConfigId"},{default:a(()=>[o(B,{modelValue:l(t).dataSourceConfigId,"onUpdate:modelValue":e[0]||(e[0]=n=>l(t).dataSourceConfigId=n),class:"!w-240px",placeholder:"请选择数据源"},{default:a(()=>[(_(!0),P(Q,null,A(l(m),n=>(_(),w(q,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(p,{label:"表名称",prop:"name"},{default:a(()=>[o(S,{modelValue:l(t).name,"onUpdate:modelValue":e[1]||(e[1]=n=>l(t).name=n),class:"!w-240px",clearable:"",placeholder:"请输入表名称",onKeyup:x(d,["enter"])},null,8,["modelValue"])]),_:1}),o(p,{label:"表描述",prop:"comment"},{default:a(()=>[o(S,{modelValue:l(t).comment,"onUpdate:modelValue":e[2]||(e[2]=n=>l(t).comment=n),class:"!w-240px",clearable:"",placeholder:"请输入表描述",onKeyup:x(d,["enter"])},null,8,["modelValue"])]),_:1}),o(p,null,{default:a(()=>[o(f,{onClick:d},{default:a(()=>[o(k,{class:"mr-5px",icon:"ep:search"}),e[4]||(e[4]=b(" 搜索 "))]),_:1}),o(f,{onClick:R},{default:a(()=>[o(k,{class:"mr-5px",icon:"ep:refresh"}),e[5]||(e[5]=b(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"]),o(E,null,{default:a(()=>[H((_(),w(l(O),{ref_key:"tableRef",ref:V,data:l(C),height:"260px",onRowClick:D,onSelectionChange:F},{default:a(()=>[o(v,{type:"selection",width:"55"}),o(v,{label:"表名称",prop:"name","show-overflow-tooltip":!0}),o(v,{label:"表描述",prop:"comment","show-overflow-tooltip":!0})]),_:1},8,["data"])),[[j,l(g)]])]),_:1})]),_:1},8,["modelValue"])}}});export{re as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{V as so,W as io,O as Te,r as i,f as X,b as po,X as te,R as mo,Y as fo,Z as m,g as P,h as ne,c as ye,o as _,w as T,j as o,$ as Oe,m as l,J as ue,a as I,D as co,v as g,a0 as vo,k as b,a1 as be,a2 as go,G as No,a3 as _o,i as S,t as De,x as To,C as Pe,M as yo,F as Oo,n as bo,a4 as Do,T as Y,a5 as Po}from"./index-lcC3l4R2.js";import{_ as So}from"./DictTag.vue_vue_type_script_lang-G_4C17ZW.js";import{g as Eo,a as wo,b as Se,c as Ro,e as Io,d as Lo,u as Co,f as Vo,s as zo,h as Ao,i as ho,j as ko}from"./index-aLvMrSQ5.js";import"./CLodopfuncs2-DO7GswBP.js";import{l as xo}from"./index-CYoC9eHz.js";import{D as Ee}from"./dict-B7jb0IEc.js";import"./color-B5phLuB-.js";const Fo=async()=>await so.get({url:"/wms/warehouse/getTreeList"}),Uo={class:"app-container"},Mo={class:"dialog-footer"},qo={class:"dialog-footer"},Xo={style:{"text-align":"right","margin-top":"20px"}},Yo={class:"dialog-footer"},Qo={class:"dialog-footer"},Zo={__name:"index",setup(Bo){const re=io(),s=Te(()=>re.currentSize==="mini"?"small":re.currentSize),V=i(null),k=i(null),E=i(!0),J=i(!1),$=i(!0),Q=i(0),K=i([]),x=i([]),B=i(""),Z=i(!0),se=i(!0),F=i(!1),L=i(!1),ie=i([]),p=i([]),z=i(1),h=i(!1),U=i(!1),de=i(null),j=i(null),pe=i(null),we=i(null),Re=i(null),me=i(null),Ie=i(null),y=X({pageNo:1,pageSize:10,purchaseId:null,goodsNumber:null,goodsName:null,goodsSpecs:null,company:null,monovalent:null,quantity:null,taxes:null,total:null,categoryName:null,brandName:null,createTime:[]}),c=X({}),N=X({}),f=X({poNo:"",goodsNumber:"",receiveNum:"",unitOfMeasure:""}),O=i([]),D=X({splitQuantity:"",splitCount:""}),ee=i([]),Le={multiple:!1,value:"pId",label:"pName"},fe={poNo:[{required:!0,message:"采购单号不能为空",trigger:"blur"}],goodsNumber:[{required:!0,message:"商品编号不能为空",trigger:"blur"}],company:[{required:!0,message:"商品单位不能为空",trigger:"blur"}],quantity:[{required:!0,message:"采购数量不能为空",trigger:"blur"}],receiveNum:[{required:!0,message:"收货数量不能为空",trigger:"blur"}],unitOfMeasure:[{required:!0,message:"收货单位不能为空",trigger:"blur"}]};Te(()=>p.value.length>0);const Ce=()=>{N.poNo="",V.value=null,q()},w=async()=>{E.value=!0;try{const a=await wo(y);K.value=a.list,Q.value=a.total}finally{E.value=!1}},M=()=>{y.pageNo=1,K.value=[],Q.value=0,w()},Ve=()=>{de.value?.resetFields(),Object.assign(y,{pageNo:1,pageSize:10,poNo:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0,createTime:[]}),M()},ze=a=>{p.value=a,Z.value=a.length!==1,se.value=!a.length},Ae=a=>{me.value?.toggleRowSelection(a)},oe=()=>{F.value=!1,L.value=!1,x.value=[],h.value=!1,z.value=1,ce()},ce=()=>{Object.assign(c,{id:void 0,purchaseId:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0}),Object.assign(N,{id:void 0,purchaseId:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0}),j.value?.resetFields(),pe.value?.resetFields()},q=()=>{L.value&&k.value&&te(()=>{k.value.focus(),isFocused.value=!0})};po(()=>{w(),Be(),window.addEventListener("keydown",ve),document.addEventListener("click",()=>{L.value&&q()}),te(()=>{setTimeout(q,500)})}),mo(()=>{he()});const he=()=>{window.removeEventListener("keydown",ve,!1)};fo(()=>L.value,a=>{a?te(()=>{setTimeout(()=>{k.value&&(k.value.focus(),console.log("设置焦点成功"))},300)}):N.poNo=null});const ve=a=>{if(!a.target.value)return;if(a.keyCode===13){V.value=a.target.value;var t=V.value;if(typeof t=="string"&&t.includes("{")&&t.includes("}")){t=t.replace(/"/g,'"').replace(/"/g,'"').replace(/：/g,":").replace(/，/g,","),console.log(t,"newVal 111"),t=t.replace(/\uFEFF/g,""),t=ke(t);const u=JSON.parse(t);try{u&&u.po_no&&(V.value=null,N.poNo=u.po_no,le(),q())}catch{m.error("扫描结果不是有效的 JSON 字符串")}}else typeof t=="object"&&t.po_no?(N.poNo=t.po_no,V.value=null,le(),q()):console.log('输入内容不包含完整的 "{" 和 "}"')}};function ke(a){let e=0,t=!1,u=!1;for(let r=0;r<a.length;r++){const R=a[r];if(u){u=!1;continue}if(R==="\\"){u=!0;continue}if(R==='"'&&(t=!t),!t){if(R==="{")e++;else if(R==="}"&&(e--,e===0)){const v=a.slice(0,r+1);try{return v}catch{throw new Error("Invalid JSON object")}}}}throw new Error("No valid JSON object found")}const xe=async a=>{ce();const e=a.id||p.value[0].id;if(a.status===2){m.error("该单据已入库，禁止修改！");return}try{const t=await xo();ie.value=t;const u=await Se(e);u.unitOfMeasure=u.unitOfMeasure||u.company,Object.assign(c,u),F.value=!0,B.value="修改采购商品明细"}catch(t){console.error("获取数据失败:",t)}},Fe=async()=>{if(j.value)try{await j.value.validate(),c.id!=null?(await Co(c),m.success("修改成功")):(await Vo(c),m.success("新增成功")),F.value=!1,w()}catch(a){console.error("提交失败:",a)}},Ue=async a=>{const e=a.id;try{await Y.confirm('是否确认删除采购商品明细编号为"'+e+'"的数据项?'),await Lo(e),w(),m.success("删除成功")}catch(t){console.error("删除失败:",t)}},Me=async()=>{const a={...y};delete a.pageNo,delete a.pageSize;try{await Y.confirm("是否确认导出所有采购商品明细数据项?"),J.value=!0;const e=await Io(a);console.log("response",e),Po.excel(e,"采购商品明细.xls"),m.success("导出成功")}catch(e){console.error("导出失败:",e)}finally{J.value=!1}},qe=async()=>{try{const a=await Ro(p.value[0].poNo);if(!a){m.error("采购单: "+p.value[0].poNo+"存在未配置单位与收货数量的明细信息，请先配置后打印！");return}if(!Array.isArray(a.data)){console.error("结果不是一个数组: ",a);return}await Y.confirm("确认打印？"),console.log("开始循环: "+a),LODOP.PRINT_INITA(0,0,150,100),LODOP.SET_PRINT_PAGESIZE(2,"","","热敏纸");for(const e of a.data){console.log("数据解析: ",e),LODOP.NEWPAGE(),LODOP.ADD_PRINT_RECT(8,5,150*3.71-10,100*3.71-10,0,1),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("FontName","Microsoft YaHei"),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.SET_PRINT_STYLE("Horient",2),LODOP.ADD_PRINT_TEXT(13,0,150,30,"入库单标签"),LODOP.SET_PRINT_STYLE("FontSize",14),LODOP.SET_PRINT_STYLE("Bold",0),LODOP.SET_PRINT_STYLE("Horient",0),LODOP.ADD_PRINT_TEXT(65,15,120,35,"条码编号:"),LODOP.ADD_PRINT_TEXT(65,120,280,35,e.id),LODOP.ADD_PRINT_TEXT(110,15,120,35,"采购料号:"),LODOP.ADD_PRINT_TEXT(110,120,280,35,e.goodsNumber),LODOP.ADD_PRINT_TEXT(155,15,120,35,"物料名称:"),LODOP.ADD_PRINT_TEXT(155,120,280,35,e.goodsName+e.goodsSpecs),LODOP.ADD_PRINT_TEXT(200,15,120,35,"采购单号:"),LODOP.ADD_PRINT_TEXT(200,120,280,35,e.poNo),LODOP.ADD_PRINT_TEXT(245,15,120,35,"收货数量:"),LODOP.ADD_PRINT_TEXT(245,120,280,35,e.receiveNum+e.unitOfMeasure),LODOP.ADD_PRINT_TEXT(290,15,120,35,"批次号:"),LODOP.ADD_PRINT_TEXT(290,120,280,35,e.batchCode),LODOP.ADD_PRINT_TEXT(335,15,120,35,"收货日期:");const t=new Date(e.receiveTime).toISOString().slice(0,19).replace("T"," ");LODOP.ADD_PRINT_TEXT(335,120,280,35,t);const u={id:e.id,type:"purchase",po_no:e.poNo};LODOP.ADD_PRINT_BARCODE(220,390,170,170,"QRCode",JSON.stringify(u))}LODOP.SET_PRINT_MODE("AUTO_CLOSE_PREWINDOW",1),LODOP.PREVIEW(),await Qe(p.value[0].poNo)}catch(a){console.error("打印失败:",a)}},Xe=async()=>{try{for(let a=0;a<p.value.length;a++){if(!p.value[a].receiveNum){m.error("请先确认第"+(a+1)+"行的收货数量");return}if(!p.value[a].unitOfMeasure){m.error("请先确认第"+(a+1)+"行的收货单位");return}}await Y.confirm("确认批量打印？"),LODOP.PRINT_INITA(0,0,150,100),LODOP.SET_PRINT_PAGESIZE(2,"","","热敏纸");for(const a of p.value.map(e=>e.id)){const t=await Se(a);LODOP.NEWPAGE(),LODOP.ADD_PRINT_RECT(8,5,150*3.71-10,100*3.71-10,0,1),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("FontName","Microsoft YaHei"),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.SET_PRINT_STYLE("Horient",2),LODOP.ADD_PRINT_TEXT(13,0,150,30,"入库单标签"),LODOP.SET_PRINT_STYLE("FontSize",14),LODOP.SET_PRINT_STYLE("Bold",0),LODOP.SET_PRINT_STYLE("Horient",0),LODOP.ADD_PRINT_TEXT(65,15,120,35,"条码编号:"),LODOP.ADD_PRINT_TEXT(65,120,280,35,t.id),LODOP.ADD_PRINT_TEXT(110,15,120,35,"采购料号:"),LODOP.ADD_PRINT_TEXT(110,120,280,35,t.goodsNumber),LODOP.ADD_PRINT_TEXT(155,15,120,35,"物料名称:"),LODOP.ADD_PRINT_TEXT(155,120,280,35,t.goodsName+t.goodsSpecs),LODOP.ADD_PRINT_TEXT(200,15,120,35,"采购单号:"),LODOP.ADD_PRINT_TEXT(200,120,280,35,t.poNo),LODOP.ADD_PRINT_TEXT(245,15,120,35,"收货数量:"),LODOP.ADD_PRINT_TEXT(245,120,280,35,t.receiveNum+t.unitOfMeasure),LODOP.ADD_PRINT_TEXT(290,15,120,35,"批次号:"),LODOP.ADD_PRINT_TEXT(290,120,280,35,t.batchCode),LODOP.ADD_PRINT_TEXT(335,15,120,35,"收货日期:");const u=new Date(t.receiveTime).toISOString().slice(0,19).replace("T"," ");LODOP.ADD_PRINT_TEXT(335,120,280,35,u);const r={id:t.id,type:"purchase",po_no:t.poNo};LODOP.ADD_PRINT_BARCODE(220,390,170,170,"QRCode",JSON.stringify(r))}LODOP.SET_PRINT_MODE("AUTO_CLOSE_PREWINDOW",1),LODOP.PREVIEW(),await Ye()}catch(a){console.error("批量打印失败:",a)}},Ye=async()=>{try{await ho(p.value),m.success("打印成功"),w()}catch(a){console.error("更新状态失败:",a)}},Qe=async a=>{try{await ko(a),m.success("打印成功"),w()}catch(e){console.error("批量更新状态失败:",e)}},Be=async()=>{try{const a=await Fo();ee.value=a,ee.value.map(e=>{e.pId=e.id,e.pName=e.warehouseName,e.children.map(t=>{t.pId=t.id,t.pName=t.locationName,t.children.map(u=>{u.pId=u.id,u.pName=u.areaName})})})}catch(a){console.error("获取仓库列表失败:",a)}},je=a=>{a!=null&&(N.warehouseId=a[0],N.locationId=a[1],N.areaId=a[2])},He=()=>{L.value=!0,B.value="一键入库"},Ge=async()=>{try{for(const t of x.value)if(t.status===0){m.error("存在未打印的单据, 物料号: "+t.goodsNumber+"，请先打印条码!");return}if(!N.wareHouse){m.error("请选择要入库的位置!");return}const a={poNo:N.poNo,warehouseId:N.warehouseId,locationId:N.locationId,areaId:N.areaId};E.value=!0;const e=await zo(a);if(e!=="success"){m.error("入库失败, 请联系系统管理员, 问题如下: "+e);return}L.value=!1,w(),N.poNo="",x.value=[],m.success("入库成功")}catch(a){console.error("入库失败:",a)}finally{E.value=!1}},le=async()=>{if(N.poNo){E.value=!0;try{const a=await Eo(N);x.value=a}finally{E.value=!1}}},We=a=>{scanResult.value=a},Je=()=>{if(p.value.length===0){m.warning("请选择至少一项进行拆分");return}if(!p.value[0].receiveNum){m.warning("请先填写收货数量");return}Object.assign(f,{id:p.value[0].id,poNo:p.value[0].poNo,goodsNumber:p.value[0].goodsNumber,receiveNum:p.value[0].receiveNum,unitOfMeasure:p.value[0].unitOfMeasure}),O.value=p.value.map(a=>({index:z.value,poNo:a.poNo,goodsNumber:a.goodsNumber,unitOfMeasure:a.unitOfMeasure,quantity:""})),h.value=!0},$e=()=>{const a=parseFloat(f.receiveNum);if(O.value.reduce((u,r)=>u+(parseFloat(r.quantity)||0),0)>=a){m.error("拆分数量总和不能超过采购数量");return}z.value+=1;const t={index:z.value,poNo:f.poNo,goodsNumber:f.goodsNumber,unitOfMeasure:f.unitOfMeasure,quantity:""};O.value.push(t)},Ke=async()=>{try{await Y.confirm("是否基于当前采购数量"+f.receiveNum+"追加拆分行?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=parseFloat(f.receiveNum),e=[];let t=0;for(let u=0;u<a;u++)e.push({index:u+1,poNo:f.poNo,goodsNumber:f.goodsNumber,unitOfMeasure:f.unitOfMeasure,quantity:1}),t++;z.value=t+1,O.value=e}catch{}},Ze=a=>{O.value.splice(a,1),O.value.forEach((e,t)=>{e.index=t+1}),O.value.length>0?a.value=Math.max(...O.value.map(e=>e.index)):a.value=0},eo=async()=>{const a=O.value.reduce((t,u)=>t+(parseFloat(u.quantity)||0),0).toFixed(4);if(parseFloat(a)>parseFloat(f.receiveNum)){m.error("拆分数量总和不能超过采购数量");return}for(const t of O.value)if(!t.quantity||parseFloat(t.quantity)===0){m.error("拆分行的数量禁止为空或0");return}const e={id:f.id,poNo:f.poNo,goodsNumber:f.goodsNumber,splitDetails:O.value};E.value=!0;try{await Ao(e),h.value=!1,w(),z.value=1,m.success("拆分成功")}catch(t){console.error("拆分失败:",t)}finally{E.value=!1}},oo=()=>{if(p.value.length===0){m.warning("请选择至少一项进行拆分");return}if(!p.value[0].receiveNum){m.warning("请先填写收货数量");return}U.value=!0},lo=()=>{if(!D.splitQuantity||!D.splitCount){m.error("拆分数量和拆分个数不能为空");return}const a=parseFloat(D.splitQuantity),e=parseInt(D.splitCount,10);if(a*e>p.value[0].receiveNum){m.error("拆分数量乘以拆分个数不能大于当前的入库数量");return}O.value=[];for(let t=0;t<e;t++)O.value.push({index:t+1,poNo:p.value[0].poNo,goodsNumber:p.value[0].goodsNumber,unitOfMeasure:p.value[0].unitOfMeasure,quantity:a});z.value=O.value.length+1,U.value=!1,h.value=!0,D.splitQuantity="",D.splitCount=""},ao=()=>{U.value=!1,D.splitQuantity="",D.splitCount=""};return(a,e)=>{const t=P("el-input"),u=P("el-form-item"),r=P("el-button"),R=P("el-form"),v=P("el-col"),ge=P("right-toolbar"),C=P("el-row"),d=P("el-table-column"),Ne=So,ae=P("el-table"),to=yo,no=P("el-option"),uo=P("el-select"),H=P("el-dialog"),ro=P("el-cascader"),A=ne("hasPermi"),_e=ne("loading"),G=ne("dialogDrag");return _(),ye("div",Uo,[T(o(R,{model:y,ref_key:"queryFormRef",ref:de,size:s.value,inline:!0},{default:l(()=>[o(u,{label:"采购单号",prop:"goodsNumber"},{default:l(()=>[o(t,{modelValue:y.poNo,"onUpdate:modelValue":e[0]||(e[0]=n=>y.poNo=n),placeholder:"请输入采购单号",clearable:"",onKeyup:ue(M,["enter"])},null,8,["modelValue"])]),_:1}),o(u,{label:"商品编号",prop:"goodsNumber"},{default:l(()=>[o(t,{modelValue:y.goodsNumber,"onUpdate:modelValue":e[1]||(e[1]=n=>y.goodsNumber=n),placeholder:"请输入商品编号",clearable:"",onKeyup:ue(M,["enter","native"])},null,8,["modelValue"])]),_:1}),o(u,{label:"商品名称",prop:"goodsName"},{default:l(()=>[o(t,{modelValue:y.goodsName,"onUpdate:modelValue":e[2]||(e[2]=n=>y.goodsName=n),placeholder:"请输入商品名称",clearable:"",onKeyup:ue(M,["enter","native"])},null,8,["modelValue"])]),_:1}),o(u,null,{default:l(()=>[o(r,{type:"primary",icon:I(co),onClick:M},{default:l(()=>e[28]||(e[28]=[g("搜索")])),_:1},8,["icon"]),o(r,{icon:I(vo),onClick:Ve},{default:l(()=>e[29]||(e[29]=[g("重置")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model","size"]),[[Oe,$.value]]),o(C,{gutter:10,class:"mb8"},{default:l(()=>[o(v,{span:1.5},{default:l(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(be),size:s.value,disabled:se.value,onClick:Xe},{default:l(()=>e[30]||(e[30]=[g("批量打印")])),_:1},8,["icon","size","disabled"])),[[A,["purchase:goods:print"]]])]),_:1}),o(v,{span:1.5},{default:l(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(be),size:s.value,disabled:Z.value,onClick:qe},{default:l(()=>e[31]||(e[31]=[g("单据打印")])),_:1},8,["icon","size","disabled"])),[[A,["purchase:goods:print"]]])]),_:1}),o(v,{span:1.5},{default:l(()=>[T((_(),b(r,{type:"warning",plain:"",icon:I(go),size:s.value,onClick:He},{default:l(()=>e[32]||(e[32]=[g("一键入库")])),_:1},8,["icon","size"])),[[A,["purchase:goods:warehousing"]]])]),_:1}),o(v,{span:1.5},{default:l(()=>[T((_(),b(r,{type:"warning",plain:"",icon:I(No),size:s.value,onClick:Me,loading:J.value},{default:l(()=>e[33]||(e[33]=[g("导出")])),_:1},8,["icon","size","loading"])),[[A,["purchase:goods:export"]]])]),_:1}),o(v,{span:1.5},{default:l(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(_o),size:s.value,disabled:Z.value,onClick:Je},{default:l(()=>e[34]||(e[34]=[g("拆分")])),_:1},8,["icon","size","disabled"])),[[A,["purchase:goods:split"]]])]),_:1}),o(ge,{showSearch:$.value,"onUpdate:showSearch":e[3]||(e[3]=n=>$.value=n),onQueryTable:w},null,8,["showSearch"])]),_:1}),T((_(),b(ae,{data:K.value,onSelectionChange:ze,size:s.value,ref_key:"multipleTableRef",ref:me,onRowClick:Ae},{default:l(()=>[o(d,{type:"selection",width:"55",align:"center"}),o(d,{label:"单据编码",align:"center",prop:"id"}),o(d,{label:"采购单号",align:"center",prop:"poNo"}),o(d,{label:"商品编号",align:"center",prop:"goodsNumber"}),o(d,{"show-overflow-tooltip":!0,label:"商品名称",align:"center",prop:"goodsName"}),o(d,{"show-overflow-tooltip":!0,label:"商品规格",align:"center",prop:"goodsSpecs"}),o(d,{label:"商品单位",align:"center",prop:"company"}),o(d,{label:"采购数量",align:"center",prop:"quantity"}),o(d,{label:"收货数量",align:"center",prop:"receiveNum"}),o(d,{label:"创建时间",align:"center",prop:"createTime",width:"180",formatter:a.dateFormatter},{default:l(n=>[S("span",null,De(I(To)(n.row.createTime,"YYYY-MM-DD HH:mm")),1)]),_:1},8,["formatter"]),o(d,{label:"入库状态",prop:"status",width:"80"},{default:l(n=>[o(Ne,{type:I(Ee).PURCHASE_STATUS,value:n.row.status},null,8,["type","value"])]),_:1}),o(d,{width:"150",fixed:"right",label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:l(n=>[T((_(),b(r,{size:s.value,type:"text",onClick:Pe(W=>xe(n.row),["stop"])},{default:l(()=>e[35]||(e[35]=[g("修改")])),_:2},1032,["size","onClick"])),[[A,["purchase:goods:update"]]]),T((_(),b(r,{size:s.value,type:"text",onClick:Pe(W=>Ue(n.row),["stop"])},{default:l(()=>e[36]||(e[36]=[g("删除")])),_:2},1032,["size","onClick"])),[[A,["purchase:goods:delete"]]])]),_:1})]),_:1},8,["data","size"])),[[_e,E.value]]),T(o(to,{size:"currentSize",total:Q.value,page:y.pageNo,"onUpdate:page":e[4]||(e[4]=n=>y.pageNo=n),limit:y.pageSize,"onUpdate:limit":e[5]||(e[5]=n=>y.pageSize=n),onPagination:w},null,8,["total","page","limit"]),[[Oe,Q.value>0]]),T((_(),b(H,{title:B.value,modelValue:F.value,"onUpdate:modelValue":e[15]||(e[15]=n=>F.value=n),width:"65%","append-to-body":""},{footer:l(()=>[S("div",Mo,[o(r,{size:s.value,type:"primary",onClick:Fe},{default:l(()=>e[37]||(e[37]=[g("确 定")])),_:1},8,["size"]),o(r,{size:s.value,onClick:oe},{default:l(()=>e[38]||(e[38]=[g("取 消")])),_:1},8,["size"])])]),default:l(()=>[o(R,{ref_key:"formRef",ref:j,model:c,rules:fe,size:s.value},{default:l(()=>[o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:l(()=>[o(t,{disabled:"",modelValue:c.poNo,"onUpdate:modelValue":e[6]||(e[6]=n=>c.poNo=n),placeholder:"请输入采购单号"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"商品编号",prop:"goodsNumber"},{default:l(()=>[o(t,{disabled:"",modelValue:c.goodsNumber,"onUpdate:modelValue":e[7]||(e[7]=n=>c.goodsNumber=n),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"商品名称",prop:"goodsName"},{default:l(()=>[o(t,{disabled:"",modelValue:c.goodsName,"onUpdate:modelValue":e[8]||(e[8]=n=>c.goodsName=n),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"商品规格",prop:"goodsSpecs"},{default:l(()=>[o(t,{disabled:"",modelValue:c.goodsSpecs,"onUpdate:modelValue":e[9]||(e[9]=n=>c.goodsSpecs=n),placeholder:"请输入商品规格"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"商品单位",prop:"company"},{default:l(()=>[o(t,{disabled:"",modelValue:c.company,"onUpdate:modelValue":e[10]||(e[10]=n=>c.company=n),placeholder:"请输入商品单位"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"采购数量",prop:"quantity"},{default:l(()=>[o(t,{disabled:"",modelValue:c.quantity,"onUpdate:modelValue":e[11]||(e[11]=n=>c.quantity=n),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"收货数量",prop:"receiveNum"},{default:l(()=>[o(t,{modelValue:c.receiveNum,"onUpdate:modelValue":e[12]||(e[12]=n=>c.receiveNum=n),placeholder:"请输入收货数量"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"收货单位"},{default:l(()=>[o(uo,{filterable:"",clearable:"",onFocus:e[13]||(e[13]=n=>n.target.blur()),modelValue:c.unitOfMeasure,"onUpdate:modelValue":e[14]||(e[14]=n=>c.unitOfMeasure=n),width:"100%",placeholder:"请选择"},{default:l(()=>[(_(!0),ye(Oo,null,bo(ie.value,n=>(_(),b(no,{key:n.measureCode,label:n.measureName,value:n.measureCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])]),_:1},8,["title","modelValue"])),[[G]]),T((_(),b(H,{title:B.value,modelValue:L.value,"onUpdate:modelValue":e[19]||(e[19]=n=>L.value=n),width:"75%","append-to-body":""},{footer:l(()=>[S("div",qo,[o(r,{size:s.value,type:"primary",onClick:Ge},{default:l(()=>e[41]||(e[41]=[g("确 定")])),_:1},8,["size"]),o(r,{size:s.value,onClick:oe},{default:l(()=>e[42]||(e[42]=[g("取 消")])),_:1},8,["size"])])]),default:l(()=>[o(R,{ref_key:"wareFormRef",ref:pe,model:N,rules:fe,size:s.value},{default:l(()=>[o(C,{gutter:20},{default:l(()=>[o(v,{span:8},{default:l(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:l(()=>[o(t,{modelValue:N.poNo,"onUpdate:modelValue":e[16]||(e[16]=n=>N.poNo=n),placeholder:"请输入采购单号",onBlur:le,onInput:We},null,8,["modelValue"]),T(S("input",{ref_key:"scannerInput",ref:k,"onUpdate:modelValue":e[17]||(e[17]=n=>V.value=n),placeholder:"请输入",style:{position:"absolute",opacity:"0",width:"0",height:"0","z-index":"-1","-webkit-user-select":"none"},inputmode:"none",autofocus:""},null,512),[[Do,V.value]]),e[39]||(e[39]=S("span",null,"支持扫码枪扫描, 无法扫码时点击重置按钮",-1))]),_:1})]),_:1}),o(v,{span:4},{default:l(()=>[o(r,{type:"primary",round:"",onClick:Ce},{default:l(()=>e[40]||(e[40]=[g("重置")])),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"仓库信息",prop:"goodsNumber"},{default:l(()=>[o(ro,{modelValue:N.wareHouse,"onUpdate:modelValue":e[18]||(e[18]=n=>N.wareHouse=n),options:ee.value,props:Le,onChange:je},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),T((_(),b(ae,{data:x.value,height:"500",size:s.value},{default:l(()=>[o(d,{label:"商品编号",align:"center",prop:"goodsNumber"}),o(d,{label:"商品名称",align:"center",prop:"goodsName"}),o(d,{label:"商品规格",align:"center",prop:"goodsSpecs"}),o(d,{label:"商品单位",align:"center",prop:"company"}),o(d,{label:"采购数量",align:"center",prop:"quantity"}),o(d,{label:"收货数量",align:"center",prop:"receiveNum"}),o(d,{label:"创建时间",align:"center",prop:"createTime"},{default:l(n=>[S("span",null,De(a.parseTime(n.row.createTime)),1)]),_:1}),o(d,{label:"入库状态",prop:"status",width:"80"},{default:l(n=>[o(Ne,{type:I(Ee).PURCHASE_STATUS,value:n.row.status},null,8,["type","value"])]),_:1})]),_:1},8,["data","size"])),[[_e,E.value]])]),_:1},8,["model","size"]),S("div",null,[S("video",{ref_key:"videoCameraRef",ref:Ie,style:{display:"none"}},null,512)])]),_:1},8,["title","modelValue"])),[[G]]),T((_(),b(H,{title:"拆分详情",modelValue:h.value,"onUpdate:modelValue":e[24]||(e[24]=n=>h.value=n),width:"80%","append-to-body":""},{footer:l(()=>[S("div",Yo,[o(r,{size:s.value,onClick:oe},{default:l(()=>e[47]||(e[47]=[g("取消")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:eo},{default:l(()=>e[48]||(e[48]=[g("确定拆分")])),_:1},8,["size"])])]),default:l(()=>[o(R,{ref_key:"splitFormRef",ref:we,model:f,size:s.value},{default:l(()=>[o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:l(()=>[o(t,{disabled:"",modelValue:f.poNo,"onUpdate:modelValue":e[20]||(e[20]=n=>f.poNo=n),placeholder:"请输入采购单号"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"商品编号",prop:"goodsNumber"},{default:l(()=>[o(t,{disabled:"",modelValue:f.goodsNumber,"onUpdate:modelValue":e[21]||(e[21]=n=>f.goodsNumber=n),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(C,{gutter:20},{default:l(()=>[o(v,{span:12},{default:l(()=>[o(u,{label:"入库数量",prop:"quantity"},{default:l(()=>[o(t,{disabled:"",modelValue:f.receiveNum,"onUpdate:modelValue":e[22]||(e[22]=n=>f.receiveNum=n),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1}),o(v,{span:12},{default:l(()=>[o(u,{label:"入库单位",prop:"unitOfMeasure"},{default:l(()=>[o(t,{disabled:"",modelValue:f.unitOfMeasure,"onUpdate:modelValue":e[23]||(e[23]=n=>f.unitOfMeasure=n),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),S("div",Xo,[o(r,{size:s.value,type:"primary",onClick:oo},{default:l(()=>e[43]||(e[43]=[g("按条件拆分")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:Ke},{default:l(()=>e[44]||(e[44]=[g("按数量拆分")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:$e},{default:l(()=>e[45]||(e[45]=[g("新增")])),_:1},8,["size"])]),o(ae,{data:O.value,style:{width:"100%"},"max-height":"400",size:s.value},{default:l(()=>[o(d,{prop:"index",label:"序号",width:"60"}),o(d,{prop:"poNo",label:"采购单号",width:"180"}),o(d,{prop:"goodsNumber",label:"物料料号",width:"180"}),o(d,{prop:"unitOfMeasure",label:"物料单位",width:"180"}),o(d,{prop:"quantity",label:"数量"},{default:l(n=>[o(t,{modelValue:n.row.quantity,"onUpdate:modelValue":W=>n.row.quantity=W,type:"number",placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(d,{label:"操作",width:"100"},{default:l(n=>[o(r,{size:s.value,type:"text",icon:"el-icon-delete",onClick:W=>Ze(n.$index)},{default:l(()=>e[46]||(e[46]=[g("删除")])),_:2},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"])]),_:1},8,["modelValue"])),[[G]]),T((_(),b(H,{title:"按条件拆分",modelValue:U.value,"onUpdate:modelValue":e[27]||(e[27]=n=>U.value=n),width:"50%","append-to-body":""},{footer:l(()=>[S("div",Qo,[o(r,{onClick:ao,size:s.value},{default:l(()=>e[49]||(e[49]=[g("取消")])),_:1},8,["size"]),o(r,{type:"primary",onClick:lo,size:s.value},{default:l(()=>e[50]||(e[50]=[g("确定")])),_:1},8,["size"])])]),default:l(()=>[o(R,{ref_key:"splitConditionFormRef",ref:Re,model:D,size:s.value},{default:l(()=>[o(u,{label:"拆分条数"},{default:l(()=>[o(t,{modelValue:D.splitCount,"onUpdate:modelValue":e[25]||(e[25]=n=>D.splitCount=n),type:"number",step:"1",placeholder:"请输入拆分条数"},null,8,["modelValue"])]),_:1}),o(u,{label:"拆分数量"},{default:l(()=>[o(t,{modelValue:D.splitQuantity,"onUpdate:modelValue":e[26]||(e[26]=n=>D.splitQuantity=n),type:"number",step:"0.001",placeholder:"请输入拆分数量"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","size"])]),_:1},8,["modelValue"])),[[G]])])}}};export{Zo as default};

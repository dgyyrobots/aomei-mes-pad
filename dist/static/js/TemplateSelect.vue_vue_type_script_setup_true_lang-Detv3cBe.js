/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{d as oe,r as d,f as U,b as ne,g as i,h as B,k as _,o as c,m as a,j as l,a as o,J as O,c as se,F as ie,n as me,w as T,v as p,K as re,t as de,L as pe,M as ue,y as ce,_ as fe,z as _e,N as be}from"./index-BdC40rFX.js";import{_ as ge}from"./DictTag.vue_vue_type_script_lang-BKaaD_BY.js";import{_ as ve}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{a as ye,D as N}from"./dict-D4wjFrBa.js";import{g as we,d as Te,a as ke,b as Ie}from"./index-BxEvKQWX.js";import{_ as Ce}from"./TemplateForm.vue_vue_type_script_setup_true_lang-D6Ls73-E.js";import{_ as Ne}from"./TemplateIndexList.vue_vue_type_script_setup_true_lang-AQ6-gNHF.js";import{_ as Ve}from"./TemplateProductList.vue_vue_type_script_setup_true_lang-CRlBg6TS.js";const Be=oe({name:"Template",__name:"TemplateSelect",emits:["onSelected"],setup(xe,{expose:E,emit:M}){const k=_e(),{t:V}=be(),b=d(!0),x=d([]),F=d(0),n=U({pageNo:1,pageSize:10,templateCode:void 0,templateName:void 0,qcTypes:"OQC",enableFlag:void 0,createTime:[]}),S=d();d(!1);const g=async()=>{b.value=!0;try{const m=await we(n);x.value=m.list,F.value=m.total}finally{b.value=!1}},y=()=>{n.pageNo=1,g()},Y=()=>{S.value.resetFields(),y()},P=d(),$=(m,e)=>{P.value.open(m,e)},z=async m=>{try{await k.delConfirm(),await Te(m),k.success(V("common.delSuccess")),await g()}catch{}};ne(()=>{g()});const f=d(!1),A=d(""),K=d(!1);E({open:async()=>{f.value=!0}});const Q=M,G=async()=>{if(s.selectedItemId==null||s.selectedItemId==0){k.warning(V("请至少选择一条数据!"));return}b.value=!0;try{s.selectedTmp=await ke(s.selectedItemId),s.selectedPro=await Ie(s.selectedItemId)}finally{b.value=!1}console.log(s.selectedTmp[0]),console.log(s.selectedPro[0]),Q("onSelected",s),f.value=!1},s=U({loading:!1,showFlag:!1,selectedItemId:void 0,selectedRows:void 0,selectedTmp:void 0,selectedPro:void 0,single:!0,multiple:!0,showSearch:!0,total:0,itemList:[],itemTypeOptions:void 0,itemTypeName:void 0,defaultProps:{children:"children",label:"label"},queryParams:{pageNo:1,pageSize:10,itemCode:void 0,itemName:void 0,itemTypeId:0},columns:[{key:0,label:"物料/产品编码",visible:!0},{key:1,label:"物料/产品名称",visible:!0},{key:2,label:"规格型号",visible:!0},{key:3,label:"单位",visible:!0},{key:4,label:"物料/产品",visible:!0},{key:5,label:"物料分类",visible:!0},{key:6,label:"创建时间",visible:!0}]}),H=m=>{m&&(s.selectedRows=m)};return(m,e)=>{const D=i("el-input"),v=i("el-form-item"),j=i("el-option"),J=i("el-select"),W=i("el-date-picker"),I=re,u=i("el-button"),X=i("el-form"),R=ve,Z=i("el-radio"),r=i("el-table-column"),q=i("el-tab-pane"),h=i("el-tabs"),L=ge,ee=i("el-table"),le=ue,te=fe,C=B("hasPermi"),ae=B("loading");return c(),_(te,{title:o(A),modelValue:o(f),"onUpdate:modelValue":e[9]||(e[9]=t=>ce(f)?f.value=t:null),width:"90%"},{footer:a(()=>[l(u,{onClick:G,type:"primary",disabled:o(K)},{default:a(()=>e[16]||(e[16]=[p("确 定")])),_:1},8,["disabled"]),l(u,{onClick:e[8]||(e[8]=t=>f.value=!1)},{default:a(()=>e[17]||(e[17]=[p("取 消")])),_:1})]),default:a(()=>[l(R,null,{default:a(()=>[l(X,{class:"-mb-15px",model:o(n),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"110px"},{default:a(()=>[l(v,{label:"检测模板编号",prop:"templateCode"},{default:a(()=>[l(D,{modelValue:o(n).templateCode,"onUpdate:modelValue":e[0]||(e[0]=t=>o(n).templateCode=t),placeholder:"请输入检测模板编号",clearable:"",onKeyup:O(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(v,{label:"检测模板名称",prop:"templateName"},{default:a(()=>[l(D,{modelValue:o(n).templateName,"onUpdate:modelValue":e[1]||(e[1]=t=>o(n).templateName=t),placeholder:"请输入检测模板名称",clearable:"",onKeyup:O(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),l(v,{label:"是否启用",prop:"enableFlag"},{default:a(()=>[l(J,{modelValue:o(n).enableFlag,"onUpdate:modelValue":e[2]||(e[2]=t=>o(n).enableFlag=t),placeholder:"请选择是否启用",clearable:"",class:"!w-240px"},{default:a(()=>[(c(!0),se(ie,null,me(o(ye)(o(N).INFRA_BOOLEAN_STRING),t=>(c(),_(j,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(v,{label:"创建时间",prop:"createTime"},{default:a(()=>[l(W,{modelValue:o(n).createTime,"onUpdate:modelValue":e[3]||(e[3]=t=>o(n).createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),l(v,null,{default:a(()=>[l(u,{onClick:y},{default:a(()=>[l(I,{icon:"ep:search",class:"mr-5px"}),e[10]||(e[10]=p(" 搜索 "))]),_:1}),l(u,{onClick:Y},{default:a(()=>[l(I,{icon:"ep:refresh",class:"mr-5px"}),e[11]||(e[11]=p(" 重置 "))]),_:1}),T((c(),_(u,{type:"primary",plain:"",onClick:e[4]||(e[4]=t=>$("create"))},{default:a(()=>[l(I,{icon:"ep:plus",class:"mr-5px"}),e[12]||(e[12]=p(" 新增 "))]),_:1})),[[C,["qmcbasic:template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(R,null,{default:a(()=>[T((c(),_(ee,{data:o(x),stripe:!0,"show-overflow-tooltip":!0},{default:a(()=>[l(r,{align:"center",label:"检测模板编号"},{default:a(t=>[l(Z,{modelValue:o(s).selectedItemId,"onUpdate:modelValue":e[5]||(e[5]=w=>o(s).selectedItemId=w),label:t.row.id,onChange:w=>H(t.row)},{default:a(()=>e[13]||(e[13]=[p(de(""))])),_:2},1032,["modelValue","label","onChange"])]),_:1}),l(r,{type:"expand"},{default:a(t=>[l(h,{"model-value":"templateIndex"},{default:a(()=>[l(q,{label:"检测模板项",name:"templateIndex"},{default:a(()=>[l(Ne,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024),l(q,{label:"检测模板产品",name:"templateProduct"},{default:a(()=>[l(Ve,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024)]),_:2},1024)]),_:1}),l(r,{label:"检测模板编号",align:"center",prop:"templateCode"}),l(r,{label:"检测模板名称",align:"center",prop:"templateName"}),l(r,{label:"检测种类",align:"center",prop:"qcTypes"},{default:a(t=>[l(L,{type:o(N).MES_QC_TYPE,value:t.row.qcTypes},null,8,["type","value"])]),_:1}),l(r,{label:"是否启用",align:"center",prop:"enableFlag"},{default:a(t=>[l(L,{type:o(N).INFRA_BOOLEAN_STRING,value:t.row.enableFlag},null,8,["type","value"])]),_:1}),l(r,{label:"备注",align:"center",prop:"remark"}),l(r,{label:"创建时间",align:"center",prop:"createTime",formatter:o(pe),width:"180px"},null,8,["formatter"]),l(r,{label:"操作",align:"center"},{default:a(t=>[T((c(),_(u,{link:"",type:"primary",onClick:w=>$("update",t.row.id)},{default:a(()=>e[14]||(e[14]=[p(" 编辑 ")])),_:2},1032,["onClick"])),[[C,["qmcbasic:template:update"]]]),T((c(),_(u,{link:"",type:"danger",onClick:w=>z(t.row.id)},{default:a(()=>e[15]||(e[15]=[p(" 删除 ")])),_:2},1032,["onClick"])),[[C,["qmcbasic:template:delete"]]])]),_:1})]),_:1},8,["data"])),[[ae,o(b)]]),l(le,{total:o(F),page:o(n).pageNo,"onUpdate:page":e[6]||(e[6]=t=>o(n).pageNo=t),limit:o(n).pageSize,"onUpdate:limit":e[7]||(e[7]=t=>o(n).pageSize=t),onPagination:g},null,8,["total","page","limit"])]),_:1}),l(Ce,{ref_key:"formRef",ref:P,onSuccess:g},null,512)]),_:1},8,["title","modelValue"])}}});export{Be as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as B,r as m,g as i,h as N,k as p,o as f,m as o,w as S,a as s,j as t,c as A,F as $,n as j,v as V,y as z,_ as E,z as M,N as T}from"./index-D3S9e4gi.js";import{c as q,d as G}from"./index-C0OnZzJq.js";import{g as H}from"./index-C6r8NJY6.js";const W=B({name:"SystemUserAssignRoleForm",__name:"UserAssignRoleForm",emits:["success"],setup(J,{expose:b,emit:k}){const{t:y}=T(),I=M(),n=m(!1),u=m(!1),e=m({id:-1,nickname:"",username:"",roleIds:[]}),d=m(),v=m([]);b({open:async r=>{n.value=!0,F(),e.value.id=r.id,e.value.username=r.username,e.value.nickname=r.nickname,u.value=!0;try{e.value.roleIds=await q(r.id)}finally{u.value=!1}v.value=await H()}});const R=k,U=async()=>{if(!(!d||!await d.value.validate())){u.value=!0;try{await G({userId:e.value.id,roleIds:e.value.roleIds}),I.success(y("common.updateSuccess")),n.value=!1,R("success",!0)}finally{u.value=!1}}},F=()=>{e.value={id:-1,nickname:"",username:"",roleIds:[]},d.value?.resetFields()};return(r,l)=>{const _=i("el-input"),c=i("el-form-item"),x=i("el-option"),w=i("el-select"),C=i("el-form"),g=i("el-button"),L=E,D=N("loading");return f(),p(L,{modelValue:s(n),"onUpdate:modelValue":l[4]||(l[4]=a=>z(n)?n.value=a:null),title:"分配角色"},{footer:o(()=>[t(g,{disabled:s(u),type:"primary",onClick:U},{default:o(()=>l[5]||(l[5]=[V("确 定")])),_:1},8,["disabled"]),t(g,{onClick:l[3]||(l[3]=a=>n.value=!1)},{default:o(()=>l[6]||(l[6]=[V("取 消")])),_:1})]),default:o(()=>[S((f(),p(C,{ref_key:"formRef",ref:d,"label-width":"80px",model:s(e)},{default:o(()=>[t(c,{label:"用户名称"},{default:o(()=>[t(_,{modelValue:s(e).username,"onUpdate:modelValue":l[0]||(l[0]=a=>s(e).username=a),disabled:!0},null,8,["modelValue"])]),_:1}),t(c,{label:"用户昵称"},{default:o(()=>[t(_,{modelValue:s(e).nickname,"onUpdate:modelValue":l[1]||(l[1]=a=>s(e).nickname=a),disabled:!0},null,8,["modelValue"])]),_:1}),t(c,{label:"角色"},{default:o(()=>[t(w,{modelValue:s(e).roleIds,"onUpdate:modelValue":l[2]||(l[2]=a=>s(e).roleIds=a),multiple:"",placeholder:"请选择角色"},{default:o(()=>[(f(!0),A($,null,j(s(v),a=>(f(),p(x,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[D,s(u)]])]),_:1},8,["modelValue"])}}});export{W as _};

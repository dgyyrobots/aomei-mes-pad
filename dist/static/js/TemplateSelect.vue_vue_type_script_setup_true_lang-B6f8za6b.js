/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{d as ne,r as p,f as U,b as se,g as s,h as B,k as f,o as c,m as a,j as e,a as o,J as O,c as ie,F as me,n as re,w as T,v as d,K as pe,t as de,L as ue,M as ce,y as _e,_ as fe,z as be,N as ge}from"./index-DMg0mq0e.js";import{_ as ve}from"./DictTag.vue_vue_type_script_lang-sQcOd7JH.js";import{_ as ye}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DPMk4m5L.js";import{a as we,D as z}from"./dict-BEquckDR.js";import{g as Te,d as ke,a as Ie,b as Ce}from"./index-BwM3jv5x.js";import{_ as Ne}from"./TemplateForm.vue_vue_type_script_setup_true_lang-TV_ztAMM.js";import{_ as Ve}from"./TemplateIndexList.vue_vue_type_script_setup_true_lang-BNfy2I6a.js";import{_ as xe}from"./TemplateProductList.vue_vue_type_script_setup_true_lang-Cfqeuqc8.js";const Oe=ne({name:"Template",__name:"TemplateSelect",emits:["onSelected"],setup(Se,{expose:M,emit:Y}){const k=be(),{t:N}=ge(),b=p(!0),V=p([]),x=p(0),n=U({pageNo:1,pageSize:10,templateCode:void 0,templateName:void 0,enableFlag:void 0,createTime:[]}),S=p(),g=async()=>{b.value=!0;try{const m=await Te(n);V.value=m.list,x.value=m.total}finally{b.value=!1}},y=()=>{n.pageNo=1,g()},A=()=>{S.value.resetFields(),y()},F=p(),P=(m,l)=>{F.value.open(m,l)},E=async m=>{try{await k.delConfirm(),await ke(m),k.success(N("common.delSuccess")),await g()}catch{}};se(()=>{g()});const _=p(!1),K=p(""),G=p(!1);M({open:async()=>{_.value=!0}});const H=Y,$=async()=>{if(i.selectedItemId==null||i.selectedItemId==0){k.warning(N("请至少选择一条数据!"));return}b.value=!0;try{i.selectedTmp=await Ie(i.selectedItemId),i.selectedPro=await Ce(i.selectedItemId)}finally{b.value=!1}console.log(i.selectedTmp[0]),console.log(i.selectedPro[0]),H("onSelected",i),_.value=!1},i=U({loading:!1,showFlag:!1,selectedItemId:void 0,selectedRows:void 0,single:!0,multiple:!0,showSearch:!0,total:0,itemList:[],itemTypeOptions:void 0,itemTypeName:void 0,defaultProps:{children:"children",label:"label"},queryParams:{pageNo:1,pageSize:10,itemCode:void 0,itemName:void 0,itemTypeId:0},columns:[{key:0,label:"物料/产品编码",visible:!0},{key:1,label:"物料/产品名称",visible:!0},{key:2,label:"规格型号",visible:!0},{key:3,label:"单位",visible:!0},{key:4,label:"物料/产品",visible:!0},{key:5,label:"物料分类",visible:!0},{key:6,label:"创建时间",visible:!0}]}),Q=m=>{m&&(i.selectedRows=m)};return(m,l)=>{const D=s("el-input"),v=s("el-form-item"),j=s("el-option"),J=s("el-select"),W=s("el-date-picker"),I=pe,u=s("el-button"),X=s("el-form"),R=ye,Z=s("el-radio"),r=s("el-table-column"),q=s("el-tab-pane"),h=s("el-tabs"),L=ve,ee=s("el-table"),le=ce,te=s("TemplateSelect",!0),ae=fe,C=B("hasPermi"),oe=B("loading");return c(),f(ae,{title:o(K),modelValue:o(_),"onUpdate:modelValue":l[9]||(l[9]=t=>_e(_)?_.value=t:null),width:"80%"},{footer:a(()=>[e(u,{onClick:$,type:"primary",disabled:o(G)},{default:a(()=>l[16]||(l[16]=[d("确 定")])),_:1},8,["disabled"]),e(u,{onClick:l[8]||(l[8]=t=>_.value=!1)},{default:a(()=>l[17]||(l[17]=[d("取 消")])),_:1})]),default:a(()=>[e(R,null,{default:a(()=>[e(X,{class:"-mb-15px",model:o(n),ref_key:"queryFormRef",ref:S,inline:!0,"label-width":"110px"},{default:a(()=>[e(v,{label:"检测模板编号",prop:"templateCode"},{default:a(()=>[e(D,{modelValue:o(n).templateCode,"onUpdate:modelValue":l[0]||(l[0]=t=>o(n).templateCode=t),placeholder:"请输入检测模板编号",clearable:"",onKeyup:O(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(v,{label:"检测模板名称",prop:"templateName"},{default:a(()=>[e(D,{modelValue:o(n).templateName,"onUpdate:modelValue":l[1]||(l[1]=t=>o(n).templateName=t),placeholder:"请输入检测模板名称",clearable:"",onKeyup:O(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(v,{label:"是否启用",prop:"enableFlag"},{default:a(()=>[e(J,{modelValue:o(n).enableFlag,"onUpdate:modelValue":l[2]||(l[2]=t=>o(n).enableFlag=t),placeholder:"请选择是否启用",clearable:"",class:"!w-240px"},{default:a(()=>[(c(!0),ie(me,null,re(o(we)(o(z).INFRA_BOOLEAN_STRING),t=>(c(),f(j,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"创建时间",prop:"createTime"},{default:a(()=>[e(W,{modelValue:o(n).createTime,"onUpdate:modelValue":l[3]||(l[3]=t=>o(n).createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),e(v,null,{default:a(()=>[e(u,{onClick:y},{default:a(()=>[e(I,{icon:"ep:search",class:"mr-5px"}),l[10]||(l[10]=d(" 搜索 "))]),_:1}),e(u,{onClick:A},{default:a(()=>[e(I,{icon:"ep:refresh",class:"mr-5px"}),l[11]||(l[11]=d(" 重置 "))]),_:1}),T((c(),f(u,{type:"primary",plain:"",onClick:l[4]||(l[4]=t=>P("create"))},{default:a(()=>[e(I,{icon:"ep:plus",class:"mr-5px"}),l[12]||(l[12]=d(" 新增 "))]),_:1})),[[C,["qmcbasic:template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(R,null,{default:a(()=>[T((c(),f(ee,{data:o(V),stripe:!0},{default:a(()=>[e(r,{align:"center",label:"选择"},{default:a(t=>[e(Z,{modelValue:o(i).selectedItemId,"onUpdate:modelValue":l[5]||(l[5]=w=>o(i).selectedItemId=w),label:t.row.id,onChange:w=>Q(t.row)},{default:a(()=>l[13]||(l[13]=[d(de(""))])),_:2},1032,["modelValue","label","onChange"])]),_:1}),e(r,{type:"expand"},{default:a(t=>[e(h,{"model-value":"templateIndex"},{default:a(()=>[e(q,{label:"检测模板项",name:"templateIndex"},{default:a(()=>[e(Ve,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024),e(q,{label:"检测模板产品",name:"templateProduct"},{default:a(()=>[e(xe,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024)]),_:2},1024)]),_:1}),e(r,{label:"检测模板编号",align:"center",prop:"templateCode"}),e(r,{label:"检测模板名称",align:"center",prop:"templateName"}),e(r,{label:"检测种类",align:"center",prop:"qcTypes"},{default:a(t=>[e(L,{type:"mes_qc_type",value:t.row.qcTypes},null,8,["value"])]),_:1}),e(r,{label:"是否启用",align:"center",prop:"enableFlag"},{default:a(t=>[e(L,{type:o(z).INFRA_BOOLEAN_STRING,value:t.row.enableFlag},null,8,["type","value"])]),_:1}),e(r,{label:"备注",align:"center",prop:"remark"}),e(r,{label:"创建时间",align:"center",prop:"createTime",formatter:o(ue),width:"180px"},null,8,["formatter"]),e(r,{label:"操作",align:"center",width:"200px"},{default:a(t=>[T((c(),f(u,{link:"",type:"primary",onClick:w=>P("update",t.row.id)},{default:a(()=>l[14]||(l[14]=[d(" 编辑 ")])),_:2},1032,["onClick"])),[[C,["qmcbasic:template:update"]]]),T((c(),f(u,{link:"",type:"danger",onClick:w=>E(t.row.id)},{default:a(()=>l[15]||(l[15]=[d(" 删除 ")])),_:2},1032,["onClick"])),[[C,["qmcbasic:template:delete"]]])]),_:1})]),_:1},8,["data"])),[[oe,o(b)]]),e(le,{total:o(x),page:o(n).pageNo,"onUpdate:page":l[6]||(l[6]=t=>o(n).pageNo=t),limit:o(n).pageSize,"onUpdate:limit":l[7]||(l[7]=t=>o(n).pageSize=t),onPagination:g},null,8,["total","page","limit"])]),_:1}),e(Ne,{ref_key:"formRef",ref:F,onSuccess:g},null,512),e(te,{ref:"template",onOnSelected:$},null,512)]),_:1},8,["title","modelValue"])}}});export{Oe as _};

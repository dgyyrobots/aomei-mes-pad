/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{d as Z,r as i,f as h,b as ee,g as u,h as B,c as M,o as p,j as e,m as a,a as o,J as te,F as q,n as le,k as d,w as g,v as c,K as ae,t as P,c6 as oe,i as z,L as ne,M as re,z as se,N as ie}from"./index-BdmDrM2Y.js";import{_ as pe}from"./DictTag.vue_vue_type_script_lang-bjcRCBWf.js";import{_ as ue}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CIA3YA7G.js";import{_ as ce}from"./ProductDetail.vue_vue_type_script_setup_true_lang-a5_VpKTG.js";import{_ as me,g as de,d as fe,e as _e}from"./ProductForm.vue_vue_type_script_setup_true_lang-BAht-N_W.js";import{g as ge}from"./index-D7uxMdg0.js";import{g as ye}from"./index-BXAiRI9b.js";import{b as ve,D as T}from"./dict-Cm-9nniQ.js";import{d as we}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./tree-vSlcEeQq.js";const Ne=Z({name:"CrmProduct",__name:"index",setup(be){const w=se(),{t:O}=ie(),b=i(!0),U=i(0),S=i([]),r=h({pageNo:1,pageSize:10,name:null,no:null,unit:null,price:null,status:null,categoryId:null,description:null,ownerUserId:null,createTime:[]}),D=i(),C=i(!1),f=async()=>{b.value=!0;try{const n=await de(r);S.value=n.list,U.value=n.total}finally{b.value=!1}},k=()=>{r.pageNo=1,f()},E=()=>{D.value.resetFields(),k()},R=i(),I=(n,t)=>{R.value.open(n,t)},$=i(),K=n=>{$.value.open(n)},A=async n=>{try{await w.delConfirm(),await fe(n),w.success(O("common.delSuccess")),await f()}catch(t){console.log(t)}},Q=async()=>{try{await w.exportConfirm(),C.value=!0;const n=await _e(r);we.excel(n,"产品.xls")}catch(n){console.log(n)}finally{C.value=!1}},N=i([]),V=i([]);return ee(async()=>{await f(),N.value=await ge({}),V.value=await ye()}),(n,t)=>{const Y=u("el-input"),x=u("el-form-item"),j=u("el-option"),J=u("el-select"),v=ae,m=u("el-button"),W=u("el-form"),L=ue,s=u("el-table-column"),F=pe,G=u("el-table"),H=re,y=B("hasPermi"),X=B("loading");return p(),M(q,null,[e(L,null,{default:a(()=>[e(W,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"68px",model:o(r)},{default:a(()=>[e(x,{label:"产品名称",prop:"name"},{default:a(()=>[e(Y,{modelValue:o(r).name,"onUpdate:modelValue":t[0]||(t[0]=l=>o(r).name=l),class:"!w-240px",clearable:"",placeholder:"请输入产品名称",onKeyup:te(k,["enter"])},null,8,["modelValue"])]),_:1}),e(x,{label:"状态",prop:"status"},{default:a(()=>[e(J,{modelValue:o(r).status,"onUpdate:modelValue":t[1]||(t[1]=l=>o(r).status=l),class:"!w-240px",clearable:"",placeholder:"请选择状态"},{default:a(()=>[(p(!0),M(q,null,le(o(ve)(o(T).CRM_PRODUCT_STATUS),l=>(p(),d(j,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:a(()=>[e(m,{onClick:k},{default:a(()=>[e(v,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=c(" 搜索 "))]),_:1}),e(m,{onClick:E},{default:a(()=>[e(v,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=c(" 重置 "))]),_:1}),g((p(),d(m,{type:"primary",onClick:t[2]||(t[2]=l=>I("create"))},{default:a(()=>[e(v,{class:"mr-5px",icon:"ep:plus"}),t[7]||(t[7]=c(" 新增 "))]),_:1})),[[y,["crm:product:create"]]]),g((p(),d(m,{loading:o(C),plain:"",type:"success",onClick:Q},{default:a(()=>[e(v,{class:"mr-5px",icon:"ep:download"}),t[8]||(t[8]=c(" 导出 "))]),_:1},8,["loading"])),[[y,["crm:product:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(L,null,{default:a(()=>[g((p(),d(G,{data:o(S),"show-overflow-tooltip":!0,stripe:!0},{default:a(()=>[e(s,{align:"center",label:"产品名称",prop:"name"}),e(s,{align:"center",label:"产品编码",prop:"no"}),e(s,{align:"center",label:"单位",prop:"unit"},{default:a(l=>[e(F,{type:o(T).PRODUCT_UNIT,value:l.row.unit},null,8,["type","value"])]),_:1}),e(s,{align:"center",label:"价格",prop:"price"},{default:a(({row:l})=>[c(P(o(oe)(l.price)),1)]),_:1}),e(s,{align:"center",label:"状态",prop:"status"},{default:a(l=>[e(F,{type:o(T).CRM_PRODUCT_STATUS,value:l.row.status},null,8,["type","value"])]),_:1}),e(s,{align:"center",label:"产品分类",prop:"categoryId"},{default:a(({row:l})=>[z("span",null,P(o(N)?.find(_=>_.id===l.categoryId)?.name),1)]),_:1}),e(s,{align:"center",label:"产品描述",prop:"description"}),e(s,{align:"center",label:"负责人",prop:"ownerUserId"},{default:a(({row:l})=>[z("span",null,P(o(V)?.find(_=>_.id===l.ownerUserId)?.nickname),1)]),_:1}),e(s,{align:"center",formatter:o(ne),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(s,{align:"center",label:"操作",width:"160"},{default:a(l=>[g((p(),d(m,{link:"",type:"primary",onClick:_=>K(l.row)},{default:a(()=>t[9]||(t[9]=[c("详情")])),_:2},1032,["onClick"])),[[y,["crm:product:query"]]]),g((p(),d(m,{link:"",type:"primary",onClick:_=>I("update",l.row.id)},{default:a(()=>t[10]||(t[10]=[c("编辑")])),_:2},1032,["onClick"])),[[y,["crm:product:update"]]]),g((p(),d(m,{link:"",type:"danger",onClick:_=>A(l.row.id)},{default:a(()=>t[11]||(t[11]=[c("删除")])),_:2},1032,["onClick"])),[[y,["crm:product:delete"]]])]),_:1})]),_:1},8,["data"])),[[X,o(b)]]),e(H,{limit:o(r).pageSize,"onUpdate:limit":t[3]||(t[3]=l=>o(r).pageSize=l),page:o(r).pageNo,"onUpdate:page":t[4]||(t[4]=l=>o(r).pageNo=l),total:o(U),onPagination:f},null,8,["limit","page","total"])]),_:1}),e(me,{ref_key:"formRef",ref:R,onSuccess:f},null,512),e(ce,{ref_key:"detailRef",ref:$,onSuccess:f},null,512)],64)}}});export{Ne as default};

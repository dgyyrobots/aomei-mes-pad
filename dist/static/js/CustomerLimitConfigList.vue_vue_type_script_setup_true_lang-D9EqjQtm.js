/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{d as D,r as f,f as F,b as z,g as C,h as I,c as A,o as s,j as a,w as d,m as i,v as g,K as B,k as p,a as n,l as O,L as j,M as Q,F as V,z as Y,N as q}from"./index-5TqN_QR1.js";import{_ as G}from"./DictTag.vue_vue_type_script_lang-cZQMmgs8.js";import{L as S,_ as K,g as h,d as H}from"./CustomerLimitConfigForm.vue_vue_type_script_setup_true_lang-BMqlA1pG.js";import{D as J}from"./dict-B2yk4gHf.js";const te=D({name:"CustomerLimitConfigList",__name:"CustomerLimitConfigList",props:{confType:{}},setup(v){const T=Y(),{t:x}=q(),_=f(!0),b=f(0),k=f([]),r=F({pageNo:1,pageSize:10,type:v.confType}),m=async()=>{_.value=!0;try{const o=await h(r);k.value=o.list,b.value=o.total}finally{_.value=!1}},w=f(),L=(o,e)=>{w.value.open(o,e,v.confType)},E=async o=>{try{await T.delConfirm(),await H(o),T.success(x("common.delSuccess")),await m()}catch(e){console.log(e)}},M=()=>{r.pageNo=1,m()};return z(()=>{m()}),(o,e)=>{const N=B,u=C("el-button"),l=C("el-table-column"),P=G,$=C("el-table"),R=Q,y=I("hasPermi"),U=I("loading");return s(),A(V,null,[a(u,{plain:"",type:"primary",onClick:M},{default:i(()=>[a(N,{class:"mr-5px",icon:"ep:refresh"}),e[3]||(e[3]=g(" 刷新 "))]),_:1}),d((s(),p(u,{plain:"",type:"primary",onClick:e[0]||(e[0]=t=>L("create"))},{default:i(()=>[a(N,{class:"mr-5px",icon:"ep:plus"}),e[4]||(e[4]=g(" 新增 "))]),_:1})),[[y,["crm:customer-limit-config:create"]]]),d((s(),p($,{class:"mt-4",data:n(k),"show-overflow-tooltip":!0,stripe:!0},{default:i(()=>[a(l,{align:"center",label:"编号",prop:"id"}),a(l,{align:"center",label:"规则类型",prop:"type"}),a(l,{align:"center",formatter:t=>t.users?.map(c=>c.nickname).join("，"),label:"规则适用人群"},null,8,["formatter"]),a(l,{align:"center",formatter:t=>t.depts?.map(c=>c.name).join("，"),label:"规则适用部门"},null,8,["formatter"]),a(l,{align:"center",label:o.confType===n(S).CUSTOMER_QUANTITY_LIMIT?"拥有客户数上限":"锁定客户数上限",prop:"maxCount"},null,8,["label"]),o.confType===n(S).CUSTOMER_QUANTITY_LIMIT?(s(),p(l,{key:0,align:"center",label:"成交客户是否占用拥有客户数",prop:"dealCountEnabled"},{default:i(t=>[a(P,{type:n(J).INFRA_BOOLEAN_STRING,value:t.row.dealCountEnabled},null,8,["type","value"])]),_:1})):O("",!0),a(l,{align:"center",formatter:n(j),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),a(l,{align:"center",fixed:"right",label:"操作","min-width":"110"},{default:i(t=>[d((s(),p(u,{link:"",type:"primary",onClick:c=>L("update",t.row.id)},{default:i(()=>e[5]||(e[5]=[g(" 编辑 ")])),_:2},1032,["onClick"])),[[y,["crm:customer-limit-config:update"]]]),d((s(),p(u,{link:"",type:"danger",onClick:c=>E(t.row.id)},{default:i(()=>e[6]||(e[6]=[g("删除")])),_:2},1032,["onClick"])),[[y,["crm:customer-limit-config:delete"]]])]),_:1})]),_:1},8,["data"])),[[U,n(_)]]),a(R,{limit:n(r).pageSize,"onUpdate:limit":e[1]||(e[1]=t=>n(r).pageSize=t),page:n(r).pageNo,"onUpdate:page":e[2]||(e[2]=t=>n(r).pageNo=t),total:n(b),onPagination:m},null,8,["limit","page","total"]),a(K,{ref_key:"formRef",ref:w,onSuccess:m},null,512)],64)}}});export{te as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{_ as ce}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{_ as me}from"./DictTag.vue_vue_type_script_lang-BKaaD_BY.js";import{g as _e}from"./index-CapiVWXB.js";import{g as fe}from"./index--PCGODU1.js";import{g as ye,p as ve,a as be}from"./index-3CFs3D1Q.js";import{d as ke,aA as j,r as y,H as Te,ac as Ee,u as Pe,b as ge,g as c,h as K,c as m,o as i,j as l,m as t,k as d,l as p,v as s,t as n,a as e,w as z,F as v,i as f,n as R,c6 as _,x as w,q as Se,z as Re,A as De}from"./index-BdC40rFX.js";import{D as E,T as H}from"./constants-BPQb3nxh.js";import{D as b,g as Ae,e as Ce}from"./dict-D4wjFrBa.js";import{_ as we}from"./OrderDeliveryForm.vue_vue_type_script_setup_true_lang-C256NfJM.js";import{_ as Ue}from"./OrderUpdateAddressForm.vue_vue_type_script_setup_true_lang-CI_Q9gR_.js";import{_ as Ie}from"./OrderUpdatePriceForm.vue_vue_type_script_setup_true_lang-Bd5mhA8I.js";import{_ as Ne}from"./OrderUpdateRemarkForm.vue_vue_type_script_setup_true_lang-DWxygYud.js";import"./color-B5phLuB-.js";import"./index-DEyezq8L.js";import"./tree-vSlcEeQq.js";const Fe={key:0},Oe={key:1},Le={class:"el-timeline-right-content"},xe=ke({name:"TradeOrderDetail",__name:"index",props:{id:j.number.def(void 0),showPickUp:j.bool.def(!0)},setup(I){const C=Re(),q=k=>{switch(Ce(b.USER_TYPE,k)?.colorType){case"success":return"#67C23A";case"info":return"#909399";case"warning":return"#E6A23C";case"danger":return"#F56C6C"}return"#409EFF"},a=y({logs:[]}),N=y(),W=()=>{N.value?.open(a.value)},F=y(),G=()=>{F.value?.open(a.value)},O=y(),J=()=>{O.value?.open(a.value)},L=y(),Q=()=>{L.value?.open(a.value)},Z=async()=>{try{await C.confirm("确认核销订单吗？"),await ve(a.value.id),C.success("核销成功"),await P()}catch(k){console.log(k)}},{params:h}=Te(),ee=I,x=h.id||ee.id,P=async()=>{if(x){const k=await be(x);k||(C.error("交易订单不存在"),re()),a.value=k}},{delView:te}=Ee(),{push:le,currentRoute:ae}=Pe(),re=()=>{te(e(ae)),le({name:"TradeOrder"})},se=()=>{C.success("复制成功")},V=y([]),U=y([]),Y=y({});return ge(async()=>{await P(),a.value.deliveryType===E.EXPRESS.type?(V.value=await _e(),form.value.logisticsId&&(U.value=await ye(a.value.id))):a.value.deliveryType===E.PICK_UP.type&&(Y.value=await fe(a.value.pickUpStoreId))}),(k,o)=>{const r=c("el-descriptions-item"),g=me,S=c("el-descriptions"),D=c("el-button"),oe=c("el-tag"),A=c("el-table-column"),ne=c("el-table"),$=c("el-col"),ie=c("el-row"),ue=c("el-link"),M=c("el-timeline-item"),B=c("el-timeline"),de=ce,pe=K("hasPermi"),X=K("clipboard");return i(),m(v,null,[l(de,null,{default:t(()=>[l(S,{title:"订单信息"},{default:t(()=>[l(r,{label:"订单号: "},{default:t(()=>[s(n(e(a).no),1)]),_:1}),l(r,{label:"买家: "},{default:t(()=>[s(n(e(a)?.user?.nickname),1)]),_:1}),l(r,{label:"订单类型: "},{default:t(()=>[l(g,{type:e(b).TRADE_ORDER_TYPE,value:e(a).type},null,8,["type","value"])]),_:1}),l(r,{label:"订单来源: "},{default:t(()=>[l(g,{type:e(b).TERMINAL,value:e(a).terminal},null,8,["type","value"])]),_:1}),l(r,{label:"买家留言: "},{default:t(()=>[s(n(e(a).userRemark),1)]),_:1}),l(r,{label:"商家备注: "},{default:t(()=>[s(n(e(a).remark),1)]),_:1}),l(r,{label:"支付单号: "},{default:t(()=>[s(n(e(a).payOrderId),1)]),_:1}),l(r,{label:"付款方式: "},{default:t(()=>[l(g,{type:e(b).PAY_CHANNEL_CODE,value:e(a).payChannelCode},null,8,["type","value"])]),_:1}),e(a).brokerageUser?(i(),d(r,{key:0,label:"推广用户: "},{default:t(()=>[s(n(e(a).brokerageUser?.nickname),1)]),_:1})):p("",!0)]),_:1}),l(S,{column:1,title:"订单状态"},{default:t(()=>[l(r,{label:"订单状态: "},{default:t(()=>[l(g,{type:e(b).TRADE_ORDER_STATUS,value:e(a).status},null,8,["type","value"])]),_:1}),z((i(),d(r,{"label-class-name":"no-colon"},{default:t(()=>[e(a).status===e(H).UNPAID.status?(i(),d(D,{key:0,type:"primary",onClick:Q},{default:t(()=>o[0]||(o[0]=[s("调整价格")])),_:1})):p("",!0),l(D,{type:"primary",onClick:W},{default:t(()=>o[1]||(o[1]=[s("备注")])),_:1}),e(a).status===e(H).UNDELIVERED.status?(i(),m(v,{key:1},[e(a).deliveryType===e(E).EXPRESS.type?(i(),d(D,{key:0,type:"primary",onClick:G},{default:t(()=>o[2]||(o[2]=[s("发货")])),_:1})):p("",!0),e(a).deliveryType===e(E).EXPRESS.type?(i(),d(D,{key:1,type:"primary",onClick:J},{default:t(()=>o[3]||(o[3]=[s(" 修改地址 ")])),_:1})):p("",!0),e(a).deliveryType===e(E).PICK_UP.type&&I.showPickUp?(i(),d(D,{key:2,type:"primary",onClick:Z},{default:t(()=>o[4]||(o[4]=[s(" 核销 ")])),_:1})):p("",!0)],64)):p("",!0)]),_:1})),[[pe,["trade:order:update"]]]),l(r,null,{label:t(()=>o[5]||(o[5]=[f("span",{style:{color:"red"}},"提醒:",-1)])),default:t(()=>[o[6]||(o[6]=s(" 买家付款成功后，货款将直接进入您的商户号（微信、支付宝） ")),o[7]||(o[7]=f("br",null,null,-1)),o[8]||(o[8]=s(" 请及时关注你发出的包裹状态，确保可以配送至买家手中 ")),o[9]||(o[9]=f("br",null,null,-1)),o[10]||(o[10]=s(" 如果买家表示没收到货或货物有问题，请及时联系买家处理，友好协商 "))]),_:1})]),_:1}),l(S,{title:"商品信息"},{default:t(()=>[l(r,{"label-class-name":"no-colon"},{default:t(()=>[l(ie,{gutter:20},{default:t(()=>[l($,{span:15},{default:t(()=>[l(ne,{border:"",data:e(a).items},{default:t(()=>[l(A,{label:"商品",prop:"spuName",width:"auto"},{default:t(({row:u})=>[s(n(u.spuName)+" ",1),(i(!0),m(v,null,R(u.properties,T=>(i(),d(oe,{key:T.propertyId},{default:t(()=>[s(n(T.propertyName)+": "+n(T.valueName),1)]),_:2},1024))),128))]),_:1}),l(A,{label:"商品原价",prop:"price",width:"150"},{default:t(({row:u})=>[s(n(e(_)(u.price))+"元",1)]),_:1}),l(A,{label:"数量",prop:"count",width:"100"}),l(A,{label:"合计",prop:"payPrice",width:"150"},{default:t(({row:u})=>[s(n(e(_)(u.payPrice))+"元",1)]),_:1}),l(A,{label:"售后状态",prop:"afterSaleStatus",width:"120"},{default:t(({row:u})=>[l(g,{type:e(b).TRADE_ORDER_ITEM_AFTER_SALE_STATUS,value:u.afterSaleStatus},null,8,["type","value"])]),_:1})]),_:1},8,["data"])]),_:1}),l($,{span:10})]),_:1})]),_:1})]),_:1}),l(S,{column:4},{default:t(()=>[l(r,{label:"商品总额: "},{default:t(()=>[s(n(e(_)(e(a).totalPrice))+" 元",1)]),_:1}),l(r,{label:"运费金额: "},{default:t(()=>[s(n(e(_)(e(a).deliveryPrice))+" 元",1)]),_:1}),l(r,{label:"订单调价: "},{default:t(()=>[s(n(e(_)(e(a).adjustPrice))+" 元",1)]),_:1}),(i(),m(v,null,R(1,u=>l(r,{key:u,"label-class-name":"no-colon"})),64)),l(r,null,{label:t(()=>o[11]||(o[11]=[f("span",{style:{color:"red"}},"优惠劵优惠:",-1)])),default:t(()=>[s(" "+n(e(_)(e(a).couponPrice))+" 元 ",1)]),_:1}),l(r,null,{label:t(()=>o[12]||(o[12]=[f("span",{style:{color:"red"}},"VIP 优惠:",-1)])),default:t(()=>[s(" "+n(e(_)(e(a).vipPrice))+" 元 ",1)]),_:1}),l(r,null,{label:t(()=>o[13]||(o[13]=[f("span",{style:{color:"red"}},"活动优惠:",-1)])),default:t(()=>[s(" "+n(e(_)(e(a).discountPrice))+" 元 ",1)]),_:1}),l(r,null,{label:t(()=>o[14]||(o[14]=[f("span",{style:{color:"red"}},"积分抵扣:",-1)])),default:t(()=>[s(" "+n(e(_)(e(a).pointPrice))+" 元 ",1)]),_:1}),(i(),m(v,null,R(3,u=>l(r,{key:u,"label-class-name":"no-colon"})),64)),l(r,{label:"应付金额: "},{default:t(()=>[s(n(e(_)(e(a).payPrice))+" 元",1)]),_:1})]),_:1}),l(S,{column:4,title:"收货信息"},{default:t(()=>[l(r,{label:"配送方式: "},{default:t(()=>[l(g,{type:e(b).TRADE_DELIVERY_TYPE,value:e(a).deliveryType},null,8,["type","value"])]),_:1}),l(r,{label:"收货人: "},{default:t(()=>[s(n(e(a).receiverName),1)]),_:1}),l(r,{label:"联系电话: "},{default:t(()=>[s(n(e(a).receiverMobile),1)]),_:1}),e(a).deliveryType===e(E).EXPRESS.type?(i(),m("div",Fe,[e(a).receiverDetailAddress?(i(),d(r,{key:0,label:"收货地址: "},{default:t(()=>[s(n(e(a).receiverAreaName)+" "+n(e(a).receiverDetailAddress)+" ",1),z(l(ue,{icon:"ep:document-copy",type:"primary"},null,512),[[X,e(a).receiverAreaName+" "+e(a).receiverDetailAddress,"copy"],[X,se,"success"]])]),_:1})):p("",!0),e(a).logisticsId?(i(),d(r,{key:1,label:"物流公司: "},{default:t(()=>[s(n(e(V).find(u=>u.id===e(a).logisticsId)?.name),1)]),_:1})):p("",!0),e(a).logisticsId?(i(),d(r,{key:2,label:"运单号: "},{default:t(()=>[s(n(e(a).logisticsNo),1)]),_:1})):p("",!0),e(w).deliveryTime?(i(),d(r,{key:3,label:"发货时间: "},{default:t(()=>[s(n(e(w)(e(a).deliveryTime)),1)]),_:1})):p("",!0),(i(),m(v,null,R(2,u=>l(r,{key:u,"label-class-name":"no-colon"})),64)),e(U).length>0?(i(),d(r,{key:4,label:"物流详情: "},{default:t(()=>[l(B,null,{default:t(()=>[(i(!0),m(v,null,R(e(U),(u,T)=>(i(),d(M,{key:T,timestamp:e(w)(u.time)},{default:t(()=>[s(n(u.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})):p("",!0)])):p("",!0),e(a).deliveryType===e(E).PICK_UP.type?(i(),m("div",Oe,[e(a).pickUpStoreId?(i(),d(r,{key:0,label:"自提门店: "},{default:t(()=>[s(n(e(Y)?.name),1)]),_:1})):p("",!0)])):p("",!0)]),_:1}),l(S,{title:"订单操作日志"},{default:t(()=>[l(r,{"label-class-name":"no-colon"},{default:t(()=>[l(B,null,{default:t(()=>[(i(!0),m(v,null,R(e(a).logs,(u,T)=>(i(),d(M,{key:T,placement:"top",timestamp:e(w)(u.createTime)},{dot:t(()=>[f("span",{class:"dot-node-style",style:Se({backgroundColor:q(u.userType)})},n(e(Ae)(e(b).USER_TYPE,u.userType)[0]),5)]),default:t(()=>[f("div",Le,n(u.content),1)]),_:2},1032,["timestamp"]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),l(we,{ref_key:"deliveryFormRef",ref:F,onSuccess:P},null,512),l(Ne,{ref_key:"updateRemarkForm",ref:N,onSuccess:P},null,512),l(Ue,{ref_key:"updateAddressFormRef",ref:O,onSuccess:P},null,512),l(Ie,{ref_key:"updatePriceFormRef",ref:L,onSuccess:P},null,512)],64)}}}),Ze=De(xe,[["__scopeId","data-v-bcf0ad4b"]]);export{Ze as default};

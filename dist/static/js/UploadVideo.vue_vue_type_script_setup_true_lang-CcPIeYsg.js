/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 13:49:10 
 */
import{H as M,c as N,U as S}from"./upload-iEM9vXmG.js";import{d as $,bu as j,O as q,r as p,f as A,g as n,k as F,o as H,m as t,j as l,z as I,a as o,i as O,v as m,y as P}from"./index-BW9ifGp0.js";import{U as T}from"./useUpload-BGl72F0U.js";const K=$({__name:"UploadVideo",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","uploaded"],setup(v,{emit:y}){const u=I(),U=j("accountId"),R={title:[{required:!0,message:"请输入标题",trigger:"blur"}],introduction:[{required:!0,message:"请输入描述",trigger:"blur"}]},k=v,f=y,d=q({get(){return k.modelValue},set(a){f("update:modelValue",a)}}),c=p([]),s=A({type:T.Video,title:"",introduction:"",accountId:U}),_=p(null),V=p(null),x=()=>{_.value?.validate(a=>{if(!a)return!1;V.value?.submit()})},B=a=>{if(a.code!==0)return u.error(`上传出错：${a.msg}`),!1;c.value=[],s.title="",s.introduction="",d.value=!1,u.notifySuccess("上传成功"),f("uploaded")},C=a=>u.error(`上传失败: ${a.message}`);return(a,e)=>{const i=n("el-button"),w=n("el-upload"),D=n("el-divider"),g=n("el-input"),b=n("el-form-item"),E=n("el-form"),L=n("el-dialog");return H(),F(L,{modelValue:o(d),"onUpdate:modelValue":e[3]||(e[3]=r=>P(d)?d.value=r:null),title:"新建视频",width:"600px"},{footer:t(()=>[l(i,{onClick:e[2]||(e[2]=r=>d.value=!1)},{default:t(()=>e[6]||(e[6]=[m("取 消")])),_:1}),l(i,{type:"primary",onClick:x},{default:t(()=>e[7]||(e[7]=[m("提 交")])),_:1})]),default:t(()=>[l(w,{ref_key:"uploadVideoRef",ref:V,action:o(S),"auto-upload":!1,"before-upload":o(N),class:"mb-5",data:o(s),"file-list":o(c),headers:o(M),limit:1,multiple:"","on-error":C,"on-success":B},{trigger:t(()=>[l(i,{plain:"",type:"primary"},{default:t(()=>e[4]||(e[4]=[m("选择视频")])),_:1})]),tip:t(()=>e[5]||(e[5]=[O("span",{class:"el-upload__tip",style:{"margin-left":"10px"}},"格式支持 MP4，文件大小不超过 10MB",-1)])),_:1},8,["action","before-upload","data","file-list","headers"]),l(D),l(E,{ref_key:"uploadFormRef",ref:_,model:o(s),rules:R},{default:t(()=>[l(b,{label:"标题",prop:"title"},{default:t(()=>[l(g,{modelValue:o(s).title,"onUpdate:modelValue":e[0]||(e[0]=r=>o(s).title=r),placeholder:"标题将展示在相关播放页面，建议填写清晰、准确、生动的标题"},null,8,["modelValue"])]),_:1}),l(b,{label:"描述",prop:"introduction"},{default:t(()=>[l(g,{modelValue:o(s).introduction,"onUpdate:modelValue":e[1]||(e[1]=r=>o(s).introduction=r),placeholder:"介绍语将展示在相关播放页面，建议填写简洁明确、有信息量的内容",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{K as _};

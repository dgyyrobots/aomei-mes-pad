/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{V as y,d as J,r as p,f as W,g as i,h as X,c as Y,o as k,j as o,m as a,a as l,y as w,w as Z,l as ee,k as te,v,K as oe,F as le,z as ae}from"./index-DMg0mq0e.js";import{_ as se}from"./index-B4jjJPyl.js";import{_ as ne}from"./ReplyForm.vue_vue_type_script_setup_true_lang-BsCo3AIw.js";import{R as q}from"./TabNews-B4s823c_.js";import"./main-CGhNM1M1.js";import"./main.vue_vue_type_script_setup_true_lang-y0ETAFNo.js";import{_ as re}from"./main.vue_vue_type_script_setup_true_lang-CrQbzAb1.js";import{_ as D}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DPMk4m5L.js";import{_ as ue}from"./ReplyTable.vue_vue_type_script_setup_true_lang-CDkmZxJF.js";import{M as _}from"./types-B2Kri3UF.js";import"./main-DIpHnAZ-.js";import"./TabText.vue_vue_type_script_setup_true_lang-sFUD49P0.js";import"./TabImage-C-j_J_BA.js";import"./main-BNO8ahC2.js";import"./main-FYCGpp9a.js";import"./index-B0d6CUMe.js";import"./index-DFujHF3X.js";import"./useUpload-D_n2FN4m.js";import"./TabVoice-DS8WZqED.js";import"./TabVideo-BBrttONi.js";import"./TabMusic.vue_vue_type_script_setup_true_lang-0hKmXNxc.js";import"./dict-BEquckDR.js";import"./index-CK9h_xGL.js";import"./DictTag.vue_vue_type_script_lang-sQcOd7JH.js";import"./color-B5phLuB-.js";import"./main-CQVwz4-m.js";const pe=r=>y.post({url:"/mp/auto-reply/create",data:r}),ie=r=>y.put({url:"/mp/auto-reply/update",data:r}),me=r=>y.delete({url:`/mp/auto-reply/delete?id=${r}`}),de=r=>y.get({url:`/mp/auto-reply/get?id=${r}`}),ce=r=>y.get({url:"/mp/auto-reply/page",params:r}),ze=J({name:"MpAutoReply",__name:"index",setup(r){const f=ae(),A=p(-1),u=p(_.Keyword),U=p(!0),h=p(0),I=p([]),T=p(null),m=W({pageNo:1,pageSize:10,accountId:A}),C=p(!1),d=p(!1),n=p({}),s=p({type:q.Text,accountId:-1}),F=t=>{A.value=t,s.value.accountId=t,m.pageNo=1,g()},g=async()=>{U.value=!0;try{const t=await ce({...m,type:u.value});I.value=t.list,h.value=t.total}finally{U.value=!1}},$=()=>{m.pageNo=1,g()},N=t=>{u.value=t,$()},K=()=>{x(),s.value={type:q.Text,accountId:m.accountId},C.value=!0,d.value=!0},P=async t=>{x();const e=await de(t);n.value={...e},delete n.value.responseMessageType,delete n.value.responseContent,delete n.value.responseMediaId,delete n.value.responseMediaUrl,delete n.value.responseDescription,delete n.value.responseArticles,s.value={type:e.responseMessageType,accountId:m.accountId,content:e.responseContent,mediaId:e.responseMediaId,url:e.responseMediaUrl,title:e.responseTitle,description:e.responseDescription,thumbMediaId:e.responseThumbMediaId,thumbMediaUrl:e.responseThumbMediaUrl,articles:e.responseArticles,musicUrl:e.responseMusicUrl,hqMusicUrl:e.responseHqMusicUrl},C.value=!1,d.value=!0},B=async t=>{await f.confirm("是否确认删除此数据?"),await me(t),await g(),f.success("删除成功")},z=async()=>{await T.value?.validate();const t={...n.value};t.responseMessageType=s.value.type,t.responseContent=s.value.content,t.responseMediaId=s.value.mediaId,t.responseMediaUrl=s.value.url,t.responseTitle=s.value.title,t.responseDescription=s.value.description,t.responseThumbMediaId=s.value.thumbMediaId,t.responseThumbMediaUrl=s.value.thumbMediaUrl,t.responseArticles=s.value.articles,t.responseMusicUrl=s.value.musicUrl,t.responseHqMusicUrl=s.value.hqMusicUrl,n.value.id!==void 0?(await ie(t),f.success("修改成功")):(await pe(t),f.success("新增成功")),d.value=!1,await g()},x=()=>{n.value={id:void 0,accountId:m.accountId,type:u.value,requestKeyword:void 0,requestMatch:u.value===_.Keyword?1:void 0,requestMessageType:void 0},T.value?.resetFields()},H=()=>{d.value=!1,x()};return(t,e)=>{const O=se,S=i("el-form-item"),j=i("el-form"),M=oe,V=i("el-button"),E=i("el-col"),b=i("el-row"),R=i("el-tab-pane"),L=i("el-tabs"),Q=i("el-dialog"),G=X("hasPermi");return k(),Y(le,null,[o(O,{title:"自动回复",url:"https://doc.iocoder.cn/mp/auto-reply/"}),o(l(D),null,{default:a(()=>[o(j,{class:"-mb-15px",inline:!0,"label-width":"68px",model:l(m)},{default:a(()=>[o(S,{label:"公众号",prop:"accountId"},{default:a(()=>[o(l(re),{onChange:F})]),_:1})]),_:1},8,["model"])]),_:1}),o(l(D),null,{default:a(()=>[o(L,{modelValue:l(u),"onUpdate:modelValue":e[0]||(e[0]=c=>w(u)?u.value=c:null),onTabChange:N},{default:a(()=>[o(b,{class:"mb8",gutter:10},{default:a(()=>[o(E,{span:1.5},{default:a(()=>[l(u)!==l(_).Follow||l(I).length<=0?Z((k(),te(V,{key:0,plain:"",type:"primary",onClick:K},{default:a(()=>[o(M,{icon:"ep:plus"}),e[4]||(e[4]=v(" 新增 "))]),_:1})),[[G,["mp:auto-reply:create"]]]):ee("",!0)]),_:1})]),_:1}),o(R,{name:l(_).Follow},{label:a(()=>[o(b,{align:"middle"},{default:a(()=>[o(M,{class:"mr-2px",icon:"ep:star"}),e[5]||(e[5]=v(" 关注时回复 "))]),_:1})]),_:1},8,["name"]),o(R,{name:l(_).Message},{label:a(()=>[o(b,{align:"middle"},{default:a(()=>[o(M,{class:"mr-2px",icon:"ep:chat-line-round"}),e[6]||(e[6]=v(" 消息回复 "))]),_:1})]),_:1},8,["name"]),o(R,{name:l(_).Keyword},{label:a(()=>[o(b,{align:"middle"},{default:a(()=>[o(M,{class:"mr-2px",icon:"fa:newspaper-o"}),e[7]||(e[7]=v(" 关键词回复 "))]),_:1})]),_:1},8,["name"])]),_:1},8,["modelValue"]),o(ue,{list:l(I),loading:l(U),"msg-type":l(u),onOnDelete:B,onOnUpdate:P},null,8,["list","loading","msg-type"]),o(Q,{modelValue:l(d),"onUpdate:modelValue":e[3]||(e[3]=c=>w(d)?d.value=c:null),"destroy-on-close":"",title:l(C)?"新增自动回复":"修改自动回复",width:"800px"},{footer:a(()=>[o(V,{onClick:H},{default:a(()=>e[8]||(e[8]=[v("取 消")])),_:1}),o(V,{type:"primary",onClick:z},{default:a(()=>e[9]||(e[9]=[v("确 定")])),_:1})]),default:a(()=>[o(ne,{ref_key:"formRef",ref:T,modelValue:l(n),"onUpdate:modelValue":e[1]||(e[1]=c=>w(n)?n.value=c:null),reply:l(s),"onUpdate:reply":e[2]||(e[2]=c=>w(s)?s.value=c:null),"msg-type":l(u)},null,8,["modelValue","reply","msg-type"])]),_:1},8,["modelValue","title"])]),_:1})],64)}}});export{ze as default};

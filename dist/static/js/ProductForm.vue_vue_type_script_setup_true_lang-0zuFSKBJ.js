/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 13:49:10 
 */
import{V as v,d as H,r as i,e as J,f as K,b as Q,g as u,h as W,k as g,o as p,m as o,w as X,a as t,j as a,c as I,F as P,n as C,v as R,y as Z,_ as h,N as ee,z as le}from"./index-BW9ifGp0.js";import{c as L,D as S}from"./dict-BcQRoIPV.js";import{g as te}from"./index-DthlJIAh.js";import{h as ae,d as oe}from"./tree-vSlcEeQq.js";import{g as re}from"./index-B3qz3hLy.js";const ve=async s=>await v.get({url:"/crm/product/page",params:s}),se=async s=>await v.get({url:`/crm/product/get?id=${s}`}),ue=async s=>await v.post({url:"/crm/product/create",data:s}),ne=async s=>await v.put({url:"/crm/product/update",data:s}),ge=async s=>await v.delete({url:`/crm/product/delete?id=${s}`}),_e=async s=>await v.download({url:"/crm/product/export-excel",params:s}),be=H({name:"CrmProductForm",__name:"ProductForm",emits:["success"],setup(s,{expose:$,emit:N}){const{t:y}=ee(),k=le(),m=i(!1),T=i(""),c=i(!1),D=i(""),B=J().getUser.id,r=i({id:void 0,name:void 0,no:void 0,unit:void 0,price:void 0,status:void 0,categoryId:void 0,description:void 0,ownerUserId:void 0}),M=K({name:[{required:!0,message:"产品名称不能为空",trigger:"blur"}],no:[{required:!0,message:"产品编码不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"change"}],categoryId:[{required:!0,message:"产品分类ID不能为空",trigger:"blur"}],ownerUserId:[{required:!0,message:"负责人不能为空",trigger:"blur"}],unit:[{required:!0,message:"单位不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"}]}),_=i();$({open:async(f,e)=>{if(m.value=!0,T.value=y(`action.${f}`),D.value=f,j(),r.value.ownerUserId=B,e){c.value=!0;try{r.value=await se(e)}finally{c.value=!1}}}});const O=N,E=async()=>{if(!(!_||!await _.value.validate())){c.value=!0;try{const e=r.value;D.value==="create"?(await ue(e),k.success(y("common.createSuccess"))):(await ne(e),k.success(y("common.updateSuccess"))),m.value=!1,O("success")}finally{c.value=!1}}},j=()=>{r.value={id:void 0,name:void 0,no:void 0,unit:void 0,price:void 0,status:void 0,categoryId:void 0,description:void 0,ownerUserId:void 0},_.value?.resetFields()},x=i([]),q=i([]);return Q(async()=>{const f=await te({});x.value=ae(f,"id","parentId"),q.value=await re()}),(f,e)=>{const b=u("el-input"),n=u("el-form-item"),d=u("el-col"),V=u("el-row"),w=u("el-option"),U=u("el-select"),z=u("el-cascader"),A=u("el-form"),F=u("el-button"),Y=h,G=W("loading");return p(),g(Y,{modelValue:t(m),"onUpdate:modelValue":e[9]||(e[9]=l=>Z(m)?m.value=l:null),title:t(T)},{footer:o(()=>[a(F,{disabled:t(c),type:"primary",onClick:E},{default:o(()=>e[10]||(e[10]=[R("确 定")])),_:1},8,["disabled"]),a(F,{onClick:e[8]||(e[8]=l=>m.value=!1)},{default:o(()=>e[11]||(e[11]=[R("取 消")])),_:1})]),default:o(()=>[X((p(),g(A,{ref_key:"formRef",ref:_,"label-width":"100px",model:t(r),rules:t(M)},{default:o(()=>[a(V,null,{default:o(()=>[a(d,{span:12},{default:o(()=>[a(n,{label:"产品名称",prop:"name"},{default:o(()=>[a(b,{modelValue:t(r).name,"onUpdate:modelValue":e[0]||(e[0]=l=>t(r).name=l),placeholder:"请输入产品名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:o(()=>[a(n,{label:"产品编码",prop:"no"},{default:o(()=>[a(b,{modelValue:t(r).no,"onUpdate:modelValue":e[1]||(e[1]=l=>t(r).no=l),placeholder:"请输入产品编码"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(V,null,{default:o(()=>[a(d,{span:12},{default:o(()=>[a(n,{label:"单位",prop:"unit"},{default:o(()=>[a(U,{modelValue:t(r).unit,"onUpdate:modelValue":e[2]||(e[2]=l=>t(r).unit=l),class:"w-1/1",placeholder:"请选择单位"},{default:o(()=>[(p(!0),I(P,null,C(t(L)(t(S).PRODUCT_UNIT),l=>(p(),g(w,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:o(()=>[a(n,{label:"价格",prop:"price"},{default:o(()=>[a(b,{modelValue:t(r).price,"onUpdate:modelValue":e[3]||(e[3]=l=>t(r).price=l),placeholder:"请输入价格",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(V,null,{default:o(()=>[a(d,{span:12},{default:o(()=>[a(n,{label:"状态",prop:"status"},{default:o(()=>[a(U,{modelValue:t(r).status,"onUpdate:modelValue":e[4]||(e[4]=l=>t(r).status=l),placeholder:"请选择状态"},{default:o(()=>[(p(!0),I(P,null,C(t(L)(t(S).CRM_PRODUCT_STATUS),l=>(p(),g(w,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:o(()=>[a(n,{label:"产品分类",prop:"categoryId"},{default:o(()=>[a(z,{modelValue:t(r).categoryId,"onUpdate:modelValue":e[5]||(e[5]=l=>t(r).categoryId=l),class:"w-1/1",clearable:"",filterable:"",options:t(x),placeholder:"请选择产品分类",props:t(oe)},null,8,["modelValue","options","props"])]),_:1})]),_:1})]),_:1}),a(V,null,{default:o(()=>[a(d,{span:12},{default:o(()=>[a(n,{label:"产品描述",prop:"description"},{default:o(()=>[a(b,{modelValue:t(r).description,"onUpdate:modelValue":e[6]||(e[6]=l=>t(r).description=l),placeholder:"请输入产品描述"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{span:12},{default:o(()=>[a(n,{label:"负责人",prop:"ownerUserId"},{default:o(()=>[a(U,{modelValue:t(r).ownerUserId,"onUpdate:modelValue":e[7]||(e[7]=l=>t(r).ownerUserId=l),disabled:t(r).id,placeholder:"请选择负责人"},{default:o(()=>[(p(!0),I(P,null,C(t(q),l=>(p(),g(w,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[G,t(c)]])]),_:1},8,["modelValue","title"])}}});export{be as _,ge as d,_e as e,ve as g};

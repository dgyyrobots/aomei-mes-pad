/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{d as ne,r as m,f as U,b as se,g as s,h as B,k as _,o as c,m as a,j as e,a as o,J as E,c as ie,F as re,n as me,w as k,v as d,K as pe,t as de,L as ue,M as ce,y as fe,_ as _e,z as be,N as ge}from"./index-5TqN_QR1.js";import{_ as ve}from"./DictTag.vue_vue_type_script_lang-cZQMmgs8.js";import{_ as ye}from"./ContentWrap.vue_vue_type_script_setup_true_lang-fpmIiri3.js";import{a as we,D as N}from"./dict-B2yk4gHf.js";import{g as ke,d as Te,b as Ce}from"./index-BA6HnA42.js";import{_ as Ie}from"./TemplateForm.vue_vue_type_script_setup_true_lang-DqLsp55d.js";import{_ as Ne}from"./TemplateIndexList.vue_vue_type_script_setup_true_lang-DcolD4PZ.js";import{_ as Ve}from"./TemplateProductList.vue_vue_type_script_setup_true_lang-CJxCVoyZ.js";const Ue=ne({name:"Template",__name:"TemplateSelect",emits:["onSelected"],setup(Se,{expose:M,emit:Y}){const T=be(),{t:V}=ge(),b=m(!0),S=m([]),x=m(0),n=U({pageNo:1,pageSize:10,templateCode:void 0,templateName:void 0,qcTypes:"OQC",enableFlag:void 0,createTime:[]}),F=m();m(!1);const g=async()=>{b.value=!0;try{const i=await ke(n);S.value=i.list,x.value=i.total}finally{b.value=!1}},y=()=>{n.pageNo=1,g()},z=()=>{F.value.resetFields(),y()},P=m(),$=(i,l)=>{P.value.open(i,l)},A=async i=>{try{await T.delConfirm(),await Te(i),T.success(V("common.delSuccess")),await g()}catch{}};se(()=>{g()});const f=m(!1),K=m(""),Q=m(!1);M({open:async()=>{f.value=!0}});const G=Y,D=async()=>{if(p.selectedItemId==null||p.selectedItemId==0){T.warning(V("请至少选择一条数据!"));return}b.value=!0;try{p.selectedPro=await Ce(p.selectedItemId)}finally{b.value=!1}G("onSelected",p),f.value=!1},p=U({loading:!1,showFlag:!1,selectedItemId:void 0,selectedRows:void 0,selectedTmp:void 0,selectedPro:void 0,single:!0,multiple:!0,showSearch:!0,total:0,itemList:[],itemTypeOptions:void 0,itemTypeName:void 0,defaultProps:{children:"children",label:"label"},queryParams:{pageNo:1,pageSize:10,itemCode:void 0,itemName:void 0,itemTypeId:0},columns:[{key:0,label:"物料/产品编码",visible:!0},{key:1,label:"物料/产品名称",visible:!0},{key:2,label:"规格型号",visible:!0},{key:3,label:"单位",visible:!0},{key:4,label:"物料/产品",visible:!0},{key:5,label:"物料分类",visible:!0},{key:6,label:"创建时间",visible:!0}]}),H=i=>{i&&(p.selectedRows=i)};return(i,l)=>{const R=s("el-input"),v=s("el-form-item"),j=s("el-option"),J=s("el-select"),W=s("el-date-picker"),C=pe,u=s("el-button"),X=s("el-form"),q=ye,Z=s("el-radio"),r=s("el-table-column"),L=s("el-tab-pane"),h=s("el-tabs"),O=ve,ee=s("el-table"),le=ce,te=s("TemplateSelect",!0),ae=_e,I=B("hasPermi"),oe=B("loading");return c(),_(ae,{title:o(K),modelValue:o(f),"onUpdate:modelValue":l[9]||(l[9]=t=>fe(f)?f.value=t:null),width:"90%"},{footer:a(()=>[e(u,{onClick:D,type:"primary",disabled:o(Q)},{default:a(()=>l[16]||(l[16]=[d("确 定")])),_:1},8,["disabled"]),e(u,{onClick:l[8]||(l[8]=t=>f.value=!1)},{default:a(()=>l[17]||(l[17]=[d("取 消")])),_:1})]),default:a(()=>[e(q,null,{default:a(()=>[e(X,{class:"-mb-15px",model:o(n),ref_key:"queryFormRef",ref:F,inline:!0,"label-width":"110px"},{default:a(()=>[e(v,{label:"检测模板编号",prop:"templateCode"},{default:a(()=>[e(R,{modelValue:o(n).templateCode,"onUpdate:modelValue":l[0]||(l[0]=t=>o(n).templateCode=t),placeholder:"请输入检测模板编号",clearable:"",onKeyup:E(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(v,{label:"检测模板名称",prop:"templateName"},{default:a(()=>[e(R,{modelValue:o(n).templateName,"onUpdate:modelValue":l[1]||(l[1]=t=>o(n).templateName=t),placeholder:"请输入检测模板名称",clearable:"",onKeyup:E(y,["enter"]),class:"!w-240px"},null,8,["modelValue"])]),_:1}),e(v,{label:"是否启用",prop:"enableFlag"},{default:a(()=>[e(J,{modelValue:o(n).enableFlag,"onUpdate:modelValue":l[2]||(l[2]=t=>o(n).enableFlag=t),placeholder:"请选择是否启用",clearable:"",class:"!w-240px"},{default:a(()=>[(c(!0),ie(re,null,me(o(we)(o(N).INFRA_BOOLEAN_STRING),t=>(c(),_(j,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"创建时间",prop:"createTime"},{default:a(()=>[e(W,{modelValue:o(n).createTime,"onUpdate:modelValue":l[3]||(l[3]=t=>o(n).createTime=t),"value-format":"YYYY-MM-DD HH:mm:ss",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],class:"!w-240px"},null,8,["modelValue","default-time"])]),_:1}),e(v,null,{default:a(()=>[e(u,{onClick:y},{default:a(()=>[e(C,{icon:"ep:search",class:"mr-5px"}),l[10]||(l[10]=d(" 搜索 "))]),_:1}),e(u,{onClick:z},{default:a(()=>[e(C,{icon:"ep:refresh",class:"mr-5px"}),l[11]||(l[11]=d(" 重置 "))]),_:1}),k((c(),_(u,{type:"primary",plain:"",onClick:l[4]||(l[4]=t=>$("create"))},{default:a(()=>[e(C,{icon:"ep:plus",class:"mr-5px"}),l[12]||(l[12]=d(" 新增 "))]),_:1})),[[I,["qmcbasic:template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(q,null,{default:a(()=>[k((c(),_(ee,{data:o(S),stripe:!0,"show-overflow-tooltip":!0},{default:a(()=>[e(r,{align:"center",label:"检测模板编号"},{default:a(t=>[e(Z,{modelValue:o(p).selectedItemId,"onUpdate:modelValue":l[5]||(l[5]=w=>o(p).selectedItemId=w),label:t.row.id,onChange:w=>H(t.row)},{default:a(()=>l[13]||(l[13]=[d(de(""))])),_:2},1032,["modelValue","label","onChange"])]),_:1}),e(r,{type:"expand"},{default:a(t=>[e(h,{"model-value":"templateIndex"},{default:a(()=>[e(L,{label:"检测模板项",name:"templateIndex"},{default:a(()=>[e(Ne,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024),e(L,{label:"检测模板产品",name:"templateProduct"},{default:a(()=>[e(Ve,{"template-id":t.row.id},null,8,["template-id"])]),_:2},1024)]),_:2},1024)]),_:1}),e(r,{label:"检测模板编号",align:"center",prop:"templateCode"}),e(r,{label:"检测模板名称",align:"center",prop:"templateName"}),e(r,{label:"检测种类",align:"center",prop:"qcTypes"},{default:a(t=>[e(O,{type:o(N).MES_QC_TYPE,value:t.row.qcTypes},null,8,["type","value"])]),_:1}),e(r,{label:"是否启用",align:"center",prop:"enableFlag"},{default:a(t=>[e(O,{type:o(N).INFRA_BOOLEAN_STRING,value:t.row.enableFlag},null,8,["type","value"])]),_:1}),e(r,{label:"备注",align:"center",prop:"remark"}),e(r,{label:"创建时间",align:"center",prop:"createTime",formatter:o(ue),width:"180px"},null,8,["formatter"]),e(r,{label:"操作",align:"center"},{default:a(t=>[k((c(),_(u,{link:"",type:"primary",onClick:w=>$("update",t.row.id)},{default:a(()=>l[14]||(l[14]=[d(" 编辑 ")])),_:2},1032,["onClick"])),[[I,["qmcbasic:template:update"]]]),k((c(),_(u,{link:"",type:"danger",onClick:w=>A(t.row.id)},{default:a(()=>l[15]||(l[15]=[d(" 删除 ")])),_:2},1032,["onClick"])),[[I,["qmcbasic:template:delete"]]])]),_:1})]),_:1},8,["data"])),[[oe,o(b)]]),e(le,{total:o(x),page:o(n).pageNo,"onUpdate:page":l[6]||(l[6]=t=>o(n).pageNo=t),limit:o(n).pageSize,"onUpdate:limit":l[7]||(l[7]=t=>o(n).pageSize=t),onPagination:g},null,8,["total","page","limit"])]),_:1}),e(Ie,{ref_key:"formRef",ref:P,onSuccess:g},null,512),e(te,{ref:"template",onOnSelected:D},null,512)]),_:1},8,["title","modelValue"])}}});export{Ue as _};

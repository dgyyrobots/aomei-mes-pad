/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 13:49:10 
 */
import{d as h,u as G,r as f,f as X,b as Z,g as s,h as A,c as P,o as p,j as t,m as o,a,F as T,n as $,k as m,J as ee,v as d,K as te,w as v,L as x,l as le,M as ae,N as oe,z as ne}from"./index-BW9ifGp0.js";import{_ as re}from"./DictTag.vue_vue_type_script_lang-CGh0XIVR.js";import{_ as se}from"./ContentWrap.vue_vue_type_script_setup_true_lang-58zNwBTb.js";import{c as O,D as y}from"./dict-BcQRoIPV.js";import{a as pe}from"./index-ooVf4mdg.js";import{a as ue}from"./index-BqBsEhGT.js";import"./color-B5phLuB-.js";const ge=h({name:"BpmOALeave",__name:"index",setup(ie){const U=ne(),g=G(),{t:V}=oe(),b=f(!0),E=f(0),S=f([]),n=X({pageNo:1,pageSize:10,type:void 0,result:void 0,reason:void 0,createTime:[]}),D=f(),_=async()=>{b.value=!0;try{const r=await pe(n);S.value=r.list,E.value=r.total}finally{b.value=!1}},w=()=>{n.pageNo=1,_()},q=()=>{D.value.resetFields(),w()},R=()=>{g.push({name:"OALeaveCreate"})},Y=r=>{g.push({name:"OALeaveDetail",query:{id:r.id}})},F=async r=>{const{value:l}=await ElMessageBox.prompt("请输入取消原因","取消流程",{confirmButtonText:V("common.ok"),cancelButtonText:V("common.cancel"),inputPattern:/^[\s\S]*.*\S[\s\S]*$/,inputErrorMessage:"取消原因不能为空"});await ue(r.id,l),U.success("取消成功"),await _()},z=r=>{g.push({name:"BpmProcessInstanceDetail",query:{id:r.processInstanceId}})};return Z(()=>{_()}),(r,l)=>{const B=s("el-option"),L=s("el-select"),c=s("el-form-item"),K=s("el-date-picker"),H=s("el-input"),k=te,i=s("el-button"),Q=s("el-form"),N=se,u=s("el-table-column"),M=re,j=s("el-table"),J=ae,C=A("hasPermi"),W=A("loading");return p(),P(T,null,[t(N,null,{default:o(()=>[t(Q,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"68px",model:a(n)},{default:o(()=>[t(c,{label:"请假类型",prop:"type"},{default:o(()=>[t(L,{modelValue:a(n).type,"onUpdate:modelValue":l[0]||(l[0]=e=>a(n).type=e),class:"!w-240px",clearable:"",placeholder:"请选择请假类型"},{default:o(()=>[(p(!0),P(T,null,$(a(O)(a(y).BPM_OA_LEAVE_TYPE),e=>(p(),m(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"申请时间",prop:"createTime"},{default:o(()=>[t(K,{modelValue:a(n).createTime,"onUpdate:modelValue":l[1]||(l[1]=e=>a(n).createTime=e),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(c,{label:"结果",prop:"result"},{default:o(()=>[t(L,{modelValue:a(n).result,"onUpdate:modelValue":l[2]||(l[2]=e=>a(n).result=e),class:"!w-240px",clearable:"",placeholder:"请选择结果"},{default:o(()=>[(p(!0),P(T,null,$(a(O)(a(y).BPM_PROCESS_INSTANCE_RESULT),e=>(p(),m(B,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"原因",prop:"reason"},{default:o(()=>[t(H,{modelValue:a(n).reason,"onUpdate:modelValue":l[3]||(l[3]=e=>a(n).reason=e),class:"!w-240px",clearable:"",placeholder:"请输入原因",onKeyup:ee(w,["enter"])},null,8,["modelValue"])]),_:1}),t(c,null,{default:o(()=>[t(i,{onClick:w},{default:o(()=>[t(k,{class:"mr-5px",icon:"ep:search"}),l[7]||(l[7]=d(" 搜索 "))]),_:1}),t(i,{onClick:q},{default:o(()=>[t(k,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=d(" 重置 "))]),_:1}),t(i,{plain:"",type:"primary",onClick:l[4]||(l[4]=e=>R())},{default:o(()=>[t(k,{class:"mr-5px",icon:"ep:plus"}),l[9]||(l[9]=d(" 发起请假 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(N,null,{default:o(()=>[v((p(),m(j,{data:a(S)},{default:o(()=>[t(u,{align:"center",label:"申请编号",prop:"id"}),t(u,{align:"center",label:"状态",prop:"result"},{default:o(e=>[t(M,{type:a(y).BPM_PROCESS_INSTANCE_RESULT,value:e.row.result},null,8,["type","value"])]),_:1}),t(u,{align:"center",formatter:a(x),label:"开始时间",prop:"startTime",width:"180"},null,8,["formatter"]),t(u,{align:"center",formatter:a(x),label:"结束时间",prop:"endTime",width:"180"},null,8,["formatter"]),t(u,{align:"center",label:"请假类型",prop:"type"},{default:o(e=>[t(M,{type:a(y).BPM_OA_LEAVE_TYPE,value:e.row.type},null,8,["type","value"])]),_:1}),t(u,{align:"center",label:"原因",prop:"reason"}),t(u,{align:"center",formatter:a(x),label:"申请时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(u,{align:"center",label:"操作",width:"200"},{default:o(e=>[v((p(),m(i,{link:"",type:"primary",onClick:I=>Y(e.row)},{default:o(()=>l[10]||(l[10]=[d("详情")])),_:2},1032,["onClick"])),[[C,["bpm:oa-leave:query"]]]),v((p(),m(i,{link:"",type:"primary",onClick:I=>z(e.row)},{default:o(()=>l[11]||(l[11]=[d("进度")])),_:2},1032,["onClick"])),[[C,["bpm:oa-leave:query"]]]),e.row.result===1?v((p(),m(i,{key:0,link:"",type:"danger",onClick:I=>F(e.row)},{default:o(()=>l[12]||(l[12]=[d(" 取消 ")])),_:2},1032,["onClick"])),[[C,["bpm:oa-leave:create"]]]):le("",!0)]),_:1})]),_:1},8,["data"])),[[W,a(b)]]),t(J,{limit:a(n).pageSize,"onUpdate:limit":l[5]||(l[5]=e=>a(n).pageSize=e),page:a(n).pageNo,"onUpdate:page":l[6]||(l[6]=e=>a(n).pageNo=e),total:a(E),onPagination:_},null,8,["limit","page","total"])]),_:1})],64)}}});export{ge as default};

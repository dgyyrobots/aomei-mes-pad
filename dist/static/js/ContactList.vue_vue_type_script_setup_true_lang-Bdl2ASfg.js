/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{_ as $}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dg75KKir.js";import{d as E,r as p,f as P,u as F,Y as L,g as i,h,c as M,o as g,F as O,j as e,m as n,v as b,K as U,w as j,a as o,k as A,t as V,M as Y}from"./index-D3eRVKjp.js";import{_ as q}from"./DictTag.vue_vue_type_script_lang-h3s-iN69.js";import{_ as G,g as K}from"./ContactForm.vue_vue_type_script_setup_true_lang-Der2ccOi.js";import{D as Q}from"./dict-CqgorI4d.js";import{B as W}from"./index-qSrunOlf.js";const oe=E({name:"CrmContactList",__name:"ContactList",props:{bizType:{},bizId:{}},setup(v){const c=v,m=p(!0),u=p(0),d=p([]),t=P({pageNo:1,pageSize:10,customerId:void 0}),_=async()=>{m.value=!0;try{t.customerId=void 0;let l={list:[],total:0};switch(c.bizType){case W.CRM_CUSTOMER:t.customerId=c.bizId,l=await K(t);break;default:return}d.value=l.list,u.value=l.total}finally{m.value=!1}},y=()=>{t.pageNo=1,_()},f=p(),C=()=>{f.value.open("create")},{push:w}=F(),k=l=>{w({name:"CrmContactDetail",params:{id:l}})};return L(()=>[c.bizId,c.bizType],()=>{y()},{immediate:!0,deep:!0}),(l,s)=>{const z=U,I=i("el-button"),N=i("el-row"),T=i("el-link"),r=i("el-table-column"),x=q,B=i("el-table"),D=Y,R=$,S=h("loading");return g(),M(O,null,[e(N,{justify:"end"},{default:n(()=>[e(I,{onClick:C},{default:n(()=>[e(z,{class:"mr-5px",icon:"system-uicons:contacts"}),s[2]||(s[2]=b(" 创建联系人 "))]),_:1})]),_:1}),e(R,{class:"mt-10px"},{default:n(()=>[j((g(),A(B,{data:o(d),"show-overflow-tooltip":!0,stripe:!0},{default:n(()=>[e(r,{align:"center",fixed:"left",label:"姓名",prop:"name"},{default:n(a=>[e(T,{type:"primary",underline:!1,onClick:H=>k(a.row.id)},{default:n(()=>[b(V(a.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{align:"center",label:"手机号",prop:"mobile"}),e(r,{align:"center",label:"职位",prop:"post"}),e(r,{align:"center",label:"直属上级",prop:"parentName"}),e(r,{align:"center",label:"是否关键决策人",prop:"master"},{default:n(a=>[e(x,{type:o(Q).INFRA_BOOLEAN_STRING,value:a.row.master},null,8,["type","value"])]),_:1})]),_:1},8,["data"])),[[S,o(m)]]),e(D,{limit:o(t).pageSize,"onUpdate:limit":s[0]||(s[0]=a=>o(t).pageSize=a),page:o(t).pageNo,"onUpdate:page":s[1]||(s[1]=a=>o(t).pageNo=a),total:o(u),onPagination:_},null,8,["limit","page","total"])]),_:1}),e(G,{ref_key:"formRef",ref:f,onSuccess:_},null,512)],64)}}});export{oe as _};

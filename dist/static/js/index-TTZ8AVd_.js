/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as Z,r as f,f as ee,u as le,b as te,g as p,h as A,c as x,o as u,j as e,m as o,a as t,J as B,F as k,n as E,k as i,w as g,v as d,K as ae,t as oe,L as I,M as ne,cG as re,z as se,cI as ue,N as pe,cJ as ie}from"./index-D3S9e4gi.js";import{_ as me}from"./DictTag.vue_vue_type_script_lang-DqsMypuM.js";import{_ as de}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DXTslarw.js";import{_ as ce}from"./CustomerForm.vue_vue_type_script_setup_true_lang-CwYB_NOn.js";import{c as T,D as m}from"./dict-D5UmY5m8.js";import{d as _e}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./index-DMSqiyAj.js";import"./tree-vSlcEeQq.js";import"./index-Dg5E73Z_.js";const Ne=Z({name:"CrmCustomer",__name:"index",setup(fe){const R=se(),{t:z}=pe(),S=f(!0),M=f(0),O=f([]),n=ee({pageNo:1,pageSize:10,pool:!1,name:"",mobile:"",industryId:void 0,level:void 0,source:void 0}),D=f(),N=f(!1),v=async()=>{S.value=!0;try{const s=await re(n);O.value=s.list,M.value=s.total}finally{S.value=!1}},y=()=>{n.pageNo=1,v()},K=()=>{D.value.resetFields(),n.pool=!1,y()},{push:q}=le(),G=s=>{q({name:"CrmCustomerDetail",params:{id:s}})},L=f(),F=(s,a)=>{L.value.open(s,a)},Y=async s=>{try{await R.delConfirm(),await ue(s),R.success(z("common.delSuccess")),await v()}catch(a){console.log(a)}},J=async()=>{try{await R.exportConfirm(),N.value=!0;const s=await ie(n);_e.excel(s,"客户.xls")}catch(s){console.log(s)}finally{N.value=!1}};return te(()=>{v()}),(s,a)=>{const $=p("el-input"),c=p("el-form-item"),U=p("el-option"),V=p("el-select"),w=ae,_=p("el-button"),Q=p("el-form"),P=de,r=p("el-table-column"),j=p("el-link"),b=me,W=p("el-table"),H=ne,C=A("hasPermi"),X=A("loading");return u(),x(k,null,[e(P,null,{default:o(()=>[e(Q,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"68px",model:t(n)},{default:o(()=>[e(c,{label:"客户名称",prop:"name"},{default:o(()=>[e($,{modelValue:t(n).name,"onUpdate:modelValue":a[0]||(a[0]=l=>t(n).name=l),class:"!w-240px",clearable:"",placeholder:"请输入客户名称",onKeyup:B(y,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"手机",prop:"mobile"},{default:o(()=>[e($,{modelValue:t(n).mobile,"onUpdate:modelValue":a[1]||(a[1]=l=>t(n).mobile=l),class:"!w-240px",clearable:"",placeholder:"请输入手机",onKeyup:B(y,["enter"])},null,8,["modelValue"])]),_:1}),e(c,{label:"所属行业",prop:"industryId"},{default:o(()=>[e(V,{modelValue:t(n).industryId,"onUpdate:modelValue":a[2]||(a[2]=l=>t(n).industryId=l),class:"!w-240px",clearable:"",placeholder:"请选择所属行业"},{default:o(()=>[(u(!0),x(k,null,E(t(T)(t(m).CRM_CUSTOMER_INDUSTRY),l=>(u(),i(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"客户等级",prop:"level"},{default:o(()=>[e(V,{modelValue:t(n).level,"onUpdate:modelValue":a[3]||(a[3]=l=>t(n).level=l),class:"!w-240px",clearable:"",placeholder:"请选择客户等级"},{default:o(()=>[(u(!0),x(k,null,E(t(T)(t(m).CRM_CUSTOMER_LEVEL),l=>(u(),i(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"客户来源",prop:"source"},{default:o(()=>[e(V,{modelValue:t(n).source,"onUpdate:modelValue":a[4]||(a[4]=l=>t(n).source=l),class:"!w-240px",clearable:"",placeholder:"请选择客户来源"},{default:o(()=>[(u(!0),x(k,null,E(t(T)(t(m).CRM_CUSTOMER_SOURCE),l=>(u(),i(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(c,null,{default:o(()=>[e(_,{onClick:y},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:search"}),a[8]||(a[8]=d(" 搜索 "))]),_:1}),e(_,{onClick:K},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:refresh"}),a[9]||(a[9]=d(" 重置 "))]),_:1}),g((u(),i(_,{type:"primary",onClick:a[5]||(a[5]=l=>F("create"))},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:plus"}),a[10]||(a[10]=d(" 新增 "))]),_:1})),[[C,["crm:customer:create"]]]),g((u(),i(_,{loading:t(N),plain:"",type:"success",onClick:J},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:download"}),a[11]||(a[11]=d(" 导出 "))]),_:1},8,["loading"])),[[C,["crm:customer:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:o(()=>[g((u(),i(W,{data:t(O),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[e(r,{align:"center",label:"编号",prop:"id"}),e(r,{align:"center",label:"客户名称",prop:"name",width:"160"},{default:o(l=>[e(j,{type:"primary",underline:!1,onClick:h=>G(l.row.id)},{default:o(()=>[d(oe(l.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{align:"center",label:"所属行业",prop:"industryId",width:"120"},{default:o(l=>[e(b,{type:t(m).CRM_CUSTOMER_INDUSTRY,value:l.row.industryId},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"客户来源",prop:"source",width:"100"},{default:o(l=>[e(b,{type:t(m).CRM_CUSTOMER_SOURCE,value:l.row.source},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"客户等级",prop:"level",width:"120"},{default:o(l=>[e(b,{type:t(m).CRM_CUSTOMER_LEVEL,value:l.row.level},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"手机",prop:"mobile",width:"120"}),e(r,{align:"center",label:"详细地址",prop:"detailAddress",width:"200"}),e(r,{align:"center",label:"负责人",prop:"ownerUserName"}),e(r,{align:"center",label:"所属部门",prop:"ownerUserDeptName"}),e(r,{align:"center",label:"创建人",prop:"creatorName"}),e(r,{align:"center",formatter:t(I),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"成交状态",prop:"dealStatus"},{default:o(l=>[e(b,{type:t(m).INFRA_BOOLEAN_STRING,value:l.row.dealStatus},null,8,["type","value"])]),_:1}),e(r,{align:"center",formatter:t(I),label:"下次联系时间",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",formatter:t(I),label:"最后跟进时间",prop:"contactLastTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"锁定状态",prop:"lockStatus"},{default:o(l=>[e(b,{type:t(m).INFRA_BOOLEAN_STRING,value:l.row.lockStatus},null,8,["type","value"])]),_:1}),e(r,{align:"center",fixed:"right",label:"操作","min-width":"150"},{default:o(l=>[g((u(),i(_,{link:"",type:"primary",onClick:h=>F("update",l.row.id)},{default:o(()=>a[12]||(a[12]=[d("编辑")])),_:2},1032,["onClick"])),[[C,["crm:customer:update"]]]),g((u(),i(_,{link:"",type:"danger",onClick:h=>Y(l.row.id)},{default:o(()=>a[13]||(a[13]=[d("删除")])),_:2},1032,["onClick"])),[[C,["crm:customer:delete"]]])]),_:1})]),_:1},8,["data"])),[[X,t(S)]]),e(H,{limit:t(n).pageSize,"onUpdate:limit":a[6]||(a[6]=l=>t(n).pageSize=l),page:t(n).pageNo,"onUpdate:page":a[7]||(a[7]=l=>t(n).pageNo=l),total:t(M),onPagination:v},null,8,["limit","page","total"])]),_:1}),e(ce,{ref_key:"formRef",ref:L,onSuccess:v},null,512)],64)}}});export{Ne as default};

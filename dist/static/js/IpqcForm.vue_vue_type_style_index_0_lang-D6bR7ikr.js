/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{V as C,d as H,r as p,f as J,Y as W,g as m,h as X,c as Z,o as Q,F as h,j as e,_ as ee,a as o,y as le,m as a,w as ae,k as te,v as V,K as oe,aP as de,N as ue,z as ie}from"./index-FPuwcz_Y.js";import{_ as ne}from"./DictTag.vue_vue_type_script_lang-o_bnFpkw.js";import{_ as se}from"./TemplateSelect.vue_vue_type_script_setup_true_lang-IT3kiQQa.js";import{_ as re}from"./TaskSelect.vue_vue_type_script_setup_true_lang-bAj74lWC.js";const pe=async f=>await C.get({url:"/ipqc/get?id="+f}),me=async f=>await C.post({url:"/ipqc/create",data:f}),fe=async f=>await C.put({url:"/ipqc/update",data:f}),ve="top",be=H({__name:"IpqcForm",emits:["success"],setup(f,{expose:D,emit:j}){const{t:y}=ue(),q=ie(),v=p(!1),g=p(""),c=p(!1),N=p(""),l=p({id:void 0,ipqcCode:void 0,ipqcName:void 0,ipqcType:void 0,templateId:void 0,workorderId:void 0,workorderCode:void 0,workorderName:void 0,taskId:void 0,taskCode:void 0,taskName:void 0,workstationId:void 0,workstationCode:void 0,workstationName:void 0,processId:void 0,processCode:void 0,processName:void 0,itemId:void 0,itemCode:void 0,itemName:void 0,specification:void 0,unitOfMeasure:void 0,quantityCheck:void 0,quantityUnqualified:void 0,quantityQualified:void 0,crRate:void 0,majRate:void 0,minRate:void 0,crQuantity:void 0,majQuantity:void 0,minQuantity:void 0,checkResult:void 0,inspectDate:void 0,inspector:void 0,status:void 0,remark:void 0,attr1:void 0,attr2:void 0,attr3:void 0,attr4:void 0}),O=J({ipqcCode:[{required:!0,message:"检验单编号不能为空",trigger:"change"}],ipqcType:[{required:!0,message:"检验类型不能为空",trigger:"change"}],templateId:[{required:!0,message:"检验模板ID不能为空",trigger:"change"}],workorderId:[{required:!0,message:"工单ID不能为空",trigger:"change"}],workstationId:[{required:!0,message:"工作站ID不能为空",trigger:"change"}],itemId:[{required:!0,message:"产品物料ID不能为空",trigger:"change"}]}),b=p();D({open:async(u,t,k)=>{if(v.value=!0,g.value=y("action."+u),N.value=u,M(),k&&R(k),t){c.value=!0;try{l.value=await pe(t)}finally{c.value=!1}}}});const S=j,x=async()=>{await b.value.validate(),c.value=!0;try{const u=l.value;N.value==="create"?(u.status="0",await me(u),q.success(y("新增成功"))):(await fe(u),q.success(y("修改成功"))),v.value=!1,S("success",l.value.taskId)}finally{c.value=!1}},M=()=>{l.value={id:void 0,ipqcCode:void 0,ipqcName:void 0,ipqcType:void 0,templateId:void 0,workorderId:void 0,workorderCode:void 0,workorderName:void 0,taskId:void 0,taskCode:void 0,taskName:void 0,workstationId:void 0,workstationCode:void 0,workstationName:void 0,processId:void 0,processCode:void 0,processName:void 0,itemId:void 0,itemCode:void 0,itemName:void 0,specification:void 0,unitOfMeasure:void 0,quantityCheck:void 0,quantityUnqualified:void 0,quantityQualified:void 0,crRate:void 0,majRate:void 0,minRate:void 0,crQuantity:void 0,majQuantity:void 0,minQuantity:void 0,checkResult:void 0,inspectDate:void 0,inspector:void 0,status:void 0,remark:void 0,attr1:void 0,attr2:void 0,attr3:void 0,attr4:void 0},b.value?.resetFields()},T=p(),F=u=>{u!=null&&u!=null&&(console.log(u.id),l.value.itemId=u.id,l.value.itemCode=u.itemCode,l.value.itemName=u.itemName,l.value.specification=u.specification,l.value.unitOfMeasure=u.unitOfMeasure)};W(l,()=>{l.value.crQuantity==null||l.value.quantityCheck==null?l.value.crRate=void 0:l.value.crRate=(l.value.crQuantity/l.value.quantityCheck).toFixed(2),l.value.majQuantity==null||l.value.quantityCheck==null?l.value.majRate=void 0:l.value.majRate=(l.value.majQuantity/l.value.quantityCheck).toFixed(2),l.value.minQuantity==null||l.value.quantityCheck==null?l.value.minRate=void 0:l.value.minRate=(l.value.minQuantity/l.value.quantityCheck).toFixed(2)},{deep:!0});const U=p(),P=()=>{U.value.open()},$=u=>{u!=null&&u!=null&&(console.log(u),l.value.templateId=u.selectedRows.id,l.value.itemCode=u.selectedRows.itemCode,l.value.itemName=u.selectedRows.itemName,l.value.specification=u.selectedRows.specification,l.value.unitOfMeasure=u.selectedRows.unitOfMeasure,l.value.itemCode=u.selectedPro[0].itemCode,l.value.itemId=u.selectedPro[0].itemId,l.value.itemName=u.selectedPro[0].itemName,l.value.specification=u.selectedPro[0].specification,l.value.unitOfMeasure=u.selectedPro[0].unitOfMeasure,l.value.ipqcType=u.selectedRows.qcTypes)},B=p(),R=u=>{u!=null&&u!=null&&(l.value.taskCode=u.taskCode,l.value.taskName=u.taskName,l.value.taskId=u.id,l.value.workorderCode=u.workorderCode,l.value.workorderName=u.workorderName,l.value.workorderId=u.workorderId,l.value.processCode=u.processCode,l.value.processName=u.processName,l.value.processId=u.processId,l.value.workstationCode=u.workstationCode,l.value.workstationName=u.workstationName,l.value.workstationId=u.workstationId)},I=p(!0);return(u,t)=>{const k=m("SwitchS"),s=m("el-input"),i=m("el-form-item"),n=m("el-col"),r=m("el-row"),_=m("el-divider"),E=oe,w=m("el-button"),z=ne,K=m("el-date-picker"),L=m("el-form"),Y=ee,A=de,G=X("loading");return Q(),Z(h,null,[e(Y,{title:o(g),modelValue:o(v),"onUpdate:modelValue":t[34]||(t[34]=d=>le(v)?v.value=d:null),width:"80%"},{footer:a(()=>[e(w,{onClick:x,type:"primary",disabled:o(c)},{default:a(()=>t[39]||(t[39]=[V("确 定")])),_:1},8,["disabled"]),e(w,{onClick:t[33]||(t[33]=d=>v.value=!1)},{default:a(()=>t[40]||(t[40]=[V("取 消")])),_:1})]),default:a(()=>[ae((Q(),te(L,{ref_key:"formRef",ref:b,model:o(l),rules:o(O),"label-width":"100px","label-position":ve},{default:a(()=>[e(r,{gutter:20},{default:a(()=>[e(n,{span:12},{default:a(()=>[e(i,{label:"检验单编号",prop:"ipqcCode"},{default:a(()=>[e(s,{modelValue:o(l).ipqcCode,"onUpdate:modelValue":t[0]||(t[0]=d=>o(l).ipqcCode=d),placeholder:"请输入检验单编号"},{append:a(()=>[e(k,{name:"QMS_IQC_CODE",obj:o(l),val:"ipqcCode"},null,8,["obj"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(i,{label:"检验单名称",prop:"ipqcName"},{default:a(()=>[e(s,{modelValue:o(l).ipqcName,"onUpdate:modelValue":t[1]||(t[1]=d=>o(l).ipqcName=d),placeholder:"请输入检验单名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>t[35]||(t[35]=[V("工单信息")])),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"任务ID",prop:"taskId"},{default:a(()=>[e(s,{modelValue:o(l).taskId,"onUpdate:modelValue":t[2]||(t[2]=d=>o(l).taskId=d),placeholder:"请输入任务ID",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"任务编号",prop:"taskCode"},{default:a(()=>[e(s,{modelValue:o(l).taskCode,"onUpdate:modelValue":t[3]||(t[3]=d=>o(l).taskCode=d),placeholder:"请输入任务编号",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"任务名称",prop:"taskName"},{default:a(()=>[e(s,{modelValue:o(l).taskName,"onUpdate:modelValue":t[4]||(t[4]=d=>o(l).taskName=d),placeholder:"请输入任务名称",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"工单ID",prop:"workorderId"},{default:a(()=>[e(s,{modelValue:o(l).workorderId,"onUpdate:modelValue":t[5]||(t[5]=d=>o(l).workorderId=d),placeholder:"请输入工单ID",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工单编码",prop:"workorderCode"},{default:a(()=>[e(s,{modelValue:o(l).workorderCode,"onUpdate:modelValue":t[6]||(t[6]=d=>o(l).workorderCode=d),placeholder:"请输入工单编码",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工单名称",prop:"workorderName"},{default:a(()=>[e(s,{modelValue:o(l).workorderName,"onUpdate:modelValue":t[7]||(t[7]=d=>o(l).workorderName=d),placeholder:"请输入工单名称",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"工作站ID",prop:"workstationId"},{default:a(()=>[e(s,{modelValue:o(l).workstationId,"onUpdate:modelValue":t[8]||(t[8]=d=>o(l).workstationId=d),placeholder:"请输入工作站ID",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工作站编号",prop:"workstationCode"},{default:a(()=>[e(s,{modelValue:o(l).workstationCode,"onUpdate:modelValue":t[9]||(t[9]=d=>o(l).workstationCode=d),placeholder:"请输入工作站编号",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工作站名称",prop:"workstationName"},{default:a(()=>[e(s,{modelValue:o(l).workstationName,"onUpdate:modelValue":t[10]||(t[10]=d=>o(l).workstationName=d),placeholder:"请输入工作站名称",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"工序ID",prop:"processId"},{default:a(()=>[e(s,{modelValue:o(l).processId,"onUpdate:modelValue":t[11]||(t[11]=d=>o(l).processId=d),placeholder:"请输入工序ID",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工序编码",prop:"processCode"},{default:a(()=>[e(s,{modelValue:o(l).processCode,"onUpdate:modelValue":t[12]||(t[12]=d=>o(l).processCode=d),placeholder:"请输入工序编码",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"工序名称",prop:"processName"},{default:a(()=>[e(s,{modelValue:o(l).processName,"onUpdate:modelValue":t[13]||(t[13]=d=>o(l).processName=d),placeholder:"请输入工序名称",disabled:"disinput"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>t[36]||(t[36]=[V("模板信息")])),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"检验模板ID",prop:"templateId"},{default:a(()=>[e(s,{modelValue:o(l).templateId,"onUpdate:modelValue":t[14]||(t[14]=d=>o(l).templateId=d),placeholder:"请输入检验模板ID",maxlength:"",disabled:"disinput"},{append:a(()=>[e(w,{onClick:P},{default:a(()=>[e(E,{icon:"ep:search",class:"mr-5px"})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(i,{label:"检验类型",prop:"ipqcType"},{default:a(()=>[e(z,{type:"mes_qc_type",value:o(l).ipqcType},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"产品物料ID",prop:"itemId"},{default:a(()=>[e(s,{modelValue:o(l).itemId,"onUpdate:modelValue":t[15]||(t[15]=d=>o(l).itemId=d),placeholder:"请输入产品物料ID",disabled:o(I)},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"产品物料编码",prop:"itemCode"},{default:a(()=>[e(s,{modelValue:o(l).itemCode,"onUpdate:modelValue":t[16]||(t[16]=d=>o(l).itemCode=d),placeholder:"请输入产品物料编码",disabled:o(I)},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"产品物料名称",prop:"itemName"},{default:a(()=>[e(s,{modelValue:o(l).itemName,"onUpdate:modelValue":t[17]||(t[17]=d=>o(l).itemName=d),placeholder:"请输入产品物料名称",disabled:o(I)},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"规格型号",prop:"specification"},{default:a(()=>[e(s,{modelValue:o(l).specification,"onUpdate:modelValue":t[18]||(t[18]=d=>o(l).specification=d),placeholder:"请输入规格型号"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"单位",prop:"unitOfMeasure"},{default:a(()=>[e(s,{modelValue:o(l).unitOfMeasure,"onUpdate:modelValue":t[19]||(t[19]=d=>o(l).unitOfMeasure=d),placeholder:"请输入单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>t[37]||(t[37]=[V("检测信息")])),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:8},{default:a(()=>[e(i,{label:"本次检测数量",prop:"quantityCheck"},{default:a(()=>[e(s,{modelValue:o(l).quantityCheck,"onUpdate:modelValue":t[20]||(t[20]=d=>o(l).quantityCheck=d),placeholder:"请输入本次检测数量",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"合格品数量",prop:"quantityQualified"},{default:a(()=>[e(s,{modelValue:o(l).quantityQualified,"onUpdate:modelValue":t[21]||(t[21]=d=>o(l).quantityQualified=d),placeholder:"请输入合格品数量",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:8},{default:a(()=>[e(i,{label:"不合格数",prop:"quantityUnqualified"},{default:a(()=>[e(s,{modelValue:o(l).quantityUnqualified,"onUpdate:modelValue":t[22]||(t[22]=d=>o(l).quantityUnqualified=d),placeholder:"请输入不合格数",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"致命缺陷数量",prop:"crQuantity"},{default:a(()=>[e(s,{modelValue:o(l).crQuantity,"onUpdate:modelValue":t[23]||(t[23]=d=>o(l).crQuantity=d),placeholder:"请输入致命缺陷数量",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"致命缺陷率",prop:"crRate"},{default:a(()=>[e(s,{modelValue:o(l).crRate,"onUpdate:modelValue":t[24]||(t[24]=d=>o(l).crRate=d),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20,offset:0},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"严重缺陷数量",prop:"majQuantity"},{default:a(()=>[e(s,{modelValue:o(l).majQuantity,"onUpdate:modelValue":t[25]||(t[25]=d=>o(l).majQuantity=d),placeholder:"请输入严重缺陷数量",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"严重缺陷率",prop:"majRate"},{default:a(()=>[e(s,{modelValue:o(l).majRate,"onUpdate:modelValue":t[26]||(t[26]=d=>o(l).majRate=d),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"轻微缺陷数量",prop:"minQuantity"},{default:a(()=>[e(s,{modelValue:o(l).minQuantity,"onUpdate:modelValue":t[27]||(t[27]=d=>o(l).minQuantity=d),placeholder:"请输入轻微缺陷数量",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"轻微缺陷率",prop:"minRate"},{default:a(()=>[e(s,{modelValue:o(l).minRate,"onUpdate:modelValue":t[28]||(t[28]=d=>o(l).minRate=d),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:a(()=>t[38]||(t[38]=[V("检测结果")])),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"检测结果",prop:"checkResult"},{default:a(()=>[e(s,{modelValue:o(l).checkResult,"onUpdate:modelValue":t[29]||(t[29]=d=>o(l).checkResult=d),placeholder:"请输入检测结果"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"检测日期",prop:"inspectDate"},{default:a(()=>[e(K,{modelValue:o(l).inspectDate,"onUpdate:modelValue":t[30]||(t[30]=d=>o(l).inspectDate=d),type:"date","value-format":"x",placeholder:"选择检测日期"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,{span:12,offset:0},{default:a(()=>[e(i,{label:"检测人员",prop:"inspector"},{default:a(()=>[e(s,{modelValue:o(l).inspector,"onUpdate:modelValue":t[31]||(t[31]=d=>o(l).inspector=d),placeholder:"请输入检测人员"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{gutter:20},{default:a(()=>[e(n,null,{default:a(()=>[e(i,{label:"备注",prop:"remark"},{default:a(()=>[e(s,{modelValue:o(l).remark,"onUpdate:modelValue":t[32]||(t[32]=d=>o(l).remark=d),placeholder:"请输入备注",rows:2,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[G,o(c)]])]),_:1},8,["title","modelValue"]),e(A,{ref_key:"Select",ref:T,onOnSelected:F},null,512),e(se,{ref_key:"template",ref:U,onOnSelected:$},null,512),e(re,{ref_key:"task",ref:B,onOnSelected:R},null,512)],64)}}});export{be as _};

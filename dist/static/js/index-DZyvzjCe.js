/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{d as J,r as _,f as W,b as G,g as i,h as V,c as S,o as m,j as o,m as a,a as l,J as X,F as U,n as Z,k as d,w as f,v as p,K as ee,t as $,x as F,L as te,M as oe,z as le,N as ae}from"./index-BdC40rFX.js";import{_ as ne}from"./DictTag.vue_vue_type_script_lang-BKaaD_BY.js";import{_ as ie}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{_ as se,g as re,c as me,d as pe}from"./DiscountActivityForm.vue_vue_type_script_setup_true_lang-D4Uj0Hxh.js";import{c as ue,D as P}from"./dict-D4wjFrBa.js";import"./color-B5phLuB-.js";import"./Form-B_lUyqVK.js";import"./style.css_vue_type_style_index_0_src_true_lang-BD-Jc5v5.js";import"./locale-SYpyG3Sh.js";import"./InputPassword-CI-TQFG7.js";import"./UploadImg-DaT9X0X7.js";import"./index-BSG-APLS.js";import"./UploadImgs-BgpwDFvH.js";import"./UploadImgs.vue_vue_type_script_setup_true_lang-BmqlOvX1.js";import"./UploadFile-CJkJUA02.js";import"./UploadFile.vue_vue_type_script_setup_true_lang-CuPWgWix.js";import"./SpuAndSkuList.vue_vue_type_script_setup_true_lang-AgLoi315.js";import"./SkuList.vue_vue_type_script_setup_true_lang-Co7H7wx_.js";import"./SpuSelect.vue_vue_type_script_setup_true_lang-D9nb0a4N.js";import"./tree-vSlcEeQq.js";import"./index-BP-_ByMC.js";import"./category-c5DlsBPI.js";import"./spu-Cd27YdRa.js";import"./formRules-opgphle0.js";import"./useCrudSchemas-DS68AF99.js";const ze=J({name:"DiscountActivity",__name:"index",setup(ce){const v=le(),{t:h}=ae(),g=_(!0),D=_(0),x=_([]),n=W({pageNo:1,pageSize:10,activeTime:null,name:null,status:null}),C=_(),u=async()=>{g.value=!0;try{const s=await re(n);x.value=s.list,D.value=s.total}finally{g.value=!1}},b=()=>{n.pageNo=1,u()},A=()=>{C.value.resetFields(),b()},T=_(),M=(s,e)=>{T.value.open(s,e)},O=async s=>{try{await v.confirm("确认关闭该限时折扣活动吗？"),await me(s),v.success("关闭成功"),await u()}catch(e){console.log(e)}},z=async s=>{try{await v.delConfirm(),await pe(s),v.success(h("common.delSuccess")),await u()}catch(e){console.log(e)}};return G(async()=>{await u()}),(s,e)=>{const I=i("el-input"),w=i("el-form-item"),R=i("el-option"),q=i("el-select"),B=i("el-date-picker"),k=ee,c=i("el-button"),K=i("el-form"),Y=ie,r=i("el-table-column"),L=i("el-image"),E=ne,H=i("el-table"),Q=oe,y=V("hasPermi"),j=V("loading");return m(),S(U,null,[o(Y,null,{default:a(()=>[o(K,{ref_key:"queryFormRef",ref:C,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(n)},{default:a(()=>[o(w,{label:"活动名称",prop:"name"},{default:a(()=>[o(I,{modelValue:l(n).name,"onUpdate:modelValue":e[0]||(e[0]=t=>l(n).name=t),class:"!w-240px",clearable:"",placeholder:"请输入活动名称",onKeyup:X(b,["enter"])},null,8,["modelValue"])]),_:1}),o(w,{label:"活动状态",prop:"status"},{default:a(()=>[o(q,{modelValue:l(n).status,"onUpdate:modelValue":e[1]||(e[1]=t=>l(n).status=t),class:"!w-240px",clearable:"",placeholder:"请选择活动状态"},{default:a(()=>[(m(!0),S(U,null,Z(l(ue)(l(P).COMMON_STATUS),t=>(m(),d(R,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(w,{label:"活动时间",prop:"activeTime"},{default:a(()=>[o(B,{modelValue:l(n).activeTime,"onUpdate:modelValue":e[2]||(e[2]=t=>l(n).activeTime=t),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),o(w,null,{default:a(()=>[o(c,{onClick:b},{default:a(()=>[o(k,{class:"mr-5px",icon:"ep:search"}),e[6]||(e[6]=p(" 搜索 "))]),_:1}),o(c,{onClick:A},{default:a(()=>[o(k,{class:"mr-5px",icon:"ep:refresh"}),e[7]||(e[7]=p(" 重置 "))]),_:1}),f((m(),d(c,{plain:"",type:"primary",onClick:e[3]||(e[3]=t=>M("create"))},{default:a(()=>[o(k,{class:"mr-5px",icon:"ep:plus"}),e[8]||(e[8]=p(" 新增活动 "))]),_:1})),[[y,["promotion:discount-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),o(Y,null,{default:a(()=>[f((m(),d(H,{data:l(x),"show-overflow-tooltip":!0,stripe:!0},{default:a(()=>[o(r,{label:"活动编号","min-width":"80",prop:"id"}),o(r,{label:"活动名称","min-width":"140",prop:"name"}),o(r,{label:"活动时间","min-width":"210"},{default:a(t=>[p($(l(F)(t.row.startTime,"YYYY-MM-DD"))+" ~ "+$(l(F)(t.row.endTime,"YYYY-MM-DD")),1)]),_:1}),o(r,{label:"商品图片","min-width":"80",prop:"spuName"},{default:a(t=>[o(L,{class:"h-40px w-40px","preview-src-list":[t.row.picUrl],"preview-teleported":"",src:t.row.picUrl},null,8,["preview-src-list","src"])]),_:1}),o(r,{label:"商品标题","min-width":"300",prop:"spuName"}),o(r,{align:"center",label:"活动状态","min-width":"100",prop:"status"},{default:a(t=>[o(E,{type:l(P).COMMON_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),o(r,{align:"center",formatter:l(te),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),o(r,{align:"center",fixed:"right",label:"操作",width:"150px"},{default:a(t=>[f((m(),d(c,{link:"",type:"primary",onClick:N=>M("update",t.row.id)},{default:a(()=>e[9]||(e[9]=[p(" 编辑 ")])),_:2},1032,["onClick"])),[[y,["promotion:discount-activity:update"]]]),t.row.status===0?f((m(),d(c,{key:0,link:"",type:"danger",onClick:N=>O(t.row.id)},{default:a(()=>e[10]||(e[10]=[p(" 关闭 ")])),_:2},1032,["onClick"])),[[y,["promotion:discount-activity:close"]]]):f((m(),d(c,{key:1,link:"",type:"danger",onClick:N=>z(t.row.id)},{default:a(()=>e[11]||(e[11]=[p(" 删除 ")])),_:2},1032,["onClick"])),[[y,["promotion:discount-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[j,l(g)]]),o(Q,{limit:l(n).pageSize,"onUpdate:limit":e[4]||(e[4]=t=>l(n).pageSize=t),page:l(n).pageNo,"onUpdate:page":e[5]||(e[5]=t=>l(n).pageNo=t),total:l(D),onPagination:u},null,8,["limit","page","total"])]),_:1}),o(se,{ref_key:"formRef",ref:T,onSuccess:u},null,512)],64)}}});export{ze as default};

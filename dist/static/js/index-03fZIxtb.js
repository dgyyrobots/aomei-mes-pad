/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{V as D,d as ae,u as oe,r as d,f as ne,b as le,g as s,h as re,c as x,o as i,j as t,m as o,v as y,K as se,w as S,k as g,a as n,i as I,t as v,L as P,l as V,x as ie,M as de,F as T,n as pe,y as ue,_ as ce,z as me,N as fe}from"./index-BdmDrM2Y.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CIA3YA7G.js";import{_ as ye}from"./DictTag.vue_vue_type_script_lang-bjcRCBWf.js";import{_ as ge}from"./index-63l7YclF.js";import{D as ve}from"./dict-Cm-9nniQ.js";import"./color-B5phLuB-.js";function be(p){return D.post({url:"/pay/demo-order/create",data:p})}function we(p){return D.get({url:"/pay/demo-order/page",params:p})}function ke(p){return D.put({url:`/pay/demo-order/refund?id=${p}`})}const xe={key:0},Ie={key:1},Ce={style:{float:"left"}},Ne={style:{float:"right","font-size":"13px",color:"#8492a6"}},Pe=ae({__name:"index",setup(p){const{t:O}=fe(),h=oe(),C=me(),N=d(!0),R=d(0),$=d([]),m=ne({pageNo:1,pageSize:10}),b=d(),w=async()=>{N.value=!0;try{const r=await we(m);$.value=r.list,R.value=r.total}finally{N.value=!1}},U=r=>{h.push({name:"PayCashier",query:{id:r.payOrderId,returnUrl:encodeURIComponent(`/pay/demo-order?id=${r.id}`)}})},z=async r=>{const a=r.id;try{await C.confirm(`是否确认退款编号为"${a}"的示例订单?`),await ke(a),await w(),C.success("发起退款成功！")}catch(c){console.log(c)}},B=d([{id:1,name:"华为手机",price:1},{id:2,name:"小米电视",price:10},{id:3,name:"苹果手表",price:100},{id:4,name:"华硕笔记本",price:1e3},{id:5,name:"蔚来汽车",price:2e5}]),u=d(!1),k=d(!1),f=d({}),L={spuId:[{required:!0,message:"商品编号不能为空",trigger:"blur"}]},q=()=>{f.value={spuId:void 0},b.value?.resetFields()},E=()=>{q(),u.value=!0},M=async()=>{if(!(!b||!await b.value.validate())){k.value=!0;try{await be(f.value),C.success(O("common.createSuccess")),u.value=!1}finally{k.value=!1,w()}}};return le(()=>{w()}),(r,a)=>{const c=ge,A=se,_=s("el-button"),j=s("el-col"),G=s("el-row"),l=s("el-table-column"),K=ye,W=s("el-table"),Y=de,H=_e,J=s("el-option"),Q=s("el-select"),X=s("el-form-item"),Z=s("el-form"),ee=ce,F=re("loading");return i(),x(T,null,[t(c,{title:"支付宝支付接入",url:"https://doc.iocoder.cn/pay/alipay-pay-demo/"}),t(c,{title:"支付宝、微信退款接入",url:"https://doc.iocoder.cn/pay/refund-demo/"}),t(c,{title:"微信公众号支付接入",url:"https://doc.iocoder.cn/pay/wx-pub-pay-demo/"}),t(c,{title:"微信小程序支付接入",url:"https://doc.iocoder.cn/pay/wx-lite-pay-demo/"}),t(G,{class:"mb8",gutter:10},{default:o(()=>[t(j,{span:1.5},{default:o(()=>[t(_,{plain:"",type:"primary",onClick:E},{default:o(()=>[t(A,{icon:"ep:plus"}),a[5]||(a[5]=y(" 发起订单 "))]),_:1})]),_:1})]),_:1}),t(H,null,{default:o(()=>[S((i(),g(W,{data:n($)},{default:o(()=>[t(l,{align:"center",label:"订单编号",prop:"id"}),t(l,{align:"center",label:"用户编号",prop:"userId"}),t(l,{align:"center",label:"商品名字",prop:"spuName"}),t(l,{align:"center",label:"支付价格",prop:"price"},{default:o(e=>[I("span",null,"￥"+v((e.row.price/100).toFixed(2)),1)]),_:1}),t(l,{align:"center",label:"退款金额",prop:"refundPrice"},{default:o(e=>[I("span",null,"￥"+v((e.row.refundPrice/100).toFixed(2)),1)]),_:1}),t(l,{align:"center",formatter:n(P),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(l,{align:"center",label:"支付单号",prop:"payOrderId"}),t(l,{align:"center",label:"是否支付",prop:"payStatus"},{default:o(e=>[t(K,{type:n(ve).INFRA_BOOLEAN_STRING,value:e.row.payStatus},null,8,["type","value"])]),_:1}),t(l,{align:"center",formatter:n(P),label:"支付时间",prop:"payTime",width:"180"},null,8,["formatter"]),t(l,{align:"center",label:"退款时间",prop:"refundTime",width:"180"},{default:o(e=>[e.row.refundTime?(i(),x("span",xe,v(n(ie)(e.row.refundTime)),1)):e.row.payRefundId?(i(),x("span",Ie,"退款中，等待退款结果")):V("",!0)]),_:1}),t(l,{align:"center","class-name":"small-padding fixed-width",label:"操作"},{default:o(e=>[e.row.payStatus?V("",!0):(i(),g(_,{key:0,link:"",type:"primary",onClick:te=>U(e.row)},{default:o(()=>a[6]||(a[6]=[y("前往支付")])),_:2},1032,["onClick"])),e.row.payStatus&&!e.row.payRefundId?(i(),g(_,{key:1,link:"",type:"danger",onClick:te=>z(e.row)},{default:o(()=>a[7]||(a[7]=[y(" 发起退款 ")])),_:2},1032,["onClick"])):V("",!0)]),_:1})]),_:1},8,["data"])),[[F,n(N)]]),t(Y,{limit:n(m).pageSize,"onUpdate:limit":a[0]||(a[0]=e=>n(m).pageSize=e),page:n(m).pageNo,"onUpdate:page":a[1]||(a[1]=e=>n(m).pageNo=e),total:n(R),onPagination:w},null,8,["limit","page","total"])]),_:1}),t(ee,{modelValue:n(u),"onUpdate:modelValue":a[4]||(a[4]=e=>ue(u)?u.value=e:null),title:"发起订单",width:"500px"},{footer:o(()=>[t(_,{disabled:n(k),type:"primary",onClick:M},{default:o(()=>a[8]||(a[8]=[y("确 定")])),_:1},8,["disabled"]),t(_,{onClick:a[3]||(a[3]=e=>u.value=!1)},{default:o(()=>a[9]||(a[9]=[y("取 消")])),_:1})]),default:o(()=>[S((i(),g(Z,{ref_key:"formRef",ref:b,"label-width":"80px",model:n(f),rules:L},{default:o(()=>[t(X,{label:"商品",prop:"spuId"},{default:o(()=>[t(Q,{modelValue:n(f).spuId,"onUpdate:modelValue":a[2]||(a[2]=e=>n(f).spuId=e),clearable:"",placeholder:"请输入下单商品",style:{width:"380px"}},{default:o(()=>[(i(!0),x(T,null,pe(n(B),e=>(i(),g(J,{key:e.id,label:e.name,value:e.id},{default:o(()=>[I("span",Ce,v(e.name),1),I("span",Ne,"￥"+v((e.price/100).toFixed(2)),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[F,n(k)]])]),_:1},8,["modelValue"])],64)}}});export{Pe as default};

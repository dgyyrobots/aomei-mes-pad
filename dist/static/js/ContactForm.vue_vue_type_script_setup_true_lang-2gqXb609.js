/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{V as f,d as K,r as p,f as W,g as s,h as Z,k as v,o as i,m as a,w as h,a as t,j as e,c as b,F as w,n as g,v as C,y as ee,_ as le,N as ae,cF as te,z as oe,t as de}from"./index-FPuwcz_Y.js";import{c as ne,D as B,b as ue}from"./dict-C9lD-gwA.js";import{g as re}from"./index-CzdicQpi.js";import{g as se}from"./index-CXspfiw7.js";import{d as ie}from"./tree-vSlcEeQq.js";const ye=async r=>await f.get({url:"/crm/contact/page",params:r}),xe=async r=>await f.get({url:"/crm/contact/page-by-customer",params:r}),pe=async r=>await f.get({url:`/crm/contact/get?id=${r}`}),me=async r=>await f.post({url:"/crm/contact/create",data:r}),ce=async r=>await f.put({url:"/crm/contact/update",data:r}),Ue=async r=>await f.delete({url:`/crm/contact/delete?id=${r}`}),ke=async r=>await f.download({url:"/crm/contact/export-excel",params:r}),fe=async()=>await f.get({url:"/crm/contact/simple-all-list"}),Ie=K({__name:"ContactForm",emits:["success"],setup(r,{expose:E,emit:$}){const{t:I}=ae(),q=oe(),_=p(!1),T=p(""),V=p(!1),L=p(""),S=p([]),d=p({nextTime:void 0,mobile:void 0,telephone:void 0,email:void 0,customerId:void 0,customerName:void 0,address:void 0,remark:void 0,ownerUserId:void 0,lastTime:void 0,id:void 0,parentId:void 0,name:void 0,post:void 0,qq:void 0,wechat:void 0,sex:void 0,master:!1,areaId:void 0}),A=W({name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],customerId:[{required:!0,message:"客户不能为空",trigger:"blur"}],ownerUserId:[{required:!0,message:"负责人不能为空",trigger:"blur"}]}),y=p(),O=p([]),D=p([]),F=p([]),N=p([]);E({open:async(x,o)=>{if(_.value=!0,T.value=I(`action.${x}`),L.value=x,M(),N.value=await fe(),D.value=await re(),F.value=await te(),S.value=await se(),o){V.value=!0;try{d.value=await pe(o)}finally{V.value=!1}}}});const P=$,Q=async()=>{if(!(!y||!await y.value.validate())){V.value=!0;try{const o=d.value;L.value==="create"?(await me(o),q.success(I("common.createSuccess"))):(await ce(o),q.success(I("common.updateSuccess"))),_.value=!1,P("success")}finally{V.value=!1}}},M=()=>{d.value={nextTime:void 0,mobile:void 0,telephone:void 0,email:void 0,customerId:void 0,address:void 0,remark:void 0,ownerUserId:void 0,lastTime:void 0,id:void 0,parentId:void 0,name:void 0,post:void 0,qq:void 0,wechat:void 0,sex:void 0,master:!1},y.value?.resetFields(),O.value=[]};return(x,o)=>{const m=s("el-input"),n=s("el-form-item"),u=s("el-col"),U=s("el-option"),k=s("el-select"),c=s("el-row"),Y=s("el-date-picker"),j=s("el-tree-select"),z=s("el-radio"),G=s("el-radio-group"),X=s("el-form"),R=s("el-button"),H=le,J=Z("loading");return i(),v(H,{modelValue:t(_),"onUpdate:modelValue":o[17]||(o[17]=l=>ee(_)?_.value=l:null),title:t(T),width:820},{footer:a(()=>[e(R,{disabled:t(V),type:"primary",onClick:Q},{default:a(()=>o[18]||(o[18]=[C("确 定")])),_:1},8,["disabled"]),e(R,{onClick:o[16]||(o[16]=l=>_.value=!1)},{default:a(()=>o[19]||(o[19]=[C("取 消")])),_:1})]),default:a(()=>[h((i(),v(X,{ref_key:"formRef",ref:y,"label-width":"110px",model:t(d),rules:t(A)},{default:a(()=>[e(c,{gutter:20},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"姓名",prop:"name"},{default:a(()=>[e(m,{modelValue:t(d).name,"onUpdate:modelValue":o[0]||(o[0]=l=>t(d).name=l),"input-style":"width:190px;",placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"负责人",prop:"ownerUserId"},{default:a(()=>[e(k,{modelValue:t(d).ownerUserId,"onUpdate:modelValue":o[1]||(o[1]=l=>t(d).ownerUserId=l),"lable-key":"nickname",placeholder:"请选择负责人","value-key":"id"},{default:a(()=>[(i(!0),b(w,null,g(t(D),l=>(i(),v(U,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"客户名称",prop:"customerName"},{default:a(()=>[e(k,{modelValue:t(d).customerId,"onUpdate:modelValue":o[2]||(o[2]=l=>t(d).customerId=l),"lable-key":"name",placeholder:"请选择客户","value-key":"id"},{default:a(()=>[(i(!0),b(w,null,g(t(F),l=>(i(),v(U,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"性别",prop:"sex"},{default:a(()=>[e(k,{modelValue:t(d).sex,"onUpdate:modelValue":o[3]||(o[3]=l=>t(d).sex=l),placeholder:"请选择"},{default:a(()=>[(i(!0),b(w,null,g(t(ne)(t(B).SYSTEM_USER_SEX),l=>(i(),v(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"手机号",prop:"mobile"},{default:a(()=>[e(m,{modelValue:t(d).mobile,"onUpdate:modelValue":o[4]||(o[4]=l=>t(d).mobile=l),"input-style":"width:190px;",placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"座机",prop:"telephone"},{default:a(()=>[e(m,{modelValue:t(d).telephone,"onUpdate:modelValue":o[5]||(o[5]=l=>t(d).telephone=l),placeholder:"请输入座机",style:{width:"215px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"邮箱",prop:"email"},{default:a(()=>[e(m,{modelValue:t(d).email,"onUpdate:modelValue":o[6]||(o[6]=l=>t(d).email=l),"input-style":"width:190px;",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"QQ",prop:"qq"},{default:a(()=>[e(m,{modelValue:t(d).qq,"onUpdate:modelValue":o[7]||(o[7]=l=>t(d).qq=l),placeholder:"请输入QQ",style:{width:"215px"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"微信",prop:"wechat"},{default:a(()=>[e(m,{modelValue:t(d).wechat,"onUpdate:modelValue":o[8]||(o[8]=l=>t(d).wechat=l),"input-style":"width:190px;",placeholder:"请输入微信"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"下次联系时间",prop:"nextTime"},{default:a(()=>[e(Y,{modelValue:t(d).nextTime,"onUpdate:modelValue":o[9]||(o[9]=l=>t(d).nextTime=l),placeholder:"选择下次联系时间",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"所在地",prop:"areaId"},{default:a(()=>[e(j,{modelValue:t(d).areaId,"onUpdate:modelValue":o[10]||(o[10]=l=>t(d).areaId=l),data:t(S),props:t(ie),"render-after-expand":!0},null,8,["modelValue","data","props"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"地址",prop:"address"},{default:a(()=>[e(m,{modelValue:t(d).address,"onUpdate:modelValue":o[11]||(o[11]=l=>t(d).address=l),"input-style":"width:190px;",placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"直属上级",prop:"parentId"},{default:a(()=>[e(k,{modelValue:t(d).parentId,"onUpdate:modelValue":o[12]||(o[12]=l=>t(d).parentId=l),placeholder:"请选择"},{default:a(()=>[(i(!0),b(w,null,g(t(N),l=>(i(),v(U,{key:l.id,disabled:l.id==t(d).id,label:l.name,value:l.id},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(n,{label:"职位",prop:"post"},{default:a(()=>[e(m,{modelValue:t(d).post,"onUpdate:modelValue":o[13]||(o[13]=l=>t(d).post=l),"input-style":"width:190px;",placeholder:"请输入职位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:12},{default:a(()=>[e(n,{label:"是否关键决策人",prop:"master",style:{width:"400px"}},{default:a(()=>[e(G,{modelValue:t(d).master,"onUpdate:modelValue":o[14]||(o[14]=l=>t(d).master=l)},{default:a(()=>[(i(!0),b(w,null,g(t(ue)(t(B).INFRA_BOOLEAN_STRING),l=>(i(),v(z,{key:l.value,label:l.value},{default:a(()=>[C(de(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,null,{default:a(()=>[e(u,{span:24},{default:a(()=>[e(n,{label:"备注",prop:"remark"},{default:a(()=>[e(m,{modelValue:t(d).remark,"onUpdate:modelValue":o[15]||(o[15]=l=>t(d).remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[J,t(V)]])]),_:1},8,["modelValue","title"])}}});export{Ie as _,pe as a,ye as b,Ue as d,ke as e,xe as g};

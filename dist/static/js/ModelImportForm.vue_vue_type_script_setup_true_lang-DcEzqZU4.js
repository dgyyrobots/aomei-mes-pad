/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as z,r as n,f as A,g as i,k as D,o as E,m as a,i as m,j as o,a as l,y as k,K as j,v as y,_ as H,z as K,bx as S,by as G}from"./index-lcC3l4R2.js";const Q=z({name:"ModelImportForm",__name:"ModelImportForm",emits:["success"],setup(J,{expose:x,emit:F}){const d=K(),u=n(!1),r=n(!1),s=n({key:"",name:"",description:""}),R=A({key:[{required:!0,message:"流程标识不能为空",trigger:"blur"}],name:[{required:!0,message:"流程名称不能为空",trigger:"blur"}]}),p=n(),_=n(),U=`${void 0+void 0}/bpm/model/import`,g=n(),f=n([]);x({open:async()=>{u.value=!0,I()}});const w=async()=>{if(!(!p||!await p.value.validate())){if(f.value.length==0){d.error("请上传文件");return}g.value={Authorization:`Bearer ${G()}`,"tenant-id":S()},r.value=!0,_.value.submit()}},C=F,$=async c=>{if(c.code!==0){d.error(c.msg),r.value=!1;return}d.success("导入流程成功！请点击【设计流程】按钮，进行编辑保存后，才可以进行【发布流程】"),C("success")},B=()=>{d.error("导入流程失败，请您重新上传！"),r.value=!1},I=()=>{r.value=!1,_.value?.clearFiles(),s.value={key:"",name:"",description:""},p.value?.resetFields()},L=()=>{d.error("最多只能上传一个文件！")};return(c,e)=>{const M=j,v=i("el-input"),b=i("el-form-item"),N=i("el-form"),T=i("el-upload"),V=i("el-button"),q=H;return E(),D(q,{modelValue:l(u),"onUpdate:modelValue":e[5]||(e[5]=t=>k(u)?u.value=t:null),title:"导入流程",width:"400"},{footer:a(()=>[o(V,{disabled:l(r),type:"primary",onClick:w},{default:a(()=>e[8]||(e[8]=[y("确 定")])),_:1},8,["disabled"]),o(V,{onClick:e[4]||(e[4]=t=>u.value=!1)},{default:a(()=>e[9]||(e[9]=[y("取 消")])),_:1})]),default:a(()=>[m("div",null,[o(T,{ref_key:"uploadRef",ref:_,"file-list":l(f),"onUpdate:fileList":e[3]||(e[3]=t=>k(f)?f.value=t:null),accept:".bpmn, .xml",action:U,"auto-upload":!1,data:l(s),disabled:l(r),drag:"",headers:l(g),limit:1,name:"bpmnFile","on-error":B,"on-exceed":L,"on-success":$},{tip:a(()=>[e[6]||(e[6]=m("div",{class:"el-upload__tip",style:{color:"red"}},"提示：仅允许导入“bpm”或“xml”格式文件！",-1)),m("div",null,[o(N,{ref_key:"formRef",ref:p,"label-width":"120px",model:l(s),rules:l(R)},{default:a(()=>[o(b,{label:"流程标识",prop:"key"},{default:a(()=>[o(v,{modelValue:l(s).key,"onUpdate:modelValue":e[0]||(e[0]=t=>l(s).key=t),placeholder:"请输入流标标识",style:{width:"250px"}},null,8,["modelValue"])]),_:1}),o(b,{label:"流程名称",prop:"name"},{default:a(()=>[o(v,{modelValue:l(s).name,"onUpdate:modelValue":e[1]||(e[1]=t=>l(s).name=t),clearable:"",placeholder:"请输入流程名称"},null,8,["modelValue"])]),_:1}),o(b,{label:"流程描述",prop:"description"},{default:a(()=>[o(v,{modelValue:l(s).description,"onUpdate:modelValue":e[2]||(e[2]=t=>l(s).description=t),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),default:a(()=>[o(M,{class:"el-icon--upload",icon:"ep:upload-filled"}),e[7]||(e[7]=m("div",{class:"el-upload__text"},[y(" 将文件拖到此处，或 "),m("em",null,"点击上传")],-1))]),_:1},8,["file-list","data","disabled","headers"])])]),_:1},8,["modelValue"])}}});export{Q as _};

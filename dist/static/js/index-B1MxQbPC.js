/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{d as de,r as _,f as pe,b as ue,g as r,h as A,c as Y,o as i,j as t,m as o,a as n,J as z,F as K,n as ce,k as d,w as g,v as p,K as _e,L as fe,i as ye,l as U,d7 as S,M as we,z as ge,N as ve}from"./index-BdmDrM2Y.js";import{_ as be}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CIA3YA7G.js";import{_ as ke}from"./index-63l7YclF.js";import{_ as xe}from"./DeptTree.vue_vue_type_script_setup_true_lang-DCp03Js0.js";import{_ as Ce}from"./UserAssignRoleForm.vue_vue_type_script_setup_true_lang-CSrRFc-Y.js";import{_ as he}from"./UserForm.vue_vue_type_script_setup_true_lang-hFTeSFDA.js";import{_ as Ve}from"./UserImportForm.vue_vue_type_script_setup_true_lang-2qF8hpKV.js";import{d as Ne,e as Re,f as Ue,h as Se,r as $e}from"./index-BXAiRI9b.js";import{C}from"./constants-BPQb3nxh.js";import{c as De,D as Ee}from"./dict-Cm-9nniQ.js";import{d as Fe}from"./download-U6qaYcnP.js";import"./index-CL-TxIfG.js";import"./tree-vSlcEeQq.js";import"./index-B9Zhmqiy.js";import"./index-CdJAl9ha.js";import"./index-DV9qPTiw.js";const Pe={class:"flex items-center justify-center"},Xe=de({name:"SystemUser",__name:"index",setup(Te){const y=ge(),{t:$}=ve(),h=_(!0),D=_(0),E=_([]),s=pe({pageNo:1,pageSize:10,username:void 0,mobile:void 0,status:void 0,deptId:void 0,createTime:[]}),F=_(),u=async()=>{h.value=!0;try{const l=await Ne(s);E.value=l.list,D.value=l.total}finally{h.value=!1}},x=()=>{s.pageNo=1,u()},q=()=>{F.value?.resetFields(),x()},O=async l=>{s.deptId=l.id,await u()},P=_(),T=(l,e)=>{P.value.open(l,e)},B=_(),j=()=>{B.value.open()},H=async l=>{try{const e=l.status===C.ENABLE?"启用":"停用";await y.confirm(`确认要"${e}""${l.username}"用户吗?`),await Re(l.id,l.status),await u()}catch{l.status=l.status===C.ENABLE?C.DISABLE:C.ENABLE}},V=_(!1),Q=async()=>{try{await y.exportConfirm(),V.value=!0;const l=await Ue(s);Fe.excel(l,"用户数据.xls")}catch(l){console.log(l)}finally{V.value=!1}},J=(l,e)=>{switch(l){case"handleDelete":G(e.id);break;case"handleResetPwd":W(e);break;case"handleRole":X(e);break}},G=async l=>{try{await y.delConfirm(),await Se(l),y.success($("common.delSuccess")),await u()}catch(e){console.log(e)}},W=async l=>{try{const w=(await y.prompt(`请输入"${l.username}"的新密码`,$("common.reminder"))).value;await $e(l.id,w),y.success(`修改成功，新密码是：${w}`)}catch(e){console.log(e)}},L=_(),X=l=>{L.value.open(l)};return ue(()=>{u()}),(l,e)=>{const w=ke,N=be,I=r("el-col"),M=r("el-input"),v=r("el-form-item"),Z=r("el-option"),ee=r("el-select"),te=r("el-date-picker"),m=_e,f=r("el-button"),oe=r("el-form"),c=r("el-table-column"),le=r("el-switch"),R=r("el-dropdown-item"),ae=r("el-dropdown-menu"),ne=r("el-dropdown"),se=r("el-table"),re=we,ie=r("el-row"),b=A("hasPermi"),me=A("loading");return i(),Y(K,null,[t(w,{title:"用户体系",url:"https://doc.iocoder.cn/user-center/"}),t(w,{title:"三方登陆",url:"https://doc.iocoder.cn/social-user/"}),t(w,{title:"Excel 导入导出",url:"https://doc.iocoder.cn/excel-import-and-export/"}),t(ie,{gutter:20},{default:o(()=>[t(I,{span:4,xs:24},{default:o(()=>[t(N,{class:"h-1/1"},{default:o(()=>[t(xe,{onNodeClick:O})]),_:1})]),_:1}),t(I,{span:20,xs:24},{default:o(()=>[t(N,null,{default:o(()=>[t(oe,{ref_key:"queryFormRef",ref:F,class:"-mb-15px",inline:!0,"label-width":"68px",model:n(s)},{default:o(()=>[t(v,{label:"用户名称",prop:"username"},{default:o(()=>[t(M,{modelValue:n(s).username,"onUpdate:modelValue":e[0]||(e[0]=a=>n(s).username=a),class:"!w-240px",clearable:"",placeholder:"请输入用户名称",onKeyup:z(x,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"手机号码",prop:"mobile"},{default:o(()=>[t(M,{modelValue:n(s).mobile,"onUpdate:modelValue":e[1]||(e[1]=a=>n(s).mobile=a),class:"!w-240px",clearable:"",placeholder:"请输入手机号码",onKeyup:z(x,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"状态",prop:"status"},{default:o(()=>[t(ee,{modelValue:n(s).status,"onUpdate:modelValue":e[2]||(e[2]=a=>n(s).status=a),class:"!w-240px",clearable:"",placeholder:"用户状态"},{default:o(()=>[(i(!0),Y(K,null,ce(n(De)(n(Ee).COMMON_STATUS),a=>(i(),d(Z,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"创建时间",prop:"createTime"},{default:o(()=>[t(te,{modelValue:n(s).createTime,"onUpdate:modelValue":e[3]||(e[3]=a=>n(s).createTime=a),class:"!w-240px","end-placeholder":"结束日期","start-placeholder":"开始日期",type:"datetimerange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),t(v,null,{default:o(()=>[t(f,{onClick:x},{default:o(()=>[t(m,{icon:"ep:search"}),e[7]||(e[7]=p(" 搜索 "))]),_:1}),t(f,{onClick:q},{default:o(()=>[t(m,{icon:"ep:refresh"}),e[8]||(e[8]=p(" 重置 "))]),_:1}),g((i(),d(f,{plain:"",type:"primary",onClick:e[4]||(e[4]=a=>T("create"))},{default:o(()=>[t(m,{icon:"ep:plus"}),e[9]||(e[9]=p(" 新增 "))]),_:1})),[[b,["system:user:create"]]]),g((i(),d(f,{plain:"",type:"warning",onClick:j},{default:o(()=>[t(m,{icon:"ep:upload"}),e[10]||(e[10]=p(" 导入 "))]),_:1})),[[b,["system:user:import"]]]),g((i(),d(f,{loading:n(V),plain:"",type:"success",onClick:Q},{default:o(()=>[t(m,{icon:"ep:download"}),e[11]||(e[11]=p(" 导出 "))]),_:1},8,["loading"])),[[b,["system:user:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(N,null,{default:o(()=>[g((i(),d(se,{data:n(E)},{default:o(()=>[t(c,{key:"id",align:"center",label:"用户编号",prop:"id"}),t(c,{align:"center",label:"用户名称",prop:"username","show-overflow-tooltip":!0}),t(c,{align:"center",label:"用户昵称",prop:"nickname","show-overflow-tooltip":!0}),t(c,{key:"deptName",align:"center",label:"部门",prop:"deptName","show-overflow-tooltip":!0}),t(c,{align:"center",label:"手机号码",prop:"mobile",width:"120"}),t(c,{key:"status",label:"状态"},{default:o(a=>[t(le,{modelValue:a.row.status,"onUpdate:modelValue":k=>a.row.status=k,"active-value":0,"inactive-value":1,onChange:k=>H(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(c,{align:"center",formatter:n(fe),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(c,{align:"center",label:"操作",width:"160"},{default:o(a=>[ye("div",Pe,[g((i(),d(f,{link:"",type:"primary",onClick:k=>T("update",a.row.id)},{default:o(()=>[t(m,{icon:"ep:edit"}),e[12]||(e[12]=p(" 修改 "))]),_:2},1032,["onClick"])),[[b,["system:user:update"]]]),g((i(),d(ne,{onCommand:k=>J(k,a.row)},{dropdown:o(()=>[t(ae,null,{default:o(()=>[n(S)(["system:user:delete"])?(i(),d(R,{key:0,command:"handleDelete"},{default:o(()=>[t(m,{icon:"ep:delete"}),e[14]||(e[14]=p(" 删除 "))]),_:1})):U("",!0),n(S)(["system:user:update-password"])?(i(),d(R,{key:1,command:"handleResetPwd"},{default:o(()=>[t(m,{icon:"ep:key"}),e[15]||(e[15]=p(" 重置密码 "))]),_:1})):U("",!0),n(S)(["system:permission:assign-user-role"])?(i(),d(R,{key:2,command:"handleRole"},{default:o(()=>[t(m,{icon:"ep:circle-check"}),e[16]||(e[16]=p(" 分配角色 "))]),_:1})):U("",!0)]),_:1})]),default:o(()=>[t(f,{link:"",type:"primary"},{default:o(()=>[t(m,{icon:"ep:d-arrow-right"}),e[13]||(e[13]=p(" 更多 "))]),_:1})]),_:2},1032,["onCommand"])),[[b,["system:user:delete","system:user:update-password","system:permission:assign-user-role"]]])])]),_:1})]),_:1},8,["data"])),[[me,n(h)]]),t(re,{limit:n(s).pageSize,"onUpdate:limit":e[5]||(e[5]=a=>n(s).pageSize=a),page:n(s).pageNo,"onUpdate:page":e[6]||(e[6]=a=>n(s).pageNo=a),total:n(D),onPagination:u},null,8,["limit","page","total"])]),_:1})]),_:1})]),_:1}),t(he,{ref_key:"formRef",ref:P,onSuccess:u},null,512),t(Ve,{ref_key:"importFormRef",ref:B,onSuccess:u},null,512),t(Ce,{ref_key:"assignRoleFormRef",ref:L,onSuccess:u},null,512)],64)}}});export{Xe as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{_ as re}from"./Descriptions-bK5yEg59.js";import{_ as se}from"./UploadImgs-CwkRwUw3.js";import{_ as ne}from"./UploadImg-BE45TJSs.js";import{_ as pe}from"./ProductAttributes.vue_vue_type_script_setup_true_lang-CMqSe1YE.js";import{_ as ie}from"./ProductPropertyAddForm.vue_vue_type_script_setup_true_lang-Dxkc2IUJ.js";import{b as ue}from"./spu.data-B7RrOj77.js";import{g as de}from"./brand-CtDGcGJV.js";import{g as me}from"./category-BfSOHD5l.js";import{g as ce}from"./index-Dn3U7vTn.js";import{c as fe}from"./index-DAvM7WNv.js";import{d as _e,aA as O,r as _,f as j,Y as ye,b as be,g as u,c as b,o as p,k as f,l as v,j as a,a as e,m as o,F as g,n as C,v as m,t as T,z as ge,bJ as ke,c2 as ve}from"./index-BdmDrM2Y.js";import{c as Te,D as Ve}from"./dict-Cm-9nniQ.js";import{h as Ie,d as Ue,t as Ce}from"./tree-vSlcEeQq.js";import{g as Pe}from"./index-K--N5cbR.js";import{u as we}from"./useCrudSchemas-CKDeb1Cb.js";import{r as d}from"./formRules-wW3jWK7m.js";import{_ as P}from"./SkuList.vue_vue_type_script_setup_true_lang-Cxi7z97n.js";const Ge=_e({name:"ProductSpuBasicInfoForm",__name:"BasicInfoForm",props:{propFormData:{type:Object,default:()=>{}},activeName:O.string.def(""),isDetail:O.bool.def(!1)},emits:["update:activeName"],setup(V,{expose:h,emit:M}){const F=[{name:"stock",rule:s=>s>=0,message:"商品库存必须大于等于 1 ！！！"},{name:"price",rule:s=>s>=.01,message:"商品销售价格必须大于等于 0.01 元！！！"},{name:"marketPrice",rule:s=>s>=.01,message:"商品市场价格必须大于等于 0.01 元！！！"},{name:"costPrice",rule:s=>s>=.01,message:"商品成本价格必须大于等于 0.00 元！！！"}],{allSchemas:Y}=we(ue),R=s=>{const t=[];ke(s)?s.forEach(k=>{t.push(k.url)}):t.push(s),fe({urlList:t})},q=ge(),N=V,$=_(),w=_(),c=_([]),I=_(),z=s=>{I.value.generateTableData(s)},r=j({name:"",categoryId:null,keyword:"",unit:null,picUrl:"",sliderPicUrls:[],introduction:"",deliveryTemplateId:null,brandId:null,specType:!1,subCommissionType:!1,skus:[]}),J=j({name:[d],categoryId:[d],keyword:[d],unit:[d],introduction:[d],picUrl:[d],sliderPicUrls:[d],deliveryTemplateId:[d],brandId:[d],specType:[d],subCommissionType:[d]});ye(()=>N.propFormData,s=>{s&&(ve(r,s),r.sliderPicUrls=s.sliderPicUrls?.map(t=>({url:t})),c.value=Pe(s))},{immediate:!0});const G=M;h({validate:async()=>{if(I.value.validateSku(),!!w)return await e(w).validate(s=>{if(s)Object.assign(N.propFormData,r);else throw q.warning("商品信息未完善！！"),G("update:activeName","basicInfo"),new Error("商品信息未完善！！")})}});const H=()=>{for(const s of r.skus)s.firstBrokeragePrice=0,s.secondBrokeragePrice=0},K=()=>{c.value=[],r.skus=[{price:0,marketPrice:0,costPrice:0,barCode:"",picUrl:"",stock:0,weight:0,volume:0,firstBrokeragePrice:0,secondBrokeragePrice:0}]},D=_([]),Q=s=>Ce(D.value,s),S=_([]),x=_([]);return be(async()=>{const s=await me({});D.value=Ie(s,"id","parentId"),S.value=await de(),x.value=await ce()}),(s,t)=>{const k=u("el-input"),n=u("el-form-item"),i=u("el-col"),W=u("el-cascader"),L=u("el-option"),B=u("el-select"),X=ne,Z=se,U=u("el-radio"),A=u("el-radio-group"),ee=u("el-button"),le=u("el-row"),ae=u("el-form"),E=u("el-image"),oe=re;return p(),b(g,null,[V.isDetail?v("",!0):(p(),f(ae,{key:0,ref_key:"productSpuBasicInfoRef",ref:w,"label-width":"120px",model:e(r),rules:e(J)},{default:o(()=>[a(le,null,{default:o(()=>[a(i,{span:12},{default:o(()=>[a(n,{label:"商品名称",prop:"name"},{default:o(()=>[a(k,{modelValue:e(r).name,"onUpdate:modelValue":t[0]||(t[0]=l=>e(r).name=l),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"商品分类",prop:"categoryId"},{default:o(()=>[a(W,{modelValue:e(r).categoryId,"onUpdate:modelValue":t[1]||(t[1]=l=>e(r).categoryId=l),class:"w-1/1",clearable:"",filterable:"",options:e(D),placeholder:"请选择商品分类",props:e(Ue)},null,8,["modelValue","options","props"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"商品关键字",prop:"keyword"},{default:o(()=>[a(k,{modelValue:e(r).keyword,"onUpdate:modelValue":t[2]||(t[2]=l=>e(r).keyword=l),placeholder:"请输入商品关键字"},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"单位",prop:"unit"},{default:o(()=>[a(B,{modelValue:e(r).unit,"onUpdate:modelValue":t[3]||(t[3]=l=>e(r).unit=l),class:"w-1/1",placeholder:"请选择单位"},{default:o(()=>[(p(!0),b(g,null,C(e(Te)(e(Ve).PRODUCT_UNIT),l=>(p(),f(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"商品简介",prop:"introduction"},{default:o(()=>[a(k,{modelValue:e(r).introduction,"onUpdate:modelValue":t[4]||(t[4]=l=>e(r).introduction=l),placeholder:"请输入商品简介",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"商品封面图",prop:"picUrl"},{default:o(()=>[a(X,{modelValue:e(r).picUrl,"onUpdate:modelValue":t[5]||(t[5]=l=>e(r).picUrl=l),height:"80px"},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{span:24},{default:o(()=>[a(n,{label:"商品轮播图",prop:"sliderPicUrls"},{default:o(()=>[a(Z,{modelValue:e(r).sliderPicUrls,"onUpdate:modelValue":t[6]||(t[6]=l=>e(r).sliderPicUrls=l)},null,8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"运费模板",prop:"deliveryTemplateId"},{default:o(()=>[a(B,{modelValue:e(r).deliveryTemplateId,"onUpdate:modelValue":t[7]||(t[7]=l=>e(r).deliveryTemplateId=l),placeholder:"请选择"},{default:o(()=>[(p(!0),b(g,null,C(e(x),l=>(p(),f(L,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"品牌",prop:"brandId"},{default:o(()=>[a(B,{modelValue:e(r).brandId,"onUpdate:modelValue":t[8]||(t[8]=l=>e(r).brandId=l),placeholder:"请选择"},{default:o(()=>[(p(!0),b(g,null,C(e(S),l=>(p(),f(L,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"商品规格",props:"specType"},{default:o(()=>[a(A,{modelValue:e(r).specType,"onUpdate:modelValue":t[9]||(t[9]=l=>e(r).specType=l),onChange:K},{default:o(()=>[a(U,{class:"radio",label:!1},{default:o(()=>t[11]||(t[11]=[m("单规格")])),_:1}),a(U,{label:!0},{default:o(()=>t[12]||(t[12]=[m("多规格")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(i,{span:12},{default:o(()=>[a(n,{label:"分销类型",props:"subCommissionType"},{default:o(()=>[a(A,{modelValue:e(r).subCommissionType,"onUpdate:modelValue":t[10]||(t[10]=l=>e(r).subCommissionType=l),onChange:H},{default:o(()=>[a(U,{label:!1},{default:o(()=>t[13]||(t[13]=[m("默认设置")])),_:1}),a(U,{class:"radio",label:!0},{default:o(()=>t[14]||(t[14]=[m("单独设置")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(i,{span:24},{default:o(()=>[e(r).specType?v("",!0):(p(),f(n,{key:0},{default:o(()=>[a(e(P),{ref_key:"skuListRef",ref:I,"prop-form-data":e(r),"property-list":e(c),"rule-config":F},null,8,["prop-form-data","property-list"])]),_:1})),e(r).specType?(p(),f(n,{key:1,label:"商品属性"},{default:o(()=>[a(ee,{class:"mb-10px mr-15px",onClick:e($).open},{default:o(()=>t[15]||(t[15]=[m("添加属性")])),_:1},8,["onClick"]),a(pe,{"property-list":e(c),onSuccess:z},null,8,["property-list"])]),_:1})):v("",!0),e(r).specType&&e(c).length>0?(p(),b(g,{key:2},[a(n,{label:"批量设置"},{default:o(()=>[a(e(P),{"is-batch":!0,"prop-form-data":e(r),"property-list":e(c)},null,8,["prop-form-data","property-list"])]),_:1}),a(n,{label:"属性列表"},{default:o(()=>[a(e(P),{ref_key:"skuListRef",ref:I,"prop-form-data":e(r),"property-list":e(c),"rule-config":F},null,8,["prop-form-data","property-list"])]),_:1})],64)):v("",!0)]),_:1})]),_:1})]),_:1},8,["model","rules"])),V.isDetail?(p(),f(oe,{key:1,data:e(r),schema:e(Y).detailSchema},{categoryId:o(({row:l})=>[m(T(Q(l.categoryId)),1)]),brandId:o(({row:l})=>[m(T(e(S).find(y=>y.id===l.brandId)?.name),1)]),deliveryTemplateId:o(({row:l})=>[m(T(e(x).find(y=>y.id===l.deliveryTemplateId)?.name),1)]),specType:o(({row:l})=>[m(T(l.specType?"多规格":"单规格"),1)]),subCommissionType:o(({row:l})=>[m(T(l.subCommissionType?"单独设置":"默认设置"),1)]),picUrl:o(({row:l})=>[a(E,{class:"h-60px w-60px",src:l.picUrl,onClick:y=>R(l.picUrl)},null,8,["src","onClick"])]),sliderPicUrls:o(({row:l})=>[(p(!0),b(g,null,C(l.sliderPicUrls,(y,te)=>(p(),f(E,{key:te,class:"mr-10px h-60px w-60px",src:y.url,onClick:Se=>R(l.sliderPicUrls)},null,8,["src","onClick"]))),128))]),skus:o(()=>[a(e(P),{ref:"skuDetailListRef","is-detail":V.isDetail,"prop-form-data":e(r),"property-list":e(c)},null,8,["is-detail","prop-form-data","property-list"])]),_:1},8,["data","schema"])):v("",!0),a(ie,{ref_key:"attributesAddFormRef",ref:$,"property-list":e(c)},null,8,["property-list"])],64)}}});export{Ge as _};

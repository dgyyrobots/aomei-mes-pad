/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as J,r as _,f as X,b as Z,g as u,h as M,c as V,o as p,j as e,m as o,a,F as P,n as h,k as i,w as b,v as f,K as ee,i as te,t as le,L as ae,M as oe,z as ne,N as re}from"./index-D3eRVKjp.js";import{_ as se}from"./DictTag.vue_vue_type_script_lang-h3s-iN69.js";import{_ as ue}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dg75KKir.js";import{_ as pe}from"./index-66PJkU8k.js";import{_ as ie}from"./CouponTemplateForm.vue_vue_type_script_setup_true_lang-BCHNQrQf.js";import{g as me,b as de,d as ce}from"./couponTemplate-DiVhRKo-.js";import{C as T}from"./constants-BPQb3nxh.js";import{c as L,D as g}from"./dict-CqgorI4d.js";import{d as _e,v as fe,r as ge,t as ye}from"./formatter-iJVa4YJ3.js";import"./color-B5phLuB-.js";import"./SpuShowcase-Dfl-sNDJ.js";import"./spu-CL8bP2N_.js";import"./SpuTableSelect.vue_vue_type_script_setup_true_lang-VCIUZbuB.js";import"./tree-vSlcEeQq.js";import"./category-RLeiMjVu.js";import"./ProductCategorySelect.vue_vue_type_script_setup_true_lang-CHY6KGrS.js";const Ie=J({name:"PromotionCouponTemplate",__name:"index",setup(ve){const y=ne(),{t:R}=re(),C=_(!0),x=_(0),S=_([]),n=X({pageNo:1,pageSize:10,name:null,status:null,discountType:null,type:null,createTime:[]}),D=_(),m=async()=>{C.value=!0;try{const r=await me(n);S.value=r.list,x.value=r.total}finally{C.value=!1}},w=()=>{n.pageNo=1,m()},B=()=>{D?.value?.resetFields(),w()},E=_(),U=(r,l)=>{E.value.open(r,l)},Y=async r=>{const l=r.status===T.ENABLE?"启用":"停用";try{await y.confirm(`确认要"${l}""${r.name}"优惠劵吗?`),await de(r.id,r.status),y.success(`${l}成功`)}catch{r.status=r.status===T.ENABLE?T.DISABLE:T.ENABLE}},A=async r=>{try{await y.confirm(`是否确认删除优惠劵编号为"${r}"的数据项?`),await ce(r),y.success(R("common.delSuccess")),await m()}catch(l){console.log(l)}};return Z(()=>{m()}),(r,l)=>{const z=pe,q=u("el-input"),d=u("el-form-item"),$=u("el-option"),F=u("el-select"),K=u("el-date-picker"),k=ee,c=u("el-button"),H=u("el-form"),I=ue,s=u("el-table-column"),O=se,Q=u("el-switch"),j=u("el-table"),W=oe,N=M("hasPermi"),G=M("loading");return p(),V(P,null,[e(z,{title:"功能开启",url:"https://doc.iocoder.cn/mall/build/"}),e(I,null,{default:o(()=>[e(H,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"82px",model:a(n)},{default:o(()=>[e(d,{label:"优惠券名称",prop:"name"},{default:o(()=>[e(q,{modelValue:a(n).name,"onUpdate:modelValue":l[0]||(l[0]=t=>a(n).name=t),class:"!w-240px",clearable:"",placeholder:"请输入优惠劵名",onKeyup:w},null,8,["modelValue"])]),_:1}),e(d,{label:"优惠类型",prop:"discountType"},{default:o(()=>[e(F,{modelValue:a(n).discountType,"onUpdate:modelValue":l[1]||(l[1]=t=>a(n).discountType=t),class:"!w-240px",clearable:"",placeholder:"请选择优惠券类型"},{default:o(()=>[(p(!0),V(P,null,h(a(L)(a(g).PROMOTION_DISCOUNT_TYPE),t=>(p(),i($,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"优惠券状态",prop:"status"},{default:o(()=>[e(F,{modelValue:a(n).status,"onUpdate:modelValue":l[2]||(l[2]=t=>a(n).status=t),class:"!w-240px",clearable:"",placeholder:"请选择优惠券状态"},{default:o(()=>[(p(!0),V(P,null,h(a(L)(a(g).COMMON_STATUS),t=>(p(),i($,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"创建时间",prop:"createTime"},{default:o(()=>[e(K,{modelValue:a(n).createTime,"onUpdate:modelValue":l[3]||(l[3]=t=>a(n).createTime=t),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(d,null,{default:o(()=>[e(c,{onClick:w},{default:o(()=>[e(k,{class:"mr-5px",icon:"ep:search"}),l[7]||(l[7]=f(" 搜索 "))]),_:1}),e(c,{onClick:B},{default:o(()=>[e(k,{class:"mr-5px",icon:"ep:refresh"}),l[8]||(l[8]=f(" 重置 "))]),_:1}),b((p(),i(c,{plain:"",type:"primary",onClick:l[4]||(l[4]=t=>U("create"))},{default:o(()=>[e(k,{class:"mr-5px",icon:"ep:plus"}),l[9]||(l[9]=f(" 新增 "))]),_:1})),[[N,["promotion:coupon-template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(I,null,{default:o(()=>[b((p(),i(j,{data:a(S)},{default:o(()=>[e(s,{label:"优惠券名称","min-width":"140",prop:"name"}),e(s,{label:"类型","min-width":"130",prop:"productScope"},{default:o(t=>[e(O,{type:a(g).PROMOTION_PRODUCT_SCOPE,value:t.row.productScope},null,8,["type","value"])]),_:1}),e(s,{label:"优惠","min-width":"110",prop:"discount"},{default:o(t=>[e(O,{type:a(g).PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"]),te("div",null,le(a(_e)(t.row)),1)]),_:1}),e(s,{label:"领取方式","min-width":"100",prop:"takeType"},{default:o(t=>[e(O,{type:a(g).PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),e(s,{align:"center",formatter:a(fe),label:"使用时间",prop:"validityType",width:"185"},null,8,["formatter"]),e(s,{align:"center",label:"发放数量",prop:"totalCount"}),e(s,{align:"center",formatter:a(ge),label:"剩余数量",prop:"totalCount"},null,8,["formatter"]),e(s,{align:"center",formatter:a(ye),label:"领取上限",prop:"takeLimitCount"},null,8,["formatter"]),e(s,{align:"center",label:"状态",prop:"status"},{default:o(t=>[e(Q,{modelValue:t.row.status,"onUpdate:modelValue":v=>t.row.status=v,"active-value":0,"inactive-value":1,onChange:v=>Y(t.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(s,{align:"center",formatter:a(ae),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),e(s,{align:"center","class-name":"small-padding fixed-width",fixed:"right",label:"操作",width:"120"},{default:o(t=>[b((p(),i(c,{link:"",type:"primary",onClick:v=>U("update",t.row.id)},{default:o(()=>l[10]||(l[10]=[f(" 修改 ")])),_:2},1032,["onClick"])),[[N,["promotion:coupon-template:update"]]]),b((p(),i(c,{link:"",type:"danger",onClick:v=>A(t.row.id)},{default:o(()=>l[11]||(l[11]=[f(" 删除 ")])),_:2},1032,["onClick"])),[[N,["promotion:coupon-template:delete"]]])]),_:1})]),_:1},8,["data"])),[[G,a(C)]]),e(W,{limit:a(n).pageSize,"onUpdate:limit":l[5]||(l[5]=t=>a(n).pageSize=t),page:a(n).pageNo,"onUpdate:page":l[6]||(l[6]=t=>a(n).pageNo=t),total:a(x),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(ie,{ref_key:"formRef",ref:E,onSuccess:m},null,512)],64)}}});export{Ie as default};

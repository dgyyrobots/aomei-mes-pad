/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{V as $,d as G,r as u,f as W,b as X,g as p,h as Y,c as L,o as m,j as e,m as o,a as t,J as M,F as U,n as Z,k as f,w as k,v as g,K as ee,i as F,t as O,L as le,M as te,z as ae}from"./index-D3eRVKjp.js";import{_ as oe}from"./DictTag.vue_vue_type_script_lang-h3s-iN69.js";import{_ as ne}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dg75KKir.js";import{_ as se}from"./index-66PJkU8k.js";import{_ as re}from"./OperateLogDetail.vue_vue_type_script_setup_true_lang-BSWlx2gp.js";import{c as pe,D as R}from"./dict-CqgorI4d.js";import{d as ie}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";const ue=d=>$.get({url:"/system/operate-log/page",params:d}),me=d=>$.download({url:"/system/operate-log/export",params:d}),xe=G({name:"SystemOperateLog",__name:"index",setup(d){const q=ae(),y=u(!0),V=u(0),T=u([]),n=W({pageNo:1,pageSize:10,module:void 0,userNickname:void 0,type:void 0,success:void 0,startTime:[]}),N=u(),b=u(!1),v=async()=>{y.value=!0;try{const s=await ue(n);T.value=s.list,V.value=s.total}finally{y.value=!1}},c=()=>{n.pageNo=1,v()},z=()=>{N.value.resetFields(),c()},C=u(),B=s=>{C.value.open(s)},K=async()=>{try{await q.exportConfirm(),b.value=!0;const s=await me(n);ie.excel(s,"操作日志.xls")}catch(s){console.log(s)}finally{b.value=!1}};return X(()=>{v()}),(s,a)=>{const A=se,D=p("el-input"),i=p("el-form-item"),w=p("el-option"),E=p("el-select"),H=p("el-date-picker"),x=ee,_=p("el-button"),I=p("el-form"),P=ne,r=p("el-table-column"),Q=oe,h=p("el-table"),j=te,S=Y("hasPermi"),J=Y("loading");return m(),L(U,null,[e(A,{title:"系统日志",url:"https://doc.iocoder.cn/system-log/"}),e(P,null,{default:o(()=>[e(I,{ref_key:"queryFormRef",ref:N,class:"-mb-15px",inline:!0,"label-width":"68px",model:t(n)},{default:o(()=>[e(i,{label:"系统模块",prop:"module"},{default:o(()=>[e(D,{modelValue:t(n).module,"onUpdate:modelValue":a[0]||(a[0]=l=>t(n).module=l),class:"!w-240px",clearable:"",placeholder:"请输入系统模块",onKeyup:M(c,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"操作人员",prop:"userNickname"},{default:o(()=>[e(D,{modelValue:t(n).userNickname,"onUpdate:modelValue":a[1]||(a[1]=l=>t(n).userNickname=l),class:"!w-240px",clearable:"",placeholder:"请输入操作人员",onKeyup:M(c,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"操作类型",prop:"type"},{default:o(()=>[e(E,{modelValue:t(n).type,"onUpdate:modelValue":a[2]||(a[2]=l=>t(n).type=l),class:"!w-240px",clearable:"",placeholder:"请选择操作类型"},{default:o(()=>[(m(!0),L(U,null,Z(t(pe)(t(R).SYSTEM_OPERATE_TYPE),l=>(m(),f(w,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"操作状态",prop:"success"},{default:o(()=>[e(E,{modelValue:t(n).success,"onUpdate:modelValue":a[3]||(a[3]=l=>t(n).success=l),class:"!w-240px",clearable:"",placeholder:"请选择操作状态"},{default:o(()=>[e(w,{key:"true",label:"成功",value:!0}),e(w,{key:"false",label:"失败",value:!1})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"操作时间",prop:"startTime"},{default:o(()=>[e(H,{modelValue:t(n).startTime,"onUpdate:modelValue":a[4]||(a[4]=l=>t(n).startTime=l),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(i,null,{default:o(()=>[e(_,{onClick:c},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:search"}),a[7]||(a[7]=g(" 搜索 "))]),_:1}),e(_,{onClick:z},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:refresh"}),a[8]||(a[8]=g(" 重置 "))]),_:1}),k((m(),f(_,{loading:t(b),plain:"",type:"success",onClick:K},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:download"}),a[9]||(a[9]=g(" 导出 "))]),_:1},8,["loading"])),[[S,["infra:config:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(P,null,{default:o(()=>[k((m(),f(h,{data:t(T)},{default:o(()=>[e(r,{align:"center",label:"日志编号",prop:"id"}),e(r,{align:"center",label:"操作模块",prop:"module",width:"180"}),e(r,{align:"center",label:"操作名",prop:"name",width:"180"}),e(r,{align:"center",label:"操作类型",prop:"type"},{default:o(l=>[e(Q,{type:t(R).SYSTEM_OPERATE_TYPE,value:l.row.type},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"操作人",prop:"userNickname"}),e(r,{align:"center",label:"操作结果",prop:"status"},{default:o(l=>[F("span",null,O(l.row.resultCode===0?"成功":"失败"),1)]),_:1}),e(r,{align:"center",formatter:t(le),label:"操作时间",prop:"startTime",width:"180"},null,8,["formatter"]),e(r,{align:"center",label:"执行时长",prop:"startTime"},{default:o(l=>[F("span",null,O(l.row.duration)+" ms",1)]),_:1}),e(r,{align:"center",label:"操作"},{default:o(l=>[k((m(),f(_,{link:"",type:"primary",onClick:de=>B(l.row)},{default:o(()=>a[10]||(a[10]=[g("详情")])),_:2},1032,["onClick"])),[[S,["infra:config:query"]]])]),_:1})]),_:1},8,["data"])),[[J,t(y)]]),e(j,{limit:t(n).pageSize,"onUpdate:limit":a[5]||(a[5]=l=>t(n).pageSize=l),page:t(n).pageNo,"onUpdate:page":a[6]||(a[6]=l=>t(n).pageNo=l),total:t(V),onPagination:v},null,8,["limit","page","total"])]),_:1}),e(re,{ref_key:"detailRef",ref:C},null,512)],64)}}});export{xe as default};

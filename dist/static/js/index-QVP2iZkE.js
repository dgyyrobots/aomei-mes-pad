/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 10:14:51 
 */
import{V as K,d as le,r as m,f as te,b as ae,g as i,h as H,c as f,o as s,j as l,m as o,a as t,J as q,F as w,n as D,k as c,w as I,v as S,K as oe,L as ne,i as T,l as se,t as g,x as z,M as re,z as ue}from"./index-BuFigy1A.js";import{_ as ie}from"./DictTag.vue_vue_type_script_lang-DcBSip_F.js";import{_ as de}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dq4j5fFx.js";import{_ as pe}from"./index-Bm6lKD5Z.js";import{_ as me}from"./SmsLogDetail.vue_vue_type_script_setup_true_lang-BG37-Ldu.js";import{b as ce}from"./index-D4HL_G3x.js";import{g as _e,D as p,c as B}from"./dict-Ve5yp9Dm.js";import{d as fe}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";const Se=v=>K.get({url:"/system/sms-log/page",params:v}),ge=v=>K.download({url:"/system/sms-log/export-excel",params:v}),ve={key:0},ke=le({name:"SystemSmsLog",__name:"index",setup(v){const O=ue(),x=m(!1),N=m(0),U=m([]),L=m(),n=te({pageNo:1,pageSize:10,channelId:null,templateId:null,mobile:"",sendStatus:null,receiveStatus:null,sendTime:[],receiveTime:[]}),V=m(!1),E=m([]),M=async()=>{x.value=!0;try{const u=await Se(n);U.value=u.list,N.value=u.total}finally{x.value=!1}},b=()=>{n.pageNo=1,M()},Q=()=>{L.value.resetFields(),b()},j=async()=>{try{await O.exportConfirm(),V.value=!0;const u=await ge(n);fe.excel(u,"短信日志.xls")}catch(u){console.log(u)}finally{V.value=!1}},h=m(),J=u=>{h.value.open(u)};return ae(async()=>{await M(),E.value=await ce()}),(u,a)=>{const G=pe,P=i("el-input"),d=i("el-form-item"),C=i("el-option"),k=i("el-select"),A=i("el-date-picker"),Y=oe,y=i("el-button"),W=i("el-form"),R=de,r=i("el-table-column"),_=ie,X=i("el-table"),Z=re,$=H("hasPermi"),ee=H("loading");return s(),f(w,null,[l(G,{title:"短信配置",url:"https://doc.iocoder.cn/sms/"}),l(R,null,{default:o(()=>[l(W,{ref_key:"queryFormRef",ref:L,class:"-mb-15px",inline:!0,"label-width":"100px",model:t(n)},{default:o(()=>[l(d,{label:"手机号",prop:"mobile"},{default:o(()=>[l(P,{modelValue:t(n).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>t(n).mobile=e),class:"!w-240px",clearable:"",placeholder:"请输入手机号",onKeyup:q(b,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"短信渠道",prop:"channelId"},{default:o(()=>[l(k,{modelValue:t(n).channelId,"onUpdate:modelValue":a[1]||(a[1]=e=>t(n).channelId=e),class:"!w-240px",clearable:"",placeholder:"请选择短信渠道"},{default:o(()=>[(s(!0),f(w,null,D(t(E),e=>(s(),c(C,{key:e.id,label:e.signature+`【 ${t(_e)(t(p).SYSTEM_SMS_CHANNEL_CODE,e.code)}】`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"模板编号",prop:"templateId"},{default:o(()=>[l(P,{modelValue:t(n).templateId,"onUpdate:modelValue":a[2]||(a[2]=e=>t(n).templateId=e),class:"!w-240px",clearable:"",placeholder:"请输入模板编号",onKeyup:q(b,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{label:"发送状态",prop:"sendStatus"},{default:o(()=>[l(k,{modelValue:t(n).sendStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>t(n).sendStatus=e),class:"!w-240px",clearable:"",placeholder:"请选择发送状态"},{default:o(()=>[(s(!0),f(w,null,D(t(B)(t(p).SYSTEM_SMS_SEND_STATUS),e=>(s(),c(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"发送时间",prop:"sendTime"},{default:o(()=>[l(A,{modelValue:t(n).sendTime,"onUpdate:modelValue":a[4]||(a[4]=e=>t(n).sendTime=e),class:"!w-240px","end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(d,{label:"接收状态",prop:"receiveStatus"},{default:o(()=>[l(k,{modelValue:t(n).receiveStatus,"onUpdate:modelValue":a[5]||(a[5]=e=>t(n).receiveStatus=e),class:"!w-240px",clearable:"",placeholder:"请选择接收状态"},{default:o(()=>[(s(!0),f(w,null,D(t(B)(t(p).SYSTEM_SMS_RECEIVE_STATUS),e=>(s(),c(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"接收时间",prop:"receiveTime"},{default:o(()=>[l(A,{modelValue:t(n).receiveTime,"onUpdate:modelValue":a[6]||(a[6]=e=>t(n).receiveTime=e),class:"!w-240px","end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(d,null,{default:o(()=>[l(y,{onClick:b},{default:o(()=>[l(Y,{class:"mr-5px",icon:"ep:search"}),a[9]||(a[9]=S(" 搜索 "))]),_:1}),l(y,{onClick:Q},{default:o(()=>[l(Y,{class:"mr-5px",icon:"ep:refresh"}),a[10]||(a[10]=S(" 重置 "))]),_:1}),I((s(),c(y,{loading:t(V),plain:"",type:"success",onClick:j},{default:o(()=>[l(Y,{class:"mr-5px",icon:"ep:download"}),a[11]||(a[11]=S(" 导出 "))]),_:1},8,["loading"])),[[$,["system:sms-log:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(R,null,{default:o(()=>[I((s(),c(X,{data:t(U)},{default:o(()=>[l(r,{align:"center",label:"编号",prop:"id"}),l(r,{align:"center",formatter:t(ne),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),l(r,{align:"center",label:"手机号",prop:"mobile",width:"120"},{default:o(e=>[T("div",null,g(e.row.mobile),1),e.row.userType&&e.row.userId?(s(),f("div",ve,[l(_,{type:t(p).USER_TYPE,value:e.row.userType},null,8,["type","value"]),S(" "+g("("+e.row.userId+")"),1)])):se("",!0)]),_:1}),l(r,{align:"center",label:"短信内容",prop:"templateContent",width:"300"}),l(r,{align:"center",label:"发送状态",width:"180"},{default:o(e=>[l(_,{type:t(p).SYSTEM_SMS_SEND_STATUS,value:e.row.sendStatus},null,8,["type","value"]),T("div",null,g(t(z)(e.row.sendTime)),1)]),_:1}),l(r,{align:"center",label:"接收状态",width:"180"},{default:o(e=>[l(_,{type:t(p).SYSTEM_SMS_RECEIVE_STATUS,value:e.row.receiveStatus},null,8,["type","value"]),T("div",null,g(t(z)(e.row.receiveTime)),1)]),_:1}),l(r,{align:"center",label:"短信渠道",width:"120"},{default:o(e=>[T("div",null,g(t(E).find(F=>F.id===e.row.channelId)?.signature),1),l(_,{type:t(p).SYSTEM_SMS_CHANNEL_CODE,value:e.row.channelCode},null,8,["type","value"])]),_:1}),l(r,{align:"center",label:"模板编号",prop:"templateId"}),l(r,{align:"center",label:"短信类型",prop:"templateType"},{default:o(e=>[l(_,{type:t(p).SYSTEM_SMS_TEMPLATE_TYPE,value:e.row.templateType},null,8,["type","value"])]),_:1}),l(r,{align:"center","class-name":"fixed-width",fixed:"right",label:"操作"},{default:o(e=>[I((s(),c(y,{link:"",type:"primary",onClick:F=>J(e.row)},{default:o(()=>a[12]||(a[12]=[S("详情")])),_:2},1032,["onClick"])),[[$,["system:sms-log:query"]]])]),_:1})]),_:1},8,["data"])),[[ee,t(x)]]),l(Z,{limit:t(n).pageSize,"onUpdate:limit":a[7]||(a[7]=e=>t(n).pageSize=e),page:t(n).pageNo,"onUpdate:page":a[8]||(a[8]=e=>t(n).pageNo=e),total:t(N),onPagination:M},null,8,["limit","page","total"])]),_:1}),l(me,{ref_key:"detailRef",ref:h},null,512)],64)}}});export{ke as default};

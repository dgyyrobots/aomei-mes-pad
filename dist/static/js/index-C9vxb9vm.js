/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 15:23:48 
 */
import{d as M,r as i,f as G,b as Q,g as m,h as P,c as j,o as u,j as e,m as o,a as t,J as N,w as _,v as c,K as J,k as g,L as S,M as W,F as Y,z as H,N as X}from"./index-C8VsLzxx.js";import{_ as Z}from"./DictTag.vue_vue_type_script_lang-lHf-rDoT.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DmvxiVVs.js";import{_ as le,g as te,d as ae,e as oe}from"./ClueForm.vue_vue_type_script_setup_true_lang-BqU4JE7A.js";import{D as L}from"./dict-_inVRzR5.js";import{d as ne}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";const fe=M({name:"CrmClue",__name:"index",setup(re){const x=H(),{t:h}=X(),v=i(!0),V=i(0),F=i([]),n=G({pageNo:1,pageSize:10,name:null,telephone:null,mobile:null}),I=i(),C=i(!1),d=async()=>{v.value=!0;try{const s=await te(n);F.value=s.list,V.value=s.total}finally{v.value=!1}},f=()=>{n.pageNo=1,d()},B=()=>{I.value.resetFields(),f()},R=i(),T=(s,l)=>{R.value.open(s,l)},D=async s=>{try{await x.delConfirm(),await ae(s),x.success(h("common.delSuccess")),await d()}catch(l){console.log(l)}},E=async()=>{try{await x.exportConfirm(),C.value=!0;const s=await oe(n);ne.excel(s,"线索.xls")}catch(s){console.log(s)}finally{C.value=!1}};return Q(()=>{d()}),(s,l)=>{const k=m("el-input"),b=m("el-form-item"),w=J,p=m("el-button"),K=m("el-form"),U=ee,r=m("el-table-column"),$=Z,z=m("el-table"),A=W,y=P("hasPermi"),O=P("loading");return u(),j(Y,null,[e(U,null,{default:o(()=>[e(K,{ref_key:"queryFormRef",ref:I,class:"-mb-15px",inline:!0,"label-width":"68px",model:t(n)},{default:o(()=>[e(b,{label:"线索名称",prop:"name"},{default:o(()=>[e(k,{modelValue:t(n).name,"onUpdate:modelValue":l[0]||(l[0]=a=>t(n).name=a),class:"!w-240px",clearable:"",placeholder:"请输入线索名称",onKeyup:N(f,["enter"])},null,8,["modelValue"])]),_:1}),e(b,{label:"电话",prop:"telephone"},{default:o(()=>[e(k,{modelValue:t(n).telephone,"onUpdate:modelValue":l[1]||(l[1]=a=>t(n).telephone=a),class:"!w-240px",clearable:"",placeholder:"请输入电话",onKeyup:N(f,["enter"])},null,8,["modelValue"])]),_:1}),e(b,{label:"手机号",prop:"mobile"},{default:o(()=>[e(k,{modelValue:t(n).mobile,"onUpdate:modelValue":l[2]||(l[2]=a=>t(n).mobile=a),class:"!w-240px",clearable:"",placeholder:"请输入手机号",onKeyup:N(f,["enter"])},null,8,["modelValue"])]),_:1}),e(b,null,{default:o(()=>[e(p,{onClick:f},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:search"}),l[6]||(l[6]=c(" 搜索 "))]),_:1}),e(p,{onClick:B},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:refresh"}),l[7]||(l[7]=c(" 重置 "))]),_:1}),_((u(),g(p,{type:"primary",onClick:l[3]||(l[3]=a=>T("create"))},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:plus"}),l[8]||(l[8]=c(" 新增 "))]),_:1})),[[y,["crm:clue:create"]]]),_((u(),g(p,{loading:t(C),plain:"",type:"success",onClick:E},{default:o(()=>[e(w,{class:"mr-5px",icon:"ep:download"}),l[9]||(l[9]=c(" 导出 "))]),_:1},8,["loading"])),[[y,["crm:clue:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(U,null,{default:o(()=>[_((u(),g(z,{data:t(F),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[e(r,{align:"center",label:"编号",prop:"id"}),e(r,{align:"center",label:"转化状态",prop:"transformStatus"},{default:o(a=>[e($,{type:t(L).INFRA_BOOLEAN_STRING,value:a.row.transformStatus},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"跟进状态",prop:"followUpStatus"},{default:o(a=>[e($,{type:t(L).INFRA_BOOLEAN_STRING,value:a.row.followUpStatus},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"线索名称",prop:"name"}),e(r,{align:"center",label:"客户id",prop:"customerId"}),e(r,{align:"center",formatter:t(S),label:"下次联系时间",prop:"contactNextTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"电话",prop:"telephone"}),e(r,{align:"center",label:"手机号",prop:"mobile"}),e(r,{align:"center",label:"地址",prop:"address"}),e(r,{align:"center",label:"负责人",prop:"ownerUserId"}),e(r,{align:"center",formatter:t(S),label:"最后跟进时间",prop:"contactLastTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"备注",prop:"remark"}),e(r,{align:"center",formatter:t(S),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",fixed:"right",label:"操作","min-width":"110"},{default:o(a=>[_((u(),g(p,{link:"",type:"primary",onClick:q=>T("update",a.row.id)},{default:o(()=>l[10]||(l[10]=[c("编辑")])),_:2},1032,["onClick"])),[[y,["crm:clue:update"]]]),_((u(),g(p,{link:"",type:"danger",onClick:q=>D(a.row.id)},{default:o(()=>l[11]||(l[11]=[c("删除")])),_:2},1032,["onClick"])),[[y,["crm:clue:delete"]]])]),_:1})]),_:1},8,["data"])),[[O,t(v)]]),e(A,{limit:t(n).pageSize,"onUpdate:limit":l[4]||(l[4]=a=>t(n).pageSize=a),page:t(n).pageNo,"onUpdate:page":l[5]||(l[5]=a=>t(n).pageNo=a),total:t(V),onPagination:d},null,8,["limit","page","total"])]),_:1}),e(le,{ref_key:"formRef",ref:R,onSuccess:d},null,512)],64)}}});export{fe as default};

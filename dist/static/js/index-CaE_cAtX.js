/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{d as ee,r as d,f as le,b as te,g as i,h as O,c as T,o as r,j as l,m as o,a,F as k,n as P,k as m,J as R,w as f,v as _,K as ae,i as oe,t as ne,L as se,M as re,z as pe,N as ie}from"./index-DMg0mq0e.js";import{_ as me}from"./DictTag.vue_vue_type_script_lang-sQcOd7JH.js";import{_ as de}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DPMk4m5L.js";import{_ as ue}from"./index-B4jjJPyl.js";import{_ as ce}from"./SmsTemplateForm.vue_vue_type_script_setup_true_lang-DbLyxKHI.js";import{_ as _e}from"./SmsTemplateSendForm.vue_vue_type_script_setup_true_lang-BMdmGQpf.js";import{b as fe}from"./index-pDgyzk9N.js";import{a as ye,d as ge,e as ve}from"./index-BhxHgDFW.js";import{c as z,D as y,g as we}from"./dict-BEquckDR.js";import{d as be}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./constants-BPQb3nxh.js";const Ye=ee({name:"SystemSmsTemplate",__name:"index",setup(Se){const x=pe(),{t:B}=ie(),C=d(!1),D=d(0),L=d([]),Y=d(),n=le({pageNo:1,pageSize:10,type:void 0,status:void 0,code:"",content:"",apiTemplateId:"",channelId:void 0,createTime:[]}),V=d(!1),M=d([]),g=async()=>{C.value=!0;try{const s=await ye(n);L.value=s.list,D.value=s.total}finally{C.value=!1}},w=()=>{n.pageNo=1,g()},H=()=>{Y.value.resetFields(),w()},$=d(),h=(s,t)=>{$.value.open(s,t)},F=d(),K=s=>{F.value.open(s)},q=async s=>{try{await x.delConfirm(),await ge(s),x.success(B("common.delSuccess")),await g()}catch(t){console.log(t)}},Q=async()=>{try{await x.exportConfirm(),V.value=!0;const s=await ve(n);be.excel(s,"短信模板.xls")}catch(s){console.log(s)}finally{V.value=!1}};return te(async()=>{await g(),M.value=await fe()}),(s,t)=>{const j=ue,E=i("el-option"),I=i("el-select"),u=i("el-form-item"),U=i("el-input"),J=i("el-date-picker"),b=ae,c=i("el-button"),G=i("el-form"),A=de,p=i("el-table-column"),N=me,W=i("el-table"),X=re,v=O("hasPermi"),Z=O("loading");return r(),T(k,null,[l(j,{title:"短信配置",url:"https://doc.iocoder.cn/sms/"}),l(A,null,{default:o(()=>[l(G,{ref_key:"queryFormRef",ref:Y,class:"-mb-15px",inline:!0,"label-width":"150px",model:a(n)},{default:o(()=>[l(u,{label:"短信类型",prop:"type"},{default:o(()=>[l(I,{modelValue:a(n).type,"onUpdate:modelValue":t[0]||(t[0]=e=>a(n).type=e),class:"!w-240px",clearable:"",placeholder:"请选择短信类型"},{default:o(()=>[(r(!0),T(k,null,P(a(z)(a(y).SYSTEM_SMS_TEMPLATE_TYPE),e=>(r(),m(E,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"开启状态",prop:"status"},{default:o(()=>[l(I,{modelValue:a(n).status,"onUpdate:modelValue":t[1]||(t[1]=e=>a(n).status=e),class:"!w-240px",clearable:"",placeholder:"请选择开启状态"},{default:o(()=>[(r(!0),T(k,null,P(a(z)(a(y).COMMON_STATUS),e=>(r(),m(E,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"模板编码",prop:"code"},{default:o(()=>[l(U,{modelValue:a(n).code,"onUpdate:modelValue":t[2]||(t[2]=e=>a(n).code=e),class:"!w-240px",clearable:"",placeholder:"请输入模板编码",onKeyup:R(w,["enter"])},null,8,["modelValue"])]),_:1}),l(u,{label:"短信 API 的模板编号",prop:"apiTemplateId"},{default:o(()=>[l(U,{modelValue:a(n).apiTemplateId,"onUpdate:modelValue":t[3]||(t[3]=e=>a(n).apiTemplateId=e),class:"!w-240px",clearable:"",placeholder:"请输入短信 API 的模板编号",onKeyup:R(w,["enter"])},null,8,["modelValue"])]),_:1}),l(u,{label:"短信渠道",prop:"channelId"},{default:o(()=>[l(I,{modelValue:a(n).channelId,"onUpdate:modelValue":t[4]||(t[4]=e=>a(n).channelId=e),class:"!w-240px",clearable:"",placeholder:"请选择短信渠道"},{default:o(()=>[(r(!0),T(k,null,P(a(M),e=>(r(),m(E,{key:e.id,label:e.signature+`【 ${a(we)(a(y).SYSTEM_SMS_CHANNEL_CODE,e.code)}】`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"创建时间",prop:"createTime"},{default:o(()=>[l(J,{modelValue:a(n).createTime,"onUpdate:modelValue":t[5]||(t[5]=e=>a(n).createTime=e),class:"!w-240px","end-placeholder":"结束日期","start-placeholder":"开始日期",style:{width:"240px"},type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),l(u,null,{default:o(()=>[l(c,{onClick:w},{default:o(()=>[l(b,{class:"mr-5px",icon:"ep:search"}),t[9]||(t[9]=_(" 搜索 "))]),_:1}),l(c,{onClick:H},{default:o(()=>[l(b,{class:"mr-5px",icon:"ep:refresh"}),t[10]||(t[10]=_(" 重置 "))]),_:1}),f((r(),m(c,{plain:"",type:"primary",onClick:t[6]||(t[6]=e=>h("create"))},{default:o(()=>[l(b,{class:"mr-5px",icon:"ep:plus"}),t[11]||(t[11]=_(" 新增 "))]),_:1})),[[v,["system:sms-template:create"]]]),f((r(),m(c,{loading:a(V),plain:"",type:"success",onClick:Q},{default:o(()=>[l(b,{class:"mr-5px",icon:"ep:download"}),t[12]||(t[12]=_(" 导出 "))]),_:1},8,["loading"])),[[v,["system:sms-template:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),l(A,null,{default:o(()=>[f((r(),m(W,{data:a(L)},{default:o(()=>[l(p,{align:"center",label:"模板编码",prop:"code","show-overflow-tooltip":!0,width:"120"}),l(p,{align:"center",label:"模板名称",prop:"name","show-overflow-tooltip":!0,width:"120"}),l(p,{align:"center",label:"模板内容",prop:"content","show-overflow-tooltip":!0,width:"200"}),l(p,{align:"center",label:"短信类型",prop:"type"},{default:o(e=>[l(N,{type:a(y).SYSTEM_SMS_TEMPLATE_TYPE,value:e.row.type},null,8,["type","value"])]),_:1}),l(p,{align:"center",label:"状态",prop:"status",width:"80"},{default:o(e=>[l(N,{type:a(y).COMMON_STATUS,value:e.row.status},null,8,["type","value"])]),_:1}),l(p,{align:"center",label:"备注",prop:"remark"}),l(p,{align:"center",label:"短信 API 的模板编号",prop:"apiTemplateId","show-overflow-tooltip":!0,width:"200"}),l(p,{align:"center",label:"短信渠道",width:"120"},{default:o(e=>[oe("div",null,ne(a(M).find(S=>S.id===e.row.channelId)?.signature),1),l(N,{type:a(y).SYSTEM_SMS_CHANNEL_CODE,value:e.row.channelCode},null,8,["type","value"])]),_:1}),l(p,{align:"center",formatter:a(se),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),l(p,{align:"center",fixed:"right",label:"操作",width:"210"},{default:o(e=>[f((r(),m(c,{link:"",type:"primary",onClick:S=>h("update",e.row.id)},{default:o(()=>t[13]||(t[13]=[_(" 修改 ")])),_:2},1032,["onClick"])),[[v,["system:sms-template:update"]]]),f((r(),m(c,{link:"",type:"primary",onClick:S=>K(e.row.id)},{default:o(()=>t[14]||(t[14]=[_("测试")])),_:2},1032,["onClick"])),[[v,["system:sms-template:send-sms"]]]),f((r(),m(c,{link:"",type:"danger",onClick:S=>q(e.row.id)},{default:o(()=>t[15]||(t[15]=[_("删除")])),_:2},1032,["onClick"])),[[v,["system:sms-template:delete"]]])]),_:1})]),_:1},8,["data"])),[[Z,a(C)]]),l(X,{limit:a(n).pageSize,"onUpdate:limit":t[7]||(t[7]=e=>a(n).pageSize=e),page:a(n).pageNo,"onUpdate:page":t[8]||(t[8]=e=>a(n).pageNo=e),total:a(D),onPagination:g},null,8,["limit","page","total"])]),_:1}),l(ce,{ref_key:"formRef",ref:$,onSuccess:g},null,512),l(_e,{ref_key:"sendFormRef",ref:F},null,512)],64)}}});export{Ye as default};

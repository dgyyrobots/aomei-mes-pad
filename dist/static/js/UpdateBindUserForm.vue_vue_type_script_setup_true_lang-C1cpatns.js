/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{d as E,r as c,f as G,g as r,h as K,k as d,o as u,m as e,w as I,l as L,a,j as o,K as M,v as m,t as V,x as A,y as H,_ as J,z as O,N as P}from"./index-5TqN_QR1.js";import{u as Q,a as W}from"./index-CNuHfDmw.js";const ee=E({name:"UpdateBindUserForm",__name:"UpdateBindUserForm",emits:["success"],setup(X,{expose:w,emit:x}){const{t:C}=P(),_=O(),i=c(!1),n=c(!1),s=c(),p=c(),B=G({bindUserId:[{required:!0,message:"推广员人不能为空",trigger:"blur"}]});w({open:async f=>{N(),s.value.id=f.id,s.value.bindUserId=f.bindUserId,f.bindUserId&&await g(),i.value=!0}});const D=x,F=async()=>{if(!(n.value||!p||!await p.value.validate())){if(!l.value){_.error("请先查询并确认推广人");return}n.value=!0;try{await Q(s.value),_.success(C("common.updateSuccess")),i.value=!1,D("success",!0)}finally{n.value=!1}}},N=()=>{s.value={id:0,bindUserId:void 0},p.value?.resetFields(),l.value=void 0},l=c(),g=async()=>{if(s.value.bindUserId==s.value.id){_.error("不能绑定自己为推广人");return}n.value=!0,l.value=await W(s.value.bindUserId),l.value||_.warning("推广员不存在"),n.value=!1};return(f,t)=>{const R=M,U=r("el-button"),$=r("el-input"),S=r("el-form-item"),T=r("el-form"),j=r("el-avatar"),v=r("el-descriptions-item"),k=r("el-tag"),q=r("el-descriptions"),z=J,y=K("loading");return u(),d(z,{modelValue:a(i),"onUpdate:modelValue":t[2]||(t[2]=b=>H(i)?i.value=b:null),title:"修改上级推广人",width:"500"},{footer:e(()=>[o(U,{disabled:a(n),type:"primary",onClick:F},{default:e(()=>t[5]||(t[5]=[m("确 定")])),_:1},8,["disabled"]),o(U,{onClick:t[1]||(t[1]=b=>i.value=!1)},{default:e(()=>t[6]||(t[6]=[m("取 消")])),_:1})]),default:e(()=>[I((u(),d(T,{ref_key:"formRef",ref:p,"label-width":"80px",model:a(s),rules:a(B)},{default:e(()=>[o(S,{label:"推广人",prop:"bindUserId"},{default:e(()=>[I((u(),d($,{modelValue:a(s).bindUserId,"onUpdate:modelValue":t[0]||(t[0]=b=>a(s).bindUserId=b),placeholder:"请输入推广员编号"},{append:e(()=>[o(U,{onClick:g},{default:e(()=>[o(R,{class:"mr-5px",icon:"ep:search"})]),_:1})]),_:1},8,["modelValue"])),[[y,a(n)]])]),_:1})]),_:1},8,["model","rules"])),[[y,a(n)]]),a(l)?(u(),d(q,{key:0,border:"",column:1},{default:e(()=>[o(v,{label:"头像"},{default:e(()=>[o(j,{src:a(l).avatar},null,8,["src"])]),_:1}),o(v,{label:"昵称"},{default:e(()=>[m(V(a(l).nickname),1)]),_:1}),o(v,{label:"推广资格"},{default:e(()=>[a(l).brokerageEnabled?(u(),d(k,{key:0},{default:e(()=>t[3]||(t[3]=[m("有")])),_:1})):(u(),d(k,{key:1,type:"info"},{default:e(()=>t[4]||(t[4]=[m("无")])),_:1}))]),_:1}),o(v,{label:"成为推广员的时间"},{default:e(()=>[m(V(a(A)(a(l).brokerageTime)),1)]),_:1})]),_:1})):L("",!0)]),_:1},8,["modelValue"])}}});export{ee as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{f as y,c2 as b,bn as S,aF as F,N as w}from"./index-FPuwcz_Y.js";import{d as T,c as C,b as D}from"./dict-C9lD-gwA.js";import{e as d,a as P,f as _}from"./tree-vSlcEeQq.js";import{_ as O}from"./DictTag.vue_vue_type_script_lang-o_bnFpkw.js";const{t:u}=w(),A=i=>{const t=y({searchSchema:[],tableColumns:[],formSchema:[],detailSchema:[]}),o=g(i,t);t.searchSchema=o||[];const l=k(i);t.tableColumns=l||[];const e=v(i,t);t.formSchema=e;const a=x(i);return t.detailSchema=a,{allSchemas:t}},g=(i,t)=>{const o=[],l=[];d(i,e=>{if(e?.isSearch||e.search?.show){let a=e?.search?.component||"Input";const f=[];let p={};if(e.dictType){const s={label:"全部",value:""};f.push(s),T(e.dictType).forEach(n=>{f.push(n)}),p={options:f},e.search?.component||(a="Select")}const r=b({component:a,...e.search,field:e.field,label:e.search?.label||e.label},{componentProps:p});r.api&&l.push(async()=>{const s=await r.api();if(s){const n=S(t.searchSchema,c=>c.field===r.field);n!==-1&&(t.searchSchema[n].componentProps.options=h(s,r.componentProps.optionsAlias?.labelField))}}),delete r.show,o.push(r)}});for(const e of l)e();return o},k=i=>{const t=P(i,{conversion:o=>{if(o?.isTable!==!1&&o?.table?.show!==!1)return!o.formatter&&o.dictType&&(o.formatter=(l,e,a)=>F(O,{type:o.dictType,value:a})),{...o.table,...o}}});return _(t,o=>(o.children===void 0&&delete o.children,!!o.field))},v=(i,t)=>{const o=[],l=[];d(i,e=>{if(e?.isForm!==!1&&e?.form?.show!==!1){let a=e?.form?.component||"Input",f="";e.form?.value?f=e.form?.value:a==="InputNumber"&&(f=0);let p={};if(e.dictType){const s=[];e.dictClass&&e.dictClass==="number"?C(e.dictType).forEach(n=>{s.push(n)}):e.dictClass&&e.dictClass==="boolean"?D(e.dictType).forEach(n=>{s.push(n)}):T(e.dictType).forEach(n=>{s.push(n)}),p={options:s},e.form&&e.form.component||(a="Select")}const r=b({component:a,value:f,...e.form,field:e.field,label:e.form?.label||e.label},{componentProps:p});r.api&&l.push(async()=>{const s=await r.api();if(s){const n=S(t.formSchema,c=>c.field===r.field);n!==-1&&(t.formSchema[n].componentProps.options=h(s,r.componentProps.optionsAlias?.labelField))}}),delete r.show,o.push(r)}});for(const e of l)e();return o},x=i=>{const t=[];return d(i,o=>{if(o?.isDetail!==!1&&o.detail?.show!==!1){const l={...o.detail,field:o.field,label:o.detail?.label||o.label};o.dictType&&(l.dictType=o.dictType),(o.detail?.dateFormat||o.formatter=="formatDate")&&(l.dateFormat=o?.detail?.dateFormat?o?.detail?.dateFormat:"YYYY-MM-DD HH:mm:ss"),delete l.show,t.push(l)}}),t},h=(i,t)=>i?.map(o=>(t?o.labelField=u(o.labelField):o.label=u(o.label),o));export{A as u};

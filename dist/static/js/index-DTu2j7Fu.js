/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as j,r as y,f as G,u as J,b as W,g as m,h as P,c as C,o as i,j as t,m as l,a as o,J as X,w as f,v as u,K as Z,k as d,F as D,n as ee,L as R,l as te,M as ae,z as le,N as oe}from"./index-lcC3l4R2.js";import{_ as ne}from"./DictTag.vue_vue_type_script_lang-G_4C17ZW.js";import{_ as re}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C6z1f3RI.js";import{_ as ie}from"./DiyTemplateForm.vue_vue_type_script_setup_true_lang-BzuAP3gD.js";import{d as se,e as me,f as pe}from"./template-BIK5usOj.js";import{D as ue}from"./dict-B7jb0IEc.js";import"./color-B5phLuB-.js";import"./UploadImgs-DP0b9AwB.js";import"./UploadImgs.vue_vue_type_script_setup_true_lang-DPD2ftyX.js";const xe=j({name:"DiyTemplate",__name:"index",setup(de){const w=le(),{t:S}=oe(),v=y(!0),T=y(0),N=y([]),r=G({pageNo:1,pageSize:10,name:null,createTime:[]}),$=y(),c=async()=>{v.value=!0;try{const n=await se(r);N.value=n.list,T.value=n.total}finally{v.value=!1}},k=()=>{r.pageNo=1,c()},M=()=>{$.value.resetFields(),k()},V=y(),F=(n,e)=>{V.value.open(n,e)},Y=async n=>{try{await w.delConfirm(),await me(n),w.success(S("common.delSuccess")),await c()}catch(e){console.log(e)}},z=async n=>{try{await w.confirm(`是否使用模板“${n.name}”?`),await pe(n.id),w.success("使用成功"),await c()}catch(e){console.log(e)}},{push:B}=J(),L=n=>{B({name:"DiyTemplateDecorate",params:{id:n}})};return W(()=>{c()}),(n,e)=>{const q=m("el-input"),b=m("el-form-item"),E=m("el-date-picker"),x=Z,p=m("el-button"),K=m("el-form"),I=re,s=m("el-table-column"),A=m("el-image"),H=ne,O=m("el-table"),Q=ae,_=P("hasPermi"),h=P("loading");return i(),C(D,null,[t(I,null,{default:l(()=>[t(K,{ref_key:"queryFormRef",ref:$,class:"-mb-15px",inline:!0,"label-width":"68px",model:o(r)},{default:l(()=>[t(b,{label:"模板名称",prop:"name"},{default:l(()=>[t(q,{modelValue:o(r).name,"onUpdate:modelValue":e[0]||(e[0]=a=>o(r).name=a),class:"!w-240px",clearable:"",placeholder:"请输入模板名称",onKeyup:X(k,["enter"])},null,8,["modelValue"])]),_:1}),t(b,{label:"创建时间",prop:"createTime"},{default:l(()=>[t(E,{modelValue:o(r).createTime,"onUpdate:modelValue":e[1]||(e[1]=a=>o(r).createTime=a),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(b,null,{default:l(()=>[t(p,{onClick:k},{default:l(()=>[t(x,{class:"mr-5px",icon:"ep:search"}),e[5]||(e[5]=u(" 搜索 "))]),_:1}),t(p,{onClick:M},{default:l(()=>[t(x,{class:"mr-5px",icon:"ep:refresh"}),e[6]||(e[6]=u(" 重置 "))]),_:1}),f((i(),d(p,{plain:"",type:"primary",onClick:e[2]||(e[2]=a=>F("create"))},{default:l(()=>[t(x,{class:"mr-5px",icon:"ep:plus"}),e[7]||(e[7]=u(" 新增 "))]),_:1})),[[_,["promotion:diy-template:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(I,null,{default:l(()=>[f((i(),d(O,{data:o(N),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[t(s,{align:"center",label:"编号",prop:"id"}),t(s,{align:"center",label:"预览图",prop:"previewImageUrls"},{default:l(a=>[(i(!0),C(D,null,ee(a.row.previewImageUrls,(g,U)=>(i(),d(A,{key:U,class:"h-40px max-w-40px","initial-index":U,"preview-src-list":a.row.previewImageUrls,"preview-teleported":"",src:g},null,8,["initial-index","preview-src-list","src"]))),128))]),_:1}),t(s,{align:"center",label:"模板名称",prop:"name"}),t(s,{align:"center",label:"是否使用",prop:"used"},{default:l(a=>[t(H,{type:o(ue).INFRA_BOOLEAN_STRING,value:a.row.used},null,8,["type","value"])]),_:1}),t(s,{align:"center",formatter:o(R),label:"使用时间",prop:"usedTime",width:"180px"},null,8,["formatter"]),t(s,{align:"center",label:"备注",prop:"remark"}),t(s,{align:"center",formatter:o(R),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),t(s,{align:"center",label:"操作",width:"200"},{default:l(a=>[f((i(),d(p,{link:"",type:"primary",onClick:g=>L(a.row.id)},{default:l(()=>e[8]||(e[8]=[u(" 装修 ")])),_:2},1032,["onClick"])),[[_,["promotion:diy-template:update"]]]),f((i(),d(p,{link:"",type:"primary",onClick:g=>F("update",a.row.id)},{default:l(()=>e[9]||(e[9]=[u(" 编辑 ")])),_:2},1032,["onClick"])),[[_,["promotion:diy-template:update"]]]),a.row.used?te("",!0):(i(),C(D,{key:0},[f((i(),d(p,{link:"",type:"primary",onClick:g=>z(a.row)},{default:l(()=>e[10]||(e[10]=[u("使用")])),_:2},1032,["onClick"])),[[_,["promotion:diy-template:use"]]]),f((i(),d(p,{link:"",type:"danger",onClick:g=>Y(a.row.id)},{default:l(()=>e[11]||(e[11]=[u(" 删除 ")])),_:2},1032,["onClick"])),[[_,["promotion:diy-template:delete"]]])],64))]),_:1})]),_:1},8,["data"])),[[h,o(v)]]),t(Q,{limit:o(r).pageSize,"onUpdate:limit":e[3]||(e[3]=a=>o(r).pageSize=a),page:o(r).pageNo,"onUpdate:page":e[4]||(e[4]=a=>o(r).pageNo=a),total:o(T),onPagination:c},null,8,["limit","page","total"])]),_:1}),t(ie,{ref_key:"formRef",ref:V,onSuccess:c},null,512)],64)}}});export{xe as default};

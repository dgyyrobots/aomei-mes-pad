/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{d as q,r as p,f as O,b as Q,g as c,h as F,c as Y,o as u,j as e,m as o,a as l,J as P,w as f,v as m,K as j,k as _,cK as J,L as W,M as G,F as H,z as X,N as Z}from"./index-DMg0mq0e.js";import{_ as ee}from"./DictTag.vue_vue_type_script_lang-sQcOd7JH.js";import{_ as te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DPMk4m5L.js";import{_ as le,a as ae,d as oe,e as ne}from"./ReceivableForm.vue_vue_type_script_setup_true_lang-D3J-MMCx.js";import{D as I}from"./dict-BEquckDR.js";import{d as re}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./index-DsEIKZmm.js";const ge=q({name:"Receivable",__name:"index",setup(se){const y=X(),{t:$}=Z(),w=p(!0),T=p(0),R=p([]),r=O({pageNo:1,pageSize:10,no:null,customerId:null}),S=p(),x=p(!1),d=async()=>{w.value=!0;try{const s=await ae(r);R.value=s.list,T.value=s.total}finally{w.value=!1}},g=()=>{r.pageNo=1,d()},D=()=>{S.value.resetFields(),g()},N=p(),U=(s,t)=>{N.value.open(s,t)},M=async s=>{try{await y.delConfirm(),await oe(s),y.success($("common.delSuccess")),await d()}catch(t){console.log(t)}},K=async()=>{try{await y.exportConfirm(),x.value=!0;const s=await ne(r);re.excel(s,"回款.xls")}catch(s){console.log(s)}finally{x.value=!1}};return Q(()=>{d()}),(s,t)=>{const V=c("el-input"),k=c("el-form-item"),b=j,i=c("el-button"),h=c("el-form"),E=te,n=c("el-table-column"),C=ee,z=c("el-table"),A=G,v=F("hasPermi"),B=F("loading");return u(),Y(H,null,[e(E,null,{default:o(()=>[e(h,{ref_key:"queryFormRef",ref:S,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(r)},{default:o(()=>[e(k,{label:"回款编号",prop:"no"},{default:o(()=>[e(V,{modelValue:l(r).no,"onUpdate:modelValue":t[0]||(t[0]=a=>l(r).no=a),class:"!w-240px",clearable:"",placeholder:"请输入回款编号",onKeyup:P(g,["enter"])},null,8,["modelValue"])]),_:1}),e(k,{label:"客户名称",prop:"customerId"},{default:o(()=>[e(V,{modelValue:l(r).customerId,"onUpdate:modelValue":t[1]||(t[1]=a=>l(r).customerId=a),class:"!w-240px",clearable:"",placeholder:"请输入客户名称",onKeyup:P(g,["enter"])},null,8,["modelValue"])]),_:1}),e(k,null,{default:o(()=>[e(i,{onClick:g},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=m(" 搜索 "))]),_:1}),e(i,{onClick:D},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=m(" 重置 "))]),_:1}),f((u(),_(i,{plain:"",type:"primary",onClick:t[2]||(t[2]=a=>U("create"))},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:plus"}),t[7]||(t[7]=m(" 新增 "))]),_:1})),[[v,["crm:receivable:create"]]]),f((u(),_(i,{loading:l(x),plain:"",type:"success",onClick:K},{default:o(()=>[e(b,{class:"mr-5px",icon:"ep:download"}),t[8]||(t[8]=m(" 导出 "))]),_:1},8,["loading"])),[[v,["crm:receivable:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(E,null,{default:o(()=>[f((u(),_(z,{data:l(R),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[e(n,{align:"center",label:"ID",prop:"id"}),e(n,{align:"center",label:"回款编号",prop:"no"}),e(n,{align:"center",label:"客户",prop:"customerId"}),e(n,{align:"center",label:"合同",prop:"contractId"}),e(n,{align:"center",label:"审批状态",prop:"checkStatus",width:"130px"},{default:o(a=>[e(C,{type:l(I).CRM_AUDIT_STATUS,value:a.row.checkStatus},null,8,["type","value"])]),_:1}),e(n,{align:"center",formatter:l(J),label:"回款日期",prop:"returnTime",width:"150px"},null,8,["formatter"]),e(n,{align:"center",label:"回款方式",prop:"returnType",width:"130px"},{default:o(a=>[e(C,{type:l(I).CRM_RECEIVABLE_RETURN_TYPE,value:a.row.returnType},null,8,["type","value"])]),_:1}),e(n,{align:"center",label:"回款金额(元)",prop:"price"}),e(n,{align:"center",label:"负责人",prop:"ownerUserId"}),e(n,{align:"center",label:"批次",prop:"batchId"}),e(n,{align:"center",label:"状态",prop:"status"},{default:o(a=>[e(C,{type:l(I).COMMON_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),e(n,{align:"center",label:"备注",prop:"remark"}),e(n,{align:"center",formatter:l(W),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(n,{align:"center",label:"操作",width:"180px"},{default:o(a=>[f((u(),_(i,{link:"",type:"primary",onClick:L=>U("update",a.row.id)},{default:o(()=>t[9]||(t[9]=[m("编辑")])),_:2},1032,["onClick"])),[[v,["crm:receivable:update"]]]),f((u(),_(i,{link:"",type:"danger",onClick:L=>M(a.row.id)},{default:o(()=>t[10]||(t[10]=[m("删除")])),_:2},1032,["onClick"])),[[v,["crm:receivable:delete"]]])]),_:1})]),_:1},8,["data"])),[[B,l(w)]]),e(A,{limit:l(r).pageSize,"onUpdate:limit":t[3]||(t[3]=a=>l(r).pageSize=a),page:l(r).pageNo,"onUpdate:page":t[4]||(t[4]=a=>l(r).pageNo=a),total:l(T),onPagination:d},null,8,["limit","page","total"])]),_:1}),e(le,{ref_key:"formRef",ref:N,onSuccess:d},null,512)],64)}}});export{ge as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as K,r as p,f as U,b as Q,g as r,h as D,c as x,o as m,F as M,j as e,m as o,a,v,K as j,w as S,y as W,n as G,k as b,L as V,M as J,z as X}from"./index-D3eRVKjp.js";import{_ as Z}from"./DictTag.vue_vue_type_script_lang-h3s-iN69.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dg75KKir.js";import{g as te,d as ae}from"./coupon-D4fJCbhD.js";import{c as le,D as c}from"./dict-CqgorI4d.js";const pe=K({name:"UserCouponList",__name:"UserCouponList",props:{userId:{type:Number,required:!0}},setup(R){const y=X(),d=p(!0),T=p(0),O=p([]),n=U({pageNo:1,pageSize:10,createTime:[],status:void 0,userIds:void 0}),w=p(),_=p("all"),C=U([{label:"全部",value:"all"}]),u=async()=>{d.value=!0;try{n.userIds=R.userId;const s=await te(n);O.value=s.list,T.value=s.total}finally{d.value=!1}},P=()=>{n.pageNo=1,u()},Y=()=>{w.value?.resetFields(),P()},F=async s=>{try{await y.confirm("回收将会收回会员领取的待使用的优惠券，已使用的将无法回收，确定要回收所选优惠券吗？"),await ae(s),y.notifySuccess("回收成功"),await u()}catch(l){console.log(l)}},h=s=>{n.status=s==="all"?void 0:s,u()};return Q(()=>{u();for(const s of le(c.PROMOTION_COUPON_STATUS))C.push({label:s.label,value:s.value})}),(s,l)=>{const E=r("el-date-picker"),k=r("el-form-item"),N=j,f=r("el-button"),L=r("el-form"),I=ee,$=r("el-tab-pane"),q=r("el-tabs"),i=r("el-table-column"),g=Z,z=r("el-table"),A=J,B=D("hasPermi"),H=D("loading");return m(),x(M,null,[e(I,null,{default:o(()=>[e(L,{ref_key:"queryFormRef",ref:w,class:"-mb-15px",inline:!0,"label-width":"68px",model:a(n)},{default:o(()=>[e(k,{label:"创建时间",prop:"createTime"},{default:o(()=>[e(E,{modelValue:a(n).createTime,"onUpdate:modelValue":l[0]||(l[0]=t=>a(n).createTime=t),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(k,null,{default:o(()=>[e(f,{onClick:P},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:search"}),l[4]||(l[4]=v(" 搜索 "))]),_:1}),e(f,{onClick:Y},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:refresh"}),l[5]||(l[5]=v(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(I,null,{default:o(()=>[e(q,{modelValue:a(_),"onUpdate:modelValue":l[1]||(l[1]=t=>W(_)?_.value=t:null),type:"card",onTabChange:h},{default:o(()=>[(m(!0),x(M,null,G(a(C),t=>(m(),b($,{key:t.value,label:t.label,name:t.value},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),S((m(),b(z,{data:a(O)},{default:o(()=>[e(i,{align:"center",label:"优惠劵",prop:"name"}),e(i,{align:"center",label:"优惠券类型",prop:"discountType"},{default:o(t=>[e(g,{type:a(c).PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"])]),_:1}),e(i,{align:"center",label:"领取方式",prop:"takeType"},{default:o(t=>[e(g,{type:a(c).PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),e(i,{align:"center",label:"状态",prop:"status"},{default:o(t=>[e(g,{type:a(c).PROMOTION_COUPON_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),e(i,{align:"center",formatter:a(V),label:"领取时间",prop:"createTime",width:"180"},null,8,["formatter"]),e(i,{align:"center",formatter:a(V),label:"使用时间",prop:"useTime",width:"180"},null,8,["formatter"]),e(i,{align:"center","class-name":"small-padding fixed-width",label:"操作"},{default:o(t=>[S((m(),b(f,{link:"",type:"danger",onClick:oe=>F(t.row.id)},{default:o(()=>l[6]||(l[6]=[v("回收")])),_:2},1032,["onClick"])),[[B,["promotion:coupon:delete"]]])]),_:1})]),_:1},8,["data"])),[[H,a(d)]]),e(A,{limit:a(n).pageSize,"onUpdate:limit":l[2]||(l[2]=t=>a(n).pageSize=t),page:a(n).pageNo,"onUpdate:page":l[3]||(l[3]=t=>a(n).pageNo=t),total:a(T),onPagination:u},null,8,["limit","page","total"])]),_:1})],64)}}});export{pe as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{d as H,r as n,f as K,g as r,h as j,k as y,o as k,m as t,w as z,a,j as o,ds as Y,v as _,y as C,c as G,F as J,n as Q,t as W,_ as X,N as Z,z as ee,A as ae}from"./index-BdmDrM2Y.js";import{g as le}from"./index-DmCSPnK7.js";import{a as te,c as oe,u as se}from"./index--4cKtZG9.js";import{C as I}from"./constants-BPQb3nxh.js";import{c as ne,D as ue}from"./dict-Cm-9nniQ.js";import{d as re,h as de}from"./tree-vSlcEeQq.js";const me=H({name:"SystemTenantPackageForm",__name:"TenantPackageForm",emits:["success"],setup(ie,{expose:D,emit:F}){const{t:V}=Z(),x=ee(),m=n(!1),T=n(""),i=n(!1),w=n(""),s=n({id:null,name:null,remark:null,menuIds:[],status:I.ENABLE}),P=K({name:[{required:!0,message:"套餐名不能为空",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}],menuIds:[{required:!0,message:"关联的菜单编号不能为空",trigger:"blur"}]}),g=n(),b=n([]),c=n(!1),d=n(),p=n(!1);D({open:async(u,e)=>{if(m.value=!0,T.value=V(`action.${u}`),w.value=u,A(),b.value=de(await le()),e){i.value=!0;try{const v=await te(e);s.value=v,v.menuIds.forEach(f=>{d.value.setChecked(f,!0,!1)})}finally{i.value=!1}}}});const S=F,U=async()=>{if(!(!g||!await g.value.validate())){i.value=!0;try{const e=s.value;e.menuIds=[...d.value.getCheckedKeys(!1),...d.value.getHalfCheckedKeys()],w.value==="create"?(await oe(e),x.success(V("common.createSuccess"))):(await se(e),x.success(V("common.updateSuccess"))),m.value=!1,S("success")}finally{i.value=!1}}},A=()=>{p.value=!1,c.value=!1,s.value={id:null,name:null,remark:null,menuIds:[],status:I.ENABLE},d.value?.setCheckedNodes([]),g.value?.resetFields()},R=()=>{d.value.setCheckedNodes(p.value?b.value:[])},h=()=>{const u=d.value?.store.nodesMap;for(const e in u)u[e].expanded!==c.value&&(u[e].expanded=c.value)};return(u,e)=>{const v=r("el-input"),f=r("el-form-item"),E=r("el-switch"),B=r("el-card"),L=r("el-radio"),M=r("el-radio-group"),O=r("el-form"),N=r("el-button"),q=X,$=j("loading");return k(),y(q,{modelValue:a(m),"onUpdate:modelValue":e[6]||(e[6]=l=>C(m)?m.value=l:null),title:a(T)},{footer:t(()=>[o(N,{disabled:a(i),type:"primary",onClick:U},{default:t(()=>e[9]||(e[9]=[_("确 定")])),_:1},8,["disabled"]),o(N,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:t(()=>e[10]||(e[10]=[_("取 消")])),_:1})]),default:t(()=>[z((k(),y(O,{ref_key:"formRef",ref:g,"label-width":"80px",model:a(s),rules:a(P)},{default:t(()=>[o(f,{label:"套餐名",prop:"name"},{default:t(()=>[o(v,{modelValue:a(s).name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(s).name=l),placeholder:"请输入套餐名"},null,8,["modelValue"])]),_:1}),o(f,{label:"菜单权限"},{default:t(()=>[o(B,{class:"cardHeight"},{header:t(()=>[e[7]||(e[7]=_(" 全选/全不选: ")),o(E,{modelValue:a(p),"onUpdate:modelValue":e[1]||(e[1]=l=>C(p)?p.value=l:null),"active-text":"是","inactive-text":"否","inline-prompt":"",onChange:R},null,8,["modelValue"]),e[8]||(e[8]=_(" 全部展开/折叠: ")),o(E,{modelValue:a(c),"onUpdate:modelValue":e[2]||(e[2]=l=>C(c)?c.value=l:null),"active-text":"展开","inactive-text":"折叠","inline-prompt":"",onChange:h},null,8,["modelValue"])]),default:t(()=>[o(a(Y),{ref_key:"treeRef",ref:d,data:a(b),"empty-text":"加载中，请稍候","node-key":"id",props:a(re),"show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1}),o(f,{label:"状态",prop:"status"},{default:t(()=>[o(M,{modelValue:a(s).status,"onUpdate:modelValue":e[3]||(e[3]=l=>a(s).status=l)},{default:t(()=>[(k(!0),G(J,null,Q(a(ne)(a(ue).COMMON_STATUS),l=>(k(),y(L,{key:l.value,label:l.value},{default:t(()=>[_(W(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"备注",prop:"remark"},{default:t(()=>[o(v,{modelValue:a(s).remark,"onUpdate:modelValue":e[4]||(e[4]=l=>a(s).remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[$,a(i)]])]),_:1},8,["modelValue","title"])}}}),Ve=ae(me,[["__scopeId","data-v-493f6b83"]]);export{Ve as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as P,r as m,f as j,g as i,h as z,k as f,o as s,m as o,w as K,a,j as e,l as G,c as g,F as C,n as I,v as S,y as J,_ as W,N as X,cB as Z,bE as h,bH as ee,cD as le,z as ae,cE as oe}from"./index-D3S9e4gi.js";import{a as k,D as T}from"./dict-D5UmY5m8.js";import{g as te}from"./index-DMSqiyAj.js";import{d as de}from"./tree-vSlcEeQq.js";import{g as ue}from"./index-Dg5E73Z_.js";const ve=P({__name:"CustomerForm",emits:["success"],setup(ne,{expose:D,emit:A}){const{t:y}=X(),x=ae(),v=m(!1),E=m(""),_=m(!1),V=m(""),R=m([]),q=m([]),d=m({id:void 0,name:void 0,mobile:void 0,industryId:void 0,level:void 0,source:void 0,telephone:void 0,website:void 0,qq:void 0,wechat:void 0,email:void 0,description:void 0,remark:void 0,areaId:void 0,detailAddress:void 0,contactNextTime:void 0,ownerUserId:void 0}),M=j({name:[{required:!0,message:"客户名称不能为空",trigger:"blur"}],ownerUserId:[{required:!0,message:"负责人不能为空",trigger:"blur"}]}),c=m();D({open:async(b,t)=>{if(v.value=!0,E.value=y(`action.${b}`),V.value=b,O(),t){_.value=!0;try{d.value=await Z(t)}finally{_.value=!1}}if(R.value=await te(),q.value=await ue(),V.value==="create"){const{wsCache:r}=h(),u=r.get(ee.USER).user;d.value.ownerUserId=u.id}}});const F=A,L=async()=>{if(!(!c||!await c.value.validate())){_.value=!0;try{const t=d.value;V.value==="create"?(await le(t),x.success(y("common.createSuccess"))):(await oe(t),x.success(y("common.updateSuccess"))),v.value=!1,F("success")}finally{_.value=!1}}},O=()=>{d.value={id:void 0,name:void 0,mobile:void 0,industryId:void 0,level:void 0,source:void 0,telephone:void 0,website:void 0,qq:void 0,wechat:void 0,email:void 0,description:void 0,remark:void 0,areaId:void 0,detailAddress:void 0,contactNextTime:void 0,ownerUserId:void 0},c.value?.resetFields()};return(b,t)=>{const r=i("el-input"),u=i("el-form-item"),n=i("el-col"),U=i("el-option"),w=i("el-select"),p=i("el-row"),B=i("el-tree-select"),Q=i("el-date-picker"),Y=i("el-form"),N=i("el-button"),$=W,H=z("loading");return s(),f($,{modelValue:a(v),"onUpdate:modelValue":t[17]||(t[17]=l=>J(v)?v.value=l:null),title:a(E)},{footer:o(()=>[e(N,{disabled:a(_),type:"primary",onClick:L},{default:o(()=>t[18]||(t[18]=[S("确 定")])),_:1},8,["disabled"]),e(N,{onClick:t[16]||(t[16]=l=>v.value=!1)},{default:o(()=>t[19]||(t[19]=[S("取 消")])),_:1})]),default:o(()=>[K((s(),f(Y,{ref_key:"formRef",ref:c,"label-width":"100px",model:a(d),rules:a(M)},{default:o(()=>[e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"客户名称",prop:"name"},{default:o(()=>[e(r,{modelValue:a(d).name,"onUpdate:modelValue":t[0]||(t[0]=l=>a(d).name=l),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"所属行业",prop:"industryId"},{default:o(()=>[e(w,{modelValue:a(d).industryId,"onUpdate:modelValue":t[1]||(t[1]=l=>a(d).industryId=l),placeholder:"请选择所属行业"},{default:o(()=>[(s(!0),g(C,null,I(a(k)(a(T).CRM_CUSTOMER_INDUSTRY),l=>(s(),f(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"客户来源",prop:"source"},{default:o(()=>[e(w,{modelValue:a(d).source,"onUpdate:modelValue":t[2]||(t[2]=l=>a(d).source=l),placeholder:"请选择客户来源"},{default:o(()=>[(s(!0),g(C,null,I(a(k)(a(T).CRM_CUSTOMER_SOURCE),l=>(s(),f(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"客户等级",prop:"level"},{default:o(()=>[e(w,{modelValue:a(d).level,"onUpdate:modelValue":t[3]||(t[3]=l=>a(d).level=l),placeholder:"请选择客户等级"},{default:o(()=>[(s(!0),g(C,null,I(a(k)(a(T).CRM_CUSTOMER_LEVEL),l=>(s(),f(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"手机",prop:"mobile"},{default:o(()=>[e(r,{modelValue:a(d).mobile,"onUpdate:modelValue":t[4]||(t[4]=l=>a(d).mobile=l),placeholder:"请输入手机"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"电话",prop:"telephone"},{default:o(()=>[e(r,{modelValue:a(d).telephone,"onUpdate:modelValue":t[5]||(t[5]=l=>a(d).telephone=l),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"邮箱",prop:"email"},{default:o(()=>[e(r,{modelValue:a(d).email,"onUpdate:modelValue":t[6]||(t[6]=l=>a(d).email=l),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"QQ",prop:"qq"},{default:o(()=>[e(r,{modelValue:a(d).qq,"onUpdate:modelValue":t[7]||(t[7]=l=>a(d).qq=l),placeholder:"请输入QQ"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"微信",prop:"wechat"},{default:o(()=>[e(r,{modelValue:a(d).wechat,"onUpdate:modelValue":t[8]||(t[8]=l=>a(d).wechat=l),placeholder:"请输入微信"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"网址",prop:"website"},{default:o(()=>[e(r,{modelValue:a(d).website,"onUpdate:modelValue":t[9]||(t[9]=l=>a(d).website=l),placeholder:"请输入网址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"所在地",prop:"areaId"},{default:o(()=>[e(B,{modelValue:a(d).areaId,"onUpdate:modelValue":t[10]||(t[10]=l=>a(d).areaId=l),data:a(R),props:a(de),"render-after-expand":!0},null,8,["modelValue","data","props"])]),_:1})]),_:1}),e(n,{span:12},{default:o(()=>[e(u,{label:"详细地址",prop:"detailAddress"},{default:o(()=>[e(r,{modelValue:a(d).detailAddress,"onUpdate:modelValue":t[11]||(t[11]=l=>a(d).detailAddress=l),placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(V)==="create"?(s(),f(u,{key:0,label:"负责人",prop:"userIds",span:"24"},{default:o(()=>[e(w,{modelValue:a(d).ownerUserId,"onUpdate:modelValue":t[12]||(t[12]=l=>a(d).ownerUserId=l)},{default:o(()=>[(s(!0),g(C,null,I(a(q),l=>(s(),f(U,{key:parseInt(l.id),label:l.nickname,value:parseInt(l.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):G("",!0),e(p,null,{default:o(()=>[e(n,{span:12},{default:o(()=>[e(u,{label:"下次联系时间",prop:"contactNextTime"},{default:o(()=>[e(Q,{modelValue:a(d).contactNextTime,"onUpdate:modelValue":t[13]||(t[13]=l=>a(d).contactNextTime=l),placeholder:"选择下次联系时间",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{span:24},{default:o(()=>[e(u,{label:"客户描述",prop:"description"},{default:o(()=>[e(r,{modelValue:a(d).description,"onUpdate:modelValue":t[14]||(t[14]=l=>a(d).description=l),placeholder:"请输入客户描述"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:o(()=>[e(u,{label:"备注",prop:"remark"},{default:o(()=>[e(r,{modelValue:a(d).remark,"onUpdate:modelValue":t[15]||(t[15]=l=>a(d).remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[H,a(_)]])]),_:1},8,["modelValue","title"])}}});export{ve as _};

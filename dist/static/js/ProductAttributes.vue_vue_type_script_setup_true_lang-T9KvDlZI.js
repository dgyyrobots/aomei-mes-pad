/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as M,r as v,O,Y as T,g as r,c as V,o as f,F as g,n as k,a as c,k as $,m as o,i as B,j as u,v as i,t as I,w as h,bd as U,J as Y,y as q,$ as L,z as G,N as H}from"./index-D3S9e4gi.js";import{c as Q}from"./property-emTLOL-O.js";const ee=M({name:"ProductAttributes",__name:"ProductAttributes",props:{propertyList:{type:Array,default:()=>{}}},emits:["success"],setup(N,{emit:P}){const{t:x}=H(),y=G(),n=v(""),p=v(null),b=O(()=>e=>{if(p.value===null)return!1;if(p.value===e)return!0}),_=v([]),z=e=>{e===null||typeof e>"u"||_.value.some(t=>t.input?.attributes.id===e.input?.attributes.id)||_.value.push(e)},a=v([]),A=N;T(()=>A.propertyList,e=>{e&&(a.value=e)},{deep:!0,immediate:!0});const K=(e,t)=>{a.value[e].values?.splice(t,1)},R=e=>{a.value?.splice(e,1)},S=async e=>{p.value=e,_.value[e].focus()},D=P,C=async(e,t)=>{if(n.value)try{const m=await Q({propertyId:t,name:n.value});a.value[e].values.push({id:m,name:n.value}),y.success(x("common.createSuccess")),D("success",a.value)}catch{y.error("添加失败，请重试")}p.value=null,n.value=""};return(e,t)=>{const m=r("el-text"),w=r("el-tag"),E=r("el-button"),F=r("el-divider"),j=r("el-col");return f(!0),V(g,null,k(c(a),(d,s)=>(f(),$(j,{key:s},{default:o(()=>[B("div",null,[u(m,{class:"mx-1"},{default:o(()=>t[1]||(t[1]=[i("属性名：")])),_:1}),u(w,{class:"mx-1",closable:"",type:"success",onClose:l=>R(s)},{default:o(()=>[i(I(d.name),1)]),_:2},1032,["onClose"])]),B("div",null,[u(m,{class:"mx-1"},{default:o(()=>t[2]||(t[2]=[i("属性值：")])),_:1}),(f(!0),V(g,null,k(d.values,(l,J)=>(f(),$(w,{key:l.id,class:"mx-1",closable:"",onClose:W=>K(s,J)},{default:o(()=>[i(I(l.name),1)]),_:2},1032,["onClose"]))),128)),h(u(c(U),{id:`input${s}`,ref_for:!0,ref:z,modelValue:c(n),"onUpdate:modelValue":t[0]||(t[0]=l=>q(n)?n.value=l:null),class:"!w-20",size:"small",onBlur:l=>C(s,d.id),onKeyup:Y(l=>C(s,d.id),["enter"])},null,8,["id","modelValue","onBlur","onKeyup"]),[[L,c(b)(s)]]),h(u(E,{class:"button-new-tag ml-1",size:"small",onClick:l=>S(s)},{default:o(()=>t[3]||(t[3]=[i("+ 添加")])),_:2},1032,["onClick"]),[[L,!c(b)(s)]])]),u(F,{class:"my-10px"})]),_:2},1024))),128)}}});export{ee as _};

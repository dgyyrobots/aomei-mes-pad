/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{d as A,r as d,f as G,g as n,h as H,k as u,o as r,m as a,w as J,a as l,j as s,l as c,c as _,i as b,F as V,n as C,v as w,t as K,y as Q,_ as W,N as X,T as Z,z as h}from"./index-FPuwcz_Y.js";import{c as q,D as F}from"./dict-C9lD-gwA.js";import{g as ee,c as le,u as te}from"./index-BoXUSpgD.js";import{b as oe}from"./index-8reGMtkN.js";const ae={key:1},me=A({name:"ModelForm",__name:"ModelForm",emits:["success"],setup(se,{expose:I,emit:B}){const{t:k}=X(),E=h(),m=d(!1),T=d(""),p=d(!1),x=d(""),o=d({formType:10,name:"",category:void 0,description:"",formId:"",formCustomCreatePath:"",formCustomViewPath:""}),L=G({category:[{required:!0,message:"参数分类不能为空",trigger:"blur"}],name:[{required:!0,message:"参数名称不能为空",trigger:"blur"}],key:[{required:!0,message:"参数键名不能为空",trigger:"blur"}],value:[{required:!0,message:"参数键值不能为空",trigger:"blur"}],visible:[{required:!0,message:"是否可见不能为空",trigger:"blur"}]}),v=d(),P=d([]);I({open:async(g,e)=>{if(m.value=!0,T.value=k(`action.${g}`),x.value=g,O(),e){p.value=!0;try{o.value=await ee(e)}finally{p.value=!1}}P.value=await oe()}});const R=B,N=async()=>{if(!(!v||!await v.value.validate())){p.value=!0;try{const e=o.value;x.value==="create"?(await le(e),await Z.alert("<strong>新建模型成功！</strong>后续需要执行如下 4 个步骤：<div>1. 点击【修改流程】按钮，配置流程的分类、表单信息</div><div>2. 点击【设计流程】按钮，绘制流程图</div><div>3. 点击【分配规则】按钮，设置每个用户任务的审批人</div><div>4. 点击【发布流程】按钮，完成流程的最终发布</div>另外，每次流程修改后，都需要点击【发布流程】按钮，才能正式生效！！！","重要提示",{dangerouslyUseHTMLString:!0,type:"success"})):(await te(e),E.success(k("common.updateSuccess"))),m.value=!1,R("success")}finally{p.value=!1}}},O=()=>{o.value={formType:10,name:"",category:void 0,description:"",formId:"",formCustomCreatePath:"",formCustomViewPath:""},v.value?.resetFields()};return(g,e)=>{const f=n("el-input"),y=n("el-tooltip"),i=n("el-form-item"),M=n("el-option"),D=n("el-select"),S=n("el-radio"),Y=n("el-radio-group"),$=n("el-form"),U=n("el-button"),j=W,z=H("loading");return r(),u(j,{modelValue:l(m),"onUpdate:modelValue":e[9]||(e[9]=t=>Q(m)?m.value=t:null),title:l(T),width:"600"},{footer:a(()=>[s(U,{disabled:l(p),type:"primary",onClick:N},{default:a(()=>e[14]||(e[14]=[w("确 定")])),_:1},8,["disabled"]),s(U,{onClick:e[8]||(e[8]=t=>m.value=!1)},{default:a(()=>e[15]||(e[15]=[w("取 消")])),_:1})]),default:a(()=>[J((r(),u($,{ref_key:"formRef",ref:v,"label-width":"110px",model:l(o),rules:l(L)},{default:a(()=>[s(i,{label:"流程标识",prop:"key"},{default:a(()=>[s(f,{modelValue:l(o).key,"onUpdate:modelValue":e[0]||(e[0]=t=>l(o).key=t),disabled:!!l(o).id,placeholder:"请输入流标标识",style:{width:"330px"}},null,8,["modelValue","disabled"]),l(o).id?(r(),u(y,{key:1,class:"item",content:"流程标识不可修改！",effect:"light",placement:"top"},{default:a(()=>e[11]||(e[11]=[b("i",{class:"el-icon-question",style:{"padding-left":"5px"}},null,-1)])),_:1})):(r(),u(y,{key:0,class:"item",content:"新建后，流程标识不可修改！",effect:"light",placement:"top"},{default:a(()=>e[10]||(e[10]=[b("i",{class:"el-icon-question",style:{"padding-left":"5px"}},null,-1)])),_:1}))]),_:1}),s(i,{label:"流程名称",prop:"name"},{default:a(()=>[s(f,{modelValue:l(o).name,"onUpdate:modelValue":e[1]||(e[1]=t=>l(o).name=t),clearable:"",disabled:!!l(o).id,placeholder:"请输入流程名称"},null,8,["modelValue","disabled"])]),_:1}),l(o).id?(r(),u(i,{key:0,label:"流程分类",prop:"category"},{default:a(()=>[s(D,{modelValue:l(o).category,"onUpdate:modelValue":e[2]||(e[2]=t=>l(o).category=t),clearable:"",placeholder:"请选择流程分类",style:{width:"100%"}},{default:a(()=>[(r(!0),_(V,null,C(l(q)(l(F).BPM_MODEL_CATEGORY),t=>(r(),u(M,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):c("",!0),s(i,{label:"流程描述",prop:"description"},{default:a(()=>[s(f,{modelValue:l(o).description,"onUpdate:modelValue":e[3]||(e[3]=t=>l(o).description=t),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1}),l(o).id?(r(),_("div",ae,[s(i,{label:"表单类型",prop:"formType"},{default:a(()=>[s(Y,{modelValue:l(o).formType,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).formType=t)},{default:a(()=>[(r(!0),_(V,null,C(l(q)(l(F).BPM_MODEL_FORM_TYPE),t=>(r(),u(S,{key:t.value,label:t.value},{default:a(()=>[w(K(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(o).formType===10?(r(),u(i,{key:0,label:"流程表单",prop:"formId"},{default:a(()=>[s(D,{modelValue:l(o).formId,"onUpdate:modelValue":e[5]||(e[5]=t=>l(o).formId=t),clearable:"",style:{width:"100%"}},{default:a(()=>[(r(!0),_(V,null,C(l(P),t=>(r(),u(M,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):c("",!0),l(o).formType===20?(r(),u(i,{key:1,label:"表单提交路由",prop:"formCustomCreatePath"},{default:a(()=>[s(f,{modelValue:l(o).formCustomCreatePath,"onUpdate:modelValue":e[6]||(e[6]=t=>l(o).formCustomCreatePath=t),placeholder:"请输入表单提交路由",style:{width:"330px"}},null,8,["modelValue"]),s(y,{class:"item",content:"自定义表单的提交路径，使用 Vue 的路由地址，例如说：bpm/oa/leave/create",effect:"light",placement:"top"},{default:a(()=>e[12]||(e[12]=[b("i",{class:"el-icon-question",style:{"padding-left":"5px"}},null,-1)])),_:1})]),_:1})):c("",!0),l(o).formType===20?(r(),u(i,{key:2,label:"表单查看路由",prop:"formCustomViewPath"},{default:a(()=>[s(f,{modelValue:l(o).formCustomViewPath,"onUpdate:modelValue":e[7]||(e[7]=t=>l(o).formCustomViewPath=t),placeholder:"请输入表单查看路由",style:{width:"330px"}},null,8,["modelValue"]),s(y,{class:"item",content:"自定义表单的查看路径，使用 Vue 的路由地址，例如说：bpm/oa/leave/view",effect:"light",placement:"top"},{default:a(()=>e[13]||(e[13]=[b("i",{class:"el-icon-question",style:{"padding-left":"5px"}},null,-1)])),_:1})]),_:1})):c("",!0)])):c("",!0)]),_:1},8,["model","rules"])),[[z,l(p)]])]),_:1},8,["modelValue","title"])}}});export{me as _};

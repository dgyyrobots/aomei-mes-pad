/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as L,r as n,f as M,g as m,h as G,c as _,o as c,F as H,j as t,_ as J,a as o,y as O,m as a,w as P,k as I,l as Q,i as W,K as X,v as y,N as Y,z as Z}from"./index-D3eRVKjp.js";import{_ as h}from"./UploadImgs-CX_bVKw2.js";import{_ as ee}from"./UploadImg-RBMQ5RP3.js";import{g as oe,c as le}from"./comment-Bkw2mi9i.js";import te from"./SpuShowcase-Dfl-sNDJ.js";import{_ as se}from"./SkuTableSelect.vue_vue_type_script_setup_true_lang-BbEx19Ki.js";const ae={key:0},re={key:1,class:"select-box"},ve=L({__name:"CommentForm",emits:["success"],setup(ne,{expose:x,emit:C}){const{t:g}=Y(),w=Z(),i=n(!1),N=n(""),d=n(!1),b=n(""),l=n({id:void 0,userId:void 0,userNickname:void 0,userAvatar:void 0,spuId:0,skuId:void 0,descriptionScores:5,benefitScores:5,content:void 0,picUrls:[]}),q=M({spuId:[{required:!0,message:"商品不能为空",trigger:"blur"}],skuId:[{required:!0,message:"规格不能为空",trigger:"blur"}],userAvatar:[{required:!0,message:"用户头像不能为空",trigger:"blur"}],userNickname:[{required:!0,message:"用户名称不能为空",trigger:"blur"}],content:[{required:!0,message:"评论内容不能为空",trigger:"blur"}],descriptionScores:[{required:!0,message:"描述星级不能为空",trigger:"blur"}],benefitScores:[{required:!0,message:"服务星级不能为空",trigger:"blur"}]}),f=n(),v=n({id:-1,name:"",picUrl:""});x({open:async(u,e)=>{if(i.value=!0,N.value=g(`action.${u}`),b.value=u,R(),e){d.value=!0;try{l.value=await oe(e)}finally{d.value=!1}}}});const A=C,F=async()=>{if(!(!f||!await f.value.validate())){d.value=!0;try{const e=l.value.picUrls.map(p=>p?.url?p.url:p),r={...l.value,picUrls:e};b.value==="create"&&(await le(r),w.success(g("common.createSuccess"))),i.value=!1,A("success")}finally{d.value=!1}}},R=()=>{l.value={id:void 0,userId:void 0,userNickname:void 0,userAvatar:void 0,spuId:0,skuId:void 0,descriptionScores:5,benefitScores:5,content:void 0,picUrls:[]},f.value?.resetFields()},V=n(),$=()=>{V.value.open()},D=u=>{v.value=u,l.value.skuId=u.id};return(u,e)=>{const r=m("el-form-item"),p=m("el-image"),T=X,B=ee,k=m("el-input"),S=m("el-rate"),j=h,z=m("el-form"),U=m("el-button"),E=J,K=G("loading");return c(),_(H,null,[t(E,{modelValue:o(i),"onUpdate:modelValue":e[8]||(e[8]=s=>O(i)?i.value=s:null),title:"添加虚拟评论"},{footer:a(()=>[t(U,{disabled:o(d),type:"primary",onClick:F},{default:a(()=>e[9]||(e[9]=[y("确 定")])),_:1},8,["disabled"]),t(U,{onClick:e[7]||(e[7]=s=>i.value=!1)},{default:a(()=>e[10]||(e[10]=[y("取 消")])),_:1})]),default:a(()=>[P((c(),I(z,{ref_key:"formRef",ref:f,"label-width":"100px",model:o(l),rules:o(q)},{default:a(()=>[t(r,{label:"商品",prop:"spuId"},{default:a(()=>[t(te,{modelValue:o(l).spuId,"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).spuId=s),limit:1},null,8,["modelValue"])]),_:1}),o(l).spuId?(c(),I(r,{key:0,label:"商品规格",prop:"skuId"},{default:a(()=>[W("div",{class:"h-60px w-60px",onClick:$},[o(v)&&o(v).picUrl?(c(),_("div",ae,[t(p,{src:o(v).picUrl},null,8,["src"])])):(c(),_("div",re,[t(T,{icon:"ep:plus"})]))])]),_:1})):Q("",!0),t(r,{label:"用户头像",prop:"userAvatar"},{default:a(()=>[t(B,{modelValue:o(l).userAvatar,"onUpdate:modelValue":e[1]||(e[1]=s=>o(l).userAvatar=s),height:"60px",width:"60px"},null,8,["modelValue"])]),_:1}),t(r,{label:"用户名称",prop:"userNickname"},{default:a(()=>[t(k,{modelValue:o(l).userNickname,"onUpdate:modelValue":e[2]||(e[2]=s=>o(l).userNickname=s),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"评论内容",prop:"content"},{default:a(()=>[t(k,{modelValue:o(l).content,"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).content=s),type:"textarea"},null,8,["modelValue"])]),_:1}),t(r,{label:"描述星级",prop:"descriptionScores"},{default:a(()=>[t(S,{modelValue:o(l).descriptionScores,"onUpdate:modelValue":e[4]||(e[4]=s=>o(l).descriptionScores=s)},null,8,["modelValue"])]),_:1}),t(r,{label:"服务星级",prop:"benefitScores"},{default:a(()=>[t(S,{modelValue:o(l).benefitScores,"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).benefitScores=s)},null,8,["modelValue"])]),_:1}),t(r,{label:"评论图片",prop:"picUrls"},{default:a(()=>[t(j,{modelValue:o(l).picUrls,"onUpdate:modelValue":e[6]||(e[6]=s=>o(l).picUrls=s),height:"60px",limit:9,width:"60px"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[K,o(d)]])]),_:1},8,["modelValue"]),t(se,{ref_key:"skuTableSelectRef",ref:V,"spu-id":o(l).spuId,onChange:D},null,8,["spu-id"])],64)}}});export{ve as _};

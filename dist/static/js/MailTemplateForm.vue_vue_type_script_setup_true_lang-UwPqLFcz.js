/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{f as T,L as D,d as k,r,g as C,h as V,k as x,o as P,m as c,w as N,i as Y,a as s,j as g,v as h,y as A,_ as I,N as L,z as R}from"./index-DMg0mq0e.js";import{b as B}from"./index-DWFqjMnW.js";import{r as a}from"./formRules-B7VVnYvt.js";import{D as E}from"./dict-BEquckDR.js";import{u as H}from"./useCrudSchemas-CGb8S5Zu.js";import{g as $,c as O,u as U}from"./index-48d5tvon.js";const d=await B(),j=T({name:[a],code:[a],accountId:[a],label:[a],content:[a],params:[a],status:[a]}),q=T([{label:"模板编码",field:"code",isSearch:!0},{label:"模板名称",field:"name",isSearch:!0},{label:"模板标题",field:"title"},{label:"模板内容",field:"content",form:{component:"Editor",componentProps:{valueHtml:"",height:200}}},{label:"邮箱账号",field:"accountId",width:"200px",formatter:(S,f,u)=>d.find(o=>o.id===u)?.mail,search:{show:!0,component:"Select",api:()=>d,componentProps:{optionsAlias:{labelField:"mail",valueField:"id"}}},form:{component:"Select",api:()=>d,componentProps:{optionsAlias:{labelField:"mail",valueField:"id"}}}},{label:"发送人名称",field:"nickname"},{label:"开启状态",field:"status",isSearch:!0,dictType:E.COMMON_STATUS,dictClass:"number"},{label:"备注",field:"remark",isTable:!1},{label:"创建时间",field:"createTime",isForm:!1,formatter:D,search:{show:!0,component:"DatePicker",componentProps:{valueFormat:"YYYY-MM-DD HH:mm:ss",type:"daterange",defaultTime:[new Date("1 00:00:00"),new Date("1 23:59:59")]}}},{label:"操作",field:"action",isForm:!1}]),{allSchemas:z}=H(q),G=["rules","schema"],ae=k({name:"SystemMailTemplateForm",__name:"MailTemplateForm",emits:["success"],setup(S,{expose:f,emit:u}){const{t:o}=L(),p=R(),t=r(!1),v=r(""),l=r(!1),b=r(""),i=r();f({open:async(n,e)=>{if(t.value=!0,v.value=o(`action.${n}`),b.value=n,e){l.value=!0;try{const m=await $(e);i.value.setValues(m)}finally{l.value=!1}}}});const w=u,y=async()=>{if(!(!i||!await i.value.getElFormRef().validate())){l.value=!0;try{const e=i.value.formModel;b.value==="create"?(await O(e),p.success(o("common.createSuccess"))):(await U(e),p.success(o("common.updateSuccess"))),t.value=!1,w("success")}finally{l.value=!1}}};return(n,e)=>{const m=C("el-button"),F=I,M=V("loading");return P(),x(F,{modelValue:s(t),"onUpdate:modelValue":e[1]||(e[1]=_=>A(t)?t.value=_:null),"max-height":500,scroll:!0,title:s(v),width:800},{footer:c(()=>[g(m,{disabled:s(l),type:"primary",onClick:y},{default:c(()=>e[2]||(e[2]=[h("确 定")])),_:1},8,["disabled"]),g(m,{onClick:e[0]||(e[0]=_=>t.value=!1)},{default:c(()=>e[3]||(e[3]=[h("取 消")])),_:1})]),default:c(()=>[N(Y("form",{ref_key:"formRef",ref:i,rules:s(j),schema:s(z).formSchema},null,8,G),[[M,s(l)]])]),_:1},8,["modelValue","title"])}}});export{ae as _,z as a};

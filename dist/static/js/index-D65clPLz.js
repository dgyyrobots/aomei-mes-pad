/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as Z,r as c,f as ee,u as le,b as ae,cF as te,g as i,h as D,c as Q,o as u,j as e,m as o,a as t,J as f,F as R,n as oe,k as g,w as y,v as d,K as ne,t as E,L as k,M as re,z as pe,N as se}from"./index-D3S9e4gi.js";import{_ as ie}from"./DictTag.vue_vue_type_script_lang-DqsMypuM.js";import{_ as me}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DXTslarw.js";import{_ as ue,b as de,d as ce,e as fe}from"./ContactForm.vue_vue_type_script_setup_true_lang-BjmPu4PT.js";import{D as L}from"./dict-D5UmY5m8.js";import{d as _e}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./index-Dg5E73Z_.js";import"./index-DMSqiyAj.js";import"./tree-vSlcEeQq.js";const Ue=Z({name:"CrmContact",__name:"index",setup(be){const C=pe(),{t:P}=se(),V=c(!0),N=c(0),U=c([]),I=c([]),n=ee({pageNo:1,pageSize:10,nextTime:[],mobile:null,telephone:null,email:null,customerId:null,address:null,remark:null,ownerUserId:null,createTime:[],lastTime:[],parentId:null,name:null,post:null,qq:null,wechat:null,sex:null,policyMakers:null}),T=c(),q=c(!1),w=async()=>{V.value=!0;try{const p=await de(n);U.value=p.list,N.value=p.total}finally{V.value=!1}},s=()=>{n.pageNo=1,w()},M=()=>{T.value.resetFields(),s()},S=c(),F=(p,l)=>{S.value.open(p,l)},z=async p=>{try{await C.delConfirm(),await ce(p),C.success(P("common.delSuccess")),await w()}catch(l){console.log(l)}},B=async()=>{try{await C.exportConfirm(),q.value=!0;const p=await fe(n);_e.excel(p,"联系人.xls")}catch(p){console.log(p)}finally{q.value=!1}},{push:A}=le(),O=p=>{A({name:"CrmContactDetail",params:{id:p}})};return ae(async()=>{await w(),I.value=await te()}),(p,l)=>{const Y=i("el-option"),j=i("el-select"),m=i("el-form-item"),_=i("el-input"),x=ne,b=i("el-button"),G=i("el-form"),K=me,J=i("el-link"),r=i("el-table-column"),$=ie,W=i("el-table"),X=re,v=D("hasPermi"),H=D("loading");return u(),Q(R,null,[e(K,null,{default:o(()=>[e(G,{ref_key:"queryFormRef",ref:T,class:"-mb-15px",inline:!0,"label-width":"68px",model:t(n)},{default:o(()=>[e(m,{label:"客户",prop:"customerId"},{default:o(()=>[e(j,{modelValue:t(n).customerId,"onUpdate:modelValue":l[0]||(l[0]=a=>t(n).customerId=a),clearable:"","lable-key":"name",placeholder:"请选择客户","value-key":"id",onKeyup:f(s,["enter"])},{default:o(()=>[(u(!0),Q(R,null,oe(t(I),a=>(u(),g(Y,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"姓名",prop:"name"},{default:o(()=>[e(_,{modelValue:t(n).name,"onUpdate:modelValue":l[1]||(l[1]=a=>t(n).name=a),class:"!w-240px",clearable:"",placeholder:"请输入姓名",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"手机号",prop:"mobile"},{default:o(()=>[e(_,{modelValue:t(n).mobile,"onUpdate:modelValue":l[2]||(l[2]=a=>t(n).mobile=a),class:"!w-240px",clearable:"",placeholder:"请输入手机号",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"座机",prop:"telephone"},{default:o(()=>[e(_,{modelValue:t(n).telephone,"onUpdate:modelValue":l[3]||(l[3]=a=>t(n).telephone=a),class:"!w-240px",clearable:"",placeholder:"请输入电话",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"QQ",prop:"qq"},{default:o(()=>[e(_,{modelValue:t(n).qq,"onUpdate:modelValue":l[4]||(l[4]=a=>t(n).qq=a),class:"!w-240px",clearable:"",placeholder:"请输入QQ",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"微信",prop:"wechat"},{default:o(()=>[e(_,{modelValue:t(n).wechat,"onUpdate:modelValue":l[5]||(l[5]=a=>t(n).wechat=a),class:"!w-240px",clearable:"",placeholder:"请输入微信",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,{label:"电子邮箱",prop:"email"},{default:o(()=>[e(_,{modelValue:t(n).email,"onUpdate:modelValue":l[6]||(l[6]=a=>t(n).email=a),class:"!w-240px",clearable:"",placeholder:"请输入电子邮箱",onKeyup:f(s,["enter"])},null,8,["modelValue"])]),_:1}),e(m,null,{default:o(()=>[e(b,{onClick:s},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:search"}),l[10]||(l[10]=d(" 搜索 "))]),_:1}),e(b,{onClick:M},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:refresh"}),l[11]||(l[11]=d(" 重置 "))]),_:1}),y((u(),g(b,{type:"primary",onClick:l[7]||(l[7]=a=>F("create"))},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:plus"}),l[12]||(l[12]=d(" 新增 "))]),_:1})),[[v,["crm:contact:create"]]]),y((u(),g(b,{loading:t(q),plain:"",type:"success",onClick:B},{default:o(()=>[e(x,{class:"mr-5px",icon:"ep:download"}),l[13]||(l[13]=d(" 导出 "))]),_:1},8,["loading"])),[[v,["crm:contact:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(K,null,{default:o(()=>[y((u(),g(W,{data:t(U),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[e(r,{align:"center",fixed:"left",label:"姓名",prop:"name"},{default:o(a=>[e(J,{type:"primary",underline:!1,onClick:h=>O(a.row.id)},{default:o(()=>[d(E(a.row.name),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{align:"center",fixed:"left",label:"客户",prop:"customerName"}),e(r,{align:"center",label:"性别",prop:"sex"},{default:o(a=>[e($,{type:t(L).SYSTEM_USER_SEX,value:a.row.sex},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"职位",prop:"post"}),e(r,{align:"center",label:"是否关键决策人",prop:"master"},{default:o(a=>[e($,{type:t(L).INFRA_BOOLEAN_STRING,value:a.row.master},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"直属上级",prop:"parentName"}),e(r,{align:"center",label:"手机号",prop:"mobile"}),e(r,{align:"center",label:"座机",prop:"telephone"}),e(r,{align:"center",label:"QQ",prop:"qq"}),e(r,{align:"center",label:"微信",prop:"wechat"}),e(r,{align:"center",label:"邮箱",prop:"email"}),e(r,{align:"center",label:"地址",prop:"address"}),e(r,{align:"center",formatter:t(k),label:"下次联系时间",prop:"nextTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"备注",prop:"remark"}),e(r,{align:"center",formatter:t(k),label:"最后跟进时间",prop:"lastTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",label:"负责人",prop:"ownerUserId"},{default:o(a=>[d(E(a.row.ownerUserName),1)]),_:1}),e(r,{align:"center",formatter:t(k),label:"更新时间",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",formatter:t(k),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(r,{align:"center",fixed:"right",label:"操作",width:"200"},{default:o(a=>[y((u(),g(b,{plain:"",type:"primary",onClick:h=>F("update",a.row.id)},{default:o(()=>l[14]||(l[14]=[d("编辑")])),_:2},1032,["onClick"])),[[v,["crm:contact:update"]]]),y((u(),g(b,{plain:"",type:"danger",onClick:h=>z(a.row.id)},{default:o(()=>l[15]||(l[15]=[d("删除")])),_:2},1032,["onClick"])),[[v,["crm:contact:delete"]]])]),_:1})]),_:1},8,["data"])),[[H,t(V)]]),e(X,{limit:t(n).pageSize,"onUpdate:limit":l[8]||(l[8]=a=>t(n).pageSize=a),page:t(n).pageNo,"onUpdate:page":l[9]||(l[9]=a=>t(n).pageNo=a),total:t(N),onPagination:w},null,8,["limit","page","total"])]),_:1}),e(ue,{ref_key:"formRef",ref:S,onSuccess:w},null,512)],64)}}});export{Ue as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{V as f,d as R,r as p,f as A,g as s,h as M,k as V,o as v,m as l,w as O,a as t,j as o,v as _,c as j,F as z,n as P,t as Y,y as G,_ as H,N as J,z as K}from"./index-BdmDrM2Y.js";import{C as Q}from"./constants-BPQb3nxh.js";import{c as W,D as X}from"./dict-Cm-9nniQ.js";const oe=async()=>await f.get({url:"/member/sign-in/config/list"}),Z=async r=>await f.get({url:`/member/sign-in/config/get?id=${r}`}),h=async r=>await f.post({url:"/member/sign-in/config/create",data:r}),ee=async r=>await f.put({url:"/member/sign-in/config/update",data:r}),re=async r=>await f.delete({url:`/member/sign-in/config/delete?id=${r}`}),se=R({__name:"SignInConfigForm",emits:["success"],setup(r,{expose:D,emit:F}){const{t:b}=J(),x=K(),i=p(!1),w=p(""),u=p(!1),C=p(""),n=p({}),S=(m,e,d)=>{if(!n.value.point&&!n.value.experience){d(new Error("奖励积分与奖励经验至少配置一个"));return}const y=m?.field==="point"?"experience":"point";c.value.validateField(y,()=>null),d()},k=A({day:[{required:!0,message:"签到天数不能空",trigger:"blur"}],point:[{required:!0,message:"奖励积分不能空",trigger:"blur"},{validator:S,trigger:"blur"}],experience:[{required:!0,message:"奖励经验不能空",trigger:"blur"},{validator:S,trigger:"blur"}]}),c=p();D({open:async(m,e)=>{if(i.value=!0,w.value=b(`action.${m}`),C.value=m,U(),e){u.value=!0;try{n.value=await Z(e)}finally{u.value=!1}}}});const T=F,E=async()=>{if(!(!c||!await c.value.validate())){u.value=!0;try{C.value==="create"?(await h(n.value),x.success(b("common.createSuccess"))):(await ee(n.value),x.success(b("common.updateSuccess"))),i.value=!1,T("success")}finally{u.value=!1}}},U=()=>{n.value={id:void 0,day:void 0,point:0,experience:0,status:Q.ENABLE},c.value?.resetFields()};return(m,e)=>{const d=s("el-input-number"),y=s("el-text"),g=s("el-form-item"),N=s("el-radio"),$=s("el-radio-group"),q=s("el-form"),I=s("el-button"),B=H,L=M("loading");return v(),V(B,{modelValue:t(i),"onUpdate:modelValue":e[5]||(e[5]=a=>G(i)?i.value=a:null),title:t(w)},{footer:l(()=>[o(I,{disabled:t(u),type:"primary",onClick:E},{default:l(()=>e[7]||(e[7]=[_("确 定")])),_:1},8,["disabled"]),o(I,{onClick:e[4]||(e[4]=a=>i.value=!1)},{default:l(()=>e[8]||(e[8]=[_("取 消")])),_:1})]),default:l(()=>[O((v(),V(q,{ref_key:"formRef",ref:c,"label-width":"100px",model:t(n),rules:t(k)},{default:l(()=>[o(g,{label:"签到天数",prop:"day"},{default:l(()=>[o(d,{modelValue:t(n).day,"onUpdate:modelValue":e[0]||(e[0]=a=>t(n).day=a),max:7,min:1,precision:0},null,8,["modelValue"]),o(y,{class:"mx-1",style:{"margin-left":"10px"},type:"danger"},{default:l(()=>e[6]||(e[6]=[_("只允许设置 1-7，默认签到 7 天为一个周期")])),_:1})]),_:1}),o(g,{label:"奖励积分",prop:"point"},{default:l(()=>[o(d,{modelValue:t(n).point,"onUpdate:modelValue":e[1]||(e[1]=a=>t(n).point=a),min:0,precision:0},null,8,["modelValue"])]),_:1}),o(g,{label:"奖励经验",prop:"experience"},{default:l(()=>[o(d,{modelValue:t(n).experience,"onUpdate:modelValue":e[2]||(e[2]=a=>t(n).experience=a),min:0,precision:0},null,8,["modelValue"])]),_:1}),o(g,{label:"开启状态",prop:"status"},{default:l(()=>[o($,{modelValue:t(n).status,"onUpdate:modelValue":e[3]||(e[3]=a=>t(n).status=a)},{default:l(()=>[(v(!0),j(z,null,P(t(W)(t(X).COMMON_STATUS),a=>(v(),V(N,{key:a.value,label:a.value},{default:l(()=>[_(Y(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[L,t(u)]])]),_:1},8,["modelValue","title"])}}});export{se as _,re as d,oe as g};

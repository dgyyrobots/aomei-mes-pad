/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{V as m,d as q,r as f,f as S,g as i,h as j,k as T,o as C,m as d,w as z,a as o,j as e,v as k,y as M,_ as A,N as E,z as G}from"./index-BdC40rFX.js";const W=async n=>await m.get({url:"/crm/contract/page",params:n}),X=async n=>await m.get({url:"/crm/contract/page-by-customer",params:n}),H=async n=>await m.get({url:`/crm/contract/get?id=${n}`}),J=async n=>await m.post({url:"/crm/contract/create",data:n}),K=async n=>await m.put({url:"/crm/contract/update",data:n}),Y=async n=>await m.delete({url:`/crm/contract/delete?id=${n}`}),Z=async n=>await m.download({url:"/crm/contract/export-excel",params:n}),h=q({__name:"ContractForm",emits:["success"],setup(n,{expose:x,emit:P}){const{t:b}=E(),_=G(),p=f(!1),g=f(""),c=f(!1),w=f(""),a=f({id:void 0,name:void 0,customerId:void 0,businessId:void 0,processInstanceId:void 0,orderDate:void 0,ownerUserId:void 0,no:void 0,startTime:void 0,endTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,roUserIds:void 0,rwUserIds:void 0,contactId:void 0,signUserId:void 0,contactLastTime:void 0,remark:void 0}),D=S({name:[{required:!0,message:"合同名称不能为空",trigger:"blur"}]}),v=f();x({open:async(V,l)=>{if(p.value=!0,g.value=b(`action.${V}`),w.value=V,F(),l){c.value=!0;try{a.value=await H(l)}finally{c.value=!1}}}});const L=P,$=async()=>{if(!(!v||!await v.value.validate())){c.value=!0;try{const l=a.value;w.value==="create"?(await J(l),_.success(b("common.createSuccess"))):(await K(l),_.success(b("common.updateSuccess"))),p.value=!1,L("success")}finally{c.value=!1}}},F=()=>{a.value={id:void 0,name:void 0,customerId:void 0,businessId:void 0,processInstanceId:void 0,orderDate:void 0,ownerUserId:void 0,no:void 0,startTime:void 0,endTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,roUserIds:void 0,rwUserIds:void 0,contactId:void 0,signUserId:void 0,contactLastTime:void 0,remark:void 0},v.value?.resetFields()};return(V,l)=>{const s=i("el-input"),r=i("el-form-item"),u=i("el-col"),I=i("el-row"),U=i("el-date-picker"),R=i("el-form"),y=i("el-button"),B=A,N=j("loading");return C(),T(B,{modelValue:o(p),"onUpdate:modelValue":l[19]||(l[19]=t=>M(p)?p.value=t:null),title:o(g)},{footer:d(()=>[e(y,{disabled:o(c),type:"primary",onClick:$},{default:d(()=>l[20]||(l[20]=[k("确 定")])),_:1},8,["disabled"]),e(y,{onClick:l[18]||(l[18]=t=>p.value=!1)},{default:d(()=>l[21]||(l[21]=[k("取 消")])),_:1})]),default:d(()=>[z((C(),T(R,{ref_key:"formRef",ref:v,"label-width":"100px",model:o(a),rules:o(D)},{default:d(()=>[e(I,null,{default:d(()=>[e(u,{span:12},{default:d(()=>[e(r,{label:"合同名称",prop:"name"},{default:d(()=>[e(s,{modelValue:o(a).name,"onUpdate:modelValue":l[0]||(l[0]=t=>o(a).name=t),placeholder:"请输入合同名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:d(()=>[e(r,{label:"客户",prop:"customerId"},{default:d(()=>[e(s,{modelValue:o(a).customerId,"onUpdate:modelValue":l[1]||(l[1]=t=>o(a).customerId=t),placeholder:"请选择对应客户"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"商机名称",prop:"businessId"},{default:d(()=>[e(s,{modelValue:o(a).businessId,"onUpdate:modelValue":l[2]||(l[2]=t=>o(a).businessId=t),placeholder:"请选择对应商机"},null,8,["modelValue"])]),_:1}),e(r,{label:"工作流",prop:"processInstanceId"},{default:d(()=>[e(s,{modelValue:o(a).processInstanceId,"onUpdate:modelValue":l[3]||(l[3]=t=>o(a).processInstanceId=t),placeholder:"请选择工作流"},null,8,["modelValue"])]),_:1}),e(r,{label:"下单日期",prop:"orderDate"},{default:d(()=>[e(U,{modelValue:o(a).orderDate,"onUpdate:modelValue":l[4]||(l[4]=t=>o(a).orderDate=t),placeholder:"选择下单日期",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1}),e(r,{label:"负责人",prop:"ownerUserId"},{default:d(()=>[e(s,{modelValue:o(a).ownerUserId,"onUpdate:modelValue":l[5]||(l[5]=t=>o(a).ownerUserId=t),placeholder:"请选择负责人"},null,8,["modelValue"])]),_:1}),e(r,{label:"合同编号",prop:"no"},{default:d(()=>[e(s,{modelValue:o(a).no,"onUpdate:modelValue":l[6]||(l[6]=t=>o(a).no=t),placeholder:"请输入合同编号"},null,8,["modelValue"])]),_:1}),e(I,null,{default:d(()=>[e(u,{span:12},{default:d(()=>[e(r,{label:"开始时间",prop:"startTime"},{default:d(()=>[e(U,{modelValue:o(a).startTime,"onUpdate:modelValue":l[7]||(l[7]=t=>o(a).startTime=t),placeholder:"选择开始时间",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:d(()=>[e(r,{label:"结束时间",prop:"endTime"},{default:d(()=>[e(U,{modelValue:o(a).endTime,"onUpdate:modelValue":l[8]||(l[8]=t=>o(a).endTime=t),placeholder:"选择结束时间",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:d(()=>[e(u,{span:8},{default:d(()=>[e(r,{label:"合同金额",prop:"price"},{default:d(()=>[e(s,{modelValue:o(a).price,"onUpdate:modelValue":l[9]||(l[9]=t=>o(a).price=t),placeholder:"请输入合同金额"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:d(()=>[e(r,{label:"整单折扣",prop:"discountPercent"},{default:d(()=>[e(s,{modelValue:o(a).discountPercent,"onUpdate:modelValue":l[10]||(l[10]=t=>o(a).discountPercent=t),placeholder:"请输入整单折扣"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:8},{default:d(()=>[e(r,{label:"产品总金额",prop:"productPrice"},{default:d(()=>[e(s,{modelValue:o(a).productPrice,"onUpdate:modelValue":l[11]||(l[11]=t=>o(a).productPrice=t),placeholder:"请输入产品总金额"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"只读权限的用户",prop:"roUserIds"},{default:d(()=>[e(s,{modelValue:o(a).roUserIds,"onUpdate:modelValue":l[12]||(l[12]=t=>o(a).roUserIds=t),placeholder:"请输入只读权限的用户"},null,8,["modelValue"])]),_:1}),e(r,{label:"读写权限的用户",prop:"rwUserIds"},{default:d(()=>[e(s,{modelValue:o(a).rwUserIds,"onUpdate:modelValue":l[13]||(l[13]=t=>o(a).rwUserIds=t),placeholder:"请输入读写权限的用户"},null,8,["modelValue"])]),_:1}),e(I,null,{default:d(()=>[e(u,{span:12},{default:d(()=>[e(r,{label:"联系人编号",prop:"contactId"},{default:d(()=>[e(s,{modelValue:o(a).contactId,"onUpdate:modelValue":l[14]||(l[14]=t=>o(a).contactId=t),placeholder:"请输入联系人编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:d(()=>[e(r,{label:"公司签约人",prop:"signUserId"},{default:d(()=>[e(s,{modelValue:o(a).signUserId,"onUpdate:modelValue":l[15]||(l[15]=t=>o(a).signUserId=t),placeholder:"请输入公司签约人"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"最后跟进时间",prop:"contactLastTime"},{default:d(()=>[e(U,{modelValue:o(a).contactLastTime,"onUpdate:modelValue":l[16]||(l[16]=t=>o(a).contactLastTime=t),placeholder:"选择最后跟进时间",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1}),e(r,{label:"备注",prop:"remark"},{default:d(()=>[e(s,{modelValue:o(a).remark,"onUpdate:modelValue":l[17]||(l[17]=t=>o(a).remark=t),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[N,o(c)]])]),_:1},8,["modelValue","title"])}}});export{h as _,W as a,Y as d,Z as e,X as g};

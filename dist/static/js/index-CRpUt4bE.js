/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as W,r as f,f as G,b as H,g as s,h as Y,c as $,o as m,j as t,m as a,a as n,J as X,F,n as Z,k as d,w as _,v as p,K as ee,t as x,x as U,L as te,M as oe,z as ae,N as ne,c5 as le}from"./index-lcC3l4R2.js";import{_ as ie}from"./DictTag.vue_vue_type_script_lang-G_4C17ZW.js";import{_ as re}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C6z1f3RI.js";import{_ as se}from"./CombinationActivityForm.vue_vue_type_script_setup_true_lang-CTJCkmJz.js";import{a as me,b as pe,d as ce}from"./combinationActivity-D2lF0fAT.js";import{c as ue,D as V}from"./dict-B7jb0IEc.js";import{f as de}from"./formatter-DIfZBjUR.js";import"./color-B5phLuB-.js";import"./Form-DvFkc2yb.js";import"./style.css_vue_type_style_index_0_src_true_lang-CyTN0Oow.js";import"./locale-CRJotxwA.js";import"./InputPassword-DZfXqMfL.js";import"./UploadImg-CCDcPQew.js";import"./index-Bn4cwl4J.js";import"./UploadImgs-DP0b9AwB.js";import"./UploadImgs.vue_vue_type_script_setup_true_lang-DPD2ftyX.js";import"./UploadFile-B8rwxP_V.js";import"./UploadFile.vue_vue_type_script_setup_true_lang-D44NOlWT.js";import"./formRules-7o6SrC1R.js";import"./useCrudSchemas-7PYbH-Wf.js";import"./tree-vSlcEeQq.js";import"./spu-Cs5jL4YR.js";import"./index-BaS758xH.js";import"./SkuList.vue_vue_type_script_setup_true_lang-DxJap-eB.js";import"./SpuAndSkuList.vue_vue_type_script_setup_true_lang-EVm7Nk21.js";import"./SpuSelect.vue_vue_type_script_setup_true_lang-97zYe0aQ.js";import"./category-C1vxv8tw.js";const qe=W({name:"PromotionBargainActivity",__name:"index",setup(fe){const w=ae(),{t:A}=ne(),g=f(!0),P=f(0),h=f([]),i=G({pageNo:1,pageSize:10,name:null,status:null}),D=f(),c=async()=>{g.value=!0;try{const r=await me(i);h.value=r.list,P.value=r.total}finally{g.value=!1}},y=()=>{i.pageNo=1,c()},O=()=>{D.value.resetFields(),y()},M=f(),T=(r,e)=>{M.value.open(r,e)},z=async r=>{try{await w.confirm("确认关闭该秒杀活动吗？"),await pe(r),w.success("关闭成功"),await c()}catch(e){console.log(e)}},B=async r=>{try{await w.delConfirm(),await ce(r),w.success(A("common.delSuccess")),await c()}catch(e){console.log(e)}},I=r=>{const e=Math.min(...r.map(v=>v.combinationPrice));return`￥${le(e)}`};return H(async()=>{await c()}),(r,e)=>{const v=s("el-input"),C=s("el-form-item"),R=s("el-option"),q=s("el-select"),k=ee,u=s("el-button"),K=s("el-form"),N=re,l=s("el-table-column"),L=s("el-image"),E=ie,Q=s("el-table"),j=oe,b=Y("hasPermi"),J=Y("loading");return m(),$(F,null,[t(N,null,{default:a(()=>[t(K,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"68px",model:n(i)},{default:a(()=>[t(C,{label:"活动名称",prop:"name"},{default:a(()=>[t(v,{modelValue:n(i).name,"onUpdate:modelValue":e[0]||(e[0]=o=>n(i).name=o),class:"!w-240px",clearable:"",placeholder:"请输入活动名称",onKeyup:X(y,["enter"])},null,8,["modelValue"])]),_:1}),t(C,{label:"活动状态",prop:"status"},{default:a(()=>[t(q,{modelValue:n(i).status,"onUpdate:modelValue":e[1]||(e[1]=o=>n(i).status=o),class:"!w-240px",clearable:"",placeholder:"请选择活动状态"},{default:a(()=>[(m(!0),$(F,null,Z(n(ue)(n(V).COMMON_STATUS),o=>(m(),d(R,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,null,{default:a(()=>[t(u,{onClick:y},{default:a(()=>[t(k,{class:"mr-5px",icon:"ep:search"}),e[5]||(e[5]=p(" 搜索 "))]),_:1}),t(u,{onClick:O},{default:a(()=>[t(k,{class:"mr-5px",icon:"ep:refresh"}),e[6]||(e[6]=p(" 重置 "))]),_:1}),_((m(),d(u,{plain:"",type:"primary",onClick:e[2]||(e[2]=o=>T("create"))},{default:a(()=>[t(k,{class:"mr-5px",icon:"ep:plus"}),e[7]||(e[7]=p(" 新增 "))]),_:1})),[[b,["promotion:combination-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(N,null,{default:a(()=>[_((m(),d(Q,{data:n(h),"show-overflow-tooltip":!0,stripe:!0},{default:a(()=>[t(l,{label:"活动编号","min-width":"80",prop:"id"}),t(l,{label:"活动名称","min-width":"140",prop:"name"}),t(l,{label:"活动时间","min-width":"210"},{default:a(o=>[p(x(n(U)(o.row.startTime,"YYYY-MM-DD"))+" ~ "+x(n(U)(o.row.endTime,"YYYY-MM-DD")),1)]),_:1}),t(l,{label:"商品图片","min-width":"80",prop:"spuName"},{default:a(o=>[t(L,{class:"h-40px w-40px","preview-src-list":[o.row.picUrl],"preview-teleported":"",src:o.row.picUrl},null,8,["preview-src-list","src"])]),_:1}),t(l,{label:"商品标题","min-width":"300",prop:"spuName"}),t(l,{formatter:n(de),label:"原价","min-width":"100",prop:"marketPrice"},null,8,["formatter"]),t(l,{label:"拼团价","min-width":"100",prop:"seckillPrice"},{default:a(o=>[p(x(I(o.row.products)),1)]),_:1}),t(l,{label:"开团组数","min-width":"100",prop:"groupCount"}),t(l,{label:"成团组数","min-width":"100",prop:"groupSuccessCount"}),t(l,{label:"购买次数","min-width":"100",prop:"recordCount"}),t(l,{align:"center",label:"活动状态","min-width":"100",prop:"status"},{default:a(o=>[t(E,{type:n(V).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),t(l,{align:"center",formatter:n(te),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),t(l,{align:"center",fixed:"right",label:"操作",width:"150px"},{default:a(o=>[_((m(),d(u,{link:"",type:"primary",onClick:S=>T("update",o.row.id)},{default:a(()=>e[8]||(e[8]=[p(" 编辑 ")])),_:2},1032,["onClick"])),[[b,["promotion:combination-activity:update"]]]),o.row.status===0?_((m(),d(u,{key:0,link:"",type:"danger",onClick:S=>z(o.row.id)},{default:a(()=>e[9]||(e[9]=[p(" 关闭 ")])),_:2},1032,["onClick"])),[[b,["promotion:combination-activity:close"]]]):_((m(),d(u,{key:1,link:"",type:"danger",onClick:S=>B(o.row.id)},{default:a(()=>e[10]||(e[10]=[p(" 删除 ")])),_:2},1032,["onClick"])),[[b,["promotion:combination-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[J,n(g)]]),t(j,{limit:n(i).pageSize,"onUpdate:limit":e[3]||(e[3]=o=>n(i).pageSize=o),page:n(i).pageNo,"onUpdate:page":e[4]||(e[4]=o=>n(i).pageNo=o),total:n(P),onPagination:c},null,8,["limit","page","total"])]),_:1}),t(se,{ref_key:"formRef",ref:M,onSuccess:c},null,512)],64)}}});export{qe as default};

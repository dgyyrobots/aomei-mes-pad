/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{V as S,d as Q,r as d,f as j,b as E,g as r,h as D,c as J,o as s,j as e,m as a,a as o,J as N,v as p,K as W,w as P,k as c,d6 as A,L as G,M as O,F as X,z as Z,N as ee}from"./index-BdC40rFX.js";import{_ as te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{_ as le}from"./index-Cen3Pl2s.js";import{_ as ae}from"./FileForm.vue_vue_type_script_setup_true_lang-CJDY_vMr.js";const oe=f=>S.get({url:"/infra/file/page",params:f}),ne=f=>S.delete({url:`/infra/file/delete?id=${f}`}),ue=Q({name:"InfraFile",__name:"index",setup(f){const w=Z(),{t:T}=ee(),v=d(!0),k=d(0),h=d([]),n=j({pageNo:1,pageSize:10,name:void 0,type:void 0,path:void 0,createTime:[]}),x=d(),m=async()=>{v.value=!0;try{const u=await oe(n);h.value=u.list,k.value=u.total}finally{v.value=!1}},_=()=>{n.pageNo=1,m()},U=()=>{x.value.resetFields(),_()},V=d(),$=()=>{V.value.open()},M=async u=>{try{await w.delConfirm(),await ne(u),w.success(T("common.delSuccess")),await m()}catch(t){console.log(t)}};return E(()=>{m()}),(u,t)=>{const R=le,F=r("el-input"),g=r("el-form-item"),q=r("el-date-picker"),b=W,y=r("el-button"),K=r("el-form"),C=te,i=r("el-table-column"),Y=r("el-image"),z=r("el-link"),B=r("el-table"),I=O,L=D("hasPermi"),H=D("loading");return s(),J(X,null,[e(R,{title:"上传下载",url:"https://doc.iocoder.cn/file/"}),e(C,null,{default:a(()=>[e(K,{ref_key:"queryFormRef",ref:x,class:"-mb-15px",inline:!0,"label-width":"68px",model:o(n)},{default:a(()=>[e(g,{label:"文件路径",prop:"path"},{default:a(()=>[e(F,{modelValue:o(n).path,"onUpdate:modelValue":t[0]||(t[0]=l=>o(n).path=l),clearable:"",placeholder:"请输入文件路径",onKeyup:N(_,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"文件类型",prop:"type",width:"80"},{default:a(()=>[e(F,{modelValue:o(n).type,"onUpdate:modelValue":t[1]||(t[1]=l=>o(n).type=l),clearable:"",placeholder:"请输入文件类型",onKeyup:N(_,["enter"])},null,8,["modelValue"])]),_:1}),e(g,{label:"创建时间",prop:"createTime"},{default:a(()=>[e(q,{modelValue:o(n).createTime,"onUpdate:modelValue":t[2]||(t[2]=l=>o(n).createTime=l),"default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(g,null,{default:a(()=>[e(y,{onClick:_},{default:a(()=>[e(b,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=p(" 搜索 "))]),_:1}),e(y,{onClick:U},{default:a(()=>[e(b,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=p(" 重置 "))]),_:1}),e(y,{plain:"",type:"primary",onClick:$},{default:a(()=>[e(b,{class:"mr-5px",icon:"ep:upload"}),t[7]||(t[7]=p(" 上传文件 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(C,null,{default:a(()=>[P((s(),c(B,{data:o(h)},{default:a(()=>[e(i,{align:"center",label:"文件名",prop:"name","show-overflow-tooltip":!0}),e(i,{align:"center",label:"文件路径",prop:"path","show-overflow-tooltip":!0}),e(i,{align:"center",label:"URL",prop:"url","show-overflow-tooltip":!0}),e(i,{align:"center",formatter:o(A),label:"文件大小",prop:"size",width:"120"},null,8,["formatter"]),e(i,{align:"center",label:"文件类型",prop:"type",width:"180px"}),e(i,{align:"center",label:"文件内容",prop:"url",width:"110px"},{default:a(({row:l})=>[l.type.includes("image")?(s(),c(Y,{key:0,class:"h-80px w-80px",fit:"cover",lazy:"","preview-src-list":[l.url],"preview-teleported":"",src:l.url},null,8,["preview-src-list","src"])):l.type.includes("pdf")?(s(),c(z,{key:1,href:l.url,target:"_blank",type:"primary",underline:!1},{default:a(()=>t[8]||(t[8]=[p("预览")])),_:2},1032,["href"])):(s(),c(z,{key:2,download:"",href:l.url,target:"_blank",type:"primary",underline:!1},{default:a(()=>t[9]||(t[9]=[p("下载")])),_:2},1032,["href"]))]),_:1}),e(i,{align:"center",formatter:o(G),label:"上传时间",prop:"createTime",width:"180"},null,8,["formatter"]),e(i,{align:"center",label:"操作"},{default:a(l=>[P((s(),c(y,{link:"",type:"danger",onClick:re=>M(l.row.id)},{default:a(()=>t[10]||(t[10]=[p("删除")])),_:2},1032,["onClick"])),[[L,["infra:config:delete"]]])]),_:1})]),_:1},8,["data"])),[[H,o(v)]]),e(I,{limit:o(n).pageSize,"onUpdate:limit":t[3]||(t[3]=l=>o(n).pageSize=l),page:o(n).pageNo,"onUpdate:page":t[4]||(t[4]=l=>o(n).pageNo=l),total:o(k),onPagination:m},null,8,["limit","page","total"])]),_:1}),e(ae,{ref_key:"formRef",ref:V,onSuccess:m},null,512)],64)}}});export{ue as default};

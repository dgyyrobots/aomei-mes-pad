/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 10:14:51 
 */
import{d as S,r as p,f as U,g as i,h as D,k as v,o as f,m as r,w as R,a as o,j as n,c as T,F as $,n as q,v as b,y as B,_ as M,z as L}from"./index-BuFigy1A.js";import{g as N,s as z}from"./index-B4bpR3gg.js";const H=S({name:"SystemSmsTemplateSendForm",__name:"SmsTemplateSendForm",setup(E,{expose:V}){const y=L(),m=p(!1),u=p(!1),a=p({content:"",params:{},mobile:"",templateCode:"",templateParams:new Map}),_=U({mobile:[{required:!0,message:"手机不能为空",trigger:"blur"}],templateCode:[{required:!0,message:"模版编码不能为空",trigger:"blur"}],templateParams:{}}),d=p();V({open:async c=>{m.value=!0,C(),u.value=!0;try{const e=await N(c);a.value.content=e.content,a.value.params=e.params,a.value.templateCode=e.code,a.value.templateParams=e.params.reduce((l,s)=>(l[s]="",l),{}),_.templateParams=e.params.reduce((l,s)=>(l[s]={required:!0,message:`参数 ${s} 不能为空`,trigger:"blur"},l),{})}finally{u.value=!1}}});const w=async()=>{if(!(!d||!await d.value.validate())){u.value=!0;try{const e=a.value,l=await z(e);l&&y.success(`提交发送成功！发送结果，见发送日志编号：${l}`),m.value=!1}finally{u.value=!1}}},C=()=>{a.value={content:"",params:{},mobile:"",templateCode:"",templateParams:new Map},d.value?.resetFields()};return(c,e)=>{const l=i("el-input"),s=i("el-form-item"),k=i("el-form"),g=i("el-button"),P=M,x=D("loading");return f(),v(P,{modelValue:o(m),"onUpdate:modelValue":e[3]||(e[3]=t=>B(m)?m.value=t:null),title:"测试"},{footer:r(()=>[n(g,{disabled:o(u),type:"primary",onClick:w},{default:r(()=>e[4]||(e[4]=[b("确 定")])),_:1},8,["disabled"]),n(g,{onClick:e[2]||(e[2]=t=>m.value=!1)},{default:r(()=>e[5]||(e[5]=[b("取 消")])),_:1})]),default:r(()=>[R((f(),v(k,{ref_key:"formRef",ref:d,"label-width":"140px",model:o(a),rules:o(_)},{default:r(()=>[n(s,{label:"模板内容",prop:"content"},{default:r(()=>[n(l,{modelValue:o(a).content,"onUpdate:modelValue":e[0]||(e[0]=t=>o(a).content=t),placeholder:"请输入模板内容",readonly:"",type:"textarea"},null,8,["modelValue"])]),_:1}),n(s,{label:"手机号",prop:"mobile"},{default:r(()=>[n(l,{modelValue:o(a).mobile,"onUpdate:modelValue":e[1]||(e[1]=t=>o(a).mobile=t),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),(f(!0),T($,null,q(o(a).params,t=>(f(),v(s,{key:t,label:"参数 {"+t+"}",prop:"templateParams."+t},{default:r(()=>[n(l,{modelValue:o(a).templateParams[t],"onUpdate:modelValue":F=>o(a).templateParams[t]=F,placeholder:"请输入 "+t+" 参数"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label","prop"]))),128))]),_:1},8,["model","rules"])),[[x,o(u)]])]),_:1},8,["modelValue"])}}});export{H as _};

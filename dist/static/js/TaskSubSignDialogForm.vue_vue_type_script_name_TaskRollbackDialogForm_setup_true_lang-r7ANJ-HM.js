/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as B,r as n,g as r,h as N,k as c,o as m,_ as q,a as o,y as E,m as s,w as M,j as i,c as $,n as j,F as z,v as _,aM as A,z as G,t as g}from"./index-lcC3l4R2.js";import{e as H,f as I}from"./index-DA7SonX-.js";const Q=B({__name:"TaskSubSignDialogForm",emits:["success"],setup(J,{expose:V,emit:y}){const v=G(),l=n(!1),u=n(!1),t=n({id:"",reason:""}),w=n({id:[{required:!0,message:"必须选择减签任务",trigger:"change"}],reason:[{required:!0,message:"减签理由不能为空",trigger:"blur"}]}),d=n(),f=n([]);V({open:async p=>{if(f.value=await H(p),A(f.value))return v.warning("当前没有可减签的任务"),!1;l.value=!0,D()}});const x=y,C=async()=>{if(!(!d||!await d.value.validate())){u.value=!0;try{await I(t.value),v.success("减签成功"),l.value=!1,x("success")}finally{u.value=!1}}},D=()=>{t.value={id:"",reason:""},d.value?.resetFields()};return(p,e)=>{const F=r("el-radio-button"),S=r("el-radio-group"),b=r("el-form-item"),U=r("el-input"),L=r("el-form"),k=r("el-button"),R=q,T=N("loading");return m(),c(R,{modelValue:o(l),"onUpdate:modelValue":e[3]||(e[3]=a=>E(l)?l.value=a:null),title:"减签",width:"500"},{footer:s(()=>[i(k,{disabled:o(u),type:"primary",onClick:C},{default:s(()=>e[4]||(e[4]=[_("确 定")])),_:1},8,["disabled"]),i(k,{onClick:e[2]||(e[2]=a=>l.value=!1)},{default:s(()=>e[5]||(e[5]=[_("取 消")])),_:1})]),default:s(()=>[M((m(),c(L,{ref_key:"formRef",ref:d,"label-width":"110px",model:o(t),rules:o(w)},{default:s(()=>[i(b,{label:"减签任务",prop:"id"},{default:s(()=>[i(S,{modelValue:o(t).id,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).id=a)},{default:s(()=>[(m(!0),$(z,null,j(o(f),a=>(m(),c(F,{key:a.id,label:a.id},{default:s(()=>[_(g(a.name)+"("+g(a.assigneeUser.deptName)+g(a.assigneeUser.nickname)+"--审批) ",1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(b,{label:"减签理由",prop:"reason"},{default:s(()=>[i(U,{modelValue:o(t).reason,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).reason=a),clearable:"",placeholder:"请输入减签理由"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[T,o(u)]])]),_:1},8,["modelValue"])}}});export{Q as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as ae,r as s,f as re,b as te,g as d,h as P,c as oe,o as p,j as e,m as t,a as r,J as ne,v as m,K as le,w as R,k as c,d6 as b,L as q,l as w,M as de,F as ie,z as se}from"./index-lcC3l4R2.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-C6z1f3RI.js";import{g as me,c as ue,b as ce}from"./index-XtdJvyWA.js";import{f as U}from"./formatter-DIfZBjUR.js";import{_ as be}from"./BrokerageOrderListDialog.vue_vue_type_script_setup_true_lang-DtnwcMUB.js";import{_ as ge}from"./BrokerageUserListDialog.vue_vue_type_script_setup_true_lang-CFwn6b-H.js";import{_ as fe}from"./UpdateBindUserForm.vue_vue_type_script_setup_true_lang-Cuu4qigb.js";import"./DictTag.vue_vue_type_script_lang-G_4C17ZW.js";import"./color-B5phLuB-.js";import"./dict-B7jb0IEc.js";import"./index-CFqzf_V9.js";import"./constants-BPQb3nxh.js";const Fe=ae({name:"TradeBrokerageUser",__name:"index",setup(_e){const g=se(),x=s(!0),B=s(0),C=s([]),i=re({pageNo:1,pageSize:10,bindUserId:null,brokerageEnabled:!0,createTime:[]}),V=s(),u=async()=>{x.value=!0;try{const o=await me(i);C.value=o.list,B.value=o.total}finally{x.value=!1}},y=()=>{i.pageNo=1,u()},I=()=>{V.value.resetFields(),y()},N=(o,a)=>{switch(o){case"openBrokerageUserTable":O(a.id);break;case"openBrokerageOrderTable":L(a.id);break;case"openUpdateBindUserForm":z(a);break;case"handleClearBindUser":M(a);break}},T=s(),O=o=>{T.value.open(o)},E=s(),L=o=>{E.value.open(o)},F=s(),z=o=>{F.value.open(o)},M=async o=>{try{await g.confirm(`确认要清除"${o.nickname}"的上级推广人吗？`),await ue({id:o.id}),g.success("清除成功"),await u()}catch(a){console.log(a)}},Y=async o=>{try{const a=o.brokerageEnabled?"开通":"关闭";await g.confirm(`确认要${a}"${o.nickname}"的推广资格吗？`),await ce({id:o.id,enabled:o.brokerageEnabled}),g.success(`${a}成功`),await u()}catch{o.brokerageEnabled=!o.brokerageEnabled}};return te(()=>{u()}),(o,a)=>{const S=d("el-input"),f=d("el-form-item"),$=d("el-option"),K=d("el-select"),H=d("el-date-picker"),v=le,h=d("el-button"),Q=d("el-form"),D=pe,l=d("el-table-column"),j=d("el-avatar"),J=d("el-switch"),_=d("el-dropdown-item"),W=d("el-dropdown-menu"),A=d("el-dropdown"),G=d("el-table"),X=de,Z=P("hasPermi"),ee=P("loading");return p(),oe(ie,null,[e(D,null,{default:t(()=>[e(Q,{ref_key:"queryFormRef",ref:V,class:"-mb-15px",inline:!0,"label-width":"85px",model:r(i)},{default:t(()=>[e(f,{label:"推广员编号",prop:"bindUserId"},{default:t(()=>[e(S,{modelValue:r(i).bindUserId,"onUpdate:modelValue":a[0]||(a[0]=n=>r(i).bindUserId=n),class:"!w-240px",clearable:"",placeholder:"请输入推广员编号",onKeyup:ne(y,["enter"])},null,8,["modelValue"])]),_:1}),e(f,{label:"推广资格",prop:"brokerageEnabled"},{default:t(()=>[e(K,{modelValue:r(i).brokerageEnabled,"onUpdate:modelValue":a[1]||(a[1]=n=>r(i).brokerageEnabled=n),class:"!w-240px",clearable:"",placeholder:"请选择推广资格"},{default:t(()=>[e($,{label:"有",value:!0}),e($,{label:"无",value:!1})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"创建时间",prop:"createTime"},{default:t(()=>[e(H,{modelValue:r(i).createTime,"onUpdate:modelValue":a[2]||(a[2]=n=>r(i).createTime=n),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(f,null,{default:t(()=>[e(h,{onClick:y},{default:t(()=>[e(v,{class:"mr-5px",icon:"ep:search"}),a[5]||(a[5]=m(" 搜索 "))]),_:1}),e(h,{onClick:I},{default:t(()=>[e(v,{class:"mr-5px",icon:"ep:refresh"}),a[6]||(a[6]=m(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(D,null,{default:t(()=>[R((p(),c(G,{data:r(C),"show-overflow-tooltip":!0,stripe:!0},{default:t(()=>[e(l,{align:"center",label:"用户编号","min-width":"80px",prop:"id"}),e(l,{align:"center",label:"头像",prop:"avatar",width:"70px"},{default:t(n=>[e(j,{src:n.row.avatar},null,8,["src"])]),_:1}),e(l,{align:"center",label:"昵称","min-width":"80px",prop:"nickname"}),e(l,{align:"center",label:"推广人数",prop:"brokerageUserCount",width:"80px"}),e(l,{align:"center",label:"推广订单数量","min-width":"110px",prop:"brokerageOrderCount"}),e(l,{align:"center",formatter:r(U),label:"推广订单金额","min-width":"110px",prop:"brokerageOrderPrice"},null,8,["formatter"]),e(l,{align:"center",formatter:r(U),label:"已提现金额","min-width":"100px",prop:"withdrawPrice"},null,8,["formatter"]),e(l,{align:"center",label:"已提现次数","min-width":"100px",prop:"withdrawCount"}),e(l,{align:"center",formatter:r(U),label:"未提现金额","min-width":"100px",prop:"price"},null,8,["formatter"]),e(l,{align:"center",formatter:r(U),label:"冻结中佣金","min-width":"100px",prop:"frozenPrice"},null,8,["formatter"]),e(l,{align:"center",label:"推广资格","min-width":"80px",prop:"brokerageEnabled"},{default:t(n=>[e(J,{modelValue:n.row.brokerageEnabled,"onUpdate:modelValue":k=>n.row.brokerageEnabled=k,"active-text":"有",disabled:!r(b)(["trade:brokerage-user:update-bind-user"]),"inactive-text":"无","inline-prompt":"",onChange:k=>Y(n.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])]),_:1}),e(l,{align:"center",formatter:r(q),label:"成为推广员时间",prop:"brokerageTime",width:"180px"},null,8,["formatter"]),e(l,{align:"center",label:"上级推广员编号",prop:"bindUserId",width:"150px"}),e(l,{align:"center",formatter:r(q),label:"推广员绑定时间",prop:"bindUserTime",width:"180px"},null,8,["formatter"]),e(l,{align:"center",fixed:"right",label:"操作",width:"150px"},{default:t(n=>[R((p(),c(A,{onCommand:k=>N(k,n.row)},{dropdown:t(()=>[e(W,null,{default:t(()=>[r(b)(["trade:brokerage-user:user-query"])?(p(),c(_,{key:0,command:"openBrokerageUserTable"},{default:t(()=>a[8]||(a[8]=[m(" 推广人 ")])),_:1})):w("",!0),r(b)(["trade:brokerage-user:order-query"])?(p(),c(_,{key:1,command:"openBrokerageOrderTable"},{default:t(()=>a[9]||(a[9]=[m(" 推广订单 ")])),_:1})):w("",!0),r(b)(["trade:brokerage-user:update-bind-user"])?(p(),c(_,{key:2,command:"openUpdateBindUserForm"},{default:t(()=>a[10]||(a[10]=[m(" 修改上级推广人 ")])),_:1})):w("",!0),n.row.bindUserId&&r(b)(["trade:brokerage-user:clear-bind-user"])?(p(),c(_,{key:3,command:"handleClearBindUser"},{default:t(()=>a[11]||(a[11]=[m(" 清除上级推广人 ")])),_:1})):w("",!0)]),_:2},1024)]),default:t(()=>[e(h,{link:"",type:"primary"},{default:t(()=>[e(v,{icon:"ep:d-arrow-right"}),a[7]||(a[7]=m(" 更多 "))]),_:1})]),_:2},1032,["onCommand"])),[[Z,["trade:brokerage-user:user-query","trade:brokerage-user:order-query","trade:brokerage-user:update-bind-user","trade:brokerage-user:clear-bind-user"]]])]),_:1})]),_:1},8,["data"])),[[ee,r(x)]]),e(X,{limit:r(i).pageSize,"onUpdate:limit":a[3]||(a[3]=n=>r(i).pageSize=n),page:r(i).pageNo,"onUpdate:page":a[4]||(a[4]=n=>r(i).pageNo=n),total:r(B),onPagination:u},null,8,["limit","page","total"])]),_:1}),e(fe,{ref_key:"updateBindUserFormRef",ref:F,onSuccess:u},null,512),e(ge,{ref_key:"brokerageUserListDialogRef",ref:T},null,512),e(be,{ref_key:"brokerageOrderListDialogRef",ref:E},null,512)],64)}}});export{Fe as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:05:55 
 */
import{d as W,u as A,r as p,f as O,b as X,g as c,h as P,c as Z,o as m,j as t,m as o,a as n,J as R,w as u,v as i,K as ee,k as f,t as te,L as U,M as ae,F as oe,z as ne,N as le}from"./index-D3S9e4gi.js";import{_ as re}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DXTslarw.js";import{_ as ie}from"./index-B8rAEfSb.js";import{_ as se}from"./ImportTable.vue_vue_type_script_setup_true_lang-BDZm1bvD.js";import{_ as me}from"./PreviewCode.vue_vue_type_style_index_0_lang-DMmhGn_5.js";import{d as de,e as pe,s as ce,f as ue}from"./index-88CRuhkx.js";import{g as fe}from"./index-Fdi0KASF.js";import{d as _e}from"./download-U6qaYcnP.js";import"./tree-vSlcEeQq.js";/* empty css               */const Te=W({name:"InfraCodegen",__name:"index",setup(ge){const y=ne(),{t:x}=le(),{push:B}=A(),k=p(!0),$=p(0),D=p([]),r=O({pageNo:1,pageSize:10,tableName:void 0,tableComment:void 0,createTime:[]}),T=p(),V=p([]),b=async()=>{k.value=!0;try{const l=await de(r);D.value=l.list,$.value=l.total}finally{k.value=!1}},C=()=>{r.pageNo=1,b()},I=()=>{T.value.resetFields(),C()},S=p(),M=()=>{S.value.open()},K=l=>{B(`/codegen/edit?id=${l}`)},h=p(),L=l=>{h.value.open(l.id)},Y=async l=>{try{await y.delConfirm(),await pe(l),y.success(x("common.delSuccess")),await b()}catch(e){console.log(e)}},q=async l=>{const e=l.tableName;try{await y.confirm(`确认要强制同步${e}表结构吗?`,x("common.reminder")),await ce(l.id),y.success("同步成功")}catch(_){console.log(_)}},H=async l=>{const e=await ue(l.id);_e.zip(e,`codegen-${l.className}.zip`)};return X(async()=>{await b(),V.value=await fe()}),(l,e)=>{const _=ie,z=c("el-input"),v=c("el-form-item"),Q=c("el-date-picker"),N=ee,s=c("el-button"),j=c("el-form"),F=re,d=c("el-table-column"),E=c("el-table"),G=ae,g=P("hasPermi"),J=P("loading");return m(),Z(oe,null,[t(_,{title:"代码生成（单表）",url:"https://doc.iocoder.cn/new-feature/"}),t(_,{title:"代码生成（树表）",url:"https://doc.iocoder.cn/new-feature/tree/"}),t(_,{title:"代码生成（主子表）",url:"https://doc.iocoder.cn/new-feature/master-sub/"}),t(_,{title:"单元测试",url:"https://doc.iocoder.cn/unit-test/"}),t(F,null,{default:o(()=>[t(j,{ref_key:"queryFormRef",ref:T,class:"-mb-15px",inline:!0,"label-width":"68px",model:n(r)},{default:o(()=>[t(v,{label:"表名称",prop:"tableName"},{default:o(()=>[t(z,{modelValue:n(r).tableName,"onUpdate:modelValue":e[0]||(e[0]=a=>n(r).tableName=a),class:"!w-240px",clearable:"",placeholder:"请输入表名称",onKeyup:R(C,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"表描述",prop:"tableComment"},{default:o(()=>[t(z,{modelValue:n(r).tableComment,"onUpdate:modelValue":e[1]||(e[1]=a=>n(r).tableComment=a),class:"!w-240px",clearable:"",placeholder:"请输入表描述",onKeyup:R(C,["enter"])},null,8,["modelValue"])]),_:1}),t(v,{label:"创建时间",prop:"createTime"},{default:o(()=>[t(Q,{modelValue:n(r).createTime,"onUpdate:modelValue":e[2]||(e[2]=a=>n(r).createTime=a),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(v,null,{default:o(()=>[t(s,{onClick:C},{default:o(()=>[t(N,{class:"mr-5px",icon:"ep:search"}),e[6]||(e[6]=i(" 搜索 "))]),_:1}),t(s,{onClick:I},{default:o(()=>[t(N,{class:"mr-5px",icon:"ep:refresh"}),e[7]||(e[7]=i(" 重置 "))]),_:1}),u((m(),f(s,{type:"primary",onClick:e[3]||(e[3]=a=>M())},{default:o(()=>[t(N,{class:"mr-5px",icon:"ep:zoom-in"}),e[8]||(e[8]=i(" 导入 "))]),_:1})),[[g,["infra:codegen:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(F,null,{default:o(()=>[u((m(),f(E,{data:n(D)},{default:o(()=>[t(d,{align:"center",label:"数据源"},{default:o(a=>[i(te(n(V).find(w=>w.id===a.row.dataSourceConfigId)?.name),1)]),_:1}),t(d,{align:"center",label:"表名称",prop:"tableName",width:"200"}),t(d,{align:"center",label:"表描述",prop:"tableComment","show-overflow-tooltip":!0,width:"200"}),t(d,{align:"center",label:"实体",prop:"className",width:"200"}),t(d,{align:"center",formatter:n(U),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(d,{align:"center",formatter:n(U),label:"更新时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(d,{align:"center",fixed:"right",label:"操作",width:"300px"},{default:o(a=>[u((m(),f(s,{link:"",type:"primary",onClick:w=>L(a.row)},{default:o(()=>e[9]||(e[9]=[i("预览")])),_:2},1032,["onClick"])),[[g,["infra:codegen:preview"]]]),u((m(),f(s,{link:"",type:"primary",onClick:w=>K(a.row.id)},{default:o(()=>e[10]||(e[10]=[i("编辑")])),_:2},1032,["onClick"])),[[g,["infra:codegen:update"]]]),u((m(),f(s,{link:"",type:"danger",onClick:w=>Y(a.row.id)},{default:o(()=>e[11]||(e[11]=[i("删除")])),_:2},1032,["onClick"])),[[g,["infra:codegen:delete"]]]),u((m(),f(s,{link:"",type:"primary",onClick:w=>q(a.row)},{default:o(()=>e[12]||(e[12]=[i("同步")])),_:2},1032,["onClick"])),[[g,["infra:codegen:update"]]]),u((m(),f(s,{link:"",type:"primary",onClick:w=>H(a.row)},{default:o(()=>e[13]||(e[13]=[i("生成代码")])),_:2},1032,["onClick"])),[[g,["infra:codegen:download"]]])]),_:1})]),_:1},8,["data"])),[[J,n(k)]]),t(G,{limit:n(r).pageSize,"onUpdate:limit":e[4]||(e[4]=a=>n(r).pageSize=a),page:n(r).pageNo,"onUpdate:page":e[5]||(e[5]=a=>n(r).pageNo=a),total:n($),onPagination:b},null,8,["limit","page","total"])]),_:1}),t(se,{ref_key:"importRef",ref:S,onSuccess:b},null,512),t(me,{ref_key:"previewRef",ref:h},null,512)],64)}}});export{Te as default};

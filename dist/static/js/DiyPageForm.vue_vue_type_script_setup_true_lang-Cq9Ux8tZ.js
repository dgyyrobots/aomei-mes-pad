/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{d as T,r as u,f as $,g as f,h as B,k as y,o as U,m as r,w as S,a,j as n,v as V,y as j,_ as q,N as z,z as L}from"./index-lcC3l4R2.js";import{_ as M}from"./UploadImgs-DP0b9AwB.js";import{a as A,c as E,b as G}from"./page-B_YBRCdm.js";const W=T({name:"DiyPageForm",__name:"DiyPageForm",emits:["success"],setup(H,{expose:b,emit:I}){const{t:v}=z(),c=L(),m=u(!1),g=u(""),i=u(!1),_=u(""),l=u({id:void 0,name:void 0,remark:void 0,previewImageUrls:[]}),k=$({name:[{required:!0,message:"页面名称不能为空",trigger:"blur"}]}),d=u();b({open:async(p,e)=>{if(m.value=!0,g.value=v(`action.${p}`),_.value=p,P(),e){i.value=!0;try{const o=await A(e);o?.previewImageUrls?.length>0&&(o.previewImageUrls=o.previewImageUrls.map(s=>({url:s}))),l.value=o}finally{i.value=!1}}}});const D=I,x=async()=>{if(!(!d||!await d.value.validate())){i.value=!0;try{const e=l.value.previewImageUrls.map(s=>s.url?s.url:s),o={...l.value,previewImageUrls:e};_.value==="create"?(await E(o),c.success(v("common.createSuccess"))):(await G(o),c.success(v("common.updateSuccess"))),m.value=!1,D("success")}finally{i.value=!1}}},P=()=>{l.value={id:void 0,name:void 0,remark:void 0,previewImageUrls:[]},d.value?.resetFields()};return(p,e)=>{const o=f("el-input"),s=f("el-form-item"),C=M,F=f("el-form"),w=f("el-button"),R=q,N=B("loading");return U(),y(R,{modelValue:a(m),"onUpdate:modelValue":e[4]||(e[4]=t=>j(m)?m.value=t:null),title:a(g)},{footer:r(()=>[n(w,{disabled:a(i),type:"primary",onClick:x},{default:r(()=>e[5]||(e[5]=[V("确 定")])),_:1},8,["disabled"]),n(w,{onClick:e[3]||(e[3]=t=>m.value=!1)},{default:r(()=>e[6]||(e[6]=[V("取 消")])),_:1})]),default:r(()=>[S((U(),y(F,{ref_key:"formRef",ref:d,"label-width":"100px",model:a(l),rules:a(k)},{default:r(()=>[n(s,{label:"页面名称",prop:"name"},{default:r(()=>[n(o,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=t=>a(l).name=t),placeholder:"请输入页面名称"},null,8,["modelValue"])]),_:1}),n(s,{label:"备注",prop:"remark"},{default:r(()=>[n(o,{modelValue:a(l).remark,"onUpdate:modelValue":e[1]||(e[1]=t=>a(l).remark=t),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1}),n(s,{label:"预览图",prop:"previewImageUrls"},{default:r(()=>[n(C,{modelValue:a(l).previewImageUrls,"onUpdate:modelValue":e[2]||(e[2]=t=>a(l).previewImageUrls=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[N,a(i)]])]),_:1},8,["modelValue","title"])}}});export{W as _};

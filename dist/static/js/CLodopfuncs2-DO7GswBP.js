/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 15:23:48 
 */
(function(_){var r={strWebPageID:"7BCAAAE",strTaskID:"",strHostURI:"http://localhost:18000",VERSION:"6.5.6.7",IVERSION:"6567",CVERSION:"6.5.6.7",HTTPS_STATUS:0,VERSION_EXT:!0,iBaseTask:0,timeThreshold:5,Priority:0,blIslocal:!0,Iframes:[],ItemDatas:{},PageData:{},defStyleJson:{},PageDataEx:{},ItemCNameStyles:{},blWorking:!1,blNormalItemAdded:!1,blTmpSelectedIndex:null,Caption:null,Color:null,CompanyName:null,strBroadcastMS:null,Border:null,Inbrowse:null,webskt:null,SocketEnable:!1,SocketOpened:!1,NoClearAfterPrint:!1,On_Return_Remain:!1,On_Broadcast_Remain:!1,On_Return:null,Result:null,OBO_Mode:1,blOneByone:!1,DelimChar:"\f\f",Printers:{default:"1",list:[{name:"导出为WPS PDF",DriverName:"Kingsoft Virtual Printer Driver",PortName:"Kingsoft Virtual Printer Port",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"1",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"20481",DCOrientation:"90",MaxExtentWidth:"65535",MaxExtentLength:"65535",MinExtentWidth:"10",MinExtentlength:"10",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"Tabloid"},{name:"Ledger"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"10x14"},{name:"11x17"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"C size sheet"},{name:"D size sheet"},{name:"E size sheet"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C3"},{name:"信封 C4"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B4"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"美国标准 Fanfold"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"B4 (ISO)"},{name:"日式明信片"},{name:"9x11"},{name:"10x11"},{name:"15x11"},{name:"信封邀请函"},{name:"特大信纸"},{name:"特大法律专用纸"},{name:"Tabloid 特大"},{name:"A4 特大"},{name:"信纸横向"},{name:"A4 横向"},{name:"特大信纸横向"},{name:"Super A"},{name:"Super B"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A3 特大"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"A2"},{name:"A3 横向"},{name:"A3 特大横向"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #2"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"信纸旋转"},{name:"A3 旋转"},{name:"A4 旋转"},{name:"A5 旋转"},{name:"B4 (JIS) 旋转"},{name:"B5 (JIS) 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Kaku #2 旋转"},{name:"日式信封 Kaku #3 旋转"},{name:"日式信封 Chou #3 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"12x11"},{name:"日式信封 You #4"},{name:"日式信封 You #4 旋转"},{name:"PRC 16K"},{name:"PRC 32K"},{name:"PRC 32K(Big)"},{name:"PRC 信封 #1"},{name:"PRC 信封 #2"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 信封 #9"},{name:"PRC 信封 #10"},{name:"PRC 16K 旋转"},{name:"PRC 32K 旋转"},{name:"PRC 32K(大)旋转"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #2 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"PRC 信封 #5 旋转"},{name:"PRC 信封 #6 旋转"},{name:"PRC 信封 #7 旋转"},{name:"PRC 信封 #8 旋转"},{name:"PRC 信封 #9 旋转"},{name:"PRC 信封 #10 旋转"}],subdevlist:[]},{name:"Microsoft Print to PDF",DriverName:"Microsoft Print To PDF",PortName:"PORTPROMPT:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2970",MaxExtentLength:"4318",MinExtentWidth:"1397",MinExtentlength:"2100",pagelist:[{name:"信纸"},{name:"Tabloid"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"}],subdevlist:[]}]},altMessageWebSocketInvalid:"WebSocket没准备好，请稍后重试!",altMessageNoReadWriteFile:"不能远程读写文件!",altMessageNoReadFile:"不能远程读文件!",altMessageNoWriteFile:"不能远程写文件!",altMessageNoPrintDesign:"不能远程打印设计!",altMessageNoPrintSetup:"不能远程打印维护!",altMessageSomeWindowExist:"有窗口已打开，先关闭它(持续如此时请刷新页面)!",altMessageBusy:"上一个请求正忙，请稍后再试！",Browser:function(){var t=navigator.userAgent,e=Object.prototype.toString.call(window.opera)=="[object Opera]";return{IE:!!window.attachEvent&&!e,Opera:e,WebKit:t.indexOf("AppleWebKit/")>-1,Gecko:t.indexOf("Gecko")>-1&&t.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(t)}}(),GetTaskID:function(){if(!this.strTaskID||this.strTaskID==""){var t=new Date;this.iBaseTask++,this.strTaskID=""+t.getHours()+t.getMinutes()+t.getSeconds()+"_"+this.iBaseTask}return this.strWebPageID+this.strTaskID},DoInit:function(){this.strTaskID="",!this.NoClearAfterPrint&&(this.ItemDatas={count:0},this.PageData={},this.ItemCNameStyles={},this.defStyleJson={beginpage:0,beginpagea:0},this.blNormalItemAdded=!1)},OpenWebSocket:function(){if(!window.WebSocket&&!window.MozWebSocket){window.On_CLodop_Opened&&r.Priority==window.CLODOP_OK_Priority&&setTimeout("window.On_CLodop_Opened(CLODOP)",1);return}this.SocketEnable=!0;try{(!this.webskt||this.webskt.readyState==3)&&(!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),this.webskt=new WebSocket("ws://127.0.0.1:18000/c_webskt/"),this.webskt.onopen=function(t){r.SocketOpened=!0,window.On_CLodop_Opened&&r.Priority==window.CLODOP_OK_Priority&&setTimeout("window.On_CLodop_Opened(CLODOP)",1)},this.webskt.onmessage=function(t){r.blOneByone=!1;var e=t.data;r.Result=e;try{var i=null,n=e.indexOf("=");if(n>=0&&n<30&&(i=e.slice(0,n),e=e.slice(n+1)),i.indexOf("ErrorMS")>-1){alert(e);return}if(i.indexOf("BroadcastMS")>-1){if(r.strBroadcastMS=e,r.On_Broadcast){var s=r.On_Broadcast;r.On_Broadcast(e),!r.On_Broadcast_Remain&&s===r.On_Broadcast&&(r.On_Broadcast=null)}return}if(r.On_Return){var s=r.On_Return;e.toLowerCase()=="true"||e.toLowerCase()=="false"?r.On_Return(i,e.toLowerCase()=="true"):r.On_Return(i,e),!r.On_Return_Remain&&s===r.On_Return&&(r.On_Return=null)}}catch{}},this.webskt.onclose=function(t){if(!r.SocketOpened){r.SocketEnable=!1;return}setTimeout("CLODOP.OpenWebSocket()",2e3)},this.webskt.onerror=function(t){})}catch(t){this.webskt=null,t.message.indexOf("SecurityError")>-1?this.SocketEnable=!1:setTimeout("CLODOP.OpenWebSocket()",2e3)}},wsSend:function(t,e){if(this.SocketEnable){if(this.webskt&&this.webskt.readyState==1)return this.Result=null,this.webskt.send(t),!0;e?(alert(this.altMessageWebSocketInvalid),this.OpenWebSocket()):setTimeout(function(){r.wsSend(t,!0)},600)}},FORMAT:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;if(t!==void 0&&e!==void 0)if(t.replace(/^\s+|\s+$/g,"").toLowerCase().indexOf("time:")==0){t=t.replace(/^\s+|\s+$/g,"").slice(5),e.toLowerCase().indexOf("now")>-1&&(e=new Date().toString()),e.toLowerCase().indexOf("date")>-1&&(e=new Date().toString()),e.toLowerCase().indexOf("time")>-1&&(e=new Date().toString());var n="ymd";e.toLowerCase().indexOf("ymd")>-1&&(n="ymd",e=e.slice(3)),e.toLowerCase().indexOf("dmy")>-1&&(n="dmy",e=e.slice(3)),e.toLowerCase().indexOf("mdy")>-1&&(n="mdy",e=e.slice(3)),e=e.replace(/ [^ ]*\+[^ ]* /g," "),e=e.replace(/\(.*\)/g," "),e=e.replace(/星期日|星期一|星期二|星期三|星期四|星期五|星期六/g," "),e=e.replace(/[A-Za-z]+day|Mon|Tue|Wed|Thu|Fri|Sat|Sun/g," ");var s=0,a=new RegExp("Oct[A-Za-z]*|十月|10月","i");e.match(a)!==null&&(s=10,e=e.replace(a,"")),a=new RegExp("Nov[A-Za-z]*|十一月|11月","i"),e.match(a)!==null&&(s=11,e=e.replace(a,"")),a=new RegExp("Dec[A-Za-z]*|十二月|12月","i"),e.match(a)!==null&&(s=12,e=e.replace(a,"")),a=new RegExp("Jan[A-Za-z]*|一月|01月|1月","i"),e.match(a)!==null&&(s=1,e=e.replace(a,"")),a=new RegExp("Feb[A-Za-z]*|二月|02月|2月","i"),e.match(a)!==null&&(s=2,e=e.replace(a,"")),a=new RegExp("Mar[A-Za-z]*|三月|03月|3月","i"),e.match(a)!==null&&(s=3,e=e.replace(a,"")),a=new RegExp("Apr[A-Za-z]*|四月|04月|4月","i"),e.match(a)!==null&&(s=4,e=e.replace(a,"")),a=new RegExp("May[A-Za-z]*|五月|05月|5月","i"),e.match(a)!==null&&(s=5,e=e.replace(a,"")),a=new RegExp("Jun[A-Za-z]*|六月|06月|6月","i"),e.match(a)!==null&&(s=6,e=e.replace(a,"")),a=new RegExp("Jul[A-Za-z]*|七月|07月|7月","i"),e.match(a)!==null&&(s=7,e=e.replace(a,"")),a=new RegExp("Aug[A-Za-z]*|八月|08月|8月","i"),e.match(a)!==null&&(s=8,e=e.replace(a,"")),a=new RegExp("Sep[A-Za-z]*|九月|09月|9月","i"),e.match(a)!==null&&(s=9,e=e.replace(a,"")),e=e.replace(/日|秒/g," "),e=e.replace(/时|分/g,":");var l=e.match(/ \d+:\d+:\d+/);l==null&&(l=""),e=e.replace(/ \d+:\d+:\d+/,"")+l;var u=new Date,o=0,f=0,h=0,P=0,m=0,g=0,c=e,p="",d=0;MC2=0,MC3=0,p=c.match(/\d+/),p!==null&&(d=parseInt(p[0]),c=c.replace(/\d+/,"")),p=c.match(/\d+/),p!==null&&(MC2=parseInt(p[0]),c=c.replace(/\d+/,"")),s<=0&&(p=c.match(/\d+/),p!==null&&(MC3=parseInt(p[0]),c=c.replace(/\d+/,""))),s>0?(f=s,MC2<=31?(o=d,h=MC2):(o=MC2,h=d)):n=="dmy"?(h=d,f=MC2,o=MC3):n=="mdy"?(f=d,h=MC2,o=MC3):(o=d,f=MC2,h=MC3,MC3>31?(o=MC3,f=d,h=MC2,d>12&&(h=d,f=MC2)):MC2>12&&(o=MC2,f=d));var p=c.match(/\d+/);p!==null&&(P=parseInt(p[0]),c=c.replace(/\d+/,""));var p=c.match(/\d+/);p!==null&&(m=parseInt(p[0]),c=c.replace(/\d+/,""));var p=c.match(/\d+/);if(p!==null&&(g=parseInt(p[0]),c=c.replace(/\d+/,"")),t.toLowerCase()=="isvalidformat")e=o>0&&f>0&&f<=12&&h>0&&h<=31;else{(""+o).length<4&&(o=o+2e3),u.setFullYear(o,f-1,h),u.setHours(P),u.setMinutes(m),u.setSeconds(g);var R=u.getDay();if(t.toLowerCase()=="weekindex")e=R;else if(t.toLowerCase()=="floatvalue")e=u.getTime();else{var D="";switch(R){case 0:D="日";break;case 1:D="一";break;case 2:D="二";break;case 3:D="三";break;case 4:D="四";break;case 5:D="五";break;case 6:D="六";break}if(e=t.replace(/dddd/ig,"星期"+D),/(y+)/i.test(e)&&(e=e.replace(RegExp.$1,(o+"").substr(4-RegExp.$1.length))),/(m+:)/i.test(e)&&(e=e.replace(RegExp.$1,("00"+m+":").substr(("00"+m+":").length-RegExp.$1.length))),/(M+)/i.test(e)){var E=(""+f).length>RegExp.$1.length?(""+f).length:RegExp.$1.length;e=e.replace(RegExp.$1,("00"+f).substr(("00"+f).length-E))}if(/(d+)/i.test(e)){var E=(""+h).length>RegExp.$1.length?(""+h).length:RegExp.$1.length;e=e.replace(RegExp.$1,("00"+h).substr(("00"+h).length-E))}/(H+)/i.test(e)&&(e=e.replace(RegExp.$1,("00"+P).substr(("00"+P).length-RegExp.$1.length))),/(n+)/i.test(e)&&(e=e.replace(RegExp.$1,("00"+m).substr(("00"+m).length-RegExp.$1.length))),/(s+)/i.test(e)&&(e=e.replace(RegExp.$1,("00"+g).substr(("00"+g).length-RegExp.$1.length)))}}if(r.On_Return){var v=r.On_Return;r.On_Return(0,e),!r.On_Return_Remain&&v===r.On_Return&&(r.On_Return=null)}return e}else this.blIslocal||t.indexOf("FILE:")<0?(this.PageData.format_type=t,this.PageData.format_value=e,this.DoPostDatas("format")==!0&&(this.GetLastResult(!1),i=this.GetTaskID())):alert(this.altMessageNoReadWriteFile);return this.DoInit(),this.blWorking=!1,i},SET_PRINT_PAPER:function(t,e,i,n,s){return this.PRINT_INITA(t,e,i,n,s)},PRINT_INIT:function(t){return this.PRINT_INITA(null,null,null,null,t)},PRINT_INITA:function(t,e,i,n,s){return t==null&&(t=""),e==null&&(e=""),i==null&&(i=""),n==null&&(n=""),s==null&&(s=""),this.NoClearAfterPrint=!1,this.DoInit(),this.PageData.top=t,this.PageData.left=e,this.PageData.width=i,this.PageData.height=n,this.PageData.printtask=s,!0},SET_PRINT_MODE:function(t,e){if(t==null&&(t=""),e==null&&(e=""),t==="")return!1;if(t=t.toLowerCase(),this.PageData[t]=e,t=="noclear_after_print"&&(this.NoClearAfterPrint=e),t.indexOf("window_def")>-1||t.indexOf("control_printer")>-1){var i=null;return this.DoPostDatas("onlysetprint")==!0&&(this.GetLastResult(!1),i=this.GetTaskID()),this.DoInit(),this.blWorking=!1,i}},ADD_PRINT_TEXT:function(t,e,i,n,s){return this.AddItemArray(2,t,e,i,n,s)},ADD_PRINT_TEXTA:function(t,e,i,n,s,a){return this.AddItemArray(2,e,i,n,s,a,t)},ADD_PRINT_HTM:function(t,e,i,n,s){return this.AddItemArray(4,t,e,i,n,s)},ADD_PRINT_HTML:function(t,e,i,n,s){return this.AddItemArray(1,t,e,i,n,s)},ADD_PRINT_HTMLA:function(t,e,i,n,s,a){return this.AddItemArray(1,e,i,n,s,a,t)},ADD_PRINT_BARCODE:function(t,e,i,n,s,a){return this.AddItemArray(9,t,e,i,n,a,null,null,null,null,null,null,s)},ADD_PRINT_BARCODEA:function(t,e,i,n,s,a,l){return this.AddItemArray(9,e,i,n,s,l,t,null,null,null,null,null,a)},ADD_PRINT_RECTA:function(t,e,i,n,s,a,l){return this.AddItemArray(3,t,e,i,n,null,null,2,s,a,l,null)},ADD_PRINT_RECT:function(t,e,i,n,s,a){return this.AddItemArray(3,t,e,i,n,null,null,2,s,a,null,null)},ADD_PRINT_ELLIPSEA:function(t,e,i,n,s,a,l){return this.AddItemArray(3,t,e,i,n,null,null,3,s,a,l,null)},ADD_PRINT_ELLIPSE:function(t,e,i,n,s,a){return this.AddItemArray(3,t,e,i,n,null,null,3,s,a,null,null)},ADD_PRINT_SHAPE:function(t,e,i,n,s,a,l,u){return this.AddItemArray(3,e,i,n,s,null,null,t,a,l,u,null)},ADD_PRINT_LINE:function(t,e,i,n,s,a){return this.AddItemArray(3,t,e,i,n,null,null,0,s,a,null,"1")},ADD_PRINT_DNLINE:function(t,e,i,n,s,a){return this.AddItemArray(3,t,e,i,n,null,null,1,s,a,null,null)},ADD_PRINT_DNLINEA:function(t,e,i,n,s,a,l){return this.AddItemArray(3,t,e,i,n,null,null,1,s,a,l,null)},ADD_PRINT_UPLINE:function(t,e,i,n,s,a){return this.AddItemArray(3,t,e,i,n,null,null,0,s,a,null,null)},ADD_PRINT_UPLINEA:function(t,e,i,n,s,a,l){return this.AddItemArray(3,t,e,i,n,null,null,0,s,a,l,null)},ADD_PRINT_TABLE:function(t,e,i,n,s){return this.AddItemArray(6,t,e,i,n,s)},ADD_PRINT_TBURL:function(t,e,i,n,s){return this.AddItemArray(7,t,e,i,n,s)},ADD_PRINT_URL:function(t,e,i,n,s){return this.AddItemArray(5,t,e,i,n,s)},ADD_PRINT_IMAGE:function(t,e,i,n,s){return this.AddItemArray(8,t,e,i,n,s)},ADD_PRINT_CHART:function(t,e,i,n,s,a){return this.AddItemArray(10,t,e,i,n,a,null,null,null,null,null,null,null,s)},ADD_PRINT_PDF:function(t,e,i,n,s){if(!this.blIslocal&&s[1]==":")alert("Unable to print or view remote service files");else return this.AddItemArray(11,t,e,i,n,s)},SET_PRINT_PROPERTY:function(t,e,i,n){this.SET_PRINT_STYLEA(t,"ItemType",e),this.SET_PRINT_STYLEA(t,"HOrient",i),this.SET_PRINT_STYLEA(t,"VOrient",n)},SET_PRINT_PROPERTYA:function(t,e,i,n){this.SET_PRINT_PROPERTY(t,e,i,n)},SET_PRINT_STYLE:function(t,e){if(t==null&&(t=""),e==null&&(e=""),t==="")return!1;t=t.toLowerCase(),this.defStyleJson[t]=e},SET_PRINT_STYLEA:function(t,e,i){if(t==null&&(t=""),e==null&&(e=""),i==null&&(i=""),t===""||e==="")return!1;if(this.ItemDatas.count<=0)return this.PageData.add_print_program_data!==void 0?(this.ItemCNameStyles[e.toLowerCase()+"-"+t]=i,!0):!1;if(e=e.toLowerCase(),e=="type")return!1;var n=!1;t==0&&(t=this.ItemDatas.count);for(var s in this.ItemDatas){var a=this.ItemDatas[s].itemname;(t==s||t==a||typeof t=="string"&&typeof a=="string"&&t.toUpperCase()==a.toUpperCase())&&(this.ItemDatas[s][e]=i,n=!0)}return!!n},SET_PRINT_TEXT_STYLE:function(t,e,i,n,s,a,l){this.SET_PRINT_STYLEA(t,"fontname",e),this.SET_PRINT_STYLEA(t,"fontsize",i),this.SET_PRINT_STYLEA(t,"bold",n),this.SET_PRINT_STYLEA(t,"italic",s),this.SET_PRINT_STYLEA(t,"underline",a),this.SET_PRINT_STYLEA(t,"alignment",l)},SET_PRINT_TEXT_STYLEA:function(t,e,i,n,s,a,l,u){this.SET_PRINT_TEXT_STYLE(t,e,i,n,s,a,l),this.SET_PRINT_STYLEA(t,"fontcolor",u)},SET_PRINT_TEXT_STYLEB:function(t,e,i,n,s,a,l,u){this.SET_PRINT_TEXT_STYLEA(t,e,i,n,s,a,l,u)},NEWPAGE:function(){this.NewPage()},NewPage:function(){var t=!1,e;for(var i in this.ItemDatas){i=="count"?e=!1:e=!0;for(var n in this.ItemDatas[i])if(n=="itemtype"&&(e=!1,this.ItemDatas[i][n]==0||this.ItemDatas[i][n]==4)){t=!0;break}if(e&&(t=!0),t)break}t&&(this.defStyleJson.beginpage=this.defStyleJson.beginpage+1)},NEWPAGEA:function(){this.NewPageA()},NewPageA:function(){var t=!1,e;for(var i in this.ItemDatas){i=="count"?e=!1:e=!0;for(var n in this.ItemDatas[i])if(n=="itemtype"&&(e=!1,this.ItemDatas[i][n]==0||this.ItemDatas[i][n]==4)){t=!0;break}if(e&&(t=!0),t)break}t&&(this.defStyleJson.beginpagea=this.defStyleJson.beginpagea+1)},PREVIEW:function(t,e,i,n){if(this.blWorking)return alert(this.altMessageBusy),null;var s=null;return!t&&this.blIslocal&&!this.PageData.printersubid?this.DoPostDatas("preview")==!0&&(this.Result=null,this.GetLastResult(!0),s=this.GetTaskID()):this.DoPostDatas("cpreview")==!0&&(this.DoCPreview(t,e,i,n),s=this.GetTaskID()),this.DoInit(),this.blWorking=!1,s},PRINT:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.DoPostDatas("print")==!0&&(t=this.GetTaskID()),this.DoInit(),this.blWorking=!1,t},GET_PRINTER_COUNT:function(){return this.Printers===void 0?0:this.Printers.list.length},GET_PRINTER_NAME:function(t){if(this.Printers===void 0)return"";if(typeof t=="string"&&t.indexOf(":")>-1){var e=t.slice(t.indexOf(":")+1);return t=t.slice(0,t.indexOf(":")),t==-1?this.Printers.list[this.Printers.default][e]:this.Printers.list[t][e]}else return t==-1?this.Printers.list[this.Printers.default].name:t>=0&&t<this.Printers.list.length?this.Printers.list[t].name:"Printer NO. overflow"},GET_PAGESIZES_LIST:function(t,e,i,n){if(i||(i="pagelist"),n||(n="name"),this.Printers===void 0)return"";t==-1&&(t=this.Printers.list[this.Printers.default].name);for(var s in this.Printers.list)if(t==s||t==this.Printers.list[s].name){var a="";for(var l in this.Printers.list[s][i])n=="id"&&this.Printers.list[s][i][l].id?a===""?a=this.Printers.list[s][i][l].id:a=a+e+this.Printers.list[s][i][l].id:a===""?a=this.Printers.list[s][i][l].name:a=a+e+this.Printers.list[s][i][l].name;return a}return""},SET_PRINTER_INDEX:function(t,e){if(this.Printers===void 0)return!1;e||(e="printerindex"),t=t+"",t=t.replace(/^\s+|\s+$/g,"");var i=t.indexOf(","),n=t;if(i>-1&&(n=t.slice(0,i)),n=="-1")return this.PageData[e]=this.Printers.default,i>-1&&(this.PageData.printersubid=t.slice(i+1)),!0;for(var s in this.Printers.list){var a=this.Printers.list[s].name;if(a&&(a.replace(/\\/g,"")==n.replace(/\\/g,"")||s==n))return this.PageData[e]=a,i>-1&&(this.PageData.printersubid=t.slice(i+1)),!0}return!1},SET_PRINTER_INDEXA:function(t){return this.SET_PRINTER_INDEX(t,"printerindexa")},PRINT_DESIGN:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?this.DoPostDatas("print_design")==!0&&(this.Result=null,this.GetLastResult(!0),t=this.GetTaskID()):alert(this.altMessageNoPrintDesign),this.DoInit(),this.blWorking=!1,t},PRINT_SETUP:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?this.DoPostDatas("print_setup")==!0&&(this.Result=null,this.GetLastResult(!0),t=this.GetTaskID()):alert(this.altMessageNoPrintSetup),this.DoInit(),this.blWorking=!1,t},SET_PRINT_PAGESIZE:function(t,e,i,n){t!=null&&(this.PageData.orient=t),e!=null&&(this.PageData.pagewidth=e),i!=null&&(this.PageData.pageheight=i),n!=null&&(this.PageData.pagename=n)},SET_PRINT_COPIES:function(t){if(t!=null)return this.PageData.printcopies=t,!0},SELECT_PRINTER:function(t){return this.SelectBox.create(388,240,!t),!0},PRINTA:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return!e&&this.blIslocal?(this.Result=null,t?this.DoPostDatas("printb")==!0&&(this.GetLastResult(!1),i=this.GetTaskID()):this.DoPostDatas("printa")==!0&&(this.GetLastResult(!0),i=this.GetTaskID()),this.DoInit(),this.blWorking=!1):this.SELECT_PRINTER(!0),i},PRINTAOK:function(t,e,i,n,s){if(this.SET_PRINTER_INDEX(t),this.SET_PRINT_COPIES(e),i!==void 0&&i!==0&&this.SET_PRINT_MODE("PRINT_START_PAGE",i),n!==void 0&&n!==0&&this.SET_PRINT_MODE("PRINT_END_PAGE",n),!s)this.PRINT();else if(this.blTmpSelectedIndex=t,r.On_Return){var a=r.On_Return;r.On_Return(0,t),!r.On_Return_Remain&&a===r.On_Return&&(r.On_Return=null)}},SET_LICENSES:function(t,e,i,n){t=="THIRD LICENSE"&&e==""?(i&&i!==""&&(this.PageDataEx.licensec=i),n&&n!==""&&(this.PageDataEx.licensed=n)):t=="LICENSE TETCODE"&&e==""&&n==""?i&&i!==""&&(this.PageDataEx.Licensetetcode=i):(t&&t!==""&&(this.PageDataEx.companyname=t),e&&e!==""&&(this.PageDataEx.license=e),i&&i!==""&&(this.PageDataEx.licensea=i),n&&n!==""&&(this.PageDataEx.licenseb=n))},PRINTB:function(){return this.PRINTA(!0)},PREVIEWA:function(){return this.PREVIEW()},PREVIEWB:function(){return this.PREVIEW()},ADD_PRINT_SETUP_BKIMG:function(t){if(t!=null)return this.PageData.setup_bkimg=t,!0},SET_PREVIEW_WINDOW:function(t,e,i,n,s,a){t!=null&&(this.PageData.pvw_dispmode=t),e!=null&&(this.PageData.pvw_toolmode=e),i!=null&&(this.PageData.pvw_directprint=i),n!=null&&(this.PageData.pvw_width=n),s!=null&&(this.PageData.pvw_height=s),a!=null&&(this.PageData.pvw_puttoncaptoin=a)},SET_PREVIEW_MODE:function(t){t!==void 0&&(this.PageData.pvw_preview_mode=t)},SET_SHOW_MODE:function(t,e){if(t==null&&(t=""),e==null&&(e=""),t==="")return!1;t=t.toLowerCase(),this.PageData["shwmod_"+t]=e},SAVE_TO_FILE:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?t&&(this.PageData.stf_file_name=t,this.DoPostDatas("savetofile")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,e},SET_SAVE_MODE:function(t,e){if(t==null&&(t=""),e==null&&(e=""),t==="")return!1;t=t.toLowerCase(),this.PageData["stfmod_"+t]=e},SEND_PRINT_RAWDATA:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return t!==void 0&&(this.PageData.raw_print_data=t,this.DoPostDatas("sendrawdata")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())),this.DoInit(),this.blWorking=!1,e},WRITE_FILE_TEXT:function(t,e,i){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return this.blIslocal?e!==void 0&&i!==void 0&&(this.PageData.write_file_mode=t,this.PageData.write_file_name=e,this.PageData.write_file_text=i,this.DoPostDatas("writefiletext")==!0&&(this.GetLastResult(!1),n=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,n},GET_DIALOG_VALUE:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return t!==void 0&&e!==void 0&&(this.blIslocal?(this.PageData.dialog_type=t,this.PageData.dialog_value=e,this.DoPostDatas("dialog")==!0&&(this.GetLastResult(!0),i=this.GetTaskID())):alert(this.altMessageNoReadWriteFile)),this.DoInit(),this.blWorking=!1,i},WRITE_PORT_DATA:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return t!==void 0&&e!==void 0&&(this.PageData.write_port_name=t,this.PageData.write_port_data=e,this.DoPostDatas("writeportdata")==!0&&(this.GetLastResult(!1),i=this.GetTaskID())),this.DoInit(),this.blWorking=!1,i},READ_PORT_DATA:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return t!==void 0&&(this.PageData.read_port_name=t,this.DoPostDatas("readportdata")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())),this.DoInit(),this.blWorking=!1,e},GET_SYSTEM_INFO:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return t!==void 0&&(this.PageData.system_info_type=t,this.DoPostDatas("getsysteminfo")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())),this.DoInit(),this.blWorking=!1,e},GET_FILE_TEXT:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?t!==void 0&&(this.PageData.get_file_name=t,this.DoPostDatas("getfiletext")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,e},IS_FILE_EXIST:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?t!==void 0&&(this.PageData.file_exist_name=t,this.DoPostDatas("isfileexist")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,e},GET_FILE_TIME:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?t!==void 0&&(this.PageData.file_time_name=t,this.DoPostDatas("getfiletime")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,e},GET_PRINT_INIFFNAME:function(t){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?t!==void 0&&(this.PageData.iniff_task_name=t,this.DoPostDatas("getiniffname")==!0&&(this.GetLastResult(!1),e=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,e},GET_VALUE:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return t!==void 0&&e!==void 0&&(this.PageData.get_value_type=t,this.PageData.get_value_index=e,this.DoPostDatas("dogetvalue")==!0&&(this.GetLastResult(!1),i=this.GetTaskID())),this.DoInit(),this.blWorking=!1,i},ADD_PRINT_DATA:function(t,e){if(t!==void 0&&e!==null&&t.toLowerCase().indexOf("programdata")>-1)return this.PageData.add_print_program_data=e,!0},SHOW_CHART:function(){},DO_ACTION:function(t,e){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return t!==void 0&&e!==void 0&&(this.PageData.do_action_name=t,this.PageData.do_action_value=e,this.DoPostDatas("doaction")==!0&&(this.GetLastResult(!1),i=this.GetTaskID())),this.DoInit(),this.blWorking=!1,i},Create_Printer_List:function(t,e){for(;t.childNodes.length>0;)for(var i=t.childNodes,n=0;n<i.length;n++)t.removeChild(i[n]);for(var s=this.GET_PRINTER_COUNT(),a=0,n=0;n<s;n++){var l=document.createElement("option");if(l.innerHTML=this.GET_PRINTER_NAME(n),l.value=a,t.appendChild(l),a++,this.VERSION_EXT&&this.Printers.list[n].subdevlist.length>0)if(e)l.innerHTML=l.innerHTML+",..";else for(var u=l.innerHTML,o=0;o<this.Printers.list[n].subdevlist.length;o++){var f=this.Printers.list[n].subdevlist[o].id,h=this.Printers.list[n].subdevlist[o].name;if(o==0)l.innerHTML=u+","+h,l.value=u+","+f+";"+h;else if(l=document.createElement("option"),l.innerHTML=u+","+h,l.value=u+","+f+";"+h,t.appendChild(l),a++,a>=100)return}}},Create_PageSize_List:function(t,e){for(;t.childNodes.length>0;)for(var i=t.childNodes,n=0;n<i.length;n++)t.removeChild(i[n]);var s=r.GET_PAGESIZES_LIST(e,`
`),a=new Array;a=s.split(`
`);for(var n in a){var l=document.createElement("option");l.innerHTML=a[n],l.value=a[n],t.appendChild(l)}},SET_BRIDGE_INDEX:function(t){if(this.Printers===void 0)return!1;t=(t+"").replace(/^\s+|\s+$/g,"");for(var e in this.Printers.list){var i=this.Printers.list[e].name;if(i=="(AO)Client-Bridge Driver")return this.PageData.printerindex=e,this.PageData.printersubid=t,!0}return!1},Get_AOPrinters_List:function(t,e,i){return i||(i=`
`),e||(e="name"),r.GET_PAGESIZES_LIST(t,i,"subdevlist",e)},Get_AOBridges_List:function(t,e,i){return r.Get_AOPrinters_List(t,e,i)},Get_AOBridge_List:function(t,e){return r.Get_AOPrinters_List("(AO)Client-Bridge Driver",t,e)},Get_AOBridge_SubPrinters_List:function(t,e,i,n){n||(n="(AO)Client-Bridge Driver"),i||(i=`
`),e||(e="name");for(var s in this.Printers.list)if(n==s||n==this.Printers.list[s].name)for(var a in this.Printers.list[s].subdevlist){var l=this.Printers.list[s].subdevlist[a].id,u=this.Printers.list[s].subdevlist[a].name;if(t==a||t==l+";"+u){var o="";for(var f in this.Printers.list[s].subdevlist[a].ssbprinter.list)f!="0"&&(o=o+i),e.toLowerCase()=="id"?o=o+f:o=o+this.Printers.list[s].subdevlist[a].ssbprinter.list[f].name;return o}}return""},Get_AOBridge_SubPrinters_PageSize_List:function(t,e,i,n){n||(n="(AO)Client-Bridge Driver"),i||(i=`
`);for(var s in this.Printers.list)if(n==s||n==this.Printers.list[s].name)for(var a in this.Printers.list[s].subdevlist){var l=this.Printers.list[s].subdevlist[a].id,u=this.Printers.list[s].subdevlist[a].name;if(t==a||t==l+";"+u){for(var o in this.Printers.list[s].subdevlist[a].ssbprinter.list)if(e==o||e==this.Printers.list[s].subdevlist[a].ssbprinter.list[o].name){var f="";for(var h in this.Printers.list[s].subdevlist[a].ssbprinter.list[o].pagelist)h!="0"&&(f=f+i),f=f+this.Printers.list[s].subdevlist[a].ssbprinter.list[o].pagelist[h].name;return f}}}return""},AddItemArray:function(t,e,i,n,s,a,l,u,o,f,h,P,m,g){if(e===void 0||i===void 0||n===void 0||s===void 0||a===void 0)return!1;var c=this.ItemDatas.count;c++;var d={};for(var p in this.defStyleJson)d[p]=this.defStyleJson[p];return d.type=t,d.top=e,d.left=i,d.width=n,d.height=s,a!=null&&(typeof a=="string"&&a.indexOf(this.DelimChar)>-1?d.content=a.replace(new RegExp(this.DelimChar,"g"),""):d.content=a),l!==void 0&&l!=null&&(d.itemname=l+""),u!==void 0&&u!=null&&(d.shapetype=u),o!==void 0&&o!=null&&(d.penstyle=o),f!==void 0&&f!=null&&(d.penwidth=f),h!==void 0&&h!=null&&(d.fontcolor=h),P!==void 0&&P!=null&&(d.lineposition="1"),m!==void 0&&m!=null&&(d.fontname=m),g!==void 0&&g!=null&&(d.charttypess=g),d.beginpage=this.defStyleJson.beginpage,d.beginpagea=this.defStyleJson.beginpagea,this.ItemDatas.count=c,this.ItemDatas[c]=d,this.blNormalItemAdded=!0,!0},RemoveIframes:function(){var t=document.body||document.getElementsByTagName("body")[0]||document.documentElement;try{for(var e=0;e<this.Iframes.length;e++){var i=new Date().getTime();i-this.Iframes[e].time>this.timeThreshold*6e4&&(t.removeChild(this.Iframes[e].iframe),this.Iframes.splice(e,1))}}catch{}},AddInputElement:function(t,e,i,n){if(n!==void 0){var s=t.createElement("input");s.name=i,s.type="hidden",s.value=n,e.appendChild(s)}},createPostDataString:function(t){var e="act="+t+this.DelimChar;e=e+"browseurl="+window.location.href+this.DelimChar;for(var i in this.PageDataEx)e=e+i+"="+this.PageDataEx[i]+this.DelimChar;var n="";for(var i in this.PageData)e=e+i+"="+this.PageData[i]+this.DelimChar,i!="top"&&i!="left"&&i!="width"&&i!="height"&&i!="printtask"&&i!="printerindex"&&i!="printerindexa"&&i!="printersubid"&&i!="orient"&&i!="pagewidth"&&i!="pageheight"&&i!="pagename"&&i!="printcopies"&&i!="setup_bkimg"&&(n=n+";"+i);n!==""&&(e=e+"printmodenames="+n+this.DelimChar);var s="";for(var a in this.ItemCNameStyles)e=e+a+"="+this.ItemCNameStyles[a]+this.DelimChar,s=s+";"+a;s!==""&&(e=e+"printstyleclassnames="+s+this.DelimChar),e=e+"itemcount="+this.ItemDatas.count+this.DelimChar;for(var l in this.ItemDatas){var u="";for(var o in this.ItemDatas[l])o!="beginpage"&&o!="beginpagea"&&o!="type"&&o!="top"&&o!="left"&&o!="width"&&o!="height"&&(u=u+";"+o);e=e+l+"_itemstylenames="+u+this.DelimChar;for(var o in this.ItemDatas[l])e=e+l+"_"+o+"="+this.ItemDatas[l][o]+this.DelimChar}return e},wsDoPostDatas:function(t){var e="charset=丂"+this.DelimChar;return e=e+"tid="+this.GetTaskID()+this.DelimChar,e=e+this.createPostDataString(t),this.wsSend("post:"+e)},DoPostDatas:function(t){if(this.OBO_Mode&&this.blOneByone)return alert(this.altMessageSomeWindowExist),!1;if(this.blWorking=!0,this.blTmpSelectedIndex!==null&&this.SET_PRINTER_INDEX(this.blTmpSelectedIndex),this.SocketEnable)return this.wsDoPostDatas(t);this.RemoveIframes();var e=document.body||document.getElementsByTagName("body")[0]||document.documentElement,i=document.createElement("iframe");i.setAttribute("src","about:blank"),i.setAttribute("style","display:none"),i.height=0,e.appendChild(i);var n=i.contentWindow.document;n.write("<form action='"+this.strHostURI+"/c_dopostdatas' method='post' enctype='application/x-www-form-urlencoded'></form>");var s=n.getElementsByTagName("form")[0];this.AddInputElement(n,s,"charset","丂"),this.AddInputElement(n,s,"tid",this.GetTaskID()),this.AddInputElement(n,s,"post",this.createPostDataString(t)),s.submit();var a={};return a.time=new Date().getTime(),a.iframe=i,this.Iframes.push(a),!0},GetLastResult:function(t){if(t&&(this.blOneByone=!0),this.SocketEnable)return!0;var e=this.strHostURI+"/c_lastresult.js";e=e+"?times="+new Date().getTime(),e=e+"&tid="+this.GetTaskID(),e=encodeURI(e).replace("%20","+");var i=document.createElement("script");i.src=e,i.async=!1,i.type="text/javascript",i.charset="utf-8";var n=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return n.insertBefore(i,n.firstChild),i.onload=i.onreadystatechange=function(){if(!i.readyState||/loaded|complete/.test(i.readyState)){if(r.blOneByone=!1,CLodop_ACTLastResult)var s=decodeURIComponent(CLodop_ACTLastResult);var a=CLodop_ACTTaskID;if(r.Result=s,CLodop_ACTAlert&&CLodop_ACTAlert(),r.On_Return)try{var l=r.On_Return;s=="true"||s=="false"?r.On_Return(a,s=="true"):r.On_Return(a,s),!r.On_Return_Remain&&l===r.On_Return&&(r.On_Return=null)}catch{}i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i)}},!0},DoCPreview:function(t,e,i,n){var s=document.body||document.getElementsByTagName("body")[0]||document.documentElement;typeof e!="number"||!e?e=Math.round(s.offsetWidth*2/3):s.offsetWidth<e&&(e=s.offsetWidth),typeof i!="number"||!i?i=Math.round(window.screen.height-200):window.screen.height<i&&(i=window.screen.height);var a=this.strHostURI+"/c_dopreview";a=a+"?times="+new Date().getTime(),a=a+"&tid="+this.GetTaskID(),a=a+"&iw="+e,a=a+"&ih="+i,n&&(a=a+"&opid="+n),a=encodeURI(a).replace("%20","+"),this.PopView(t,a,e,i)},PopView:function(t,e,i,n){try{if(t&&typeof t=="string"&&t.length>0)if(t==="_dialog")window.showModalDialog?window.showModalDialog(e,"dialog","center:yes"):window.open(e,"","scrollbars=yes,toolbar=no,left=150,top=100,resizable=yes");else if(t==="_self"||t==="_top"||t==="_parent")window.location.href=e;else if(t==="_blank")this.PreviewBox.create(e,i,n);else if(t.indexOf("_winopen:")>-1){var s=t.slice(t.indexOf("_winopen:")+9);s.indexOf("_blank")>-1?window.open(e,"_blank",s.slice(s.indexOf("_blank")+6)):window.open(e,"",s)}else document.getElementById(t)?document.getElementById(t).src=e:alert("iframe '"+t+"' not exist!");else this.PreviewBox.create(e,i,n)}catch(a){alert("CLODOP PopView "+a)}},creatMyButtonElement:function(t,e){try{var i=document.createElement("<input type='"+t+"' value='"+e+"'></input>")}catch{}return i||(i=document.createElement("input"),i.type=t,i.value=e),i},creatLabelElement:function(t,e,i,n,s){var a=document.createElement(t);return a.innerHTML=e,a.style.cssText="position:absolute;width:"+i+"px;left:"+n+"px;top:"+s+"px;",a},SelectBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,selPrinter:void 0,selCopies:void 0,closeit:function(){r.SelectBox.PopDiv&&r.SelectBox.PopDiv.parentNode&&r.SelectBox.PopDiv.parentNode.removeChild(r.SelectBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(t){var e=window.event||t;this.offsetx=e.clientX,this.offsety=e.clientY,this.tempx=parseInt(this.PopDiv.style.left),this.tempy=parseInt(this.PopDiv.style.top),this.dragapproved=!0},drag_drop:function(t){if(this.dragapproved){var e=window.event||t;this.PopDiv.style.left=e.clientX-this.offsetx+this.tempx+"px",this.PopDiv.style.top=e.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1},clickOK:function(t){r.PRINTAOK(r.SelectBox.selPrinter.value,r.SelectBox.selCopies.value,0,0,t),this.closeit()},create:function(t,e,i){r.SelectBox.PopDiv&&this.closeit();var n=document.body||document.getElementsByTagName("body")[0]||document.documentElement,s=document.createElement("div");n.appendChild(s),s.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;background:#F5F5F5;color:#000;font-size:13px;",s.style.width=t+"px",s.style.left=Math.max((n.offsetWidth-t)/2,0)+"px",s.style.top=Math.max((n.offsetHeight-e)/2,0)+"px",s.style.height=e+"px",this.PopDiv=s;var a=document.createElement("div");s.appendChild(a),a.style.cssText="font: bold 13px Arial;line-height:25px;height:27px;text-indent:5px;color: white;background:#8BACCF",a.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打印",a.onmousedown=function(g){r.SelectBox.initializedrag(g)},a.onmousemove=function(g){r.SelectBox.drag_drop(g)},a.onmouseup=function(){r.SelectBox.stopdrag()};var l=document.createElement("button");a.appendChild(l),l.style.cssText="background:transparent url("+r.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var u=document.createElement("button");a.appendChild(u),u.style.cssText="background:transparent url("+r.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",u.onclick=function(){if(r.SelectBox.closeit(),i&&r.On_Return){var g=r.On_Return;r.On_Return(0,-1),!r.On_Return_Remain&&g===r.On_Return&&(r.On_Return=null)}};var o=document.createElement("div");s.appendChild(o),o.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",o.style.width=t-2+"px",o.style.height=e-27+"px";var f=r.creatMyButtonElement("button","确定");s.appendChild(f),f.style.cssText="position:absolute;width:80px;height:23px;",f.style.left="110px",f.style.top=e-64+"px",f.onclick=function(){r.SelectBox.clickOK(i)};var h=r.creatMyButtonElement("button","取消");s.appendChild(h),h.style.cssText="position:absolute;width:80px;;height:23px;",h.style.left="240px",h.style.top=e-64+"px",h.onclick=function(){if(r.SelectBox.closeit(),i&&r.On_Return){var g=r.On_Return;r.On_Return(0,-1),!r.On_Return_Remain&&g===r.On_Return&&(r.On_Return=null)}},o.appendChild(r.creatLabelElement("span","选打印机：",200,46,67));var P=document.createElement("select");s.appendChild(P),this.selPrinter=P,P.style.cssText="position:absolute;size:1;width:212px;left:110px;top:62px;",r.Create_Printer_List(P),o.appendChild(r.creatLabelElement("span","打印份数：",200,46,121));var m=r.creatMyButtonElement("text","1");s.appendChild(m),this.selCopies=m,m.style.cssText="position:absolute;size:1;width:30px;left:110px;top:117px;",this.FrantDiv=document.createElement("div"),n.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2;-moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",r.Browser.IE&&(document.compatMode=="BackCompat"||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=n.scrollWidth+"px",this.FrantDiv.style.height=n.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}},PreviewBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,ContentFrame:void 0,closeit:function(t){r.PreviewBox.PopDiv&&r.PreviewBox.PopDiv.parentNode&&r.PreviewBox.PopDiv.parentNode.removeChild(r.PreviewBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(t,e){var i=window.event||t;this.offsetx=i.clientX,this.offsety=i.clientY,this.tempx=parseInt(e.style.left),this.tempy=parseInt(e.style.top),this.dragapproved=!0},drag_drop:function(t,e){if(this.dragapproved){var i=window.event||t;e.style.left=i.clientX-this.offsetx+this.tempx+"px",e.style.top=i.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1,this.ContentFrame&&(this.ContentFrame.style.display="block")},create:function(t,e,i){r.PreviewBox.PopDiv&&this.closeit();var n=document.body||document.getElementsByTagName("body")[0]||document.documentElement,s=document.createElement("div");n.appendChild(s),s.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;font-size:13px;",s.style.width=e+"px";var a=(n.offsetWidth-e)/2;window.screen.width<n.offsetWidth&&(a=(window.screen.width-e)/2),a<0&&(a=0),s.style.left=a+"px",s.style.height=i+"px",s.onmousedown=function(h){r.PreviewBox.initializedrag(h,this)},s.onmouseup=function(){r.PreviewBox.stopdrag()},s.onmousemove=function(h){r.PreviewBox.drag_drop(h,this)},this.PopDiv=s;var l=document.createElement("div");s.appendChild(l),l.style.cssText="position:absolute;left:0px;width:100%;font: bold 14px Arial;line-height:27px;height:27px;text-indent:26px;color: white;background:#8BACCF",l.innerHTML="打印预览";var u=document.createElement("button");l.appendChild(u),u.style.cssText="background:transparent url("+r.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var o=document.createElement("button");l.appendChild(o),o.style.cssText="background:transparent url("+r.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",o.onclick=function(){r.PreviewBox.closeit(this)};var f=document.createElement("div");s.appendChild(f),f.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",f.style.width=e+"px",f.style.height=i-0+"px",this.ContentFrame=document.createElement("iframe"),f.appendChild(this.ContentFrame),this.ContentFrame.style.cssText="width:100%;height:100%;",this.ContentFrame.src=t,this.ContentFrame.frameBorder="no",this.FrantDiv=document.createElement("div"),n.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2; -moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",r.Browser.IE&&(document.compatMode=="BackCompat"||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=n.scrollWidth+"px",this.FrantDiv.style.height=n.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}}};if(_.CLODOP2015_7028&&_.CLODOP2015_7028.Priority&&_.CLODOP2015_7028.Priority>r.Priority){r=_.CLODOP2015_7028,_.CLODOP_OK_Priority=_.CLODOP2015_7028.Priority;return}_.LODOP=r,_.CLODOP=r,_.CLODOP2015_7028=r,_.CLODOP_OK_Priority=r.Priority,_.CLODOP.DoInit(),navigator.userAgent.indexOf("Lodop")<0&&_.CLODOP.OpenWebSocket(),_.getCLodop=function(){return window.CLODOP2015_7028}})(window);

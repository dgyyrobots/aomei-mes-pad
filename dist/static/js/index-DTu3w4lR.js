/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{V as G,d as H,r as m,f as Q,b as j,g as i,h as P,c as N,o as p,j as e,m as l,a as o,F as O,n as K,k as d,w as f,v as u,K as W,t as J,L as V,M as X}from"./index-5TqN_QR1.js";import{_ as Z}from"./DictTag.vue_vue_type_script_lang-cZQMmgs8.js";import{_ as ee}from"./ContentWrap.vue_vue_type_script_setup_true_lang-fpmIiri3.js";import{_ as te}from"./BargainRecordListDialog.vue_vue_type_script_setup_true_lang-krsnWtl9.js";import{c as ae,D as h}from"./dict-B2yk4gHf.js";import{f as F}from"./formatter-CPCKR4oB.js";import"./color-B5phLuB-.js";const oe=async y=>await G.get({url:"/promotion/bargain-record/page",params:y}),ce=H({name:"PromotionBargainRecord",__name:"index",setup(y){const g=m(!0),x=m(0),k=m([]),r=Q({pageNo:1,pageSize:10,status:null,createTime:[]}),C=m(),I=m(!1),b=async()=>{g.value=!0;try{const s=await oe(r);k.value=s.list,x.value=s.total}finally{g.value=!1}},T=()=>{r.pageNo=1,b()},M=()=>{C.value.resetFields(),T()},D=m(),S=s=>{D.value.open(s)};return j(()=>{b()}),(s,t)=>{const B=i("el-option"),L=i("el-select"),v=i("el-form-item"),$=i("el-date-picker"),_=W,c=i("el-button"),A=i("el-form"),R=ee,n=i("el-table-column"),U=i("el-image"),Y=Z,q=i("el-table"),E=X,w=P("hasPermi"),z=P("loading");return p(),N(O,null,[e(R,null,{default:l(()=>[e(A,{ref_key:"queryFormRef",ref:C,class:"-mb-15px",inline:!0,"label-width":"68px",model:o(r)},{default:l(()=>[e(v,{label:"砍价状态",prop:"status"},{default:l(()=>[e(L,{modelValue:o(r).status,"onUpdate:modelValue":t[0]||(t[0]=a=>o(r).status=a),class:"!w-240px",clearable:"",placeholder:"请选择砍价状态"},{default:l(()=>[(p(!0),N(O,null,K(o(ae)(o(h).PROMOTION_BARGAIN_RECORD_STATUS),a=>(p(),d(B,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"创建时间",prop:"createTime"},{default:l(()=>[e($,{modelValue:o(r).createTime,"onUpdate:modelValue":t[1]||(t[1]=a=>o(r).createTime=a),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(v,null,{default:l(()=>[e(c,{onClick:T},{default:l(()=>[e(_,{class:"mr-5px",icon:"ep:search"}),t[5]||(t[5]=u(" 搜索 "))]),_:1}),e(c,{onClick:M},{default:l(()=>[e(_,{class:"mr-5px",icon:"ep:refresh"}),t[6]||(t[6]=u(" 重置 "))]),_:1}),f((p(),d(c,{plain:"",type:"primary",onClick:t[2]||(t[2]=a=>s.openForm("create"))},{default:l(()=>[e(_,{class:"mr-5px",icon:"ep:plus"}),t[7]||(t[7]=u(" 新增 "))]),_:1})),[[w,["promotion:bargain-record:create"]]]),f((p(),d(c,{loading:o(I),plain:"",type:"success",onClick:s.handleExport},{default:l(()=>[e(_,{class:"mr-5px",icon:"ep:download"}),t[8]||(t[8]=u(" 导出 "))]),_:1},8,["loading","onClick"])),[[w,["promotion:bargain-record:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(R,null,{default:l(()=>[f((p(),d(q,{data:o(k),"show-overflow-tooltip":!0,stripe:!0},{default:l(()=>[e(n,{label:"编号","min-width":"50",prop:"id"}),e(n,{label:"发起用户","min-width":"120"},{default:l(a=>[e(U,{class:"h-20px w-20px","preview-src-list":[a.row.avatar],"preview-teleported":"",src:a.row.avatar},null,8,["preview-src-list","src"]),u(" "+J(a.row.nickname),1)]),_:1}),e(n,{align:"center",formatter:o(V),label:"发起时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(n,{label:"砍价活动","min-width":"150",prop:"activity.name"}),e(n,{formatter:o(F),label:"最低价","min-width":"100",prop:"activity.bargainMinPrice"},null,8,["formatter"]),e(n,{formatter:o(F),label:"当前价","min-width":"100",prop:"bargainPrice"},null,8,["formatter"]),e(n,{label:"总砍价次数","min-width":"100",prop:"activity.helpMaxCount"}),e(n,{label:"剩余砍价次数","min-width":"100",prop:"helpCount"}),e(n,{align:"center",label:"砍价状态",prop:"status"},{default:l(a=>[e(Y,{type:o(h).PROMOTION_BARGAIN_RECORD_STATUS,value:a.row.status},null,8,["type","value"])]),_:1}),e(n,{align:"center",formatter:o(V),label:"结束时间",prop:"endTime",width:"180px"},null,8,["formatter"]),e(n,{align:"center",label:"订单编号",prop:"orderId"}),e(n,{align:"center",label:"操作"},{default:l(a=>[f((p(),d(c,{link:"",type:"primary",onClick:le=>S(a.row.id)},{default:l(()=>t[9]||(t[9]=[u(" 助力 ")])),_:2},1032,["onClick"])),[[w,["promotion:bargain-help:query"]]])]),_:1})]),_:1},8,["data"])),[[z,o(g)]]),e(E,{limit:o(r).pageSize,"onUpdate:limit":t[3]||(t[3]=a=>o(r).pageSize=a),page:o(r).pageNo,"onUpdate:page":t[4]||(t[4]=a=>o(r).pageNo=a),total:o(x),onPagination:b},null,8,["limit","page","total"])]),_:1}),e(te,{ref_key:"recordListDialogRef",ref:D},null,512)],64)}}});export{ce as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 15:23:48 
 */
import{d as j,r as p,f as K,b as J,g as i,h as W,c as h,o as g,j as e,m as o,a as l,F as M,n as X,k as D,v as d,K as Z,w as ee,L as E,t as te,M as ae,z as le}from"./index-C8VsLzxx.js";import{_ as oe}from"./DictTag.vue_vue_type_script_lang-lHf-rDoT.js";import{_ as ne}from"./ContentWrap.vue_vue_type_script_setup_true_lang-DmvxiVVs.js";import{_ as re}from"./index-DEPOhjYW.js";import{_ as se}from"./MyNotifyMessageDetail.vue_vue_type_script_setup_true_lang-Ch5dmdMo.js";import{a as ie,u as F,b as pe}from"./index-BEYPSWF2.js";import{b as ce,D as w}from"./dict-_inVRzR5.js";import"./color-B5phLuB-.js";const Se=j({name:"SystemMyNotify",__name:"index",setup(ue){const b=le(),y=p(!0),S=p(0),k=p([]),r=K({pageNo:1,pageSize:10,readStatus:void 0,createTime:[]}),N=p(),m=p(),_=p([]),c=async()=>{y.value=!0;try{const n=await ie(r);k.value=n.list,S.value=n.total}finally{y.value=!1}},T=()=>{r.pageNo=1,c()},V=()=>{N.value.resetFields(),m.value.clearSelection(),T()},x=p(),Y=n=>{n.readStatus||A(n.id),x.value.open(n)},A=async n=>{await F(n),await c()},I=async()=>{await pe(),b.success("全部已读成功！"),m.value.clearSelection(),await c()},L=async()=>{_.value.length!==0&&(await F(_.value),b.success("批量已读成功！"),m.value.clearSelection(),await c())},O=n=>!n.readStatus,B=n=>{_.value=[],n&&n.forEach(a=>_.value.push(a.id))};return J(()=>{c()}),(n,a)=>{const P=re,U=i("el-option"),$=i("el-select"),v=i("el-form-item"),z=i("el-date-picker"),f=Z,u=i("el-button"),q=i("el-form"),C=ne,s=i("el-table-column"),R=oe,G=i("el-table"),H=ae,Q=W("loading");return g(),h(M,null,[e(P,{title:"站内信配置",url:"https://doc.iocoder.cn/notify/"}),e(C,null,{default:o(()=>[e(q,{ref_key:"queryFormRef",ref:N,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(r)},{default:o(()=>[e(v,{label:"是否已读",prop:"readStatus"},{default:o(()=>[e($,{modelValue:l(r).readStatus,"onUpdate:modelValue":a[0]||(a[0]=t=>l(r).readStatus=t),class:"!w-240px",clearable:"",placeholder:"请选择状态"},{default:o(()=>[(g(!0),h(M,null,X(l(ce)(l(w).INFRA_BOOLEAN_STRING),t=>(g(),D(U,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(v,{label:"发送时间",prop:"createTime"},{default:o(()=>[e(z,{modelValue:l(r).createTime,"onUpdate:modelValue":a[1]||(a[1]=t=>l(r).createTime=t),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(v,null,{default:o(()=>[e(u,{onClick:T},{default:o(()=>[e(f,{class:"mr-5px",icon:"ep:search"}),a[4]||(a[4]=d(" 搜索 "))]),_:1}),e(u,{onClick:V},{default:o(()=>[e(f,{class:"mr-5px",icon:"ep:refresh"}),a[5]||(a[5]=d(" 重置 "))]),_:1}),e(u,{onClick:L},{default:o(()=>[e(f,{class:"mr-5px",icon:"ep:reading"}),a[6]||(a[6]=d(" 标记已读 "))]),_:1}),e(u,{onClick:I},{default:o(()=>[e(f,{class:"mr-5px",icon:"ep:reading"}),a[7]||(a[7]=d(" 全部已读 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(C,null,{default:o(()=>[ee((g(),D(G,{ref_key:"tableRef",ref:m,data:l(k),"row-key":"id",onSelectionChange:B},{default:o(()=>[e(s,{"reserve-selection":!0,selectable:O,type:"selection"}),e(s,{align:"center",label:"发送人",prop:"templateNickname",width:"180"}),e(s,{align:"center",formatter:l(E),label:"发送时间",prop:"createTime",width:"200"},null,8,["formatter"]),e(s,{align:"center",label:"类型",prop:"templateType",width:"180"},{default:o(t=>[e(R,{type:l(w).SYSTEM_NOTIFY_TEMPLATE_TYPE,value:t.row.templateType},null,8,["type","value"])]),_:1}),e(s,{align:"center",label:"消息内容",prop:"templateContent","show-overflow-tooltip":""}),e(s,{align:"center",label:"是否已读",prop:"readStatus",width:"160"},{default:o(t=>[e(R,{type:l(w).INFRA_BOOLEAN_STRING,value:t.row.readStatus},null,8,["type","value"])]),_:1}),e(s,{align:"center",formatter:l(E),label:"阅读时间",prop:"readTime",width:"200"},null,8,["formatter"]),e(s,{align:"center",label:"操作",width:"160"},{default:o(t=>[e(u,{link:"",type:t.row.readStatus?"primary":"warning",onClick:de=>Y(t.row)},{default:o(()=>[d(te(t.row.readStatus?"详情":"已读"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[Q,l(y)]]),e(H,{limit:l(r).pageSize,"onUpdate:limit":a[2]||(a[2]=t=>l(r).pageSize=t),page:l(r).pageNo,"onUpdate:page":a[3]||(a[3]=t=>l(r).pageNo=t),total:l(S),onPagination:c},null,8,["limit","page","total"])]),_:1}),e(se,{ref_key:"detailRef",ref:x},null,512)],64)}}});export{Se as default};

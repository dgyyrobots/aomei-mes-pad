/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{d as j,by as D,O as E,bu as L,r as g,f as N,g as i,c as R,o as d,i as r,k as _,j as n,a,K as T,p as F,m as l,v,y as O,z as W,A as H}from"./index-DMg0mq0e.js";import{W as K}from"./main-BNO8ahC2.js";import{U as b,u as P}from"./useUpload-D_n2FN4m.js";import"./main-FYCGpp9a.js";import"./main-CGhNM1M1.js";import"./main.vue_vue_type_script_setup_true_lang-y0ETAFNo.js";import"./index-B0d6CUMe.js";import"./index-DFujHF3X.js";const q={class:"thumb-div"},G={class:"thumb-but"},J=j({__name:"CoverSelect",props:{modelValue:{},isFirst:{type:Boolean}},emits:["update:modelValue"],setup(y,{emit:U}){const u=W(),I="undefined/admin-api/mp/material/upload-permanent",V={Authorization:`Bearer ${D()}`},x=y,k=U,o=E({get(){return x.modelValue},set(e){k("update:modelValue",e)}}),m=L("accountId"),s=g(!1),p=g([]),B=N({type:b.Image,accountId:m}),h=e=>{s.value=!1,o.value.thumbMediaId=e.mediaId,o.value.thumbUrl=e.url},C=e=>P(b.Image,2)(e),M=e=>{if(e.code!==0)return u.error(`上传出错：${e.msg}`),!1;p.value=[],o.value.thumbMediaId=e.data.mediaId,o.value.thumbUrl=e.data.url},S=e=>{u.error(`上传失败: ${e.message}`)};return(e,t)=>{const $=i("el-image"),w=T,c=i("el-button"),z=i("el-upload"),A=i("el-dialog");return d(),R("div",null,[t[5]||(t[5]=r("p",null,"封面:",-1)),r("div",q,[a(o).thumbUrl?(d(),_($,{key:0,fit:"contain",src:a(o).thumbUrl,style:{width:"300px","max-height":"300px"}},null,8,["src"])):(d(),_(w,{key:1,class:F(["avatar-uploader-icon",e.isFirst?"avatar":"avatar1"]),icon:"ep:plus"},null,8,["class"])),r("div",G,[n(z,{action:I,"before-upload":C,data:a(B),"file-list":a(p),headers:V,limit:1,multiple:"","on-error":S,"on-success":M},{trigger:l(()=>[n(c,{size:"small",type:"primary"},{default:l(()=>t[2]||(t[2]=[v("本地上传")])),_:1})]),tip:l(()=>t[4]||(t[4]=[r("div",{class:"el-upload__tip"},"支持 bmp/png/jpeg/jpg/gif 格式，大小不超过 2M",-1)])),default:l(()=>[n(c,{size:"small",style:{"margin-left":"5px"},type:"primary",onClick:t[0]||(t[0]=f=>s.value=!0)},{default:l(()=>t[3]||(t[3]=[v("素材库选择")])),_:1})]),_:1},8,["data","file-list"])]),n(A,{modelValue:a(s),"onUpdate:modelValue":t[1]||(t[1]=f=>O(s)?s.value=f:null),"append-to-body":"","destroy-on-close":"",title:"选择图片",width:"80%"},{default:l(()=>[n(a(K),{"account-id":a(m),type:"image",onSelectMaterial:h},null,8,["account-id"])]),_:1},8,["modelValue"])])])}}}),le=H(J,[["__scopeId","data-v-7f930cb8"]]);export{le as default};

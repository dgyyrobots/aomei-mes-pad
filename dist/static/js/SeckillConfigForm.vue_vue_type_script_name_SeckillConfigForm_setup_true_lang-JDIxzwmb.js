/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-10 15:52:22 
 */
import{f as g,L as P,d as F,r as i,g as U,h as w,k as V,o as x,m,w as D,j as f,a as r,v as S,y as M,_ as R,N as H,z as N}from"./index-DMg0mq0e.js";import{_ as E}from"./Form-B9j6Ojul.js";import{r as n}from"./formRules-B7VVnYvt.js";import{D as I}from"./dict-BEquckDR.js";import{u as $}from"./useCrudSchemas-CGb8S5Zu.js";import{a as j,c as B,u as L}from"./seckillConfig-CAt9qwam.js";const O=g({name:[n],startTime:[n],endTime:[n],picUrl:[n],status:[n]}),q=g([{label:"秒杀时段名称",field:"name",isSearch:!0},{label:"开始时间点",field:"startTime",isSearch:!1,search:{component:"TimePicker"},form:{component:"TimePicker",componentProps:{valueFormat:"HH:mm:ss"}}},{label:"结束时间点",field:"endTime",isSearch:!1,search:{component:"TimePicker"},form:{component:"TimePicker",componentProps:{valueFormat:"HH:mm:ss"}}},{label:"秒杀轮播图",field:"sliderPicUrls",isSearch:!1,form:{component:"UploadImgs"},table:{width:300}},{label:"状态",field:"status",dictType:I.COMMON_STATUS,dictClass:"number",isSearch:!0,form:{component:"Radio"}},{label:"创建时间",field:"createTime",isForm:!1,isSearch:!1,formatter:P},{label:"操作",field:"action",isForm:!1}]),{allSchemas:z}=$(q),Z=F({__name:"SeckillConfigForm",emits:["success"],setup(A,{expose:T,emit:b}){const{t:u}=H(),d=N(),o=i(!1),p=i(""),l=i(!1),v=i(""),t=i();T({open:async(c,e)=>{if(o.value=!0,p.value=u(`action.${c}`),v.value=c,e){l.value=!0;try{const s=await j(e);s.sliderPicUrls=s.sliderPicUrls?.map(a=>({url:a})),t.value.setValues(s)}finally{l.value=!1}}}});const h=b,k=async()=>{if(!(!t||!await t.value.getElFormRef().validate())){l.value=!0;try{const e=[];t.value.formModel.sliderPicUrls.forEach(a=>{typeof a=="object"?e.push(a.url):e.push(a)});const s={...t.value.formModel,sliderPicUrls:e};v.value==="create"?(await B(s),d.success(u("common.createSuccess"))):(await L(s),d.success(u("common.updateSuccess"))),o.value=!1,h("success")}finally{l.value=!1}}};return(c,e)=>{const s=E,a=U("el-button"),C=R,y=w("loading");return x(),V(C,{modelValue:r(o),"onUpdate:modelValue":e[1]||(e[1]=_=>M(o)?o.value=_:null),title:r(p)},{footer:m(()=>[f(a,{disabled:r(l),type:"primary",onClick:k},{default:m(()=>e[2]||(e[2]=[S("确 定")])),_:1},8,["disabled"]),f(a,{onClick:e[0]||(e[0]=_=>o.value=!1)},{default:m(()=>e[3]||(e[3]=[S("取 消")])),_:1})]),default:m(()=>[D(f(s,{ref_key:"formRef",ref:t,rules:r(O),schema:r(z).formSchema},null,8,["rules","schema"]),[[y,r(l)]])]),_:1},8,["modelValue","title"])}}});export{Z as _,z as a};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as H,r as u,f as J,b as Q,g as d,h as W,k as T,o as v,m as t,w as X,j as l,a as o,i as C,c as Z,F as h,n as ee,v as V,t as le,y as I,_ as te,N as oe,z as ae}from"./index-D3eRVKjp.js";import{_ as ne}from"./UploadImg-RBMQ5RP3.js";import{g as se,c as re,u as de}from"./index-Ckc2pG6S.js";import{c as ie,D as ue}from"./dict-CqgorI4d.js";import{C as S}from"./constants-BPQb3nxh.js";import{d as me}from"./tree-vSlcEeQq.js";import{g as pe}from"./index-D3WIVxD0.js";import{g as ge}from"./index-Cu4zTWKl.js";const fe=["src"],xe=H({__name:"PickUpStoreForm",emits:["success"],setup(ce,{expose:L,emit:E}){const{t:b}=oe(),U=ae(),m=u(!1),f=u(!1),k=u(""),p=u(!1),x=u(""),n=u({id:void 0,name:"",phone:"",logo:"",detailAddress:"",introduction:"",areaId:0,openingTime:void 0,closingTime:void 0,latitude:void 0,longitude:void 0,status:S.ENABLE}),P=J({name:[{required:!0,message:"门店名称不能为空",trigger:"blur"}],logo:[{required:!0,message:"门店 logo 不能为空",trigger:"blur"}],phone:[{required:!0,message:"门店手机不能为空",trigger:"blur"},{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],areaId:[{required:!0,message:"门店所在区域不能为空",trigger:"blur"}],detailAddress:[{required:!0,message:"门店详细地址不能为空",trigger:"blur"}],openingTime:[{required:!0,message:"营业开始时间不能为空",trigger:"blur"}],closingTime:[{required:!0,message:"营业结束时间不能为空",trigger:"blur"}],latitude:[{required:!0,message:"纬度不能为空",trigger:"blur"}],longitude:[{required:!0,message:"经度不能为空",trigger:"blur"}],status:[{required:!0,message:"开启状态不能为空",trigger:"blur"}]}),_=u(),A=u(),q=u("");L({open:async(r,e)=>{if(m.value=!0,k.value=b(`action.${r}`),x.value=r,F(),e){p.value=!0;try{n.value=await se(e)}finally{p.value=!1}}}});const B=E,N=async()=>{if(!(!_||!await _.value.validate())){p.value=!0;try{const e=n.value;x.value==="create"?(await re(e),U.success(b("common.createSuccess"))):(await de(e),U.success(b("common.updateSuccess"))),m.value=!1,B("success")}finally{p.value=!1}}},F=()=>{n.value={id:void 0,name:"",phone:"",logo:"",detailAddress:"",introduction:"",areaId:void 0,openingTime:void 0,closingTime:void 0,latitude:void 0,longitude:void 0,status:S.ENABLE},_.value?.resetFields()},$=function(r){r.latlng&&r.latlng.lat&&(n.value.latitude=r.latlng.lat),r.latlng&&r.latlng.lng&&(n.value.longitude=r.latlng.lng),f.value=!1},M=async()=>{window.selectAddress=$,window.addEventListener("message",function(y){const s=y.data;s&&s.module==="locationPicker"&&window.parent.selectAddress(s)},!1);const e=(await ge()).tencentLbsKey;q.value=`https://apis.map.qq.com/tools/locpicker?type=1&key=${e}&referer=myapp`};return Q(async()=>{A.value=await pe(),await M()}),(r,e)=>{const y=ne,s=d("el-form-item"),i=d("el-col"),R=d("el-radio"),O=d("el-radio-group"),c=d("el-row"),g=d("el-input"),z=d("el-cascader"),D=d("el-time-select"),w=d("el-button"),j=d("el-form"),K=d("el-dialog"),Y=te,G=W("loading");return v(),T(Y,{modelValue:o(m),"onUpdate:modelValue":e[14]||(e[14]=a=>I(m)?m.value=a:null),title:o(k),width:"60%"},{footer:t(()=>[l(w,{disabled:o(p),type:"primary",onClick:N},{default:t(()=>e[17]||(e[17]=[V("确 定")])),_:1},8,["disabled"]),l(w,{onClick:e[12]||(e[12]=a=>m.value=!1)},{default:t(()=>e[18]||(e[18]=[V("取 消")])),_:1})]),default:t(()=>[X((v(),T(j,{ref_key:"formRef",ref:_,"label-width":"120px",model:o(n),rules:o(P)},{default:t(()=>[l(c,null,{default:t(()=>[l(i,{span:12},{default:t(()=>[l(s,{label:"门店 logo",prop:"logo"},{default:t(()=>[l(y,{modelValue:o(n).logo,"onUpdate:modelValue":e[0]||(e[0]=a=>o(n).logo=a),"is-show-tip":!1,limit:1},null,8,["modelValue"]),e[15]||(e[15]=C("div",{class:"pl-10px",style:{"font-size":"10px"}},"推荐 180x180 图片分辨率",-1))]),_:1})]),_:1}),l(i,{span:12},{default:t(()=>[l(s,{label:"门店状态",prop:"status"},{default:t(()=>[l(O,{modelValue:o(n).status,"onUpdate:modelValue":e[1]||(e[1]=a=>o(n).status=a)},{default:t(()=>[(v(!0),Z(h,null,ee(o(ie)(o(ue).COMMON_STATUS),a=>(v(),T(R,{key:a.value,label:a.value},{default:t(()=>[V(le(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[l(i,{span:12},{default:t(()=>[l(s,{label:"门店名称",prop:"name"},{default:t(()=>[l(g,{modelValue:o(n).name,"onUpdate:modelValue":e[2]||(e[2]=a=>o(n).name=a),placeholder:"请输入门店名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(i,{span:12},{default:t(()=>[l(s,{label:"门店手机",prop:"phone"},{default:t(()=>[l(g,{modelValue:o(n).phone,"onUpdate:modelValue":e[3]||(e[3]=a=>o(n).phone=a),placeholder:"请输入门店手机"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(s,{label:"门店简介",prop:"introduction"},{default:t(()=>[l(g,{modelValue:o(n).introduction,"onUpdate:modelValue":e[4]||(e[4]=a=>o(n).introduction=a),placeholder:"请输入门店简介",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1}),l(c,null,{default:t(()=>[l(i,{span:12},{default:t(()=>[l(s,{label:"门店所在地区",prop:"areaId"},{default:t(()=>[l(z,{modelValue:o(n).areaId,"onUpdate:modelValue":e[5]||(e[5]=a=>o(n).areaId=a),options:o(A),props:o(me)},null,8,["modelValue","options","props"])]),_:1})]),_:1}),l(i,{span:12},{default:t(()=>[l(s,{label:"门店详细地址",prop:"detailAddress"},{default:t(()=>[l(g,{modelValue:o(n).detailAddress,"onUpdate:modelValue":e[6]||(e[6]=a=>o(n).detailAddress=a),placeholder:"请输入门店详细地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[l(i,{span:12},{default:t(()=>[l(s,{label:"营业开始时间",prop:"openingTime"},{default:t(()=>[l(D,{modelValue:o(n).openingTime,"onUpdate:modelValue":e[7]||(e[7]=a=>o(n).openingTime=a),end:"23:30","max-time":o(n).closingTime,placeholder:"开始时间",start:"08:30",step:"00:15"},null,8,["modelValue","max-time"])]),_:1})]),_:1}),l(i,{span:12},{default:t(()=>[l(s,{label:"营业结束时间",prop:"closingTime"},{default:t(()=>[l(D,{modelValue:o(n).closingTime,"onUpdate:modelValue":e[8]||(e[8]=a=>o(n).closingTime=a),end:"23:30","min-time":o(n).openingTime,placeholder:"结束时间",start:"08:30",step:"00:15"},null,8,["modelValue","min-time"])]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[l(i,{span:12},{default:t(()=>[l(s,{label:"经度",prop:"longitude"},{default:t(()=>[l(g,{modelValue:o(n).longitude,"onUpdate:modelValue":e[9]||(e[9]=a=>o(n).longitude=a),placeholder:"请输入门店经度"},null,8,["modelValue"])]),_:1})]),_:1}),l(i,{span:12},{default:t(()=>[l(s,{label:"纬度",prop:"latitude"},{default:t(()=>[l(g,{modelValue:o(n).latitude,"onUpdate:modelValue":e[10]||(e[10]=a=>o(n).latitude=a),placeholder:"请输入门店纬度"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(s,{label:"获取经纬度"},{default:t(()=>[l(w,{type:"primary",onClick:e[11]||(e[11]=a=>f.value=!0)},{default:t(()=>e[16]||(e[16]=[V("获取")])),_:1})]),_:1})]),_:1},8,["model","rules"])),[[G,o(p)]]),l(K,{modelValue:o(f),"onUpdate:modelValue":e[13]||(e[13]=a=>I(f)?f.value=a:null),"append-to-body":"",class:"mapBox",title:"获取经纬度",width:"500px"},{default:t(()=>[C("iframe",{id:"mapPage",frameborder:"0",height:"100%",src:o(q),width:"100%"},null,8,fe)]),_:1},8,["modelValue"])]),_:1},8,["modelValue","title"])}}});export{xe as _};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 10:14:51 
 */
import{d as ee,r as f,f as te,b as le,g as s,h as U,c as h,o as m,j as t,m as o,a,J as oe,F as T,n as V,k as c,w,v as p,K as ae,t as y,x as A,L as ne,M as ie,z as re,N as se,c5 as me}from"./index-BuFigy1A.js";import{_ as pe}from"./DictTag.vue_vue_type_script_lang-DcBSip_F.js";import{_ as ce}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dq4j5fFx.js";import{_ as ue}from"./SeckillActivityForm.vue_vue_type_script_setup_true_lang-6Me7lgNS.js";import{a as de,b as fe,d as _e}from"./seckillActivity-CIS64EeZ.js";import{g as we}from"./seckillConfig-N00f0Spi.js";import{c as ge,D as I}from"./dict-Ve5yp9Dm.js";import{f as ke}from"./formatter-yC4cK5fd.js";import"./color-B5phLuB-.js";import"./Form-DbOpcpyz.js";import"./style.css_vue_type_style_index_0_src_true_lang-BB6KGiDj.js";import"./locale-Cs4A32Rl.js";import"./InputPassword-CWtSzA6D.js";import"./UploadImg-BnOMiRz9.js";import"./index-p6ysJ0Rq.js";import"./UploadImgs-OzbHnSMz.js";import"./UploadImgs.vue_vue_type_script_setup_true_lang-CQlJZsVQ.js";import"./UploadFile-CTQCbxvd.js";import"./UploadFile.vue_vue_type_script_setup_true_lang-D1xGOU-L.js";import"./SpuAndSkuList.vue_vue_type_script_setup_true_lang-Bw5vpGIA.js";import"./SkuList.vue_vue_type_script_setup_true_lang-CVzwuTvq.js";import"./SpuSelect.vue_vue_type_script_setup_true_lang-lfw87Hup.js";import"./tree-vSlcEeQq.js";import"./index-BruMDxc3.js";import"./category-DBVuNfJR.js";import"./spu-Wk_UdoYF.js";import"./formRules-BWyxeNi3.js";import"./useCrudSchemas--vLUXfOa.js";const Je=ee({name:"SeckillActivity",__name:"index",setup(ve){const g=re(),{t:L}=se(),b=f(!0),P=f(0),$=f([]),r=te({pageNo:1,pageSize:10,name:null,status:null}),D=f(),u=async()=>{b.value=!0;try{const i=await de(r);$.value=i.list,P.value=i.total}finally{b.value=!1}},x=()=>{r.pageNo=1,u()},O=()=>{D.value.resetFields(),x()},M=f(),N=(i,e)=>{M.value.open(i,e)},z=async i=>{try{await g.confirm("确认关闭该秒杀活动吗？"),await fe(i),g.success("关闭成功"),await u()}catch(e){console.log(e)}},R=async i=>{try{await g.delConfirm(),await _e(i),g.success(L("common.delSuccess")),await u()}catch(e){console.log(e)}},Y=f([]),q=i=>{const e=Y.value.find(_=>_.id===i);return e!=null?`${e.name}[${e.startTime} ~ ${e.endTime}]`:""},B=i=>{const e=Math.min(...i.map(_=>_.seckillPrice));return`￥${me(e)}`};return le(async()=>{await u(),Y.value=await we()}),(i,e)=>{const _=s("el-input"),C=s("el-form-item"),K=s("el-option"),E=s("el-select"),S=ae,d=s("el-button"),Q=s("el-form"),F=ce,n=s("el-table-column"),j=s("el-tag"),J=s("el-image"),W=pe,G=s("el-table"),H=ie,k=U("hasPermi"),X=U("loading");return m(),h(T,null,[t(F,null,{default:o(()=>[t(Q,{ref_key:"queryFormRef",ref:D,class:"-mb-15px",inline:!0,"label-width":"68px",model:a(r)},{default:o(()=>[t(C,{label:"活动名称",prop:"name"},{default:o(()=>[t(_,{modelValue:a(r).name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(r).name=l),class:"!w-240px",clearable:"",placeholder:"请输入活动名称",onKeyup:oe(x,["enter"])},null,8,["modelValue"])]),_:1}),t(C,{label:"活动状态",prop:"status"},{default:o(()=>[t(E,{modelValue:a(r).status,"onUpdate:modelValue":e[1]||(e[1]=l=>a(r).status=l),class:"!w-240px",clearable:"",placeholder:"请选择活动状态"},{default:o(()=>[(m(!0),h(T,null,V(a(ge)(a(I).COMMON_STATUS),l=>(m(),c(K,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,null,{default:o(()=>[t(d,{onClick:x},{default:o(()=>[t(S,{class:"mr-5px",icon:"ep:search"}),e[5]||(e[5]=p(" 搜索 "))]),_:1}),t(d,{onClick:O},{default:o(()=>[t(S,{class:"mr-5px",icon:"ep:refresh"}),e[6]||(e[6]=p(" 重置 "))]),_:1}),w((m(),c(d,{plain:"",type:"primary",onClick:e[2]||(e[2]=l=>N("create"))},{default:o(()=>[t(S,{class:"mr-5px",icon:"ep:plus"}),e[7]||(e[7]=p(" 新增 "))]),_:1})),[[k,["promotion:seckill-activity:create"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(F,null,{default:o(()=>[w((m(),c(G,{data:a($),"show-overflow-tooltip":!0,stripe:!0},{default:o(()=>[t(n,{label:"活动编号","min-width":"80",prop:"id"}),t(n,{label:"活动名称","min-width":"140",prop:"name"}),t(n,{label:"秒杀时段",prop:"configIds","show-overflow-tooltip":!1,width:"220px"},{default:o(l=>[(m(!0),h(T,null,V(l.row.configIds,(v,Z)=>(m(),c(j,{key:Z,class:"mr-5px"},{default:o(()=>[p(y(q(v)),1)]),_:2},1024))),128))]),_:1}),t(n,{label:"活动时间","min-width":"210"},{default:o(l=>[p(y(a(A)(l.row.startTime,"YYYY-MM-DD"))+" ~ "+y(a(A)(l.row.endTime,"YYYY-MM-DD")),1)]),_:1}),t(n,{label:"商品图片","min-width":"80",prop:"spuName"},{default:o(l=>[t(J,{class:"h-40px w-40px","preview-src-list":[l.row.picUrl],"preview-teleported":"",src:l.row.picUrl},null,8,["preview-src-list","src"])]),_:1}),t(n,{label:"商品标题","min-width":"300",prop:"spuName"}),t(n,{formatter:a(ke),label:"原价","min-width":"100",prop:"marketPrice"},null,8,["formatter"]),t(n,{label:"原价","min-width":"100",prop:"marketPrice"}),t(n,{label:"秒杀价","min-width":"100",prop:"seckillPrice"},{default:o(l=>[p(y(B(l.row.products)),1)]),_:1}),t(n,{align:"center",label:"活动状态","min-width":"100",prop:"status"},{default:o(l=>[t(W,{type:a(I).COMMON_STATUS,value:l.row.status},null,8,["type","value"])]),_:1}),t(n,{align:"center",label:"库存","min-width":"80",prop:"stock"}),t(n,{align:"center",label:"总库存","min-width":"80",prop:"totalStock"}),t(n,{align:"center",formatter:a(ne),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),t(n,{align:"center",fixed:"right",label:"操作",width:"150px"},{default:o(l=>[w((m(),c(d,{link:"",type:"primary",onClick:v=>N("update",l.row.id)},{default:o(()=>e[8]||(e[8]=[p(" 编辑 ")])),_:2},1032,["onClick"])),[[k,["promotion:seckill-activity:update"]]]),l.row.status===0?w((m(),c(d,{key:0,link:"",type:"danger",onClick:v=>z(l.row.id)},{default:o(()=>e[9]||(e[9]=[p(" 关闭 ")])),_:2},1032,["onClick"])),[[k,["promotion:seckill-activity:close"]]]):w((m(),c(d,{key:1,link:"",type:"danger",onClick:v=>R(l.row.id)},{default:o(()=>e[10]||(e[10]=[p(" 删除 ")])),_:2},1032,["onClick"])),[[k,["promotion:seckill-activity:delete"]]])]),_:1})]),_:1},8,["data"])),[[X,a(b)]]),t(H,{limit:a(r).pageSize,"onUpdate:limit":e[3]||(e[3]=l=>a(r).pageSize=l),page:a(r).pageNo,"onUpdate:page":e[4]||(e[4]=l=>a(r).pageNo=l),total:a(P),onPagination:u},null,8,["limit","page","total"])]),_:1}),t(ue,{ref_key:"formRef",ref:M,onSuccess:u},null,512)],64)}}});export{Je as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 15:23:48 
 */
import{d as z,r,f as B,b as q,g as n,h as j,k as m,o as a,m as s,w as W,a as o,l as P,j as d,c as b,F as y,n as E,v as V,y as Y,_ as A,N as G,z as H,t as J}from"./index-C8VsLzxx.js";import{g as K}from"./index-Dn2rRtuI.js";import{c as Q,u as X,P as Z}from"./index-WQkmFZZM.js";import{c as h,D as ee}from"./dict-_inVRzR5.js";const ne=z({name:"CrmPermissionForm",__name:"PermissionForm",emits:["success"],setup(oe,{expose:F,emit:R}){const{t:p}=G(),k=H(),u=r(!1),I=r(""),c=r(!1),_=r(""),w=r([]),t=r({userId:void 0,bizType:void 0,bizId:void 0,level:void 0}),x=B({userId:[{required:!0,message:"人员不能为空",trigger:"blur"}],level:[{required:!0,message:"权限级别不能为空",trigger:"blur"}]}),f=r();F({open:async(i,e,g,v)=>{u.value=!0,I.value=`${p(`action.${i}`)}团队成员`,_.value=i,S(e,g),v&&(t.value.ids=v)}});const L=R,N=async()=>{if(!(!f||!await f.value.validate())){c.value=!0;try{const e=t.value;_.value==="create"?(await Q(o(e)),k.success(p("common.createSuccess"))):(await X(o(e)),k.success(p("common.updateSuccess"))),u.value=!1,L("success")}finally{c.value=!1}}},S=(i,e)=>{f.value?.resetFields(),t.value={userId:void 0,bizType:i,bizId:e,level:void 0}};return q(async()=>{w.value=await K()}),(i,e)=>{const g=n("el-option"),v=n("el-select"),C=n("el-form-item"),T=n("el-radio"),M=n("el-radio-group"),O=n("el-form"),D=n("el-button"),U=A,$=j("loading");return a(),m(U,{modelValue:o(u),"onUpdate:modelValue":e[3]||(e[3]=l=>Y(u)?u.value=l:null),title:o(I),width:"30%"},{footer:s(()=>[d(D,{disabled:o(c),type:"primary",onClick:N},{default:s(()=>e[4]||(e[4]=[V("确 定")])),_:1},8,["disabled"]),d(D,{onClick:e[2]||(e[2]=l=>u.value=!1)},{default:s(()=>e[5]||(e[5]=[V("取 消")])),_:1})]),default:s(()=>[W((a(),m(O,{ref_key:"formRef",ref:f,"label-width":"100px",model:o(t),rules:o(x)},{default:s(()=>[o(_)==="create"?(a(),m(C,{key:0,label:"选择人员",prop:"userId"},{default:s(()=>[d(v,{modelValue:o(t).userId,"onUpdate:modelValue":e[0]||(e[0]=l=>o(t).userId=l)},{default:s(()=>[(a(!0),b(y,null,E(o(w),l=>(a(),m(g,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):P("",!0),d(C,{label:"权限级别",prop:"level"},{default:s(()=>[d(M,{modelValue:o(t).level,"onUpdate:modelValue":e[1]||(e[1]=l=>o(t).level=l)},{default:s(()=>[(a(!0),b(y,null,E(o(h)(o(ee).CRM_PERMISSION_LEVEL),l=>(a(),b(y,{key:l.value},[l.value!=o(Z).OWNER?(a(),m(T,{key:0,label:l.value},{default:s(()=>[V(J(l.label),1)]),_:2},1032,["label"])):P("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[$,o(c)]])]),_:1},8,["modelValue","title"])}}});export{ne as _};

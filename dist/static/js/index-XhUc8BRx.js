/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 10:14:51 
 */
import{V as so,W as io,O as _e,r as i,f as q,b as po,X as ae,R as mo,Y as Te,g as P,h as te,c as ye,o as _,w as T,j as o,Z as Oe,m as a,J as ne,a as I,D as fo,v,$ as co,k as b,a0 as be,a1 as vo,G as go,a2 as No,i as S,t as De,x as _o,C as Pe,M as To,F as yo,n as Oo,a3 as bo,a4 as m,T as X,a5 as Do}from"./index-BuFigy1A.js";import{_ as Po}from"./DictTag.vue_vue_type_script_lang-DcBSip_F.js";import{g as So,a as Se,c as wo,e as Eo,d as Io,u as Ro,b as Lo,f as Vo,s as Co,h as zo,i as Ao,j as ho}from"./index-DAtDkzWx.js";import"./CLodopfuncs2-DO7GswBP.js";import{l as ko}from"./index-00Ek29wB.js";import{D as we}from"./dict-Ve5yp9Dm.js";import"./color-B5phLuB-.js";const xo=async()=>await so.get({url:"/wms/warehouse/getTreeList"}),Uo={class:"app-container"},Fo={class:"dialog-footer"},Mo={class:"dialog-footer"},qo={style:{"text-align":"right","margin-top":"20px"}},Xo={class:"dialog-footer"},Yo={class:"dialog-footer"},Ko={__name:"index",setup(Qo){const ue=io(),s=_e(()=>ue.currentSize==="mini"?"small":ue.currentSize),A=i(null),h=i(null),w=i(!0),j=i(!1),J=i(!0),Y=i(0),$=i([]),k=i([]),Q=i(""),K=i(!0),re=i(!0),x=i(!1),R=i(!1),se=i([]),p=i([]),V=i(1),z=i(!1),U=i(!1),ie=i(null),B=i(null),de=i(null),Ee=i(null),Ie=i(null),pe=i(null),Re=i(null),y=q({pageNo:1,pageSize:10,purchaseId:null,goodsNumber:null,goodsName:null,goodsSpecs:null,company:null,monovalent:null,quantity:null,taxes:null,total:null,categoryName:null,brandName:null,createTime:[]}),c=q({}),g=q({}),f=q({poNo:"",goodsNumber:"",receiveNum:"",unitOfMeasure:""}),O=i([]),D=q({splitQuantity:"",splitCount:""}),Z=i([]),Le={multiple:!1,value:"pId",label:"pName"},me={poNo:[{required:!0,message:"采购单号不能为空",trigger:"blur"}],goodsNumber:[{required:!0,message:"商品编号不能为空",trigger:"blur"}],company:[{required:!0,message:"商品单位不能为空",trigger:"blur"}],quantity:[{required:!0,message:"采购数量不能为空",trigger:"blur"}],receiveNum:[{required:!0,message:"收货数量不能为空",trigger:"blur"}],unitOfMeasure:[{required:!0,message:"收货单位不能为空",trigger:"blur"}]};_e(()=>p.value.length>0);const Ve=()=>{g.poNo="",A.value=null},E=async()=>{w.value=!0;try{const l=await So(y);$.value=l.list,Y.value=l.total}finally{w.value=!1}},F=()=>{y.pageNo=1,$.value=[],Y.value=0,E()},Ce=()=>{ie.value?.resetFields(),Object.assign(y,{pageNo:1,pageSize:10,poNo:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0,createTime:[]}),F()},ze=l=>{p.value=l,K.value=l.length!==1,re.value=!l.length},Ae=l=>{pe.value?.toggleRowSelection(l)},ee=()=>{x.value=!1,R.value=!1,k.value=[],z.value=!1,V.value=1,fe()},fe=()=>{Object.assign(c,{id:void 0,purchaseId:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0}),Object.assign(g,{id:void 0,purchaseId:void 0,goodsNumber:void 0,goodsName:void 0,goodsSpecs:void 0,company:void 0,monovalent:void 0,quantity:void 0,taxes:void 0,total:void 0,categoryName:void 0,brandName:void 0}),B.value?.resetFields(),de.value?.resetFields()},ce=()=>{R.value&&h.value&&ae(()=>{h.value.focus(),isFocused.value=!0})};po(()=>{E(),Qe(),window.addEventListener("keydown",ve),document.addEventListener("click",()=>{R.value&&ce()}),ae(()=>{setTimeout(ce,500)})}),mo(()=>{he()});const he=()=>{window.removeEventListener("keydown",ve,!1)};Te(()=>A.value,l=>{if(typeof l=="string"&&l.includes("{")&&l.includes("}")){console.log('输入内容包含完整的 "{" 和 "}"');try{const e=JSON.parse(l);e&&e.po_no&&(g.poNo=e.po_no,oe())}catch{m.error("扫描结果不是有效的 JSON 字符串")}}else typeof l=="object"&&l.po_no?(g.poNo=l.po_no,oe()):console.log('输入内容不包含完整的 "{" 和 "}"')}),Te(()=>R.value,l=>{l&&ae(()=>{setTimeout(()=>{h.value&&(h.value.focus(),console.log("设置焦点成功"))},300)})});const ve=l=>{l.keyCode===13&&(console.log(l,"eeeeeeeeeeee"),A.value=l.target.value)},ke=async l=>{fe();const e=l.id||p.value[0].id;if(l.status===2){m.error("该单据已入库，禁止修改！");return}try{const n=await ko();se.value=n;const u=await Se(e);u.unitOfMeasure=u.unitOfMeasure||u.company,Object.assign(c,u),x.value=!0,Q.value="修改采购商品明细"}catch(n){console.error("获取数据失败:",n)}},xe=async()=>{if(B.value)try{await B.value.validate(),c.id!=null?(await Ro(c),m.success("修改成功")):(await Lo(c),m.success("新增成功")),x.value=!1,E()}catch(l){console.error("提交失败:",l)}},Ue=async l=>{const e=l.id;try{await X.confirm('是否确认删除采购商品明细编号为"'+e+'"的数据项?'),await Io(e),E(),m.success("删除成功")}catch(n){console.error("删除失败:",n)}},Fe=async()=>{const l={...y};delete l.pageNo,delete l.pageSize;try{await X.confirm("是否确认导出所有采购商品明细数据项?"),j.value=!0;const e=await Eo(l);console.log("response",e),Do.excel(e,"采购商品明细.xls"),m.success("导出成功")}catch(e){console.error("导出失败:",e)}finally{j.value=!1}},Me=async()=>{try{const l=await wo(p.value[0].poNo);if(!l){m.error("采购单: "+p.value[0].poNo+"存在未配置单位与收货数量的明细信息，请先配置后打印！");return}if(!Array.isArray(l.data)){console.error("结果不是一个数组: ",l);return}await X.confirm("确认打印？"),console.log("开始循环: "+l),LODOP.PRINT_INITA(0,0,150,100),LODOP.SET_PRINT_PAGESIZE(2,"","","热敏纸");for(const e of l.data){console.log("数据解析: ",e),LODOP.NEWPAGE(),LODOP.ADD_PRINT_RECT(8,5,150*3.71-10,100*3.71-10,0,1),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("FontName","Microsoft YaHei"),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.SET_PRINT_STYLE("Horient",2),LODOP.ADD_PRINT_TEXT(13,0,150,30,"入库单标签"),LODOP.SET_PRINT_STYLE("FontSize",14),LODOP.SET_PRINT_STYLE("Bold",0),LODOP.SET_PRINT_STYLE("Horient",0),LODOP.ADD_PRINT_TEXT(65,15,120,35,"条码编号:"),LODOP.ADD_PRINT_TEXT(65,120,280,35,e.id),LODOP.ADD_PRINT_TEXT(110,15,120,35,"采购料号:"),LODOP.ADD_PRINT_TEXT(110,120,280,35,e.goodsNumber),LODOP.ADD_PRINT_TEXT(155,15,120,35,"物料名称:"),LODOP.ADD_PRINT_TEXT(155,120,280,35,e.goodsName+e.goodsSpecs),LODOP.ADD_PRINT_TEXT(200,15,120,35,"采购单号:"),LODOP.ADD_PRINT_TEXT(200,120,280,35,e.poNo),LODOP.ADD_PRINT_TEXT(245,15,120,35,"收货数量:"),LODOP.ADD_PRINT_TEXT(245,120,280,35,e.receiveNum+e.unitOfMeasure),LODOP.ADD_PRINT_TEXT(290,15,120,35,"批次号:"),LODOP.ADD_PRINT_TEXT(290,120,280,35,e.batchCode),LODOP.ADD_PRINT_TEXT(335,15,120,35,"收货日期:");const n=new Date(e.receiveTime).toISOString().slice(0,19).replace("T"," ");LODOP.ADD_PRINT_TEXT(335,120,280,35,n);const u={id:e.id,type:"purchase",po_no:e.poNo};LODOP.ADD_PRINT_BARCODE(220,390,170,170,"QRCode",JSON.stringify(u))}LODOP.SET_PRINT_MODE("AUTO_CLOSE_PREWINDOW",1),LODOP.PREVIEW(),await Ye(p.value[0].poNo)}catch(l){console.error("打印失败:",l)}},qe=async()=>{try{for(let l=0;l<p.value.length;l++){if(!p.value[l].receiveNum){m.error("请先确认第"+(l+1)+"行的收货数量");return}if(!p.value[l].unitOfMeasure){m.error("请先确认第"+(l+1)+"行的收货单位");return}}await X.confirm("确认批量打印？"),LODOP.PRINT_INITA(0,0,150,100),LODOP.SET_PRINT_PAGESIZE(2,"","","热敏纸");for(const l of p.value.map(e=>e.id)){const n=await Se(l);LODOP.NEWPAGE(),LODOP.ADD_PRINT_RECT(8,5,150*3.71-10,100*3.71-10,0,1),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("FontName","Microsoft YaHei"),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.SET_PRINT_STYLE("Horient",2),LODOP.ADD_PRINT_TEXT(13,0,150,30,"入库单标签"),LODOP.SET_PRINT_STYLE("FontSize",14),LODOP.SET_PRINT_STYLE("Bold",0),LODOP.SET_PRINT_STYLE("Horient",0),LODOP.ADD_PRINT_TEXT(65,15,120,35,"条码编号:"),LODOP.ADD_PRINT_TEXT(65,120,280,35,n.id),LODOP.ADD_PRINT_TEXT(110,15,120,35,"采购料号:"),LODOP.ADD_PRINT_TEXT(110,120,280,35,n.goodsNumber),LODOP.ADD_PRINT_TEXT(155,15,120,35,"物料名称:"),LODOP.ADD_PRINT_TEXT(155,120,280,35,n.goodsName+n.goodsSpecs),LODOP.ADD_PRINT_TEXT(200,15,120,35,"采购单号:"),LODOP.ADD_PRINT_TEXT(200,120,280,35,n.poNo),LODOP.ADD_PRINT_TEXT(245,15,120,35,"收货数量:"),LODOP.ADD_PRINT_TEXT(245,120,280,35,n.receiveNum+n.unitOfMeasure),LODOP.ADD_PRINT_TEXT(290,15,120,35,"批次号:"),LODOP.ADD_PRINT_TEXT(290,120,280,35,n.batchCode),LODOP.ADD_PRINT_TEXT(335,15,120,35,"收货日期:");const u=new Date(n.receiveTime).toISOString().slice(0,19).replace("T"," ");LODOP.ADD_PRINT_TEXT(335,120,280,35,u);const r={id:n.id,type:"purchase",po_no:n.poNo};LODOP.ADD_PRINT_BARCODE(220,390,170,170,"QRCode",JSON.stringify(r))}LODOP.SET_PRINT_MODE("AUTO_CLOSE_PREWINDOW",1),LODOP.PREVIEW(),await Xe()}catch(l){console.error("批量打印失败:",l)}},Xe=async()=>{try{await Ao(p.value),m.success("打印成功"),E()}catch(l){console.error("更新状态失败:",l)}},Ye=async l=>{try{await ho(l),m.success("打印成功"),E()}catch(e){console.error("批量更新状态失败:",e)}},Qe=async()=>{try{const l=await xo();Z.value=l,Z.value.map(e=>{e.pId=e.id,e.pName=e.warehouseName,e.children.map(u=>{let r=JSON.stringify(u.children).replace(/locationId/g,"lId").replace(/areaId/g,"pId").replace(/areaName/g,"pName");u.children=JSON.parse(r)});let n=JSON.stringify(e.children).replace(/warehouseId/g,"wId").replace(/locationId/g,"pId").replace(/locationName/g,"pName");e.children=JSON.parse(n)})}catch(l){console.error("获取仓库列表失败:",l)}},Be=l=>{l!=null&&(g.warehouseId=l[0],g.locationId=l[1],g.areaId=l[2])},He=()=>{R.value=!0,Q.value="一键入库"},Ge=async()=>{try{for(const n of k.value)if(n.status===0){m.error("存在未打印的单据, 物料号: "+n.goodsNumber+"，请先打印条码!");return}if(!g.wareHouse){m.error("请选择要入库的位置!");return}const l={poNo:g.poNo,warehouseId:g.warehouseId,locationId:g.locationId,areaId:g.areaId};w.value=!0;const e=await Co(l);if(e!=="success"){m.error("入库失败, 请联系系统管理员, 问题如下: "+e);return}R.value=!1,E(),g.poNo="",k.value=[],m.success("入库成功")}catch(l){console.error("入库失败:",l)}finally{w.value=!1}},oe=async()=>{if(g.poNo){w.value=!0;try{const l=await Vo(g);k.value=l}finally{w.value=!1}}},We=l=>{scanResult.value=l},je=()=>{if(p.value.length===0){m.warning("请选择至少一项进行拆分");return}if(!p.value[0].receiveNum){m.warning("请先填写收货数量");return}Object.assign(f,{id:p.value[0].id,poNo:p.value[0].poNo,goodsNumber:p.value[0].goodsNumber,receiveNum:p.value[0].receiveNum,unitOfMeasure:p.value[0].unitOfMeasure}),O.value=p.value.map(l=>({index:V.value,poNo:l.poNo,goodsNumber:l.goodsNumber,unitOfMeasure:l.unitOfMeasure,quantity:""})),z.value=!0},Je=()=>{const l=parseFloat(f.receiveNum);if(O.value.reduce((u,r)=>u+(parseFloat(r.quantity)||0),0)>=l){m.error("拆分数量总和不能超过采购数量");return}V.value+=1;const n={index:V.value,poNo:f.poNo,goodsNumber:f.goodsNumber,unitOfMeasure:f.unitOfMeasure,quantity:""};O.value.push(n)},$e=async()=>{try{await X.confirm("是否基于当前采购数量"+f.receiveNum+"追加拆分行?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const l=parseFloat(f.receiveNum),e=[];let n=0;for(let u=0;u<l;u++)e.push({index:u+1,poNo:f.poNo,goodsNumber:f.goodsNumber,unitOfMeasure:f.unitOfMeasure,quantity:1}),n++;V.value=n+1,O.value=e}catch{}},Ke=l=>{O.value.splice(l,1),O.value.forEach((e,n)=>{e.index=n+1}),O.value.length>0?l.value=Math.max(...O.value.map(e=>e.index)):l.value=0},Ze=async()=>{const l=O.value.reduce((n,u)=>n+(parseFloat(u.quantity)||0),0).toFixed(4);if(parseFloat(l)>parseFloat(f.receiveNum)){m.error("拆分数量总和不能超过采购数量");return}for(const n of O.value)if(!n.quantity||parseFloat(n.quantity)===0){m.error("拆分行的数量禁止为空或0");return}const e={id:f.id,poNo:f.poNo,goodsNumber:f.goodsNumber,splitDetails:O.value};w.value=!0;try{await zo(e),z.value=!1,E(),V.value=1,m.success("拆分成功")}catch(n){console.error("拆分失败:",n)}finally{w.value=!1}},eo=()=>{if(p.value.length===0){m.warning("请选择至少一项进行拆分");return}if(!p.value[0].receiveNum){m.warning("请先填写收货数量");return}U.value=!0},oo=()=>{if(!D.splitQuantity||!D.splitCount){m.error("拆分数量和拆分个数不能为空");return}const l=parseFloat(D.splitQuantity),e=parseInt(D.splitCount,10);if(l*e>p.value[0].receiveNum){m.error("拆分数量乘以拆分个数不能大于当前的入库数量");return}O.value=[];for(let n=0;n<e;n++)O.value.push({index:n+1,poNo:p.value[0].poNo,goodsNumber:p.value[0].goodsNumber,unitOfMeasure:p.value[0].unitOfMeasure,quantity:l});V.value=O.value.length+1,U.value=!1,z.value=!0,D.splitQuantity="",D.splitCount=""},lo=()=>{U.value=!1,D.splitQuantity="",D.splitCount=""};return(l,e)=>{const n=P("el-input"),u=P("el-form-item"),r=P("el-button"),M=P("el-form"),N=P("el-col"),ao=P("right-toolbar"),L=P("el-row"),d=P("el-table-column"),ge=Po,le=P("el-table"),to=To,no=P("el-option"),uo=P("el-select"),H=P("el-dialog"),ro=P("el-cascader"),C=te("hasPermi"),Ne=te("loading"),G=te("dialogDrag");return _(),ye("div",Uo,[T(o(M,{model:y,ref_key:"queryFormRef",ref:ie,size:s.value,inline:!0},{default:a(()=>[o(u,{label:"采购单号",prop:"goodsNumber"},{default:a(()=>[o(n,{modelValue:y.poNo,"onUpdate:modelValue":e[0]||(e[0]=t=>y.poNo=t),placeholder:"请输入采购单号",clearable:"",onKeyup:ne(F,["enter"])},null,8,["modelValue"])]),_:1}),o(u,{label:"商品编号",prop:"goodsNumber"},{default:a(()=>[o(n,{modelValue:y.goodsNumber,"onUpdate:modelValue":e[1]||(e[1]=t=>y.goodsNumber=t),placeholder:"请输入商品编号",clearable:"",onKeyup:ne(F,["enter","native"])},null,8,["modelValue"])]),_:1}),o(u,{label:"商品名称",prop:"goodsName"},{default:a(()=>[o(n,{modelValue:y.goodsName,"onUpdate:modelValue":e[2]||(e[2]=t=>y.goodsName=t),placeholder:"请输入商品名称",clearable:"",onKeyup:ne(F,["enter","native"])},null,8,["modelValue"])]),_:1}),o(u,null,{default:a(()=>[o(r,{type:"primary",icon:I(fo),onClick:F},{default:a(()=>e[28]||(e[28]=[v("搜索")])),_:1},8,["icon"]),o(r,{icon:I(co),onClick:Ce},{default:a(()=>e[29]||(e[29]=[v("重置")])),_:1},8,["icon"])]),_:1})]),_:1},8,["model","size"]),[[Oe,J.value]]),o(L,{gutter:10,class:"mb8"},{default:a(()=>[o(N,{span:1.5},{default:a(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(be),size:s.value,disabled:re.value,onClick:qe},{default:a(()=>e[30]||(e[30]=[v("批量打印")])),_:1},8,["icon","size","disabled"])),[[C,["purchase:goods:print"]]])]),_:1}),o(N,{span:1.5},{default:a(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(be),size:s.value,disabled:K.value,onClick:Me},{default:a(()=>e[31]||(e[31]=[v("单据打印")])),_:1},8,["icon","size","disabled"])),[[C,["purchase:goods:print"]]])]),_:1}),o(N,{span:1.5},{default:a(()=>[T((_(),b(r,{type:"warning",plain:"",icon:I(vo),size:s.value,onClick:He},{default:a(()=>e[32]||(e[32]=[v("一键入库")])),_:1},8,["icon","size"])),[[C,["purchase:goods:warehousing"]]])]),_:1}),o(N,{span:1.5},{default:a(()=>[T((_(),b(r,{type:"warning",plain:"",icon:I(go),size:s.value,onClick:Fe,loading:j.value},{default:a(()=>e[33]||(e[33]=[v("导出")])),_:1},8,["icon","size","loading"])),[[C,["purchase:goods:export"]]])]),_:1}),o(N,{span:1.5},{default:a(()=>[T((_(),b(r,{type:"primary",plain:"",icon:I(No),size:s.value,disabled:K.value,onClick:je},{default:a(()=>e[34]||(e[34]=[v("拆分")])),_:1},8,["icon","size","disabled"])),[[C,["purchase:goods:split"]]])]),_:1}),o(ao,{showSearch:J.value,"onUpdate:showSearch":e[3]||(e[3]=t=>J.value=t),onQueryTable:E},null,8,["showSearch"])]),_:1}),T((_(),b(le,{data:$.value,onSelectionChange:ze,size:s.value,ref_key:"multipleTableRef",ref:pe,onRowClick:Ae},{default:a(()=>[o(d,{type:"selection",width:"55",align:"center"}),o(d,{label:"单据编码",align:"center",prop:"id"}),o(d,{label:"采购单号",align:"center",prop:"poNo"}),o(d,{label:"商品编号",align:"center",prop:"goodsNumber"}),o(d,{"show-overflow-tooltip":!0,label:"商品名称",align:"center",prop:"goodsName"}),o(d,{"show-overflow-tooltip":!0,label:"商品规格",align:"center",prop:"goodsSpecs"}),o(d,{label:"商品单位",align:"center",prop:"company"}),o(d,{label:"采购数量",align:"center",prop:"quantity"}),o(d,{label:"收货数量",align:"center",prop:"receiveNum"}),o(d,{label:"创建时间",align:"center",prop:"createTime",width:"180",formatter:l.dateFormatter},{default:a(t=>[S("span",null,De(I(_o)(t.row.createTime,"YYYY-MM-DD HH:mm")),1)]),_:1},8,["formatter"]),o(d,{label:"入库状态",prop:"status",width:"80"},{default:a(t=>[o(ge,{type:I(we).PURCHASE_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),o(d,{width:"150",fixed:"right",label:"操作",align:"center","class-name":"small-padding fixed-width"},{default:a(t=>[T((_(),b(r,{size:s.value,type:"text",onClick:Pe(W=>ke(t.row),["stop"])},{default:a(()=>e[35]||(e[35]=[v("修改")])),_:2},1032,["size","onClick"])),[[C,["purchase:goods:update"]]]),T((_(),b(r,{size:s.value,type:"text",onClick:Pe(W=>Ue(t.row),["stop"])},{default:a(()=>e[36]||(e[36]=[v("删除")])),_:2},1032,["size","onClick"])),[[C,["purchase:goods:delete"]]])]),_:1})]),_:1},8,["data","size"])),[[Ne,w.value]]),T(o(to,{size:"currentSize",total:Y.value,page:y.pageNo,"onUpdate:page":e[4]||(e[4]=t=>y.pageNo=t),limit:y.pageSize,"onUpdate:limit":e[5]||(e[5]=t=>y.pageSize=t),onPagination:E},null,8,["total","page","limit"]),[[Oe,Y.value>0]]),T((_(),b(H,{title:Q.value,modelValue:x.value,"onUpdate:modelValue":e[15]||(e[15]=t=>x.value=t),width:"65%","append-to-body":""},{footer:a(()=>[S("div",Fo,[o(r,{size:s.value,type:"primary",onClick:xe},{default:a(()=>e[37]||(e[37]=[v("确 定")])),_:1},8,["size"]),o(r,{size:s.value,onClick:ee},{default:a(()=>e[38]||(e[38]=[v("取 消")])),_:1},8,["size"])])]),default:a(()=>[o(M,{ref_key:"formRef",ref:B,model:c,rules:me,size:s.value},{default:a(()=>[o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:a(()=>[o(n,{disabled:"",modelValue:c.poNo,"onUpdate:modelValue":e[6]||(e[6]=t=>c.poNo=t),placeholder:"请输入采购单号"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"商品编号",prop:"goodsNumber"},{default:a(()=>[o(n,{disabled:"",modelValue:c.goodsNumber,"onUpdate:modelValue":e[7]||(e[7]=t=>c.goodsNumber=t),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"商品名称",prop:"goodsName"},{default:a(()=>[o(n,{disabled:"",modelValue:c.goodsName,"onUpdate:modelValue":e[8]||(e[8]=t=>c.goodsName=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"商品规格",prop:"goodsSpecs"},{default:a(()=>[o(n,{disabled:"",modelValue:c.goodsSpecs,"onUpdate:modelValue":e[9]||(e[9]=t=>c.goodsSpecs=t),placeholder:"请输入商品规格"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"商品单位",prop:"company"},{default:a(()=>[o(n,{disabled:"",modelValue:c.company,"onUpdate:modelValue":e[10]||(e[10]=t=>c.company=t),placeholder:"请输入商品单位"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"采购数量",prop:"quantity"},{default:a(()=>[o(n,{disabled:"",modelValue:c.quantity,"onUpdate:modelValue":e[11]||(e[11]=t=>c.quantity=t),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"收货数量",prop:"receiveNum"},{default:a(()=>[o(n,{modelValue:c.receiveNum,"onUpdate:modelValue":e[12]||(e[12]=t=>c.receiveNum=t),placeholder:"请输入收货数量"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"收货单位"},{default:a(()=>[o(uo,{filterable:"",clearable:"",onFocus:e[13]||(e[13]=t=>t.target.blur()),modelValue:c.unitOfMeasure,"onUpdate:modelValue":e[14]||(e[14]=t=>c.unitOfMeasure=t),width:"100%",placeholder:"请选择"},{default:a(()=>[(_(!0),ye(yo,null,Oo(se.value,t=>(_(),b(no,{key:t.measureCode,label:t.measureName,value:t.measureCode},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"])]),_:1},8,["title","modelValue"])),[[G]]),T((_(),b(H,{title:Q.value,modelValue:R.value,"onUpdate:modelValue":e[19]||(e[19]=t=>R.value=t),width:"75%","append-to-body":""},{footer:a(()=>[S("div",Mo,[o(r,{size:s.value,type:"primary",onClick:Ge},{default:a(()=>e[41]||(e[41]=[v("确 定")])),_:1},8,["size"]),o(r,{size:s.value,onClick:ee},{default:a(()=>e[42]||(e[42]=[v("取 消")])),_:1},8,["size"])])]),default:a(()=>[o(M,{ref_key:"wareFormRef",ref:de,model:g,rules:me,size:s.value},{default:a(()=>[o(L,{gutter:20},{default:a(()=>[o(N,{span:8},{default:a(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:a(()=>[o(n,{modelValue:g.poNo,"onUpdate:modelValue":e[16]||(e[16]=t=>g.poNo=t),placeholder:"请输入采购单号",onBlur:oe,onInput:We},null,8,["modelValue"]),T(S("input",{ref_key:"scannerInput",ref:h,"onUpdate:modelValue":e[17]||(e[17]=t=>A.value=t),placeholder:"请输入",style:{position:"absolute",opacity:"0",width:"0",height:"0","z-index":"-1","-webkit-user-select":"none"},inputmode:"none",autofocus:""},null,512),[[bo,A.value]]),e[39]||(e[39]=S("span",null,"支持扫码枪扫描",-1))]),_:1})]),_:1}),o(N,{span:4},{default:a(()=>[o(r,{type:"primary",round:"",onClick:Ve},{default:a(()=>e[40]||(e[40]=[v("重置")])),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"仓库信息",prop:"goodsNumber"},{default:a(()=>[o(ro,{modelValue:g.wareHouse,"onUpdate:modelValue":e[18]||(e[18]=t=>g.wareHouse=t),options:Z.value,props:Le,onChange:Be},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),T((_(),b(le,{data:k.value,height:"500",size:s.value},{default:a(()=>[o(d,{label:"商品编号",align:"center",prop:"goodsNumber"}),o(d,{label:"商品名称",align:"center",prop:"goodsName"}),o(d,{label:"商品规格",align:"center",prop:"goodsSpecs"}),o(d,{label:"商品单位",align:"center",prop:"company"}),o(d,{label:"采购数量",align:"center",prop:"quantity"}),o(d,{label:"收货数量",align:"center",prop:"receiveNum"}),o(d,{label:"创建时间",align:"center",prop:"createTime"},{default:a(t=>[S("span",null,De(l.parseTime(t.row.createTime)),1)]),_:1}),o(d,{label:"入库状态",prop:"status",width:"80"},{default:a(t=>[o(ge,{type:I(we).PURCHASE_STATUS,value:t.row.status},null,8,["type","value"])]),_:1})]),_:1},8,["data","size"])),[[Ne,w.value]])]),_:1},8,["model","size"]),S("div",null,[S("video",{ref_key:"videoCameraRef",ref:Re,style:{display:"none"}},null,512)])]),_:1},8,["title","modelValue"])),[[G]]),T((_(),b(H,{title:"拆分详情",modelValue:z.value,"onUpdate:modelValue":e[24]||(e[24]=t=>z.value=t),width:"80%","append-to-body":""},{footer:a(()=>[S("div",Xo,[o(r,{size:s.value,onClick:ee},{default:a(()=>e[47]||(e[47]=[v("取消")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:Ze},{default:a(()=>e[48]||(e[48]=[v("确定拆分")])),_:1},8,["size"])])]),default:a(()=>[o(M,{ref_key:"splitFormRef",ref:Ee,model:f,size:s.value},{default:a(()=>[o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"采购单号",prop:"poNo"},{default:a(()=>[o(n,{disabled:"",modelValue:f.poNo,"onUpdate:modelValue":e[20]||(e[20]=t=>f.poNo=t),placeholder:"请输入采购单号"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"商品编号",prop:"goodsNumber"},{default:a(()=>[o(n,{disabled:"",modelValue:f.goodsNumber,"onUpdate:modelValue":e[21]||(e[21]=t=>f.goodsNumber=t),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(L,{gutter:20},{default:a(()=>[o(N,{span:12},{default:a(()=>[o(u,{label:"入库数量",prop:"quantity"},{default:a(()=>[o(n,{disabled:"",modelValue:f.receiveNum,"onUpdate:modelValue":e[22]||(e[22]=t=>f.receiveNum=t),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1}),o(N,{span:12},{default:a(()=>[o(u,{label:"入库单位",prop:"unitOfMeasure"},{default:a(()=>[o(n,{disabled:"",modelValue:f.unitOfMeasure,"onUpdate:modelValue":e[23]||(e[23]=t=>f.unitOfMeasure=t),placeholder:"请输入采购数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","size"]),S("div",qo,[o(r,{size:s.value,type:"primary",onClick:eo},{default:a(()=>e[43]||(e[43]=[v("按条件拆分")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:$e},{default:a(()=>e[44]||(e[44]=[v("按数量拆分")])),_:1},8,["size"]),o(r,{size:s.value,type:"primary",onClick:Je},{default:a(()=>e[45]||(e[45]=[v("新增")])),_:1},8,["size"])]),o(le,{data:O.value,style:{width:"100%"},"max-height":"400",size:s.value},{default:a(()=>[o(d,{prop:"index",label:"序号",width:"60"}),o(d,{prop:"poNo",label:"采购单号",width:"180"}),o(d,{prop:"goodsNumber",label:"物料料号",width:"180"}),o(d,{prop:"unitOfMeasure",label:"物料单位",width:"180"}),o(d,{prop:"quantity",label:"数量"},{default:a(t=>[o(n,{modelValue:t.row.quantity,"onUpdate:modelValue":W=>t.row.quantity=W,type:"number",placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(d,{label:"操作",width:"100"},{default:a(t=>[o(r,{size:s.value,type:"text",icon:"el-icon-delete",onClick:W=>Ke(t.$index)},{default:a(()=>e[46]||(e[46]=[v("删除")])),_:2},1032,["size","onClick"])]),_:1})]),_:1},8,["data","size"])]),_:1},8,["modelValue"])),[[G]]),T((_(),b(H,{title:"按条件拆分",modelValue:U.value,"onUpdate:modelValue":e[27]||(e[27]=t=>U.value=t),width:"50%","append-to-body":""},{footer:a(()=>[S("div",Yo,[o(r,{onClick:lo,size:s.value},{default:a(()=>e[49]||(e[49]=[v("取消")])),_:1},8,["size"]),o(r,{type:"primary",onClick:oo,size:s.value},{default:a(()=>e[50]||(e[50]=[v("确定")])),_:1},8,["size"])])]),default:a(()=>[o(M,{ref_key:"splitConditionFormRef",ref:Ie,model:D,size:s.value},{default:a(()=>[o(u,{label:"拆分条数"},{default:a(()=>[o(n,{modelValue:D.splitCount,"onUpdate:modelValue":e[25]||(e[25]=t=>D.splitCount=t),type:"number",step:"1",placeholder:"请输入拆分条数"},null,8,["modelValue"])]),_:1}),o(u,{label:"拆分数量"},{default:a(()=>[o(n,{modelValue:D.splitQuantity,"onUpdate:modelValue":e[26]||(e[26]=t=>D.splitQuantity=t),type:"number",step:"0.001",placeholder:"请输入拆分数量"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","size"])]),_:1},8,["modelValue"])),[[G]])])}}};export{Ko as default};

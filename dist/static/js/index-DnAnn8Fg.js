/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as h,r as p,f as E,b as Q,g as m,h as B,c as j,o as u,j as e,m as n,a as l,J,w as f,v as c,K as W,k as _,L as k,M as A,F as G,z as H,N as O}from"./index-D3eRVKjp.js";import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Dg75KKir.js";import{_ as Y,a as Z,d as ee,e as te}from"./BusinessForm.vue_vue_type_script_setup_true_lang-H7rSFWHo.js";import{d as le}from"./download-U6qaYcnP.js";import"./DictTag.vue_vue_type_script_lang-h3s-iN69.js";import"./color-B5phLuB-.js";import"./dict-CqgorI4d.js";import"./index-DaVno4wL.js";const ce=h({name:"CrmBusiness",__name:"index",setup(ae){const w=H(),{t:F}=O(),x=p(!0),C=p(0),N=p([]),r=E({pageNo:1,pageSize:10,name:null,statusTypeId:null,statusId:null,contactNextTime:[],customerId:null,dealTime:[],price:null,discountPercent:null,productPrice:null,remark:null,ownerUserId:null,createTime:[],roUserIds:null,rwUserIds:null,endStatus:null,endRemark:null,contactLastTime:[],followUpStatus:null}),T=p(),y=p(!1),d=async()=>{x.value=!0;try{const o=await Z(r);N.value=o.list,C.value=o.total}finally{x.value=!1}},v=()=>{r.pageNo=1,d()},$=()=>{T.value.resetFields(),v()},I=p(),U=(o,t)=>{I.value.open(o,t)},R=async o=>{try{await w.delConfirm(),await ee(o),w.success(F("common.delSuccess")),await d()}catch(t){console.log(t)}},V=async()=>{try{await w.exportConfirm(),y.value=!0;const o=await te(r);le.excel(o,"商机.xls")}catch(o){console.log(o)}finally{y.value=!1}};return Q(()=>{d()}),(o,t)=>{const z=m("el-input"),P=m("el-form-item"),g=W,i=m("el-button"),L=m("el-form"),S=X,a=m("el-table-column"),q=m("el-table"),D=A,b=B("hasPermi"),K=B("loading");return u(),j(G,null,[e(S,null,{default:n(()=>[e(L,{ref_key:"queryFormRef",ref:T,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(r)},{default:n(()=>[e(P,{label:"商机名称",prop:"name"},{default:n(()=>[e(z,{modelValue:l(r).name,"onUpdate:modelValue":t[0]||(t[0]=s=>l(r).name=s),class:"!w-240px",clearable:"",placeholder:"请输入商机名称",onKeyup:J(v,["enter"])},null,8,["modelValue"])]),_:1}),e(P,null,{default:n(()=>[e(i,{onClick:v},{default:n(()=>[e(g,{class:"mr-5px",icon:"ep:search"}),t[4]||(t[4]=c(" 搜索 "))]),_:1}),e(i,{onClick:$},{default:n(()=>[e(g,{class:"mr-5px",icon:"ep:refresh"}),t[5]||(t[5]=c(" 重置 "))]),_:1}),f((u(),_(i,{type:"primary",onClick:t[1]||(t[1]=s=>U("create"))},{default:n(()=>[e(g,{class:"mr-5px",icon:"ep:plus"}),t[6]||(t[6]=c(" 新增 "))]),_:1})),[[b,["crm:business:create"]]]),f((u(),_(i,{loading:l(y),plain:"",type:"success",onClick:V},{default:n(()=>[e(g,{class:"mr-5px",icon:"ep:download"}),t[7]||(t[7]=c(" 导出 "))]),_:1},8,["loading"])),[[b,["crm:business:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),e(S,null,{default:n(()=>[f((u(),_(q,{data:l(N),"show-overflow-tooltip":!0,stripe:!0},{default:n(()=>[e(a,{align:"center",label:"商机名称",prop:"name"}),e(a,{align:"center",label:"客户名称",prop:"customerName"}),e(a,{align:"center",label:"商机金额",prop:"price"}),e(a,{align:"center",formatter:l(k),label:"预计成交日期",prop:"dealTime",width:"180px"},null,8,["formatter"]),e(a,{align:"center",label:"备注",prop:"remark"}),e(a,{align:"center",label:"商机状态类型",prop:"statusTypeName"}),e(a,{align:"center",label:"商机状态",prop:"statusName"}),e(a,{align:"center",formatter:l(k),label:"更新时间",prop:"updateTime",width:"180px"},null,8,["formatter"]),e(a,{align:"center",formatter:l(k),label:"创建时间",prop:"createTime",width:"180px"},null,8,["formatter"]),e(a,{align:"center",label:"负责人",prop:"ownerUserId"}),e(a,{align:"center",label:"创建人",prop:"creator"}),e(a,{align:"center",label:"跟进状态",prop:"followUpStatus"}),e(a,{align:"center",fixed:"right",label:"操作",width:"130px"},{default:n(s=>[f((u(),_(i,{link:"",type:"primary",onClick:M=>U("update",s.row.id)},{default:n(()=>t[8]||(t[8]=[c("编辑")])),_:2},1032,["onClick"])),[[b,["crm:business:update"]]]),f((u(),_(i,{link:"",type:"danger",onClick:M=>R(s.row.id)},{default:n(()=>t[9]||(t[9]=[c("删除")])),_:2},1032,["onClick"])),[[b,["crm:business:delete"]]])]),_:1})]),_:1},8,["data"])),[[K,l(x)]]),e(D,{limit:l(r).pageSize,"onUpdate:limit":t[2]||(t[2]=s=>l(r).pageSize=s),page:l(r).pageNo,"onUpdate:page":t[3]||(t[3]=s=>l(r).pageNo=s),total:l(C),onPagination:d},null,8,["limit","page","total"])]),_:1}),e(Y,{ref_key:"formRef",ref:I,onSuccess:d},null,512)],64)}}});export{ce as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-14 11:54:00 
 */
import{d as A,aA as a,bC as E,r,by as I,bz as N,Y as j,g as v,c as M,o as y,j as u,i as l,k as L,l as P,a as c,p as R,y as q,m as b,U as h,K as H,C as K,a6 as m,z as Y}from"./index-BdmDrM2Y.js";const D={class:"upload-box"},G={class:"upload-empty"},J=["src"],O=["onClick"],Q=["onClick"],W={class:"el-upload__tip"},Z=A({name:"UploadImgs",__name:"UploadImgs",props:{modelValue:{type:Array,required:!0},updateUrl:a.string.def(void 0),drag:a.bool.def(!0),disabled:a.bool.def(!1),limit:a.number.def(5),fileSize:a.number.def(5),fileType:a.array.def(["image/jpeg","image/png","image/gif"]),height:a.string.def("150px"),width:a.string.def("150px"),borderradius:a.string.def("8px")},emits:["update:modelValue"],setup(t,{emit:C}){E(e=>({"25ba8115":t.borderradius,"666a804f":t.width,"4d168fbe":t.height}));const k=Y(),d=t,w=r({Authorization:`Bearer ${N()}`,"tenant-id":I()}),i=r([]);j(()=>d.modelValue,e=>{e&&(i.value=e)},{deep:!0,immediate:!0});const V=e=>{const s=e.size/1024/1024<d.fileSize,o=d.fileType;return o.includes(e.type)||m({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),s||m({title:"温馨提示",message:`上传图片大小不能超过 ${d.fileSize}M！`,type:"warning"}),o.includes(e.type)&&s},f=C,z=(e,s)=>{e&&(s.url=e.data,f("update:modelValue",i.value),k.success("上传成功"))},$=e=>{i.value=i.value.filter(s=>s.url!==e.url||s.name!==e.name),f("update:modelValue",i.value)},x=()=>{m({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},U=()=>{m({title:"温馨提示",message:`当前最多只能上传 ${d.limit} 张图片，请移除后上传！`,type:"warning"})},g=r(""),p=r(!1),T=e=>{g.value=e.url,p.value=!0};return(e,s)=>{const o=H,S=v("el-upload"),_=v("el-image-viewer");return y(),M("div",D,[u(S,{"file-list":c(i),"onUpdate:fileList":s[1]||(s[1]=n=>q(i)?i.value=n:null),accept:t.fileType.join(","),action:t.updateUrl,"before-upload":V,class:R(["upload",t.drag?"no-border":""]),drag:t.drag,headers:c(w),limit:t.limit,"list-type":"picture-card",multiple:!0,"on-error":x,"on-exceed":U,"on-success":z},{file:b(({file:n})=>[l("img",{class:"upload-image",src:n.url},null,8,J),l("div",{class:"upload-handle",onClick:s[0]||(s[0]=K(()=>{},["stop"]))},[l("div",{class:"handle-icon",onClick:B=>T(n)},[u(o,{icon:"ep:zoom-in"}),s[3]||(s[3]=l("span",null,"查看",-1))],8,O),l("div",{class:"handle-icon",onClick:B=>$(n)},[u(o,{icon:"ep:delete"}),s[4]||(s[4]=l("span",null,"删除",-1))],8,Q)])]),default:b(()=>[l("div",G,[h(e.$slots,"empty",{},()=>[u(o,{icon:"ep:plus"})],!0)])]),_:3},8,["file-list","accept","action","class","drag","headers","limit"]),l("div",W,[h(e.$slots,"tip",{},void 0,!0)]),c(p)?(y(),L(_,{key:0,"url-list":[c(g)],onClose:s[2]||(s[2]=n=>p.value=!1)},null,8,["url-list"])):P("",!0)])}}});export{Z as _};

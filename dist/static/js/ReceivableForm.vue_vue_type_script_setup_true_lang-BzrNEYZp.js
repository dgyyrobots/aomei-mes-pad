/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 15:23:48 
 */
import{V as i,d as j,r as s,g as u,h as q,k as V,o as c,m as r,w as z,a as o,j as t,c as x,F as S,n as C,v as D,y as A,_ as O,N as G,z as H}from"./index-C8VsLzxx.js";import{a as J,D as K}from"./dict-_inVRzR5.js";import{g as Q}from"./index-Dn2rRtuI.js";const ae=async d=>await i.get({url:"/crm/receivable/page",params:d}),te=async d=>await i.get({url:"/crm/receivable/page-by-customer",params:d}),W=async d=>await i.get({url:`/crm/receivable/get?id=${d}`}),X=async d=>await i.post({url:"/crm/receivable/create",data:d}),Z=async d=>await i.put({url:"/crm/receivable/update",data:d}),re=async d=>await i.delete({url:`/crm/receivable/delete?id=${d}`}),de=async d=>await i.download({url:"/crm/receivable/export-excel",params:d}),ne=j({__name:"ReceivableForm",emits:["success"],setup(d,{expose:E,emit:F}){const{t:I}=G(),y=H(),g=s([]),m=s(!1),w=s(""),p=s(!1),k=s(""),a=s({id:void 0,no:void 0,planId:void 0,customerId:void 0,contractId:void 0,checkStatus:void 0,processInstanceId:void 0,returnTime:void 0,returnType:void 0,price:void 0,ownerUserId:void 0,batchId:void 0,sort:void 0,dataScope:void 0,dataScopeDeptIds:void 0,status:void 0,remark:void 0}),b=s();E({open:async(v,e)=>{if(m.value=!0,w.value=I(`action.${v}`),k.value=v,$(),e){p.value=!0;try{a.value=await W(e)}finally{p.value=!1}}g.value=await Q()}});const B=F,L=async()=>{if(!(!b||!await b.value.validate())){p.value=!0;try{const e=a.value;k.value==="create"?(await X(e),y.success(I("common.createSuccess"))):(await Z(e),y.success(I("common.updateSuccess"))),m.value=!1,B("success")}finally{p.value=!1}}},$=()=>{a.value={id:void 0,no:void 0,planId:void 0,customerId:void 0,contractId:void 0,checkStatus:void 0,processInstanceId:void 0,returnTime:void 0,returnType:void 0,price:void 0,ownerUserId:void 0,batchId:void 0,sort:void 0,dataScope:void 0,dataScopeDeptIds:void 0,status:void 0,remark:void 0},b.value?.resetFields()};return(v,e)=>{const f=u("el-input"),n=u("el-form-item"),N=u("el-date-picker"),U=u("el-option"),T=u("el-select"),_=u("el-input-number"),P=u("el-form"),R=u("el-button"),M=O,Y=q("loading");return c(),V(M,{modelValue:o(m),"onUpdate:modelValue":e[12]||(e[12]=l=>A(m)?m.value=l:null),title:o(w)},{footer:r(()=>[t(R,{disabled:o(p),type:"primary",onClick:L},{default:r(()=>e[13]||(e[13]=[D("确 定")])),_:1},8,["disabled"]),t(R,{onClick:e[11]||(e[11]=l=>m.value=!1)},{default:r(()=>e[14]||(e[14]=[D("取 消")])),_:1})]),default:r(()=>[z((c(),V(P,{ref_key:"formRef",ref:b,"label-width":"100px",model:o(a),rules:v.formRules},{default:r(()=>[t(n,{label:"回款编号",prop:"no"},{default:r(()=>[t(f,{modelValue:o(a).no,"onUpdate:modelValue":e[0]||(e[0]=l=>o(a).no=l),placeholder:"请输入回款编号"},null,8,["modelValue"])]),_:1}),t(n,{label:"回款计划",prop:"planId"},{default:r(()=>[t(f,{modelValue:o(a).planId,"onUpdate:modelValue":e[1]||(e[1]=l=>o(a).planId=l),placeholder:"请输入回款计划"},null,8,["modelValue"])]),_:1}),t(n,{label:"客户名称",prop:"customerId"},{default:r(()=>[t(f,{modelValue:o(a).customerId,"onUpdate:modelValue":e[2]||(e[2]=l=>o(a).customerId=l),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),t(n,{label:"合同名称",prop:"contractId"},{default:r(()=>[t(f,{modelValue:o(a).contractId,"onUpdate:modelValue":e[3]||(e[3]=l=>o(a).contractId=l),placeholder:"请输入合同名称"},null,8,["modelValue"])]),_:1}),t(n,{label:"回款日期",prop:"returnTime"},{default:r(()=>[t(N,{modelValue:o(a).returnTime,"onUpdate:modelValue":e[4]||(e[4]=l=>o(a).returnTime=l),placeholder:"选择回款日期",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1}),t(n,{label:"回款方式",prop:"returnType"},{default:r(()=>[t(T,{modelValue:o(a).returnType,"onUpdate:modelValue":e[5]||(e[5]=l=>o(a).returnType=l),placeholder:"请选择回款方式"},{default:r(()=>[(c(!0),x(S,null,C(o(J)(o(K).CRM_RECEIVABLE_RETURN_TYPE),l=>(c(),V(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"回款金额",prop:"price"},{default:r(()=>[t(_,{modelValue:o(a).price,"onUpdate:modelValue":e[6]||(e[6]=l=>o(a).price=l),placeholder:"请输入回款金额"},null,8,["modelValue"])]),_:1}),t(n,{label:"负责人",prop:"ownerUserId"},{default:r(()=>[t(T,{modelValue:o(a).ownerUserId,"onUpdate:modelValue":e[7]||(e[7]=l=>o(a).ownerUserId=l),clearable:"",placeholder:"请输入负责人"},{default:r(()=>[(c(!0),x(S,null,C(o(g),l=>(c(),V(U,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"批次",prop:"batchId"},{default:r(()=>[t(_,{modelValue:o(a).batchId,"onUpdate:modelValue":e[8]||(e[8]=l=>o(a).batchId=l),placeholder:"请输入批次"},null,8,["modelValue"])]),_:1}),t(n,{label:"显示排序",prop:"sort"},{default:r(()=>[t(_,{modelValue:o(a).sort,"onUpdate:modelValue":e[9]||(e[9]=l=>o(a).sort=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),t(n,{label:"备注",prop:"remark"},{default:r(()=>[t(f,{modelValue:o(a).remark,"onUpdate:modelValue":e[10]||(e[10]=l=>o(a).remark=l),placeholder:"请输入备注",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[Y,o(p)]])]),_:1},8,["modelValue","title"])}}});export{ne as _,ae as a,re as d,de as e,te as g};

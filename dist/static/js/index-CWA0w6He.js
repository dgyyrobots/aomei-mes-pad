/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:21:26 
 */
import{d as O,u as X,H as Y,r as s,f as G,b as H,g as d,h as N,c as Q,o as r,j as n,m as a,w as F,k as m,a as o,i as C,t as w,v as f,l as L,L as W,M as J,y as D,_ as K,Q as Z,F as ee}from"./index-5TqN_QR1.js";import{_ as te}from"./ContentWrap.vue_vue_type_script_setup_true_lang-fpmIiri3.js";import{_ as ae}from"./DictTag.vue_vue_type_script_lang-cZQMmgs8.js";import{D as oe}from"./dict-B2yk4gHf.js";import{j as ne}from"./bpmn-embedded-CPhjfOCm.js";import{g as le,a as ie}from"./index-D8cC46i7.js";import{b as re}from"./formCreate-CdOY-8fL.js";import"./color-B5phLuB-.js";import"./XTextButton-DHq4yLp8.js";import"./XButton-CbKhm45g.js";const ve=O({name:"BpmProcessDefinition",__name:"index",setup(se){const{push:P}=X(),{query:M}=Y(),v=s(!0),V=s(0),x=s([]),p=G({pageNo:1,pageSize:10,key:M.key}),B=async()=>{v.value=!0;try{const l=await le(p);x.value=l.list,V.value=l.total}finally{v.value=!1}},R=l=>{P({name:"BpmTaskAssignRuleList",query:{modelId:l.id}})},_=s(!1),k=s({rule:[],option:{}}),T=async l=>{l.formType==10?(re(k,l.formConf,l.formFields),_.value=!0):await P({path:l.formCustomCreatePath})},c=s(!1),u=s(null),$=s({prefix:"flowable"}),S=async l=>{u.value=await ie(l.id),c.value=!0};return H(()=>{B()}),(l,t)=>{const i=d("el-table-column"),g=d("el-button"),U=ae,y=d("el-tag"),q=d("el-table"),A=J,E=te,z=d("form-create"),h=K,j=N("hasPermi"),I=N("loading");return r(),Q(ee,null,[n(E,null,{default:a(()=>[F((r(),m(q,{data:o(x)},{default:a(()=>[n(i,{align:"center",label:"定义编号",prop:"id",width:"400"}),n(i,{align:"center",label:"流程名称",prop:"name",width:"200"},{default:a(e=>[n(g,{link:"",type:"primary",onClick:b=>S(e.row)},{default:a(()=>[C("span",null,w(e.row.name),1)]),_:2},1032,["onClick"])]),_:1}),n(i,{align:"center",label:"定义分类",prop:"category",width:"100"},{default:a(e=>[n(U,{type:o(oe).BPM_MODEL_CATEGORY,value:e.row.category},null,8,["type","value"])]),_:1}),n(i,{align:"center",label:"表单信息",prop:"formType",width:"200"},{default:a(e=>[e.row.formType===10?(r(),m(g,{key:0,link:"",type:"primary",onClick:b=>T(e.row)},{default:a(()=>[C("span",null,w(e.row.formName),1)]),_:2},1032,["onClick"])):(r(),m(g,{key:1,link:"",type:"primary",onClick:b=>T(e.row)},{default:a(()=>[C("span",null,w(e.row.formCustomCreatePath),1)]),_:2},1032,["onClick"]))]),_:1}),n(i,{align:"center",label:"流程版本",prop:"processDefinition.version",width:"80"},{default:a(e=>[e.row?(r(),m(y,{key:0},{default:a(()=>[f("v"+w(e.row.version),1)]),_:2},1024)):(r(),m(y,{key:1,type:"warning"},{default:a(()=>t[5]||(t[5]=[f("未部署")])),_:1}))]),_:1}),n(i,{align:"center",label:"状态",prop:"version",width:"80"},{default:a(e=>[e.row.suspensionState===1?(r(),m(y,{key:0,type:"success"},{default:a(()=>t[6]||(t[6]=[f("激活")])),_:1})):L("",!0),e.row.suspensionState===2?(r(),m(y,{key:1,type:"warning"},{default:a(()=>t[7]||(t[7]=[f("挂起")])),_:1})):L("",!0)]),_:1}),n(i,{align:"center",formatter:o(W),label:"部署时间",prop:"deploymentTime",width:"180"},null,8,["formatter"]),n(i,{align:"center",label:"定义描述",prop:"description","show-overflow-tooltip":"",width:"300"}),n(i,{align:"center",fixed:"right",label:"操作",width:"150"},{default:a(e=>[F((r(),m(g,{link:"",type:"primary",onClick:b=>R(e.row)},{default:a(()=>t[8]||(t[8]=[f(" 分配规则 ")])),_:2},1032,["onClick"])),[[j,["bpm:task-assign-rule:query"]]])]),_:1})]),_:1},8,["data"])),[[I,o(v)]]),n(A,{limit:o(p).pageSize,"onUpdate:limit":t[0]||(t[0]=e=>o(p).pageSize=e),page:o(p).pageNo,"onUpdate:page":t[1]||(t[1]=e=>o(p).pageNo=e),total:o(V),onPagination:B},null,8,["limit","page","total"])]),_:1}),n(h,{modelValue:o(_),"onUpdate:modelValue":t[2]||(t[2]=e=>D(_)?_.value=e:null),title:"表单详情",width:"800"},{default:a(()=>[n(z,{option:o(k).option,rule:o(k).rule},null,8,["option","rule"])]),_:1},8,["modelValue"]),n(h,{modelValue:o(c),"onUpdate:modelValue":t[4]||(t[4]=e=>D(c)?c.value=e:null),title:"流程图",width:"800"},{default:a(()=>[n(o(ne),Z({key:"designer",modelValue:o(u),"onUpdate:modelValue":t[3]||(t[3]=e=>D(u)?u.value=e:null)},o($),{prefix:o($).prefix,value:o(u)}),null,16,["modelValue","prefix","value"])]),_:1},8,["modelValue"])],64)}}});export{ve as default};

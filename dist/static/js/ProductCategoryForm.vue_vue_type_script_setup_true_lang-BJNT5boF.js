/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{d as U,r as s,f as $,g as u,h as q,k as p,o as d,m as l,w as S,a as t,j as i,c as j,F as z,n as E,v as k,y as M,_ as A,N as G,z as H}from"./index-FPuwcz_Y.js";import{a as J,g as K,c as O,u as Q}from"./index-C93hGWEM.js";const h=U({name:"CrmProductCategoryForm",__name:"ProductCategoryForm",emits:["success"],setup(W,{expose:w,emit:I}){const{t:f}=G(),v=H(),n=s(!1),_=s(""),r=s(!1),g=s(""),o=s({id:void 0,name:void 0,parentId:void 0}),F=$({name:[{required:!0,message:"名称不能为空",trigger:"blur"}],parentId:[{required:!0,message:"父级分类不能为空",trigger:"blur"}]}),m=s(),y=s([]);w({open:async(c,e)=>{if(n.value=!0,_.value=f(`action.${c}`),g.value=c,D(),e){r.value=!0;try{o.value=await J(e)}finally{r.value=!1}}y.value=await K({parentId:0})}});const x=I,P=async()=>{if(!(!m||!await m.value.validate())){r.value=!0;try{const e=o.value;g.value==="create"?(await O(e),v.success(f("common.createSuccess"))):(await Q(e),v.success(f("common.updateSuccess"))),n.value=!1,x("success")}finally{r.value=!1}}},D=()=>{o.value={id:void 0,name:void 0,parentId:void 0},m.value?.resetFields()};return(c,e)=>{const b=u("el-option"),L=u("el-select"),C=u("el-form-item"),R=u("el-input"),B=u("el-form"),V=u("el-button"),N=A,T=q("loading");return d(),p(N,{modelValue:t(n),"onUpdate:modelValue":e[3]||(e[3]=a=>M(n)?n.value=a:null),title:t(_)},{footer:l(()=>[i(V,{disabled:t(r),type:"primary",onClick:P},{default:l(()=>e[4]||(e[4]=[k("确 定")])),_:1},8,["disabled"]),i(V,{onClick:e[2]||(e[2]=a=>n.value=!1)},{default:l(()=>e[5]||(e[5]=[k("取 消")])),_:1})]),default:l(()=>[S((d(),p(B,{ref_key:"formRef",ref:m,"label-width":"100px",model:t(o),rules:t(F)},{default:l(()=>[i(C,{label:"父级id",prop:"parentId"},{default:l(()=>[i(L,{modelValue:t(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=a=>t(o).parentId=a),placeholder:"请选择上级分类"},{default:l(()=>[(d(),p(b,{key:0,label:"顶级分类",value:0})),(d(!0),j(z,null,E(t(y),a=>(d(),p(b,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),i(C,{label:"名称",prop:"name"},{default:l(()=>[i(R,{modelValue:t(o).name,"onUpdate:modelValue":e[1]||(e[1]=a=>t(o).name=a),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[T,t(r)]])]),_:1},8,["modelValue","title"])}}});export{h as _};

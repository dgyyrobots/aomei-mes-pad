/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{d as h,r as u,f as ee,b as te,g as p,h as U,c as O,o as r,j as t,m as a,a as l,J as Y,F as z,n as oe,k as c,w as _,v as d,K as le,L as ae,M as ne,z as se,N as re}from"./index-BdC40rFX.js";import{_ as ie}from"./DictTag.vue_vue_type_script_lang-BKaaD_BY.js";import{_ as pe}from"./ContentWrap.vue_vue_type_script_setup_true_lang-CdI9J0YF.js";import{_ as me}from"./index-Cen3Pl2s.js";import ue from"./RoleAssignMenuForm-DuwWi7bq.js";import{_ as ce}from"./RoleDataPermissionForm.vue_vue_type_script_setup_true_lang-CHo31LJ_.js";import{_ as de}from"./RoleForm.vue_vue_type_script_setup_true_lang-Ca2xUYfw.js";import{b as fe,d as _e,e as ge}from"./index-9k5tupC-.js";import{c as ye,D as A}from"./dict-D4wjFrBa.js";import{d as be}from"./download-U6qaYcnP.js";import"./color-B5phLuB-.js";import"./index-CluECts2.js";import"./index-B9BDFPzP.js";import"./tree-vSlcEeQq.js";import"./index-CXnDo_Xr.js";import"./constants-BPQb3nxh.js";const Ye=h({name:"SystemRole",__name:"index",setup(ve){const k=se(),{t:K}=re(),w=u(!0),F=u(0),V=u([]),n=ee({pageNo:1,pageSize:10,code:"",name:"",status:void 0,createTime:[]}),M=u(),x=u(!1),f=async()=>{w.value=!0;try{const s=await fe(n);V.value=s.list,F.value=s.total}finally{w.value=!1}},b=()=>{n.pageNo=1,f()},L=()=>{M.value.resetFields(),b()},R=u(),S=(s,e)=>{R.value.open(s,e)},T=u(),q=async s=>{T.value.open(s)},D=u(),B=async s=>{D.value.open(s)},E=async s=>{try{await k.delConfirm(),await _e(s),k.success(K("common.delSuccess")),await f()}catch(e){console.log(e)}},I=async()=>{try{await k.exportConfirm(),x.value=!0;const s=await ge(n);be.excel(s,"角色列表.xls")}catch(s){console.log(s)}finally{x.value=!1}};return te(()=>{f()}),(s,e)=>{const $=me,N=p("el-input"),y=p("el-form-item"),H=p("el-option"),Q=p("el-select"),j=p("el-date-picker"),v=le,m=p("el-button"),J=p("el-form"),P=pe,i=p("el-table-column"),G=ie,W=p("el-table"),X=ne,g=U("hasPermi"),Z=U("loading");return r(),O(z,null,[t($,{title:"功能权限",url:"https://doc.iocoder.cn/resource-permission"}),t($,{title:"数据权限",url:"https://doc.iocoder.cn/data-permission"}),t(P,null,{default:a(()=>[t(J,{ref_key:"queryFormRef",ref:M,class:"-mb-15px",inline:!0,"label-width":"68px",model:l(n)},{default:a(()=>[t(y,{label:"角色名称",prop:"name"},{default:a(()=>[t(N,{modelValue:l(n).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(n).name=o),class:"!w-240px",clearable:"",placeholder:"请输入角色名称",onKeyup:Y(b,["enter"])},null,8,["modelValue"])]),_:1}),t(y,{label:"角色标识",prop:"code"},{default:a(()=>[t(N,{modelValue:l(n).code,"onUpdate:modelValue":e[1]||(e[1]=o=>l(n).code=o),class:"!w-240px",clearable:"",placeholder:"请输入角色标识",onKeyup:Y(b,["enter"])},null,8,["modelValue"])]),_:1}),t(y,{label:"状态",prop:"status"},{default:a(()=>[t(Q,{modelValue:l(n).status,"onUpdate:modelValue":e[2]||(e[2]=o=>l(n).status=o),class:"!w-240px",clearable:"",placeholder:"请选择状态"},{default:a(()=>[(r(!0),O(z,null,oe(l(ye)(l(A).COMMON_STATUS),o=>(r(),c(H,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"创建时间",prop:"createTime"},{default:a(()=>[t(j,{modelValue:l(n).createTime,"onUpdate:modelValue":e[3]||(e[3]=o=>l(n).createTime=o),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),t(y,null,{default:a(()=>[t(m,{onClick:b},{default:a(()=>[t(v,{class:"mr-5px",icon:"ep:search"}),e[7]||(e[7]=d(" 搜索 "))]),_:1}),t(m,{onClick:L},{default:a(()=>[t(v,{class:"mr-5px",icon:"ep:refresh"}),e[8]||(e[8]=d(" 重置 "))]),_:1}),_((r(),c(m,{plain:"",type:"primary",onClick:e[4]||(e[4]=o=>S("create"))},{default:a(()=>[t(v,{class:"mr-5px",icon:"ep:plus"}),e[9]||(e[9]=d(" 新增 "))]),_:1})),[[g,["system:role:create"]]]),_((r(),c(m,{loading:l(x),plain:"",type:"success",onClick:I},{default:a(()=>[t(v,{class:"mr-5px",icon:"ep:download"}),e[10]||(e[10]=d(" 导出 "))]),_:1},8,["loading"])),[[g,["system:role:export"]]])]),_:1})]),_:1},8,["model"])]),_:1}),t(P,null,{default:a(()=>[_((r(),c(W,{data:l(V)},{default:a(()=>[t(i,{align:"center",label:"角色编号",prop:"id"}),t(i,{align:"center",label:"角色名称",prop:"name"}),t(i,{align:"center",label:"角色类型",prop:"type"}),t(i,{align:"center",label:"角色标识",prop:"code"}),t(i,{align:"center",label:"显示顺序",prop:"sort"}),t(i,{align:"center",label:"备注",prop:"remark"}),t(i,{align:"center",label:"状态",prop:"status"},{default:a(o=>[t(G,{type:l(A).COMMON_STATUS,value:o.row.status},null,8,["type","value"])]),_:1}),t(i,{align:"center",formatter:l(ae),label:"创建时间",prop:"createTime",width:"180"},null,8,["formatter"]),t(i,{align:"center",label:"操作",width:300},{default:a(o=>[_((r(),c(m,{link:"",type:"primary",onClick:C=>S("update",o.row.id)},{default:a(()=>e[11]||(e[11]=[d("编辑")])),_:2},1032,["onClick"])),[[g,["system:role:update"]]]),_((r(),c(m,{link:"","pre-icon":"ep:basketball",title:"菜单权限",type:"primary",onClick:C=>B(o.row)},{default:a(()=>e[12]||(e[12]=[d(" 菜单权限 ")])),_:2},1032,["onClick"])),[[g,["system:permission:assign-role-menu"]]]),_((r(),c(m,{link:"","pre-icon":"ep:coin",title:"数据权限",type:"primary",onClick:C=>q(o.row)},{default:a(()=>e[13]||(e[13]=[d(" 数据权限 ")])),_:2},1032,["onClick"])),[[g,["system:permission:assign-role-data-scope"]]]),_((r(),c(m,{link:"",type:"danger",onClick:C=>E(o.row.id)},{default:a(()=>e[14]||(e[14]=[d("删除")])),_:2},1032,["onClick"])),[[g,["system:role:delete"]]])]),_:1})]),_:1},8,["data"])),[[Z,l(w)]]),t(X,{limit:l(n).pageSize,"onUpdate:limit":e[5]||(e[5]=o=>l(n).pageSize=o),page:l(n).pageNo,"onUpdate:page":e[6]||(e[6]=o=>l(n).pageNo=o),total:l(F),onPagination:f},null,8,["limit","page","total"])]),_:1}),t(de,{ref_key:"formRef",ref:R,onSuccess:f},null,512),t(ue,{ref_key:"assignMenuFormRef",ref:D,onSuccess:f},null,512),t(ce,{ref_key:"dataPermissionFormRef",ref:T,onSuccess:f},null,512)],64)}}});export{Ye as default};

/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{d as Q,r as u,f as x,b as j,g as i,h as S,c as U,o as m,j as e,m as o,a,v as _,K as W,w as V,y as G,F as M,n as J,k as T,t as X,L as I,M as Z,z as ee}from"./index-FPuwcz_Y.js";import{_ as te}from"./DictTag.vue_vue_type_script_lang-o_bnFpkw.js";import{_ as ae}from"./ContentWrap.vue_vue_type_script_setup_true_lang-32ziCa0j.js";import{_ as le}from"./index-uvMbgyfS.js";import{g as oe,d as ne}from"./coupon-BcNTPaBI.js";import{c as se,D as c}from"./dict-C9lD-gwA.js";import{d as re}from"./formatter-DOlcZ__9.js";import"./color-B5phLuB-.js";import"./constants-BPQb3nxh.js";const ye=Q({name:"PromotionCoupon",__name:"index",setup(ie){const O=ee(),f=u(!0),w=u(0),k=u([]),n=x({pageNo:1,pageSize:10,createTime:[],status:void 0,nickname:void 0}),P=u(),g=u("all"),C=x([{label:"全部",value:"all"}]),p=async()=>{f.value=!0;try{const s=await oe(n);k.value=s.list,w.value=s.total}finally{f.value=!1}},v=()=>{n.pageNo=1,p()},R=()=>{P.value?.resetFields(),v()},h=async s=>{try{await O.confirm("回收将会收回会员领取的待使用的优惠券，已使用的将无法回收，确定要回收所选优惠券吗？"),await ne(s),O.notifySuccess("回收成功"),await p()}catch(l){console.log(l)}},F=s=>{n.status=s==="all"?void 0:s,p()};return j(()=>{p();for(const s of se(c.PROMOTION_COUPON_STATUS))C.push({label:s.label,value:s.value})}),(s,l)=>{const Y=le,E=i("el-input"),b=i("el-form-item"),$=i("el-date-picker"),N=W,y=i("el-button"),z=i("el-form"),D=ae,q=i("el-tab-pane"),A=i("el-tabs"),r=i("el-table-column"),d=te,B=i("el-table"),K=Z,L=S("hasPermi"),H=S("loading");return m(),U(M,null,[e(Y,{title:"功能开启",url:"https://doc.iocoder.cn/mall/build/"}),e(D,null,{default:o(()=>[e(z,{ref_key:"queryFormRef",ref:P,class:"-mb-15px",inline:!0,"label-width":"68px",model:a(n)},{default:o(()=>[e(b,{label:"会员昵称",prop:"nickname"},{default:o(()=>[e(E,{modelValue:a(n).nickname,"onUpdate:modelValue":l[0]||(l[0]=t=>a(n).nickname=t),class:"!w-240px",clearable:"",placeholder:"请输入会员昵称",onKeyup:v},null,8,["modelValue"])]),_:1}),e(b,{label:"领取时间",prop:"createTime"},{default:o(()=>[e($,{modelValue:a(n).createTime,"onUpdate:modelValue":l[1]||(l[1]=t=>a(n).createTime=t),class:"!w-240px","default-time":[new Date("1 00:00:00"),new Date("1 23:59:59")],"end-placeholder":"结束日期","start-placeholder":"开始日期",type:"daterange","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","default-time"])]),_:1}),e(b,null,{default:o(()=>[e(y,{onClick:v},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:search"}),l[5]||(l[5]=_(" 搜索 "))]),_:1}),e(y,{onClick:R},{default:o(()=>[e(N,{class:"mr-5px",icon:"ep:refresh"}),l[6]||(l[6]=_(" 重置 "))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(D,null,{default:o(()=>[e(A,{modelValue:a(g),"onUpdate:modelValue":l[2]||(l[2]=t=>G(g)?g.value=t:null),type:"card",onTabChange:F},{default:o(()=>[(m(!0),U(M,null,J(a(C),t=>(m(),T(q,{key:t.value,label:t.label,name:t.value},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),V((m(),T(B,{data:a(k)},{default:o(()=>[e(r,{align:"center",label:"会员昵称","min-width":"100",prop:"nickname"}),e(r,{align:"center",label:"优惠券名称","min-width":"140",prop:"name"}),e(r,{align:"center",label:"类型",prop:"discountType"},{default:o(t=>[e(d,{type:a(c).PROMOTION_PRODUCT_SCOPE,value:t.row.productScope},null,8,["type","value"])]),_:1}),e(r,{label:"优惠","min-width":"100",prop:"discount"},{default:o(t=>[e(d,{type:a(c).PROMOTION_DISCOUNT_TYPE,value:t.row.discountType},null,8,["type","value"]),_(" "+X(a(re)(t.row)),1)]),_:1}),e(r,{align:"center",label:"领取方式",prop:"takeType"},{default:o(t=>[e(d,{type:a(c).PROMOTION_COUPON_TAKE_TYPE,value:t.row.takeType},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"状态",prop:"status"},{default:o(t=>[e(d,{type:a(c).PROMOTION_COUPON_STATUS,value:t.row.status},null,8,["type","value"])]),_:1}),e(r,{align:"center",formatter:a(I),label:"领取时间",prop:"createTime",width:"180"},null,8,["formatter"]),e(r,{align:"center",formatter:a(I),label:"使用时间",prop:"useTime",width:"180"},null,8,["formatter"]),e(r,{align:"center","class-name":"small-padding fixed-width",label:"操作"},{default:o(t=>[V((m(),T(y,{link:"",type:"danger",onClick:pe=>h(t.row.id)},{default:o(()=>l[7]||(l[7]=[_("回收")])),_:2},1032,["onClick"])),[[L,["promotion:coupon:delete"]]])]),_:1})]),_:1},8,["data"])),[[H,a(f)]]),e(K,{limit:a(n).pageSize,"onUpdate:limit":l[3]||(l[3]=t=>a(n).pageSize=t),page:a(n).pageNo,"onUpdate:page":l[4]||(l[4]=t=>a(n).pageNo=t),total:a(w),onPagination:p},null,8,["limit","page","total"])]),_:1})],64)}}});export{ye as default};

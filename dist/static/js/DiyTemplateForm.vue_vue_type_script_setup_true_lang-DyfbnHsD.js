/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-15 10:10:14 
 */
import{d as $,r as u,f as B,g as f,h as S,k as y,o as U,m as r,w as j,a,j as n,v as V,y as q,_ as z,N as L,z as M}from"./index-BdC40rFX.js";import{_ as A}from"./UploadImgs-BgpwDFvH.js";import{a as E,c as G,b as H}from"./template-rFO5Nvlo.js";const W=$({name:"DiyTemplateForm",__name:"DiyTemplateForm",emits:["success"],setup(J,{expose:b,emit:I}){const{t:v}=L(),c=M(),m=u(!1),_=u(""),i=u(!1),g=u(""),l=u({id:void 0,name:void 0,remark:void 0,previewImageUrls:[]}),k=B({name:[{required:!0,message:"模板名称不能为空",trigger:"blur"}]}),p=u();b({open:async(d,e)=>{if(m.value=!0,_.value=v(`action.${d}`),g.value=d,x(),e){i.value=!0;try{const o=await E(e);o?.previewImageUrls?.length>0&&(o.previewImageUrls=o.previewImageUrls.map(t=>({url:t}))),l.value=o}finally{i.value=!1}}}});const D=I,T=async()=>{if(!(!p||!await p.value.validate())){i.value=!0;try{const e=l.value.previewImageUrls.map(t=>t.url?t.url:t),o={...l.value,previewImageUrls:e};g.value==="create"?(await G(o),c.success(v("common.createSuccess"))):(await H(o),c.success(v("common.updateSuccess"))),m.value=!1,D("success")}finally{i.value=!1}}},x=()=>{l.value={id:void 0,name:void 0,remark:void 0,previewImageUrls:[]},p.value?.resetFields()};return(d,e)=>{const o=f("el-input"),t=f("el-form-item"),C=A,F=f("el-form"),w=f("el-button"),R=z,N=S("loading");return U(),y(R,{modelValue:a(m),"onUpdate:modelValue":e[4]||(e[4]=s=>q(m)?m.value=s:null),title:a(_)},{footer:r(()=>[n(w,{disabled:a(i),type:"primary",onClick:T},{default:r(()=>e[5]||(e[5]=[V("确 定")])),_:1},8,["disabled"]),n(w,{onClick:e[3]||(e[3]=s=>m.value=!1)},{default:r(()=>e[6]||(e[6]=[V("取 消")])),_:1})]),default:r(()=>[j((U(),y(F,{ref_key:"formRef",ref:p,"label-width":"100px",model:a(l),rules:a(k)},{default:r(()=>[n(t,{label:"模板名称",prop:"name"},{default:r(()=>[n(o,{modelValue:a(l).name,"onUpdate:modelValue":e[0]||(e[0]=s=>a(l).name=s),placeholder:"请输入模板名称"},null,8,["modelValue"])]),_:1}),n(t,{label:"备注",prop:"remark"},{default:r(()=>[n(o,{modelValue:a(l).remark,"onUpdate:modelValue":e[1]||(e[1]=s=>a(l).remark=s),placeholder:"请输入备注",type:"textarea"},null,8,["modelValue"])]),_:1}),n(t,{label:"预览图",prop:"previewImageUrls"},{default:r(()=>[n(C,{modelValue:a(l).previewImageUrls,"onUpdate:modelValue":e[2]||(e[2]=s=>a(l).previewImageUrls=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[N,a(i)]])]),_:1},8,["modelValue","title"])}}});export{W as _};

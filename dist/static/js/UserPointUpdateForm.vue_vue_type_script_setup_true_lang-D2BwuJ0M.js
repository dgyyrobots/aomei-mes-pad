/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-03 13:38:04 
 */
import{d as $,r as f,f as j,O as q,g as s,h as z,k as y,o as w,m as t,w as L,a as o,j as a,v,y as P,_ as M,z as O,N as S}from"./index-FPuwcz_Y.js";import{g as A,b as E}from"./index-DnBs3Jpd.js";const Q=$({name:"UpdatePointForm",__name:"UserPointUpdateForm",emits:["success"],setup(G,{expose:U,emit:k}){const{t:x}=S(),c=O(),i=f(!1),u=f(!1),l=f({id:void 0,nickname:void 0,point:0,changePoint:0,changeType:1}),T=j({changePoint:[{required:!0,message:"变动积分不能为空",trigger:"blur"}]}),r=f();U({open:async p=>{if(i.value=!0,R(),p){u.value=!0;try{l.value=await A(p),l.value.changeType=1,l.value.changePoint=0}finally{u.value=!1}}}});const C=k,F=async()=>{if(!(!r||!await r.value.validate())){if(l.value.changePoint<1){c.error("变动积分不能小于 1");return}if(m.value<0){c.error("变动后的积分不能小于 0");return}u.value=!0;try{await E({id:l.value.id,point:l.value.changePoint*l.value.changeType}),c.success(x("common.updateSuccess")),i.value=!1,C("success")}finally{u.value=!1}}},R=()=>{l.value={id:void 0,nickname:void 0,levelId:void 0,reason:void 0},r.value?.resetFields()},m=q(()=>l.value.point+l.value.changePoint*l.value.changeType);return(p,e)=>{const _=s("el-input"),d=s("el-form-item"),g=s("el-input-number"),V=s("el-radio"),D=s("el-radio-group"),N=s("el-form"),b=s("el-button"),B=M,I=z("loading");return w(),y(B,{modelValue:o(i),"onUpdate:modelValue":e[7]||(e[7]=n=>P(i)?i.value=n:null),title:"修改用户积分",width:"600"},{footer:t(()=>[a(b,{disabled:o(u),type:"primary",onClick:F},{default:t(()=>e[10]||(e[10]=[v("确 定")])),_:1},8,["disabled"]),a(b,{onClick:e[6]||(e[6]=n=>i.value=!1)},{default:t(()=>e[11]||(e[11]=[v("取 消")])),_:1})]),default:t(()=>[L((w(),y(N,{ref_key:"formRef",ref:r,"label-width":"100px",model:o(l),rules:o(T)},{default:t(()=>[a(d,{label:"用户编号",prop:"id"},{default:t(()=>[a(_,{modelValue:o(l).id,"onUpdate:modelValue":e[0]||(e[0]=n=>o(l).id=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"用户昵称",prop:"nickname"},{default:t(()=>[a(_,{modelValue:o(l).nickname,"onUpdate:modelValue":e[1]||(e[1]=n=>o(l).nickname=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"变动前积分",prop:"point"},{default:t(()=>[a(g,{modelValue:o(l).point,"onUpdate:modelValue":e[2]||(e[2]=n=>o(l).point=n),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1}),a(d,{label:"变动类型",prop:"changeType"},{default:t(()=>[a(D,{modelValue:o(l).changeType,"onUpdate:modelValue":e[3]||(e[3]=n=>o(l).changeType=n)},{default:t(()=>[a(V,{label:1},{default:t(()=>e[8]||(e[8]=[v("增加")])),_:1}),a(V,{label:-1},{default:t(()=>e[9]||(e[9]=[v("减少")])),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"变动积分",prop:"changePoint"},{default:t(()=>[a(g,{modelValue:o(l).changePoint,"onUpdate:modelValue":e[4]||(e[4]=n=>o(l).changePoint=n),class:"!w-240px",min:0,precision:0},null,8,["modelValue"])]),_:1}),a(d,{label:"变动后积分"},{default:t(()=>[a(g,{modelValue:o(m),"onUpdate:modelValue":e[5]||(e[5]=n=>P(m)?m.value=n:null),class:"!w-240px",disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[I,o(u)]])]),_:1},8,["modelValue"])}}});export{Q as _};

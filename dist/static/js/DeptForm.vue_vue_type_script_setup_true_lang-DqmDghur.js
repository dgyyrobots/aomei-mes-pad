/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-08 14:15:15 
 */
import{d as P,r,f as j,g as n,h as z,k as f,o as m,m as s,w as Y,a as t,j as o,c as w,F as T,n as x,v as C,y as G,_ as H,N as J,z as K}from"./index-D3eRVKjp.js";import{a as Q,c as W,u as X,g as Z}from"./index-6pMG05oy.js";import{g as ee}from"./index-D-YMOJxy.js";import{C as S}from"./constants-BPQb3nxh.js";import{c as le,D as te}from"./dict-CqgorI4d.js";import{d as ae,h as oe}from"./tree-vSlcEeQq.js";const ce=P({name:"SystemDeptForm",__name:"DeptForm",emits:["success"],setup(se,{expose:E,emit:F}){const{t:v}=J(),b=K(),d=r(!1),V=r(""),p=r(!1),y=r(""),a=r({id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:S.ENABLE}),L=j({parentId:[{required:!0,message:"上级部门不能为空",trigger:"blur"}],name:[{required:!0,message:"部门名称不能为空",trigger:"blur"}],sort:[{required:!0,message:"显示排序不能为空",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],phone:[{pattern:/^1[3|4|5|6|7|8|9][0-9]\d{8}$/,message:"请输入正确的手机号码",trigger:"blur"}],status:[{required:!0,message:"状态不能为空",trigger:"blur"}]}),c=r(),g=r(),I=r([]);E({open:async(i,e)=>{if(d.value=!0,V.value=v(`action.${i}`),y.value=i,B(),e){p.value=!0;try{a.value=await Q(e)}finally{p.value=!1}}I.value=await ee(),await q()}});const N=F,h=async()=>{if(!(!c||!await c.value.validate())){p.value=!0;try{const e=a.value;y.value==="create"?(await W(e),b.success(v("common.createSuccess"))):(await X(e),b.success(v("common.updateSuccess"))),d.value=!1,N("success")}finally{p.value=!1}}},B=()=>{a.value={id:void 0,title:"",parentId:void 0,name:void 0,sort:void 0,leaderUserId:void 0,phone:void 0,email:void 0,status:S.ENABLE},c.value?.resetFields()},q=async()=>{g.value=[];const i=await Z(),e={id:0,name:"顶级部门",children:[]};e.children=oe(i),g.value.push(e)};return(i,e)=>{const R=n("el-tree-select"),u=n("el-form-item"),_=n("el-input"),$=n("el-input-number"),U=n("el-option"),D=n("el-select"),A=n("el-form"),k=n("el-button"),M=H,O=z("loading");return m(),f(M,{modelValue:t(d),"onUpdate:modelValue":e[8]||(e[8]=l=>G(d)?d.value=l:null),title:t(V)},{footer:s(()=>[o(k,{type:"primary",onClick:h},{default:s(()=>e[9]||(e[9]=[C("确 定")])),_:1}),o(k,{onClick:e[7]||(e[7]=l=>d.value=!1)},{default:s(()=>e[10]||(e[10]=[C("取 消")])),_:1})]),default:s(()=>[Y((m(),f(A,{ref_key:"formRef",ref:c,"label-width":"80px",model:t(a),rules:t(L)},{default:s(()=>[o(u,{label:"上级部门",prop:"parentId"},{default:s(()=>[o(R,{modelValue:t(a).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>t(a).parentId=l),"check-strictly":"",data:t(g),"default-expand-all":"",placeholder:"请选择上级部门",props:t(ae),"value-key":"deptId"},null,8,["modelValue","data","props"])]),_:1}),o(u,{label:"部门名称",prop:"name"},{default:s(()=>[o(_,{modelValue:t(a).name,"onUpdate:modelValue":e[1]||(e[1]=l=>t(a).name=l),placeholder:"请输入部门名称"},null,8,["modelValue"])]),_:1}),o(u,{label:"显示排序",prop:"sort"},{default:s(()=>[o($,{modelValue:t(a).sort,"onUpdate:modelValue":e[2]||(e[2]=l=>t(a).sort=l),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1}),o(u,{label:"负责人",prop:"leaderUserId"},{default:s(()=>[o(D,{modelValue:t(a).leaderUserId,"onUpdate:modelValue":e[3]||(e[3]=l=>t(a).leaderUserId=l),clearable:"",placeholder:"请输入负责人"},{default:s(()=>[(m(!0),w(T,null,x(t(I),l=>(m(),f(U,{key:l.id,label:l.nickname,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"联系电话",prop:"phone"},{default:s(()=>[o(_,{modelValue:t(a).phone,"onUpdate:modelValue":e[4]||(e[4]=l=>t(a).phone=l),maxlength:"11",placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),o(u,{label:"邮箱",prop:"email"},{default:s(()=>[o(_,{modelValue:t(a).email,"onUpdate:modelValue":e[5]||(e[5]=l=>t(a).email=l),maxlength:"50",placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1}),o(u,{label:"状态",prop:"status"},{default:s(()=>[o(D,{modelValue:t(a).status,"onUpdate:modelValue":e[6]||(e[6]=l=>t(a).status=l),clearable:"",placeholder:"请选择状态"},{default:s(()=>[(m(!0),w(T,null,x(t(le)(t(te).COMMON_STATUS),l=>(m(),f(U,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[O,t(p)]])]),_:1},8,["modelValue","title"])}}});export{ce as _};

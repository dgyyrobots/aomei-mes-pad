/*!  build: Vue Shop Vite 
     copyright: https://vue-admin-beautiful.com/shop-vite  
     time: 2025-04-11 15:04:23 
 */
import{bR as Er,bP as ed,bY as ix,d as Mt,r as ie,O as Ec,B as rx,b as ya,bA as Mn,g as ce,h as ax,c as Xe,o as ve,i as Je,j as O,U as ox,l as Ge,F as Zt,m as U,k as Fe,a as V,v as Ne,t as td,w as ns,y as tn,_ as sx,Z as lx,T as lr,aK as is,Y as vt,aM as ux,x as Ji,bw as Ke,f as cx,X as Lt,$ as bc,n as or,z as hg,aJ as px,aH as fx,aI as dx,bu as ur,K as bs,q as hx}from"./index-lcC3l4R2.js";import{_ as mx}from"./XTextButton-DbNkpB8c.js";import{_ as br}from"./XButton-DI0nWSmV.js";import{c as nd,D as id}from"./dict-B7jb0IEc.js";var ho={exports:{}},rd;function vx(){return rd||(rd=1,typeof Object.create=="function"?ho.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:ho.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}}),ho.exports}var gx=vx();const ye=Er(gx);function yx(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Ex=yx(function(e){var t=e.exports=function(n,i){if(i||(i=16),n===void 0&&(n=128),n<=0)return"0";for(var a=Math.log(Math.pow(2,n))/Math.log(i),r=2;a===1/0;r*=2)a=Math.log(Math.pow(2,n/r))/Math.log(i)*r;for(var o=a-Math.floor(a),s="",r=0;r<Math.floor(a);r++){var l=Math.floor(Math.random()*i).toString(i);s=l+s}if(o){var c=Math.pow(i,o),l=Math.floor(Math.random()*c).toString(i);s=l+s}var p=parseInt(s,i);return p!==1/0&&p>=Math.pow(2,n)?t(n,i):s};t.rack=function(n,i,a){var r=function(s){var l=0;do{if(l++>10)if(a)n+=a;else throw new Error("too many ID collisions, use more bits");var c=t(n,i)}while(Object.hasOwnProperty.call(o,c));return o[c]=s,c},o=r.hats={};return r.get=function(s){return r.hats[s]},r.set=function(s,l){return r.hats[s]=l,r},r.bits=n||128,r.base=i||16,r}});function In(e){if(!(this instanceof In))return new In(e);e=e||[128,36,1],this._seed=e.length?Ex.rack(e[0],e[1],e[2]):e}In.prototype.next=function(e){return this._seed(e||!0)};In.prototype.nextPrefixed=function(e,t){var n;do n=e+this.next(!0);while(this.assigned(n));return this.claim(n,t),n};In.prototype.claim=function(e,t){this._seed.set(e,t||!0)};In.prototype.assigned=function(e){return this._seed.get(e)||!1};In.prototype.unclaim=function(e){delete this._seed.hats[e]};In.prototype.clear=function(){var e=this._seed.hats,t;for(t in e)this.unclaim(t)};function ua(e){return Array.prototype.concat.apply([],e)}var Ea=Object.prototype.toString,bx=Object.prototype.hasOwnProperty;function zn(e){return e===void 0}function Qt(e){return e!==void 0}function ca(e){return e==null}function Oe(e){return Ea.call(e)==="[object Array]"}function st(e){return Ea.call(e)==="[object Object]"}function Re(e){return Ea.call(e)==="[object Number]"}function xt(e){var t=Ea.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"||t==="[object Proxy]"}function $t(e){return Ea.call(e)==="[object String]"}function mg(e){if(!Oe(e))throw new Error("must supply array")}function Cn(e,t){return bx.call(e,t)}function Ue(e,t){t=op(t);var n;return j(e,function(i,a){if(t(i,a))return n=i,!1}),n}function ip(e,t){t=op(t);var n=Oe(e)?-1:void 0;return j(e,function(i,a){if(t(i,a))return n=a,!1}),n}function Ie(e,t){var n=[];return j(e,function(i,a){t(i,a)&&n.push(i)}),n}function j(e,t){var n,i;if(!zn(e)){var a=Oe(e)?_x:xx;for(var r in e)if(Cn(e,r)&&(n=e[r],i=t(n,a(r)),i===!1))return n}}function vg(e,t){return zn(e)?[]:(mg(e),t=op(t),e.filter(function(n,i){return!t(n,i)}))}function Vt(e,t,n){return j(e,function(i,a){n=t(n,i,a)}),n}function $i(e,t){return!!Vt(e,function(n,i,a){return n&&t(i,a)},!0)}function fi(e,t){return!!Ue(e,t)}function ht(e,t){var n=[];return j(e,function(i,a){n.push(t(i,a))}),n}function pa(e){return e&&Object.keys(e)||[]}function cr(e){return pa(e).length}function xs(e){return ht(e,function(t){return t})}function Vi(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return t=ap(t),j(e,function(i){var a=t(i)||"_",r=n[a];r||(r=n[a]=[]),r.push(i)}),n}function rp(e){e=ap(e);for(var t={},n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];j(i,function(o){return Vi(o,e,t)});var r=ht(t,function(o,s){return o[0]});return r}var gg=rp;function nn(e,t){t=ap(t);var n=[];return j(e,function(i,a){for(var r=t(i,a),o={d:r,v:i},s=0;s<n.length;s++){var l=n[s].d;if(r<l){n.splice(s,0,o);return}}n.push(o)}),ht(n,function(i){return i.v})}function en(e){return function(t){return $i(e,function(n,i){return t[i]===n})}}function ap(e){return xt(e)?e:function(t){return t[e]}}function op(e){return xt(e)?e:function(t){return t===e}}function xx(e){return e}function _x(e){return Number(e)}function sp(e,t){var n,i,a,r;function o(f){var h=Date.now(),v=f?0:r+t-h;if(v>0)return s(v);e.apply(a,i),l()}function s(f){n=setTimeout(o,f)}function l(){n&&clearTimeout(n),n=r=i=a=void 0}function c(){n&&o(!0),l()}function p(){r=Date.now();for(var f=arguments.length,h=new Array(f),v=0;v<f;v++)h[v]=arguments[v];i=h,a=this,n||s(t)}return p.flush=c,p.cancel=l,p}function Sx(e,t){var n=!1;return function(){n||(e.apply(void 0,arguments),n=!0,setTimeout(function(){n=!1},t))}}function Pt(e,t){return e.bind(t)}function Uo(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Uo=function(t){return typeof t}:Uo=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(e)}function xc(){return xc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},xc.apply(this,arguments)}function q(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return xc.apply(void 0,[e].concat(n))}function wx(e,t,n){var i=e;return j(t,function(a,r){if(typeof a!="number"&&typeof a!="string")throw new Error("illegal key type: "+Uo(a)+". Key should be of type number or string.");if(a==="constructor")throw new Error("illegal key: constructor");if(a==="__proto__")throw new Error("illegal key: __proto__");var o=t[r+1],s=i[a];Qt(o)&&ca(s)&&(s=i[a]=isNaN(+o)?{}:[]),zn(o)?zn(n)?delete i[a]:i[a]=n:i=s}),e}function Tx(e,t,n){var i=e;return j(t,function(a){if(ca(i))return i=void 0,!1;i=i[a]}),zn(i)?n:i}function rn(e,t){var n={},i=Object(e);return j(t,function(a){a in i&&(n[a]=e[a])}),n}function Un(e,t){var n={},i=Object(e);return j(i,function(a,r){t.indexOf(r)===-1&&(n[r]=a)}),n}function yg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.length&&j(n,function(a){!a||!st(a)||j(a,function(r,o){if(o!=="__proto__"){var s=e[o];st(r)?(st(s)||(s={}),e[o]=yg(s,r)):e[o]=r}})}),e}const Cx=Object.freeze(Object.defineProperty({__proto__:null,assign:q,bind:Pt,debounce:sp,ensureArray:mg,every:$i,filter:Ie,find:Ue,findIndex:ip,flatten:ua,forEach:j,get:Tx,groupBy:Vi,has:Cn,isArray:Oe,isDefined:Qt,isFunction:xt,isNil:ca,isNumber:Re,isObject:st,isString:$t,isUndefined:zn,keys:pa,map:ht,matchPattern:en,merge:yg,omit:Un,pick:rn,reduce:Vt,set:wx,size:cr,some:fi,sortBy:nn,throttle:Sx,unionBy:gg,uniqueBy:rp,values:xs,without:vg},Symbol.toStringTag,{value:"Module"}));function Ut(e,t,n){return arguments.length==2?e.getAttribute(t):n===null?e.removeAttribute(t):(e.setAttribute(t,n),e)}var Ax=[].indexOf,lp=function(e,t){if(Ax)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},Px=/\s+/,Rx=Object.prototype.toString;function dt(e){return new li(e)}function li(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}li.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=lp(t,e);return~n||t.push(e),this.el.className=t.join(" "),this};li.prototype.remove=function(e){if(Rx.call(e)=="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=lp(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this};li.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};li.prototype.toggle=function(e,t){return this.list?(typeof t<"u"?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(typeof t<"u"?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};li.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(Px);return n[0]===""&&n.shift(),n};li.prototype.has=li.prototype.contains=function(e){return this.list?this.list.contains(e):!!~lp(this.array(),e)};function _s(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}var Qi=typeof Element<"u"?Element.prototype:{},ad=Qi.matches||Qi.matchesSelector||Qi.webkitMatchesSelector||Qi.mozMatchesSelector||Qi.msMatchesSelector||Qi.oMatchesSelector,rs=Ix;function Ix(e,t){if(!e||e.nodeType!==1)return!1;if(ad)return ad.call(e,t);for(var n=e.parentNode.querySelectorAll(t),i=0;i<n.length;i++)if(n[i]==e)return!0;return!1}function Fi(e,t,n){for(var i=n?e:e.parentNode;i&&i.nodeType!==document.DOCUMENT_NODE&&i.nodeType!==document.DOCUMENT_FRAGMENT_NODE;){if(rs(i,t))return i;i=i.parentNode}return rs(i,t)?i:null}var Eg=window.addEventListener?"addEventListener":"attachEvent",Nx=window.removeEventListener?"removeEventListener":"detachEvent",bg=Eg!=="addEventListener"?"on":"",Mx=function(e,t,n,i){return e[Eg](bg+t,n,i||!1),n},Dx=function(e,t,n,i){return e[Nx](bg+t,n,i||!1),n},Se={bind:Mx,unbind:Dx},xg=["focus","blur"];function kx(e,t,n,i,a){return xg.indexOf(n)!==-1&&(a=!0),Se.bind(e,n,function(r){var o=r.target||r.srcElement;r.delegateTarget=Fi(o,t,!0),r.delegateTarget&&i.call(e,r)},a)}function Ox(e,t,n,i){return xg.indexOf(t)!==-1&&(i=!0),Se.unbind(e,t,n,i)}var Ht={bind:kx,unbind:Ox},Qe=Lx,_g=!1,mo;typeof document<"u"&&(mo=document.createElement("div"),mo.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',_g=!mo.getElementsByTagName("link").length,mo=void 0);var pt={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:_g?[1,"X<div>","</div>"]:[0,"",""]};pt.td=pt.th=[3,"<table><tbody><tr>","</tr></tbody></table>"];pt.option=pt.optgroup=[1,'<select multiple="multiple">',"</select>"];pt.thead=pt.tbody=pt.colgroup=pt.caption=pt.tfoot=[1,"<table>","</table>"];pt.polyline=pt.ellipse=pt.polygon=pt.circle=pt.text=pt.line=pt.path=pt.rect=pt.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function Lx(e,t){if(typeof e!="string")throw new TypeError("String expected");t||(t=document);var n=/<([\w:]+)/.exec(e);if(!n)return t.createTextNode(e);e=e.replace(/^\s+|\s+$/g,"");var i=n[1];if(i=="body"){var l=t.createElement("html");return l.innerHTML=e,l.removeChild(l.lastChild)}var a=pt[i]||pt._default,r=a[0],o=a[1],s=a[2],l=t.createElement("div");for(l.innerHTML=o+e+s;r--;)l=l.lastChild;if(l.firstChild==l.lastChild)return l.removeChild(l.firstChild);for(var c=t.createDocumentFragment();l.firstChild;)c.appendChild(l.removeChild(l.firstChild));return c}function it(e,t){return t=t||document,t.querySelector(e)}function _c(e,t){return t=t||document,t.querySelectorAll(e)}function Nn(e){e.parentNode&&e.parentNode.removeChild(e)}function Bx(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch{}return e}function $x(e,t){return t.appendChild(Bx(e,t))}function Ce(e,t){return $x(t,e),e}var Sc=2,Sg={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":Sc,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":Sc,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function Vx(e,t){return Sg[t]?e.style[t]:e.getAttributeNS(null,t)}function wg(e,t,n){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),a=Sg[i];a?(a===Sc&&typeof n=="number"&&(n=String(n)+"px"),e.style[i]=n):e.setAttributeNS(null,t,n)}function Fx(e,t){var n=Object.keys(t),i,a;for(i=0,a;a=n[i];i++)wg(e,a,t[a])}function ae(e,t,n){if(typeof t=="string")if(n!==void 0)wg(e,t,n);else return Vx(e,t);else Fx(e,t);return e}function up(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var jx=/\s+/,Hx=Object.prototype.toString;function wc(e){return typeof e<"u"}function Le(e){return new ui(e)}function ui(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}ui.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array(),n=up(t,e);return~n||t.push(e),wc(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this};ui.prototype.remove=function(e){if(Hx.call(e)==="[object RegExp]")return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=up(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this};ui.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this};ui.prototype.toggle=function(e,t){return this.list?(wc(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(wc(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)};ui.prototype.array=function(){var e=this.el.getAttribute("class")||"",t=e.replace(/^\s+|\s+$/g,""),n=t.split(jx);return n[0]===""&&n.shift(),n};ui.prototype.has=ui.prototype.contains=function(e){return this.list?this.list.contains(e):!!~up(this.array(),e)};function ot(e){var t=e.parentNode;return t&&t.removeChild(e),e}function Tg(e){for(var t;t=e.firstChild;)ot(t);return e}function Cg(e){return e.cloneNode(!0)}var cp={svg:"http://www.w3.org/2000/svg"},od='<svg xmlns="'+cp.svg+'"';function Gx(e){var t=!1;e.substring(0,4)==="<svg"?e.indexOf(cp.svg)===-1&&(e=od+e.substring(4)):(e=od+">"+e+"</svg>",t=!0);var n=zx(e);if(!t)return n;for(var i=document.createDocumentFragment(),a=n.firstChild;a.firstChild;)i.appendChild(a.firstChild);return i}function zx(e){var t;return t=new DOMParser,t.async=!1,t.parseFromString(e,"text/xml")}function be(e,t){var n;return e.charAt(0)==="<"?(n=Gx(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(cp.svg,e),t&&ae(n,t),n}var wl=null;function Ag(){return wl===null&&(wl=be("svg")),wl}function sd(e,t){var n,i,a=Object.keys(t);for(n=0;i=a[n];n++)e[i]=t[i];return e}function Ux(e,t,n,i,a,r){var o=Ag().createSVGMatrix();switch(arguments.length){case 0:return o;case 1:return sd(o,e);case 6:return sd(o,{a:e,b:t,c:n,d:i,e:a,f:r})}}function na(e){return Ag().createSVGTransform()}var ld=/([&<>]{1})/g,qx=/([\n\r"]{1})/g,Wx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"'"};function Tl(e,t){function n(i,a){return Wx[a]||a}return e.replace(t,n)}function Pg(e,t){var n,i,a,r,o;switch(e.nodeType){case 3:t.push(Tl(e.textContent,ld));break;case 1:if(t.push("<",e.tagName),e.hasAttributes())for(a=e.attributes,n=0,i=a.length;n<i;++n)r=a.item(n),t.push(" ",r.name,'="',Tl(r.value,qx),'"');if(e.hasChildNodes()){for(t.push(">"),o=e.childNodes,n=0,i=o.length;n<i;++n)Pg(o.item(n),t);t.push("</",e.tagName,">")}else t.push("/>");break;case 8:t.push("<!--",Tl(e.nodeValue,ld),"-->");break;case 4:t.push("<![CDATA[",e.nodeValue,"]]>");break;default:throw new Error("unable to handle node "+e.nodeType)}return t}function Yx(e){for(var t=e.firstChild,n=[];t;)Pg(t,n),t=t.nextSibling;return n.join("")}function ud(e,t){return Yx(e)}function Kx(e,t){return t instanceof SVGMatrix?e.createSVGTransformFromMatrix(t):t}function Xx(e,t){var n,i;for(e.clear(),n=0;i=t[n];n++)e.appendItem(Kx(e,i))}function fa(e,t){var n=e.transform.baseVal;return t&&(Array.isArray(t)||(t=[t]),Xx(n,t)),n.consolidate()}var Zx=/^class /;function Jx(e){return Zx.test(e.toString())}function Tc(e){return Object.prototype.toString.call(e)==="[object Array]"}function Cl(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function vo(){var e=Array.prototype.slice.call(arguments);e.length===1&&Tc(e[0])&&(e=e[0]);var t=e.pop();return t.$inject=e,t}var Qx=/constructor\s*[^(]*\(\s*([^)]*)\)/m,e_=/^(?:async )?(?:function\s*)?[^(]*\(\s*([^)]*)\)/m,t_=/\/\*([^*]*)\*\//m;function n_(e){if(typeof e!="function")throw new Error('Cannot annotate "'+e+'". Expected a function!');var t=e.toString().match(Jx(e)?Qx:e_);return t?t[1]&&t[1].split(",").map(function(n){return t=n.match(t_),t?t[1].trim():n.trim()})||[]:[]}function i_(){var e=[];this.factory=function(t,n){return e.push([t,"factory",n]),this},this.value=function(t,n){return e.push([t,"value",n]),this},this.type=function(t,n){return e.push([t,"type",n]),this},this.forEach=function(t){e.forEach(t)}}function Cc(e,t){t=t||{get:function(m,_){if(n.push(m),_===!1)return null;throw o('No provider for "'+m+'"!')}};var n=[],i=this._providers=Object.create(t._providers||null),a=this._instances=Object.create(null),r=a.injector=this,o=function(m){var _=n.join(" -> ");return n.length=0,new Error(_?m+" (Resolving: "+_+")":m)},s=function(m,_){if(!i[m]&&m.indexOf(".")!==-1){for(var b=m.split("."),M=s(b.shift());b.length;)M=M[b.shift()];return M}if(Cl(a,m))return a[m];if(Cl(i,m)){if(n.indexOf(m)!==-1)throw n.push(m),o("Cannot resolve circular dependency!");return n.push(m),a[m]=i[m][0](i[m][1]),n.pop(),a[m]}return t.get(m,_)},l=function(m,_){if(typeof _>"u"&&(_={}),typeof m!="function")if(Tc(m))m=vo(m.slice());else throw new Error('Cannot invoke "'+m+'". Expected a function!');var b=m.$inject||n_(m),M=b.map(function(P){return Cl(_,P)?_[P]:s(P)});return{fn:m,dependencies:M}},c=function(m){var _=l(m),b=_.fn,M=_.dependencies,P=Function.prototype.bind.apply(b,[null].concat(M));return new P},p=function(m,_,b){var M=l(m,b),P=M.fn,S=M.dependencies;return P.apply(_,S)},f=function(m){return vo(function(_){return m.get(_)})},h=function(m,_){if(_&&_.length){var b=Object.create(null),M=Object.create(null),P=[],S=[],w=[],T,N,B,$;for(var H in i)T=i[H],_.indexOf(H)!==-1&&(T[2]==="private"?(N=P.indexOf(T[3]),N===-1?(B=T[3].createChild([],_),$=f(B),P.push(T[3]),S.push(B),w.push($),b[H]=[$,H,"private",B]):b[H]=[w[N],H,"private",S[N]]):b[H]=[T[2],T[1]],M[H]=!0),(T[2]==="factory"||T[2]==="type")&&T[1].$scope&&_.forEach(function(Z){T[1].$scope.indexOf(Z)!==-1&&(b[H]=[T[2],T[1]],M[Z]=!0)});_.forEach(function(Z){if(!M[Z])throw new Error('No provider for "'+Z+'". Cannot use provider from the parent!')}),m.unshift(b)}return new Cc(m,r)},v={factory:p,type:c,value:function(m){return m}};e.forEach(function(m){function _(S,w){return S!=="value"&&Tc(w)&&(w=vo(w.slice())),w}if(m instanceof i_)m.forEach(function(S){var w=S[0],T=S[1],N=S[2];i[w]=[v[T],_(T,N),T]});else if(typeof m=="object")if(m.__exports__){var b=Object.keys(m).reduce(function(S,w){return w.substring(0,2)!=="__"&&(S[w]=m[w]),S},Object.create(null)),M=new Cc((m.__modules__||[]).concat([b]),r),P=vo(function(S){return M.get(S)});m.__exports__.forEach(function(S){i[S]=[P,S,"private",M]})}else Object.keys(m).forEach(function(S){if(m[S][2]==="private"){i[S]=m[S];return}var w=m[S][0],T=m[S][1];i[S]=[v[w],_(w,T),w]})}),this.get=s,this.invoke=p,this.instantiate=c,this.createChild=h}var r_=1e3;function qn(e,t){var n=this;t=t||r_,e.on(["render.shape","render.connection"],t,function(i,a){var r=i.type,o=a.element,s=a.gfx,l=a.attrs;if(n.canRender(o))return r==="render.shape"?n.drawShape(s,o,l):n.drawConnection(s,o,l)}),e.on(["render.getShapePath","render.getConnectionPath"],t,function(i,a){if(n.canRender(a))return i.type==="render.getShapePath"?n.getShapePath(a):n.getConnectionPath(a)})}qn.prototype.canRender=function(){};qn.prototype.drawShape=function(){};qn.prototype.drawConnection=function(){};qn.prototype.getShapePath=function(){};qn.prototype.getConnectionPath=function(){};function xr(e){return e.join(",").replace(/,?([A-z]),?/g,"$1")}function Rg(e){for(var t="",n=0,i;i=e[n];n++)t+=i.x+","+i.y+" ";return t}function pp(e,t){var n=be("polyline");return ae(n,{points:Rg(e)}),t&&ae(n,t),n}function a_(e,t){return ae(e,{points:Rg(t)}),e}function Ig(e){return Ie(e,function(t){return!Ue(e,function(n){return n!==t&&Ng(t,n)})})}function Ng(e,t){if(t){if(e===t)return t;if(e.parent)return Ng(e.parent,t)}}function cd(e,t,n){var i=!n||e.indexOf(t)===-1;return i&&e.push(t),i}function ji(e,t,n){n=n||0,Oe(e)||(e=[e]),j(e,function(i,a){var r=t(i,a,n);Oe(r)&&r.length&&ji(r,t,n+1)})}function o_(e,t,n){var i=[],a=[];return ji(e,function(r,o,s){cd(i,r,t);var l=r.children;if(l&&cd(a,l,t))return l}),i}function Ss(e,t){return o_(e,!t)}function s_(e,t,n){zn(t)&&(t=!0),st(t)&&(n=t,t=!0),n=n||{};var i=Ur(n.allShapes),a=Ur(n.allConnections),r=Ur(n.enclosedElements),o=Ur(n.enclosedConnections),s=Ur(n.topLevel,t&&Vi(e,function(p){return p.id}));function l(p){s[p.source.id]&&s[p.target.id]&&(s[p.id]=[p]),i[p.source.id]&&i[p.target.id]&&(o[p.id]=r[p.id]=p),a[p.id]=p}function c(p){if(r[p.id]=p,p.waypoints)o[p.id]=a[p.id]=p;else return i[p.id]=p,j(p.incoming,l),j(p.outgoing,l),p.children}return ji(e,c),{allShapes:i,allConnections:a,topLevel:s,enclosedConnections:o,enclosedElements:r}}function St(e,t){t=!!t,Oe(e)||(e=[e]);var n,i,a,r;return j(e,function(o){var s=o;o.waypoints&&!t&&(s=St(o.waypoints,!0));var l=s.x,c=s.y,p=s.height||0,f=s.width||0;(l<n||n===void 0)&&(n=l),(c<i||i===void 0)&&(i=c),(l+f>a||a===void 0)&&(a=l+f),(c+p>r||r===void 0)&&(r=c+p)}),{x:n,y:i,height:r-i,width:a-n}}function l_(e,t){var n={};return j(e,function(i){var a=i;a.waypoints&&(a=St(a)),!Re(t.y)&&a.x>t.x&&(n[i.id]=i),!Re(t.x)&&a.y>t.y&&(n[i.id]=i),a.x>t.x&&a.y>t.y&&(Re(t.width)&&Re(t.height)&&a.width+a.x<t.width+t.x&&a.height+a.y<t.height+t.y||!Re(t.width)||!Re(t.height))&&(n[i.id]=i)}),n}function Mg(e){return"waypoints"in e?"connection":"x"in e?"shape":"root"}function Dg(e){return!!(e&&e.isFrame)}function Ur(e,t){return q({},e||{},t||{})}var u_=1;function di(e,t){qn.call(this,e,u_),this.CONNECTION_STYLE=t.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=t.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=t.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}ye(di,qn);di.prototype.canRender=function(){return!0};di.prototype.drawShape=function(t,n,i){var a=be("rect");return ae(a,{x:0,y:0,width:n.width||0,height:n.height||0}),Dg(n)?ae(a,q({},this.FRAME_STYLE,i||{})):ae(a,q({},this.SHAPE_STYLE,i||{})),Ce(t,a),a};di.prototype.drawConnection=function(t,n,i){var a=pp(n.waypoints,q({},this.CONNECTION_STYLE,i||{}));return Ce(t,a),a};di.prototype.getShapePath=function(t){var n=t.x,i=t.y,a=t.width,r=t.height,o=[["M",n,i],["l",a,0],["l",0,r],["l",-a,0],["z"]];return xr(o)};di.prototype.getConnectionPath=function(t){var n=t.waypoints,i,a,r=[];for(i=0;a=n[i];i++)a=a.original||a,r.push([i===0?"M":"L",a.x,a.y]);return xr(r)};di.$inject=["eventBus","styles"];function c_(){var e={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},t=this;this.cls=function(n,i,a){var r=this.style(i,a);return q(r,{class:n})},this.style=function(n,i){!Oe(n)&&!i&&(i=n,n=[]);var a=Vt(n,function(r,o){return q(r,e[o]||{})},{});return i?q(a,i):a},this.computeStyle=function(n,i,a){return Oe(i)||(a=i,i=[]),t.style(i||[],q({},a,n||{}))}}const p_={__init__:["defaultRenderer"],defaultRenderer:["type",di],styles:["type",c_]};function rt(e,t){if(!e||!t)return-1;var n=e.indexOf(t);return n!==-1&&e.splice(n,1),n}function at(e,t,n){if(!(!e||!t)){typeof n!="number"&&(n=-1);var i=e.indexOf(t);if(i!==-1){if(i===n)return;if(n!==-1)e.splice(i,1);else return}n!==-1?e.splice(n,0,t):e.push(t)}}function fp(e,t){return!e||!t?-1:e.indexOf(t)}function ba(e,t){return!e||!t?-1:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function dp(e,t,n,i){if(typeof i>"u"&&(i=5),!e||!t||!n)return!1;var a=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),r=ba(e,t);return Math.abs(a/r)<=i}var kg=2;function jn(e,t){var n;return Oe(e)?n=e:n=[e,t],f_(n)?"h":d_(n)?"v":!1}function f_(e,t){var n;Oe(e)?n=e:n=[e,t];var i=n.slice().shift();return $i(n,function(a){return Math.abs(i.y-a.y)<=kg})}function d_(e,t){var n;Oe(e)?n=e:n=[e,t];var i=n.slice().shift();return $i(n,function(a){return Math.abs(i.x-a.x)<=kg})}function pd(e,t,n){return n=n||0,e.x>t.x-n&&e.y>t.y-n&&e.x<t.x+t.width+n&&e.y<t.y+t.height+n}function Ac(e,t){return{x:Math.round(e.x+(t.x-e.x)/2),y:Math.round(e.y+(t.y-e.y)/2)}}var Al,fd;function h_(){if(fd)return Al;fd=1;var e=/,?([a-z]),?/gi,t=parseFloat,n=Math,i=n.PI,a=n.min,r=n.max,o=n.pow,s=n.abs,l=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/ig,c=/(-?\d*\.?\d*(?:e[-+]?\d+)?)[\s]*,?[\s]*/ig,p=Array.isArray||function(x){return x instanceof Array};function f(x,R){return Object.prototype.hasOwnProperty.call(x,R)}function h(x){if(typeof x=="function"||Object(x)!==x)return x;var R=new x.constructor;for(var D in x)f(x,D)&&(R[D]=h(x[D]));return R}function v(x,R){for(var D=0,L=x.length;D<L;D++)if(x[D]===R)return x.push(x.splice(D,1)[0])}function m(x){function R(){var D=Array.prototype.slice.call(arguments,0),L=D.join("␀"),X=R.cache=R.cache||{},K=R.count=R.count||[];return f(X,L)?(v(K,L),X[L]):(K.length>=1e3&&delete X[K.shift()],K.push(L),X[L]=x.apply(0,D),X[L])}return R}function _(x){if(!x)return null;var R=b(x);if(R.arr)return h(R.arr);var D={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},L=[];return p(x)&&p(x[0])&&(L=h(x)),L.length||String(x).replace(l,function(X,K,W){var oe=[],ee=K.toLowerCase();for(W.replace(c,function(te,de){de&&oe.push(+de)}),ee=="m"&&oe.length>2&&(L.push([K].concat(oe.splice(0,2))),ee="l",K=K=="m"?"l":"L");oe.length>=D[ee]&&(L.push([K].concat(oe.splice(0,D[ee]))),!!D[ee]););}),L.toString=b.toString,R.arr=h(L),L}function b(x){var R=b.ps=b.ps||{};return R[x]?R[x].sleep=100:R[x]={sleep:100},setTimeout(function(){for(var D in R)f(R,D)&&D!=x&&(R[D].sleep--,!R[D].sleep&&delete R[D])}),R[x]}function M(x,R,D,L){return arguments.length===1&&(R=x.y,D=x.width,L=x.height,x=x.x),{x,y:R,width:D,height:L,x2:x+D,y2:R+L}}function P(){return this.join(",").replace(e,"$1")}function S(x){var R=h(x);return R.toString=P,R}function w(x,R,D,L,X,K,W,oe,ee){var te=1-ee,de=o(te,3),ge=o(te,2),fe=ee*ee,Q=fe*ee,ne=de*x+ge*3*ee*D+te*3*ee*ee*X+Q*W,we=de*R+ge*3*ee*L+te*3*ee*ee*K+Q*oe;return{x:Y(ne),y:Y(we)}}function T(x){var R=g.apply(null,x);return M(R.x0,R.y0,R.x1-R.x0,R.y1-R.y0)}function N(x,R,D){return R>=x.x&&R<=x.x+x.width&&D>=x.y&&D<=x.y+x.height}function B(x,R){return x=M(x),R=M(R),N(R,x.x,x.y)||N(R,x.x2,x.y)||N(R,x.x,x.y2)||N(R,x.x2,x.y2)||N(x,R.x,R.y)||N(x,R.x2,R.y)||N(x,R.x,R.y2)||N(x,R.x2,R.y2)||(x.x<R.x2&&x.x>R.x||R.x<x.x2&&R.x>x.x)&&(x.y<R.y2&&x.y>R.y||R.y<x.y2&&R.y>x.y)}function $(x,R,D,L,X){var K=-3*R+9*D-9*L+3*X,W=x*K+6*R-12*D+6*L;return x*W-3*R+3*D}function H(x,R,D,L,X,K,W,oe,ee){ee==null&&(ee=1),ee=ee>1?1:ee<0?0:ee;for(var te=ee/2,de=12,ge=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],fe=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],Q=0,ne=0;ne<de;ne++){var we=te*ge[ne]+te,Pe=$(we,x,D,X,W),Te=$(we,R,L,K,oe),qe=Pe*Pe+Te*Te;Q+=fe[ne]*n.sqrt(qe)}return te*Q}function Z(x,R,D,L,X,K,W,oe){if(!(r(x,D)<a(X,W)||a(x,D)>r(X,W)||r(R,L)<a(K,oe)||a(R,L)>r(K,oe))){var ee=(x*L-R*D)*(X-W)-(x-D)*(X*oe-K*W),te=(x*L-R*D)*(K-oe)-(R-L)*(X*oe-K*W),de=(x-D)*(K-oe)-(R-L)*(X-W);if(de){var ge=Y(ee/de),fe=Y(te/de),Q=+ge.toFixed(2),ne=+fe.toFixed(2);if(!(Q<+a(x,D).toFixed(2)||Q>+r(x,D).toFixed(2)||Q<+a(X,W).toFixed(2)||Q>+r(X,W).toFixed(2)||ne<+a(R,L).toFixed(2)||ne>+r(R,L).toFixed(2)||ne<+a(K,oe).toFixed(2)||ne>+r(K,oe).toFixed(2)))return{x:ge,y:fe}}}}function Y(x){return Math.round(x*1e11)/1e11}function z(x,R,D){var L=T(x),X=T(R);if(!B(L,X))return D?0:[];for(var K=H.apply(0,x),W=H.apply(0,R),oe=u(x)?1:~~(K/5)||1,ee=u(R)?1:~~(W/5)||1,te=[],de=[],ge={},fe=D?0:[],Q=0;Q<oe+1;Q++){var ne=w.apply(0,x.concat(Q/oe));te.push({x:ne.x,y:ne.y,t:Q/oe})}for(Q=0;Q<ee+1;Q++)ne=w.apply(0,R.concat(Q/ee)),de.push({x:ne.x,y:ne.y,t:Q/ee});for(Q=0;Q<oe;Q++)for(var we=0;we<ee;we++){var Pe=te[Q],Te=te[Q+1],qe=de[we],xe=de[we+1],ke=s(Te.x-Pe.x)<.01?"y":"x",Ve=s(xe.x-qe.x)<.01?"y":"x",Ze=Z(Pe.x,Pe.y,Te.x,Te.y,qe.x,qe.y,xe.x,xe.y),ue;if(Ze){if(ue=Ze.x.toFixed(9)+"#"+Ze.y.toFixed(9),ge[ue])continue;ge[ue]=!0;var Ee=Pe.t+s((Ze[ke]-Pe[ke])/(Te[ke]-Pe[ke]))*(Te.t-Pe.t),Bn=qe.t+s((Ze[Ve]-qe[Ve])/(xe[Ve]-qe[Ve]))*(xe.t-qe.t);Ee>=0&&Ee<=1&&Bn>=0&&Bn<=1&&(D?fe++:fe.push({x:Ze.x,y:Ze.y,t1:Ee,t2:Bn}))}}return fe}function G(x,R,D){x=C(x),R=C(R);for(var L,X,K,W,oe,ee,te,de,ge,fe,Q=D?0:[],ne=0,we=x.length;ne<we;ne++){var Pe=x[ne];if(Pe[0]=="M")L=oe=Pe[1],X=ee=Pe[2];else{Pe[0]=="C"?(ge=[L,X].concat(Pe.slice(1)),L=ge[6],X=ge[7]):(ge=[L,X,L,X,oe,ee,oe,ee],L=oe,X=ee);for(var Te=0,qe=R.length;Te<qe;Te++){var xe=R[Te];if(xe[0]=="M")K=te=xe[1],W=de=xe[2];else{xe[0]=="C"?(fe=[K,W].concat(xe.slice(1)),K=fe[6],W=fe[7]):(fe=[K,W,K,W,te,de,te,de],K=te,W=de);var ke=z(ge,fe,D);if(D)Q+=ke;else{for(var Ve=0,Ze=ke.length;Ve<Ze;Ve++)ke[Ve].segment1=ne,ke[Ve].segment2=Te,ke[Ve].bez1=ge,ke[Ve].bez2=fe;Q=Q.concat(ke)}}}}}return Q}function se(x){var R=b(x);if(R.abs)return S(R.abs);if((!p(x)||!p(x&&x[0]))&&(x=_(x)),!x||!x.length)return[["M",0,0]];var D=[],L=0,X=0,K=0,W=0,oe=0,ee;x[0][0]=="M"&&(L=+x[0][1],X=+x[0][2],K=L,W=X,oe++,D[0]=["M",L,X]);for(var te,de,ge=oe,fe=x.length;ge<fe;ge++){if(D.push(te=[]),de=x[ge],ee=de[0],ee!=ee.toUpperCase())switch(te[0]=ee.toUpperCase(),te[0]){case"A":te[1]=de[1],te[2]=de[2],te[3]=de[3],te[4]=de[4],te[5]=de[5],te[6]=+de[6]+L,te[7]=+de[7]+X;break;case"V":te[1]=+de[1]+X;break;case"H":te[1]=+de[1]+L;break;case"M":K=+de[1]+L,W=+de[2]+X;default:for(var Q=1,ne=de.length;Q<ne;Q++)te[Q]=+de[Q]+(Q%2?L:X)}else for(var we=0,Pe=de.length;we<Pe;we++)te[we]=de[we];switch(ee=ee.toUpperCase(),te[0]){case"Z":L=+K,X=+W;break;case"H":L=te[1];break;case"V":X=te[1];break;case"M":K=te[te.length-2],W=te[te.length-1];default:L=te[te.length-2],X=te[te.length-1]}}return D.toString=P,R.abs=S(D),D}function u(x){return x[0]===x[2]&&x[1]===x[3]&&x[4]===x[6]&&x[5]===x[7]}function d(x,R,D,L){return[x,R,D,L,D,L]}function E(x,R,D,L,X,K){var W=.3333333333333333,oe=2/3;return[W*x+oe*D,W*R+oe*L,W*X+oe*D,W*K+oe*L,X,K]}function y(x,R,D,L,X,K,W,oe,ee,te){var de=i*120/180,ge=i/180*(+X||0),fe=[],Q,ne=m(function(ro,ao,Xi){var oo=ro*n.cos(Xi)-ao*n.sin(Xi),ml=ro*n.sin(Xi)+ao*n.cos(Xi);return{x:oo,y:ml}});if(te)ue=te[0],Ee=te[1],Ve=te[2],Ze=te[3];else{Q=ne(x,R,-ge),x=Q.x,R=Q.y,Q=ne(oe,ee,-ge),oe=Q.x,ee=Q.y;var we=(x-oe)/2,Pe=(R-ee)/2,Te=we*we/(D*D)+Pe*Pe/(L*L);Te>1&&(Te=n.sqrt(Te),D=Te*D,L=Te*L);var qe=D*D,xe=L*L,ke=(K==W?-1:1)*n.sqrt(s((qe*xe-qe*Pe*Pe-xe*we*we)/(qe*Pe*Pe+xe*we*we))),Ve=ke*D*Pe/L+(x+oe)/2,Ze=ke*-L*we/D+(R+ee)/2,ue=n.asin(((R-Ze)/L).toFixed(9)),Ee=n.asin(((ee-Ze)/L).toFixed(9));ue=x<Ve?i-ue:ue,Ee=oe<Ve?i-Ee:Ee,ue<0&&(ue=i*2+ue),Ee<0&&(Ee=i*2+Ee),W&&ue>Ee&&(ue=ue-i*2),!W&&Ee>ue&&(Ee=Ee-i*2)}var Bn=Ee-ue;if(s(Bn)>de){var Ya=Ee,Ka=oe,Xa=ee;Ee=ue+de*(W&&Ee>ue?1:-1),oe=Ve+D*n.cos(Ee),ee=Ze+L*n.sin(Ee),fe=y(oe,ee,D,L,X,0,W,Ka,Xa,[Ee,Ya,Ve,Ze])}Bn=Ee-ue;var Za=n.cos(ue),Ki=n.sin(ue),Vr=n.cos(Ee),hl=n.sin(Ee),Ja=n.tan(Bn/4),Qa=4/3*D*Ja,eo=4/3*L*Ja,to=[x,R],fn=[x+Qa*Ki,R-eo*Za],no=[oe+Qa*hl,ee-eo*Vr],io=[oe,ee];if(fn[0]=2*to[0]-fn[0],fn[1]=2*to[1]-fn[1],te)return[fn,no,io].concat(fe);fe=[fn,no,io].concat(fe).join().split(",");for(var Fr=[],dn=0,jr=fe.length;dn<jr;dn++)Fr[dn]=dn%2?ne(fe[dn-1],fe[dn],ge).y:ne(fe[dn],fe[dn+1],ge).x;return Fr}function g(x,R,D,L,X,K,W,oe){for(var ee=[],te=[[],[]],de,ge,fe,Q,ne,we,Pe,Te,qe=0;qe<2;++qe){if(qe==0?(ge=6*x-12*D+6*X,de=-3*x+9*D-9*X+3*W,fe=3*D-3*x):(ge=6*R-12*L+6*K,de=-3*R+9*L-9*K+3*oe,fe=3*L-3*R),s(de)<1e-12){if(s(ge)<1e-12)continue;Q=-fe/ge,0<Q&&Q<1&&ee.push(Q);continue}Pe=ge*ge-4*fe*de,Te=n.sqrt(Pe),!(Pe<0)&&(ne=(-ge+Te)/(2*de),0<ne&&ne<1&&ee.push(ne),we=(-ge-Te)/(2*de),0<we&&we<1&&ee.push(we))}for(var xe=ee.length,ke=xe,Ve;xe--;)Q=ee[xe],Ve=1-Q,te[0][xe]=Ve*Ve*Ve*x+3*Ve*Ve*Q*D+3*Ve*Q*Q*X+Q*Q*Q*W,te[1][xe]=Ve*Ve*Ve*R+3*Ve*Ve*Q*L+3*Ve*Q*Q*K+Q*Q*Q*oe;return te[0][ke]=x,te[1][ke]=R,te[0][ke+1]=W,te[1][ke+1]=oe,te[0].length=te[1].length=ke+2,{x0:a.apply(0,te[0]),y0:a.apply(0,te[1]),x1:r.apply(0,te[0]),y1:r.apply(0,te[1])}}function C(x){var R=b(x);if(R.curve)return S(R.curve);for(var D=se(x),L={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},X=function(Q,ne,we){var Pe,Te;if(!Q)return["C",ne.x,ne.y,ne.x,ne.y,ne.x,ne.y];switch(!(Q[0]in{T:1,Q:1})&&(ne.qx=ne.qy=null),Q[0]){case"M":ne.X=Q[1],ne.Y=Q[2];break;case"A":Q=["C"].concat(y.apply(0,[ne.x,ne.y].concat(Q.slice(1))));break;case"S":we=="C"||we=="S"?(Pe=ne.x*2-ne.bx,Te=ne.y*2-ne.by):(Pe=ne.x,Te=ne.y),Q=["C",Pe,Te].concat(Q.slice(1));break;case"T":we=="Q"||we=="T"?(ne.qx=ne.x*2-ne.qx,ne.qy=ne.y*2-ne.qy):(ne.qx=ne.x,ne.qy=ne.y),Q=["C"].concat(E(ne.x,ne.y,ne.qx,ne.qy,Q[1],Q[2]));break;case"Q":ne.qx=Q[1],ne.qy=Q[2],Q=["C"].concat(E(ne.x,ne.y,Q[1],Q[2],Q[3],Q[4]));break;case"L":Q=["C"].concat(d(ne.x,ne.y,Q[1],Q[2]));break;case"H":Q=["C"].concat(d(ne.x,ne.y,Q[1],ne.y));break;case"V":Q=["C"].concat(d(ne.x,ne.y,ne.x,Q[1]));break;case"Z":Q=["C"].concat(d(ne.x,ne.y,ne.X,ne.Y));break}return Q},K=function(Q,ne){if(Q[ne].length>7){Q[ne].shift();for(var we=Q[ne];we.length;)W[ne]="A",Q.splice(ne++,0,["C"].concat(we.splice(0,6)));Q.splice(ne,1),de=D.length}},W=[],oe="",ee="",te=0,de=D.length;te<de;te++){D[te]&&(oe=D[te][0]),oe!="C"&&(W[te]=oe,te&&(ee=W[te-1])),D[te]=X(D[te],L,ee),W[te]!="A"&&oe=="C"&&(W[te]="C"),K(D,te);var ge=D[te],fe=ge.length;L.x=ge[fe-2],L.y=ge[fe-1],L.bx=t(ge[fe-4])||L.x,L.by=t(ge[fe-3])||L.y}return R.curve=S(D),D}return Al=G,Al}var m_=h_();const Og=Er(m_);function Lg(e){return{x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}}function si(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function _e(e){return{top:e.y,right:e.x+(e.width||0),bottom:e.y+(e.height||0),left:e.x}}function hp(e){return{x:e.left,y:e.top,width:e.right-e.left,height:e.bottom-e.top}}function Me(e){return si({x:e.x+(e.width||0)/2,y:e.y+(e.height||0)/2})}function wt(e,t,n){n=n||0,st(n)||(n={x:n,y:n});var i=_e(e),a=_e(t),r=i.bottom+n.y<=a.top,o=i.left-n.x>=a.right,s=i.top-n.y>=a.bottom,l=i.right+n.x<=a.left,c=r?"top":s?"bottom":null,p=l?"left":o?"right":null;return p&&c?c+"-"+p:p||c||"intersect"}function Pc(e,t,n){var i=v_(e,t);return i.length===1||i.length===2&&ba(i[0],i[1])<1?si(i[0]):i.length>1?(i=nn(i,function(a){var r=Math.floor(a.t2*100)||1;return r=100-r,r=(r<10?"0":"")+r,a.segment2+"#"+r}),si(i[n?0:i.length-1])):null}function v_(e,t){return Og(e,t)}function g_(e){e=e.slice();for(var t=0,n,i,a;e[t];)n=e[t],i=e[t-1],a=e[t+1],ba(n,a)===0||dp(i,a,n)?e.splice(t,1):t++;return e}function qo(e,t){return Math.round(e*t)/t}function dd(e){return Re(e)?e+"px":e}function y_(e){for(;e.parent;)e=e.parent;return e}function E_(e){e=q({},{width:"100%",height:"100%"},e);var t=e.container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),q(n.style,{position:"relative",overflow:"hidden",width:dd(e.width),height:dd(e.height)}),t.appendChild(n),n}function Bg(e,t,n){var i=be("g");Le(i).add(t);var a=n!==void 0?n:e.childNodes.length-1;return e.insertBefore(i,e.childNodes[a]||null),i}var as="base",Rc="djs-element-hidden",$g=0,b_=1,x_={shape:["x","y","width","height"],connection:["waypoints"]};function De(e,t,n,i){this._eventBus=t,this._elementRegistry=i,this._graphicsFactory=n,this._init(e||{})}De.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"];De.prototype._init=function(e){var t=this._eventBus,n=this._container=E_(e),i=this._svg=be("svg");ae(i,{width:"100%",height:"100%"}),Ce(n,i);var a=this._viewport=Bg(i,"viewport");this._layers={},this._planes={},e.deferUpdate!==!1&&(this._viewboxChanged=sp(Pt(this._viewboxChanged,this),300)),t.on("diagram.init",function(){t.fire("canvas.init",{svg:i,viewport:a})},this),t.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed","plane.set"],function(){delete this._cachedViewbox},this),t.on("diagram.destroy",500,this._destroy,this),t.on("diagram.clear",500,this._clear,this)};De.prototype._destroy=function(e){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var t=this._container.parentNode;t&&t.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._planes,delete this._activePlane,delete this._viewport};De.prototype._clear=function(){var e=this,t=this._elementRegistry.getAll();t.forEach(function(n){var i=Mg(n);i==="root"?e.setRootElementForPlane(null,e.findPlane(n),!0):e._removeElement(n,i)}),this._activePlane=null,this._planes={},delete this._cachedViewbox};De.prototype.getDefaultLayer=function(){return this.getLayer(as,$g)};De.prototype.getLayer=function(e,t){if(!e)throw new Error("must specify a name");var n=this._layers[e];if(n||(n=this._layers[e]=this._createLayer(e,t)),typeof t<"u"&&n.index!==t)throw new Error("layer <"+e+"> already created at index <"+t+">");return n.group};De.prototype._createLayer=function(e,t){typeof t>"u"&&(t=b_);var n=Vt(this._layers,function(i,a){return t>=a.index&&i++,i},0);return{group:Bg(this._viewport,"layer-"+e,n),index:t}};De.prototype.getPlane=function(e){if(!e)throw new Error("must specify a name");return this._planes[e]};De.prototype.createPlane=function(e,t){if(!e)throw new Error("must specify a name");if(this._planes[e])throw new Error("plane "+e+" already exists");t||(t={id:"__implicitroot"+e,children:[],isImplicit:!0});var n=this.getLayer(e,$g);Le(n).add(Rc);var i=this._planes[e]={layer:n,name:e,rootElement:null};return this.setRootElementForPlane(t,i),i};De.prototype.setActivePlane=function(e){if(!e)throw new Error("must specify a plane");return typeof e=="string"&&(e=this.getPlane(e)),this._activePlane&&Le(this._activePlane.layer).add(Rc),this._activePlane=e,Le(e.layer).remove(Rc),e.rootElement&&this._elementRegistry.updateGraphics(e.rootElement,this._svg,!0),this._eventBus.fire("plane.set",{plane:e}),e};De.prototype.getActiveLayer=function(){return this.getActivePlane().layer};De.prototype.getActivePlane=function(){var e=this._activePlane;return e||(e=this.createPlane(as),this.setActivePlane(as)),e};De.prototype.findPlane=function(e){typeof e=="string"&&(e=this._elementRegistry.get(e));var t=y_(e);return Ue(this._planes,function(n){return n.rootElement===t})};De.prototype.getContainer=function(){return this._container};De.prototype._updateMarker=function(e,t,n){var i;e.id||(e=this._elementRegistry.get(e)),i=this._elementRegistry._elements[e.id],i&&(j([i.gfx,i.secondaryGfx],function(a){a&&(n?Le(a).add(t):Le(a).remove(t))}),this._eventBus.fire("element.marker.update",{element:e,gfx:i.gfx,marker:t,add:!!n}))};De.prototype.addMarker=function(e,t){this._updateMarker(e,t,!0)};De.prototype.removeMarker=function(e,t){this._updateMarker(e,t,!1)};De.prototype.hasMarker=function(e,t){e.id||(e=this._elementRegistry.get(e));var n=this.getGraphics(e);return Le(n).has(t)};De.prototype.toggleMarker=function(e,t){this.hasMarker(e,t)?this.removeMarker(e,t):this.addMarker(e,t)};De.prototype.getRootElement=function(){var e=this.getActivePlane();return e.rootElement};De.prototype.setRootElement=function(e,t){var n=this._activePlane;if(n)return this.setRootElementForPlane(e,n,t);var i=this.createPlane(as,e);return this.setActivePlane(i),i.rootElement};De.prototype.setRootElementForPlane=function(e,t,n){typeof t=="string"&&(t=this.getPlane(t)),e&&this._ensureValid("root",e);var i=t.rootElement,a=this._elementRegistry,r=this._eventBus;if(i){if(!n)throw new Error("rootElement already set, need to specify override");r.fire("root.remove",{element:i}),r.fire("root.removed",{element:i}),a.remove(i)}if(e){var o=t.layer;r.fire("root.add",{element:e}),a.add(e,o),r.fire("root.added",{element:e,gfx:o}),t===this._activePlane&&this._elementRegistry.updateGraphics(e,this._svg,!0)}return t.rootElement=e,e};De.prototype._ensureValid=function(e,t){if(!t.id)throw new Error("element must have an id");if(this._elementRegistry.get(t.id))throw new Error("element with id "+t.id+" already exists");var n=x_[e],i=$i(n,function(a){return typeof t[a]<"u"});if(!i)throw new Error("must supply { "+n.join(", ")+" } with "+e)};De.prototype._setParent=function(e,t,n){at(t.children,e,n),e.parent=t};De.prototype._addElement=function(e,t,n,i){n=n||this.getRootElement();var a=this._eventBus,r=this._graphicsFactory;this._ensureValid(e,t),a.fire(e+".add",{element:t,parent:n}),this._setParent(t,n,i);var o=r.create(e,t,i);return this._elementRegistry.add(t,o),r.update(e,t,o),a.fire(e+".added",{element:t,gfx:o}),t};De.prototype.addShape=function(e,t,n){return this._addElement("shape",e,t,n)};De.prototype.addConnection=function(e,t,n){return this._addElement("connection",e,t,n)};De.prototype._removeElement=function(e,t){var n=this._elementRegistry,i=this._graphicsFactory,a=this._eventBus;if(e=n.get(e.id||e),!!e)return a.fire(t+".remove",{element:e}),i.remove(e),rt(e.parent&&e.parent.children,e),e.parent=null,a.fire(t+".removed",{element:e}),n.remove(e),e};De.prototype.removeShape=function(e){return this._removeElement(e,"shape")};De.prototype.removeConnection=function(e){return this._removeElement(e,"connection")};De.prototype.getGraphics=function(e,t){return this._elementRegistry.getGraphics(e,t)};De.prototype._changeViewbox=function(e){this._eventBus.fire("canvas.viewbox.changing"),e.apply(this),this._cachedViewbox=null,this._viewboxChanged()};De.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})};De.prototype.viewbox=function(e){if(e===void 0&&this._cachedViewbox)return this._cachedViewbox;var t=this._viewport,n,i=this.getSize(),a,r,o,s,l;if(e)this._changeViewbox(function(){o=Math.min(i.width/e.width,i.height/e.height);var c=this._svg.createSVGMatrix().scale(o).translate(-e.x,-e.y);fa(t,c)});else return n=this._activePlane&&this._activePlane.layer.getBBox()||{},r=fa(t),a=r?r.matrix:Ux(),o=qo(a.a,1e3),s=qo(-a.e||0,1e3),l=qo(-a.f||0,1e3),e=this._cachedViewbox={x:s?s/o:0,y:l?l/o:0,width:i.width/o,height:i.height/o,scale:o,inner:{width:n.width||0,height:n.height||0,x:n.x||0,y:n.y||0},outer:i},e;return e};De.prototype.scroll=function(e){var t=this._viewport,n=t.getCTM();return e&&this._changeViewbox(function(){e=q({dx:0,dy:0},e||{}),n=this._svg.createSVGMatrix().translate(e.dx,e.dy).multiply(n),Vg(t,n)}),{x:n.e,y:n.f}};De.prototype.scrollToElement=function(e,t){var n=100;typeof e=="string"&&(e=this._elementRegistry.get(e));var i=this.findPlane(e);i!==this._activePlane&&this.setActivePlane(i),t||(t={}),typeof t=="number"&&(n=t),t={top:t.top||n,right:t.right||n,bottom:t.bottom||n,left:t.left||n};var a=St(e),r=_e(a),o=this.viewbox(),s=this.zoom(),l,c;o.y+=t.top/s,o.x+=t.left/s,o.width-=(t.right+t.left)/s,o.height-=(t.bottom+t.top)/s;var p=_e(o),f=a.width<o.width&&a.height<o.height;if(!f)l=a.x-o.x,c=a.y-o.y;else{var h=Math.max(0,r.right-p.right),v=Math.min(0,r.left-p.left),m=Math.max(0,r.bottom-p.bottom),_=Math.min(0,r.top-p.top);l=h||v,c=m||_}this.scroll({dx:-l*s,dy:-c*s})};De.prototype.zoom=function(e,t){if(!e)return this.viewbox(e).scale;if(e==="fit-viewport")return this._fitViewport(t);var n,i;return this._changeViewbox(function(){typeof t!="object"&&(n=this.viewbox().outer,t={x:n.width/2,y:n.height/2}),i=this._setZoom(e,t)}),qo(i.a,1e3)};function Vg(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}De.prototype._fitViewport=function(e){var t=this.viewbox(),n=t.outer,i=t.inner,a,r;return i.x>=0&&i.y>=0&&i.x+i.width<=n.width&&i.y+i.height<=n.height&&!e?r={x:0,y:0,width:Math.max(i.width+i.x,n.width),height:Math.max(i.height+i.y,n.height)}:(a=Math.min(1,n.width/i.width,n.height/i.height),r={x:i.x+(e?i.width/2-n.width/a/2:0),y:i.y+(e?i.height/2-n.height/a/2:0),width:n.width/a,height:n.height/a}),this.viewbox(r),this.viewbox(!1).scale};De.prototype._setZoom=function(e,t){var n=this._svg,i=this._viewport,a=n.createSVGMatrix(),r=n.createSVGPoint(),o,s,l,c,p;l=i.getCTM();var f=l.a;return t?(o=q(r,t),s=o.matrixTransform(l.inverse()),c=a.translate(s.x,s.y).scale(1/f*e).translate(-s.x,-s.y),p=l.multiply(c)):p=a.scale(e),Vg(this._viewport,p),p};De.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}};De.prototype.getAbsoluteBBox=function(e){var t=this.viewbox(),n;if(e.waypoints){var i=this.getGraphics(e);n=i.getBBox()}else n=e;var a=n.x*t.scale-t.x*t.scale,r=n.y*t.scale-t.y*t.scale,o=n.width*t.scale,s=n.height*t.scale;return{x:a,y:r,width:o,height:s}};De.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var pr="data-element-id";function qt(e){this._elements={},this._eventBus=e}qt.$inject=["eventBus"];qt.prototype.add=function(e,t,n){var i=e.id;this._validateId(i),ae(t,pr,i),n&&ae(n,pr,i),this._elements[i]={element:e,gfx:t,secondaryGfx:n}};qt.prototype.remove=function(e){var t=this._elements,n=e.id||e,i=n&&t[n];i&&(ae(i.gfx,pr,""),i.secondaryGfx&&ae(i.secondaryGfx,pr,""),delete t[n])};qt.prototype.updateId=function(e,t){this._validateId(t),typeof e=="string"&&(e=this.get(e)),this._eventBus.fire("element.updateId",{element:e,newId:t});var n=this.getGraphics(e),i=this.getGraphics(e,!0);this.remove(e),e.id=t,this.add(e,n,i)};qt.prototype.updateGraphics=function(e,t,n){var i=e.id||e,a=this._elements[i];return n?a.secondaryGfx=t:a.gfx=t,ae(t,pr,i),t};qt.prototype.get=function(e){var t;typeof e=="string"?t=e:t=e&&ae(e,pr);var n=this._elements[t];return n&&n.element};qt.prototype.filter=function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(n)}),t};qt.prototype.find=function(e){for(var t=this._elements,n=Object.keys(t),i=0;i<n.length;i++){var a=n[i],r=t[a],o=r.element,s=r.gfx;if(e(o,s))return o}};qt.prototype.getAll=function(){return this.filter(function(e){return e})};qt.prototype.forEach=function(e){var t=this._elements;Object.keys(t).forEach(function(n){var i=t[n],a=i.element,r=i.gfx;return e(a,r)})};qt.prototype.getGraphics=function(e,t){var n=e.id||e,i=this._elements[n];return i&&(t?i.secondaryGfx:i.gfx)};qt.prototype._validateId=function(e){if(!e)throw new Error("element must have an id");if(this._elements[e])throw new Error("element with id "+e+" already added")};var go={exports:{}},yo={},hd;function Fg(){if(hd)return yo;hd=1;function e(n,i,a,r){var o=a.inverse;return Object.defineProperty(n,"remove",{value:function(s){var l=this.indexOf(s);return l!==-1&&(this.splice(l,1),i.unset(s,o,r)),s}}),Object.defineProperty(n,"contains",{value:function(s){return this.indexOf(s)!==-1}}),Object.defineProperty(n,"add",{value:function(s,l){var c=this.indexOf(s);if(typeof l>"u"){if(c!==-1)return;l=this.length}c!==-1&&this.splice(c,1),this.splice(l,0,s),c===-1&&i.set(s,o,r)}}),Object.defineProperty(n,"__refs_collection",{value:!0}),n}function t(n){return n.__refs_collection===!0}return yo.extend=e,yo.isExtended=t,yo}var Pl,md;function __(){if(md)return Pl;md=1;var e=Fg();function t(r,o){return Object.prototype.hasOwnProperty.call(r,o.name||o)}function n(r,o,s){var l=e.extend(s[o.name]||[],r,o,s);Object.defineProperty(s,o.name,{enumerable:o.enumerable,value:l}),l.length&&l.forEach(function(c){r.set(c,o.inverse,s)})}function i(r,o,s){var l=o.inverse,c=s[o.name];Object.defineProperty(s,o.name,{configurable:o.configurable,enumerable:o.enumerable,get:function(){return c},set:function(p){if(p!==c){var f=c;c=null,f&&r.unset(f,l,s),c=p,r.set(c,l,s)}}})}function a(r,o){if(!(this instanceof a))return new a(r,o);r.inverse=o,o.inverse=r,this.props={},this.props[r.name]=r,this.props[o.name]=o}return a.prototype.bind=function(r,o){if(typeof o=="string"){if(!this.props[o])throw new Error("no property <"+o+"> in ref");o=this.props[o]}o.collection?n(this,o,r):i(this,o,r)},a.prototype.ensureRefsCollection=function(r,o){var s=r[o.name];return e.isExtended(s)||n(this,o,r),s},a.prototype.ensureBound=function(r,o){t(r,o)||this.bind(r,o)},a.prototype.unset=function(r,o,s){r&&(this.ensureBound(r,o),o.collection?this.ensureRefsCollection(r,o).remove(s):r[o.name]=void 0)},a.prototype.set=function(r,o,s){r&&(this.ensureBound(r,o),o.collection?this.ensureRefsCollection(r,o).add(s):r[o.name]=s)},Pl=a,Pl}var vd;function S_(){return vd||(vd=1,go.exports=__(),go.exports.Collection=Fg()),go.exports}var w_=S_();const _r=Er(w_);var jg=new _r({name:"children",enumerable:!0,collection:!0},{name:"parent"}),Hg=new _r({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),gd=new _r({name:"attachers",collection:!0},{name:"host"}),Gg=new _r({name:"outgoing",collection:!0},{name:"source"}),zg=new _r({name:"incoming",collection:!0},{name:"target"});function xa(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(e){var t=this.label,n=this.labels;!e&&t?n.remove(t):n.add(e,0)}}),jg.bind(this,"parent"),Hg.bind(this,"labels"),Gg.bind(this,"outgoing"),zg.bind(this,"incoming")}function Sr(){xa.call(this),jg.bind(this,"children"),gd.bind(this,"host"),gd.bind(this,"attachers")}ye(Sr,xa);function Ug(){Sr.call(this)}ye(Ug,Sr);function ws(){Sr.call(this),Hg.bind(this,"labelTarget")}ye(ws,Sr);function qg(){xa.call(this),Gg.bind(this,"source"),zg.bind(this,"target")}ye(qg,xa);var T_={connection:qg,shape:Sr,label:ws,root:Ug};function C_(e,t){var n=T_[e];if(!n)throw new Error("unknown type: <"+e+">");return q(new n,t)}function Wn(){this._uid=12}Wn.prototype.createRoot=function(e){return this.create("root",e)};Wn.prototype.createLabel=function(e){return this.create("label",e)};Wn.prototype.createShape=function(e){return this.create("shape",e)};Wn.prototype.createConnection=function(e){return this.create("connection",e)};Wn.prototype.create=function(e,t){return t=q({},t||{}),t.id||(t.id=e+"_"+this._uid++),C_(e,t)};var os="__fn",Wg=1e3,A_=Array.prototype.slice;function Ft(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}Ft.prototype.on=function(e,t,n,i){if(e=Oe(e)?e:[e],xt(t)&&(i=n,n=t,t=Wg),!Re(t))throw new Error("priority must be a number");var a=n;i&&(a=Pt(n,i),a[os]=n[os]||n);var r=this;e.forEach(function(o){r._addListener(o,{priority:t,callback:a,next:null})})};Ft.prototype.once=function(e,t,n,i){var a=this;if(xt(t)&&(i=n,n=t,t=Wg),!Re(t))throw new Error("priority must be a number");function r(){r.__isTomb=!0;var o=n.apply(i,arguments);return a.off(e,r),o}r[os]=n,this.on(e,t,r)};Ft.prototype.off=function(e,t){e=Oe(e)?e:[e];var n=this;e.forEach(function(i){n._removeListener(i,t)})};Ft.prototype.createEvent=function(e){var t=new _a;return t.init(e),t};Ft.prototype.fire=function(e,t){var n,i,a,r;if(r=A_.call(arguments),typeof e=="object"&&(t=e,e=t.type),!e)throw new Error("no event type specified");if(i=this._listeners[e],!!i){t instanceof _a?n=t:n=this.createEvent(t),r[0]=n;var o=n.type;e!==o&&(n.type=e);try{a=this._invokeListeners(n,r,i)}finally{e!==o&&(n.type=o)}return a===void 0&&n.defaultPrevented&&(a=!1),a}};Ft.prototype.handleError=function(e){return this.fire("error",{error:e})===!1};Ft.prototype._destroy=function(){this._listeners={}};Ft.prototype._invokeListeners=function(e,t,n){for(var i;n&&!e.cancelBubble;)i=this._invokeListener(e,t,n),n=n.next;return i};Ft.prototype._invokeListener=function(e,t,n){var i;if(n.callback.__isTomb)return i;try{i=P_(n.callback,t),i!==void 0&&(e.returnValue=i,e.stopPropagation()),i===!1&&e.preventDefault()}catch(a){if(!this.handleError(a))throw console.error("unhandled error in event listener",a),a}return i};Ft.prototype._addListener=function(e,t){var n=this._getListeners(e),i;if(!n){this._setListeners(e,t);return}for(;n;){if(n.priority<t.priority){t.next=n,i?i.next=t:this._setListeners(e,t);return}i=n,n=n.next}i.next=t};Ft.prototype._getListeners=function(e){return this._listeners[e]};Ft.prototype._setListeners=function(e,t){this._listeners[e]=t};Ft.prototype._removeListener=function(e,t){var n=this._getListeners(e),i,a,r;if(!t){this._setListeners(e,null);return}for(;n;)i=n.next,r=n.callback,(r===t||r[os]===t)&&(a?a.next=i:this._setListeners(e,i)),a=n,n=i};function _a(){}_a.prototype.stopPropagation=function(){this.cancelBubble=!0};_a.prototype.preventDefault=function(){this.defaultPrevented=!0};_a.prototype.init=function(e){q(this,e||{})};function P_(e,t){return e.apply(null,t)}function ss(e){return e.childNodes[0]}function R_(e){return e.parentNode.childNodes[1]}function Ic(e,t,n,i,a){var r=na();r.setTranslate(t,n);var o=na();o.setRotate(i||0,0,0);var s=na();s.setScale(1,1),fa(e,[r,o,s])}function Bt(e,t,n){var i=na();i.setTranslate(t,n),fa(e,i)}function Yg(e,t){var n=na();n.setRotate(t,0,0),fa(e,n)}function Wt(e,t){this._eventBus=e,this._elementRegistry=t}Wt.$inject=["eventBus","elementRegistry"];Wt.prototype._getChildrenContainer=function(e){var t=this._elementRegistry.getGraphics(e),n;return e.parent?(n=R_(t),n||(n=be("g"),Le(n).add("djs-children"),Ce(t.parentNode,n))):n=t,n};Wt.prototype._clear=function(e){var t=ss(e);return _s(t),t};Wt.prototype._createContainer=function(e,t,n,i){var a=be("g");Le(a).add("djs-group"),typeof n<"u"?Kg(a,t,t.childNodes[n]):Ce(t,a);var r=be("g");Le(r).add("djs-element"),Le(r).add("djs-"+e),i&&Le(r).add("djs-frame"),Ce(a,r);var o=be("g");return Le(o).add("djs-visual"),Ce(r,o),r};Wt.prototype.create=function(e,t,n){var i=this._getChildrenContainer(t.parent);return this._createContainer(e,i,n,Dg(t))};Wt.prototype.updateContainments=function(e){var t=this,n=this._elementRegistry,i;i=Vt(e,function(a,r){return r.parent&&(a[r.parent.id]=r.parent),a},{}),j(i,function(a){var r=a.children;if(r){var o=t._getChildrenContainer(a);j(r.slice().reverse(),function(s){var l=n.getGraphics(s);Kg(l.parentNode,o)})}})};Wt.prototype.drawShape=function(e,t){var n=this._eventBus;return n.fire("render.shape",{gfx:e,element:t})};Wt.prototype.getShapePath=function(e){var t=this._eventBus;return t.fire("render.getShapePath",e)};Wt.prototype.drawConnection=function(e,t){var n=this._eventBus;return n.fire("render.connection",{gfx:e,element:t})};Wt.prototype.getConnectionPath=function(e){var t=this._eventBus;return t.fire("render.getConnectionPath",e)};Wt.prototype.update=function(e,t,n){if(t.parent){var i=this._clear(n);if(e==="shape")this.drawShape(i,t),Bt(n,t.x,t.y);else if(e==="connection")this.drawConnection(i,t);else throw new Error("unknown type: "+e);t.hidden?ae(n,"display","none"):ae(n,"display","block")}};Wt.prototype.remove=function(e){var t=this._elementRegistry.getGraphics(e);ot(t.parentNode)};function Kg(e,t,n){var i=n||t.firstChild;e!==i&&t.insertBefore(e,i)}const I_={__depends__:[p_],__init__:["canvas"],canvas:["type",De],elementRegistry:["type",qt],elementFactory:["type",Wn],eventBus:["type",Ft],graphicsFactory:["type",Wt]};function N_(e){var t=[],n=[];function i(s){return t.indexOf(s)>=0}function a(s){t.push(s)}function r(s){i(s)||((s.__depends__||[]).forEach(r),!i(s)&&(a(s),(s.__init__||[]).forEach(function(l){n.push(l)})))}e.forEach(r);var o=new Cc(t);return n.forEach(function(s){try{o[typeof s=="string"?"get":"invoke"](s)}catch(l){throw console.error("Failed to instantiate component"),console.error(l.stack),l}}),o}function M_(e){e=e||{};var t={config:["value",e]},n=[t,I_].concat(e.modules||[]);return N_(n)}function wr(e,t){this.injector=t=t||M_(e),this.get=t.get,this.invoke=t.invoke,this.get("eventBus").fire("diagram.init")}wr.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")};wr.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};function mp(){}mp.prototype.get=function(e){return this.$model.properties.get(this,e)};mp.prototype.set=function(e,t){this.$model.properties.set(this,e,t)};function Xg(e,t){this.model=e,this.properties=t}Xg.prototype.createType=function(e){var t=this.model,n=this.properties,i=Object.create(mp.prototype);j(e.properties,function(o){!o.isMany&&o.default!==void 0&&(i[o.name]=o.default)}),n.defineModel(i,t),n.defineDescriptor(i,e);var a=e.ns.name;function r(o){n.define(this,"$type",{value:a,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),j(o,Pt(function(s,l){this.set(l,s)},this))}return r.prototype=i,r.hasType=i.$instanceOf=this.model.hasType,n.defineModel(r,t),n.defineDescriptor(r,e),r};var D_={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},Zg={String:function(e){return e},Boolean:function(e){return e==="true"},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e)}};function vp(e,t){var n=Zg[e];return n?n(t):t}function Nc(e){return!!D_[e]}function Jg(e){return!!Zg[e]}function Nt(e,t){var n=e.split(/:/),i,a;if(n.length===1)i=e,a=t;else if(n.length===2)i=n[1],a=n[0];else throw new Error("expected <prefix:localName> or <localName>, got "+e);return e=(a?a+":":"")+i,{name:e,prefix:a,localName:i}}function an(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}an.prototype.build=function(){return rn(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])};an.prototype.addProperty=function(e,t,n){typeof t=="boolean"&&(n=t,t=void 0),this.addNamedProperty(e,n!==!1);var i=this.properties;t!==void 0?i.splice(t,0,e):i.push(e)};an.prototype.replaceProperty=function(e,t,n){var i=e.ns,a=this.properties,r=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var s=a.indexOf(e);if(s===-1)throw new Error("property <"+i.name+"> not found in property list");a.splice(s,1),this.addProperty(t,n?void 0:s,o),r[i.name]=r[i.localName]=t};an.prototype.redefineProperty=function(e,t,n){var i=e.ns.prefix,a=t.split("#"),r=Nt(a[0],i),o=Nt(a[1],r.prefix).name,s=this.propertiesByName[o];if(s)this.replaceProperty(s,e,n);else throw new Error("refined property <"+o+"> not found");delete e.redefines};an.prototype.addNamedProperty=function(e,t){var n=e.ns,i=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),i[n.name]=i[n.localName]=e};an.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]};an.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e};an.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e};an.prototype.assertNotDefined=function(e,t){var n=e.name,i=this.propertiesByName[n];if(i)throw new Error("property <"+n+"> already defined; override of <"+i.definedBy.ns.name+"#"+i.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")};an.prototype.hasProperty=function(e){return this.propertiesByName[e]};an.prototype.addTrait=function(e,t){var n=this.allTypesByName,i=this.allTypes,a=e.name;a in n||(j(e.properties,Pt(function(r){r=q({},r,{name:r.ns.localName,inherited:t}),Object.defineProperty(r,"definedBy",{value:e});var o=r.replaces,s=r.redefines;o||s?this.redefineProperty(r,o||s,o):(r.isBody&&this.setBodyProperty(r),r.isId&&this.setIdProperty(r),this.addProperty(r))},this)),i.push(e),n[a]=e)};function hi(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,j(e,Pt(this.registerPackage,this))}hi.prototype.getPackage=function(e){return this.packageMap[e]};hi.prototype.getPackages=function(){return this.packages};hi.prototype.registerPackage=function(e){e=q({},e);var t=this.packageMap;yd(t,e,"prefix"),yd(t,e,"uri"),j(e.types,Pt(function(n){this.registerType(n,e)},this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)};hi.prototype.registerType=function(e,t){e=q({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:q(e.meta||{})});var n=Nt(e.name,t.prefix),i=n.name,a={};j(e.properties,Pt(function(r){var o=Nt(r.name,n.prefix),s=o.name;Nc(r.type)||(r.type=Nt(r.type,o.prefix).name),q(r,{ns:o,name:s}),a[s]=r},this)),q(e,{ns:n,name:i,propertiesByName:a}),j(e.extends,Pt(function(r){var o=this.typeMap[r];o.traits=o.traits||[],o.traits.push(i)},this)),this.definePackage(e,t),this.typeMap[i]=e};hi.prototype.mapTypes=function(e,t,n){var i=Nc(e.name)?{name:e.name}:this.typeMap[e.name],a=this;function r(s){return o(s,!0)}function o(s,l){var c=Nt(s,Nc(s)?"":e.prefix);a.mapTypes(c,t,l)}if(!i)throw new Error("unknown type <"+e.name+">");j(i.superClass,n?r:o),t(i,!n),j(i.traits,r)};hi.prototype.getEffectiveDescriptor=function(e){var t=Nt(e),n=new an(t);this.mapTypes(t,function(a,r){n.addTrait(a,r)});var i=n.build();return this.definePackage(i,i.allTypes[i.allTypes.length-1].$pkg),i};hi.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})};function yd(e,t,n){var i=t[n];if(i in e)throw new Error("package with "+n+" <"+i+"> already defined")}function Tr(e){this.model=e}Tr.prototype.set=function(e,t,n){if(!$t(t)||!t.length)throw new TypeError("property name must be a non-empty string");var i=this.model.getPropertyDescriptor(e,t),a=i&&i.name;k_(n)?i?delete e[a]:delete e.$attrs[t]:i?a in e?e[a]=n:Qg(e,i,n):e.$attrs[t]=n};Tr.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var i=n.name;return!e[i]&&n.isMany&&Qg(e,n,[]),e[i]};Tr.prototype.define=function(e,t,n){if(!n.writable){var i=n.value;n=q({},n,{get:function(){return i}}),delete n.value}Object.defineProperty(e,t,n)};Tr.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})};Tr.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})};function k_(e){return typeof e>"u"}function Qg(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function on(e){this.properties=new Tr(this),this.factory=new Xg(this,this.properties),this.registry=new hi(e,this.properties),this.typeCache={}}on.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)};on.prototype.getType=function(e){var t=this.typeCache,n=$t(e)?e:e.ns.name,i=t[n];return i||(e=this.registry.getEffectiveDescriptor(n),i=t[n]=this.factory.createType(e)),i};on.prototype.createAny=function(e,t,n){var i=Nt(e),a={$type:e,$instanceOf:function(o){return o===this.$type}},r={name:e,isGeneric:!0,ns:{prefix:i.prefix,localName:i.localName,uri:t}};return this.properties.defineDescriptor(a,r),this.properties.defineModel(a,this),this.properties.define(a,"$parent",{enumerable:!1,writable:!0}),this.properties.define(a,"$instanceOf",{enumerable:!1,writable:!0}),j(n,function(o,s){st(o)&&o.value!==void 0?a[o.name]=o.value:a[s]=o}),a};on.prototype.getPackage=function(e){return this.registry.getPackage(e)};on.prototype.getPackages=function(){return this.registry.getPackages()};on.prototype.getElementDescriptor=function(e){return e.$descriptor};on.prototype.hasType=function(e,t){t===void 0&&(t=e,e=this);var n=e.$model.getElementDescriptor(e);return t in n.allTypesByName};on.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]};on.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var Ed=String.fromCharCode,O_=Object.prototype.hasOwnProperty,L_=/&#(\d+);|&#x([0-9a-f]+);|&(\w+);/ig,ia={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'};Object.keys(ia).forEach(function(e){ia[e.toUpperCase()]=ia[e]});function B_(e,t,n,i){return i?O_.call(ia,i)?ia[i]:"&"+i+";":Ed(t||parseInt(n,16))}function Ai(e){return e.length>3&&e.indexOf("&")!==-1?e.replace(L_,B_):e}var $_="http://www.w3.org/2001/XMLSchema-instance",V_="xsi",bd="xsi:type",xd="non-whitespace outside of root node";function er(e){return new Error(e)}function _d(e){return"missing namespace for prefix <"+e+">"}function Eo(e){return{get:e,enumerable:!0}}function F_(e){var t={},n;for(n in e)t[n]=e[n];return t}function Mc(e){return e+"$uri"}function j_(e){var t={},n,i;for(n in e)i=e[n],t[i]=i,t[Mc(i)]=n;return t}function Sd(){return{line:0,column:0}}function H_(e){throw e}function ey(e){if(!this)return new ey(e);var t=e&&e.proxy,n,i,a,r,o=H_,s,l,c,p,f=Sd,h=!1,v=!1,m=null,_=!1,b;function M(w){w instanceof Error||(w=er(w)),m=w,o(w,f)}function P(w){s&&(w instanceof Error||(w=er(w)),s(w,f))}this.on=function(w,T){if(typeof T!="function")throw er("required args <name, cb>");switch(w){case"openTag":i=T;break;case"text":n=T;break;case"closeTag":a=T;break;case"error":o=T;break;case"warn":s=T;break;case"cdata":r=T;break;case"attention":p=T;break;case"question":c=T;break;case"comment":l=T;break;default:throw er("unsupported event: "+w)}return this},this.ns=function(w){if(typeof w>"u"&&(w={}),typeof w!="object")throw er("required args <nsMap={}>");var T={},N;for(N in w)T[N]=w[N];return T[$_]=V_,v=!0,b=T,this},this.parse=function(w){if(typeof w!="string")throw er("required args <xml=string>");return m=null,S(w),f=Sd,_=!1,m},this.stop=function(){_=!0};function S(w){var T=v?[]:null,N=v?j_(b):null,B,$=[],H=0,Z=!1,Y=!1,z=0,G=0,se,u,d,E,y,g,C,x,R,D="",L=0,X;function K(){if(X!==null)return X;var oe,ee,te,de=v&&N.xmlns,ge=v&&h?[]:null,fe=L,Q=D,ne=Q.length,we,Pe,Te,qe,xe,ke={},Ve={},Ze,ue,Ee;e:for(;fe<ne;fe++)if(Ze=!1,ue=Q.charCodeAt(fe),!(ue===32||ue<14&&ue>8)){for((ue<65||ue>122||ue>90&&ue<97)&&ue!==95&&ue!==58&&(P("illegal first char attribute name"),Ze=!0),Ee=fe+1;Ee<ne;Ee++)if(ue=Q.charCodeAt(Ee),!(ue>96&&ue<123||ue>64&&ue<91||ue>47&&ue<59||ue===46||ue===45||ue===95)){if(ue===32||ue<14&&ue>8){P("missing attribute value"),fe=Ee;continue e}if(ue===61)break;P("illegal attribute name char"),Ze=!0}if(xe=Q.substring(fe,Ee),xe==="xmlns:xmlns"&&(P("illegal declaration of xmlns"),Ze=!0),ue=Q.charCodeAt(Ee+1),ue===34)Ee=Q.indexOf('"',fe=Ee+2),Ee===-1&&(Ee=Q.indexOf("'",fe),Ee!==-1&&(P("attribute value quote missmatch"),Ze=!0));else if(ue===39)Ee=Q.indexOf("'",fe=Ee+2),Ee===-1&&(Ee=Q.indexOf('"',fe),Ee!==-1&&(P("attribute value quote missmatch"),Ze=!0));else for(P("missing attribute value quotes"),Ze=!0,Ee=Ee+1;Ee<ne&&(ue=Q.charCodeAt(Ee+1),!(ue===32||ue<14&&ue>8));Ee++);for(Ee===-1&&(P("missing closing quotes"),Ee=ne,Ze=!0),Ze||(Te=Q.substring(fe,Ee)),fe=Ee;Ee+1<ne&&(ue=Q.charCodeAt(Ee+1),!(ue===32||ue<14&&ue>8));Ee++)fe===Ee&&(P("illegal character after attribute end"),Ze=!0);if(fe=Ee+1,Ze)continue e;if(xe in Ve){P("attribute <"+xe+"> already defined");continue}if(Ve[xe]=!0,!v){ke[xe]=Te;continue}if(h){if(Pe=xe==="xmlns"?"xmlns":xe.charCodeAt(0)===120&&xe.substr(0,6)==="xmlns:"?xe.substr(6):null,Pe!==null){if(oe=Ai(Te),ee=Mc(Pe),qe=b[oe],!qe){if(Pe==="xmlns"||ee in N&&N[ee]!==oe)do qe="ns"+H++;while(typeof N[qe]<"u");else qe=Pe;b[oe]=qe}N[Pe]!==qe&&(we||(N=F_(N),we=!0),N[Pe]=qe,Pe==="xmlns"&&(N[Mc(qe)]=oe,de=qe),N[ee]=oe),ke[xe]=Te;continue}ge.push(xe,Te);continue}if(ue=xe.indexOf(":"),ue===-1){ke[xe]=Te;continue}if(!(te=N[xe.substring(0,ue)])){P(_d(xe.substring(0,ue)));continue}xe=de===te?xe.substr(ue+1):te+xe.substr(ue),xe===bd&&(ue=Te.indexOf(":"),ue!==-1?(te=Te.substring(0,ue),te=N[te]||te,Te=te+Te.substring(ue)):Te=de+":"+Te),ke[xe]=Te}if(h)for(fe=0,ne=ge.length;fe<ne;fe++){if(xe=ge[fe++],Te=ge[fe],ue=xe.indexOf(":"),ue!==-1){if(!(te=N[xe.substring(0,ue)])){P(_d(xe.substring(0,ue)));continue}xe=de===te?xe.substr(ue+1):te+xe.substr(ue),xe===bd&&(ue=Te.indexOf(":"),ue!==-1?(te=Te.substring(0,ue),te=N[te]||te,Te=te+Te.substring(ue)):Te=de+":"+Te)}ke[xe]=Te}return X=ke}function W(){for(var oe=/(\r\n|\r|\n)/g,ee=0,te=0,de=0,ge=G,fe,Q;z>=de&&(fe=oe.exec(w),!(!fe||(ge=fe[0].length+fe.index,ge>z)));)ee+=1,de=ge;return z==-1?(te=ge,Q=w.substring(G)):G===0?Q=w.substring(G,z):(te=z-de,Q=G==-1?w.substring(z):w.substring(z,G+1)),{data:Q,line:ee,column:te}}for(f=W,t&&(R=Object.create({},{name:Eo(function(){return C}),originalName:Eo(function(){return x}),attrs:Eo(K),ns:Eo(function(){return N})}));G!==-1;){if(w.charCodeAt(G)===60?z=G:z=w.indexOf("<",G),z===-1){if($.length)return M("unexpected end of file");if(G===0)return M("missing start tag");G<w.length&&w.substring(G).trim()&&P(xd);return}if(G!==z){if($.length){if(n&&(n(w.substring(G,z),Ai,f),_))return}else if(w.substring(G,z).trim()&&(P(xd),_))return}if(E=w.charCodeAt(z+1),E===33){if(d=w.charCodeAt(z+2),d===91&&w.substr(z+3,6)==="CDATA["){if(G=w.indexOf("]]>",z),G===-1)return M("unclosed cdata");if(r&&(r(w.substring(z+9,G),f),_))return;G+=3;continue}if(d===45&&w.charCodeAt(z+3)===45){if(G=w.indexOf("-->",z),G===-1)return M("unclosed comment");if(l&&(l(w.substring(z+4,G),Ai,f),_))return;G+=3;continue}}if(E===63){if(G=w.indexOf("?>",z),G===-1)return M("unclosed question");if(c&&(c(w.substring(z,G+2),f),_))return;G+=2;continue}for(se=z+1;;se++){if(y=w.charCodeAt(se),isNaN(y))return G=-1,M("unclosed tag");if(y===34)d=w.indexOf('"',se+1),se=d!==-1?d:se;else if(y===39)d=w.indexOf("'",se+1),se=d!==-1?d:se;else if(y===62){G=se;break}}if(E===33){if(p&&(p(w.substring(z,G+1),Ai,f),_))return;G+=1;continue}if(X={},E===47){if(Z=!1,Y=!0,!$.length)return M("missing open tag");if(se=C=$.pop(),d=z+2+se.length,w.substring(z+2,d)!==se)return M("closing tag mismatch");for(;d<G;d++)if(E=w.charCodeAt(d),!(E===32||E>8&&E<14))return M("close tag")}else{if(w.charCodeAt(G-1)===47?(se=C=w.substring(z+1,G-1),Z=!0,Y=!0):(se=C=w.substring(z+1,G),Z=!0,Y=!1),!(E>96&&E<123||E>64&&E<91||E===95||E===58))return M("illegal first char nodeName");for(d=1,u=se.length;d<u;d++)if(E=se.charCodeAt(d),!(E>96&&E<123||E>64&&E<91||E>47&&E<59||E===45||E===95||E==46)){if(E===32||E<14&&E>8){C=se.substring(0,d),X=null;break}return M("invalid nodeName")}Y||$.push(C)}if(v){if(B=N,Z&&(Y||T.push(B),X===null&&(h=se.indexOf("xmlns",d)!==-1)&&(L=d,D=se,K(),h=!1)),x=C,E=C.indexOf(":"),E!==-1){if(g=N[C.substring(0,E)],!g)return M("missing namespace on <"+x+">");C=C.substr(E+1)}else g=N.xmlns;g&&(C=g+":"+C)}if(Z&&(L=d,D=se,i&&(t?i(R,Ai,Y,f):i(C,K,Ai,Y,f),_)))return;if(Y){if(a&&(a(t?R:C,Ai,Z,f),_))return;v&&(Z?N=B:N=T.pop())}G+=1}}}function ty(e){return e.xml&&e.xml.tagAlias==="lowerCase"}var G_={xsi:"http://www.w3.org/2001/XMLSchema-instance",xml:"http://www.w3.org/XML/1998/namespace"},Ts="xsi:type";function ny(e){return e.xml&&e.xml.serialize}function iy(e){return ny(e)===Ts}function z_(e){return ny(e)==="property"}function U_(e){return e.charAt(0).toUpperCase()+e.slice(1)}function ry(e,t){return ty(t)?e.prefix+":"+U_(e.localName):e.name}function q_(e,t){var n=e.name,i=e.localName,a=t.xml&&t.xml.typePrefix;return a&&i.indexOf(a)===0?e.prefix+":"+i.slice(a.length):n}function W_(e,t){var n=Nt(e),i=t.getPackage(n.prefix);return q_(n,i)}function ci(e){return new Error(e)}function Hn(e){return e.$descriptor}function Y_(e){q(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(t){this.references.push(t)},this.addElement=function(t){if(!t)throw ci("expected element");var n=this.elementsById,i=Hn(t),a=i.idProperty,r;if(a&&(r=t.get(a.name),r)){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(r))throw new Error("illegal ID <"+r+">");if(n[r])throw ci("duplicate ID <"+r+">");n[r]=t}},this.addWarning=function(t){this.warnings.push(t)}}function Sa(){}Sa.prototype.handleEnd=function(){};Sa.prototype.handleText=function(){};Sa.prototype.handleNode=function(){};function gp(){}gp.prototype=Object.create(Sa.prototype);gp.prototype.handleNode=function(){return this};function Cr(){}Cr.prototype=Object.create(Sa.prototype);Cr.prototype.handleText=function(e){this.body=(this.body||"")+e};function wa(e,t){this.property=e,this.context=t}wa.prototype=Object.create(Cr.prototype);wa.prototype.handleNode=function(e){if(this.element)throw ci("expected no sub nodes");return this.element=this.createReference(e),this};wa.prototype.handleEnd=function(){this.element.id=this.body};wa.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}};function yp(e,t){this.element=t,this.propertyDesc=e}yp.prototype=Object.create(Cr.prototype);yp.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=vp(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)};function Cs(){}Cs.prototype=Object.create(Cr.prototype);Cs.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t};function Rt(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}Rt.prototype=Object.create(Cs.prototype);Rt.prototype.addReference=function(e){this.context.addReference(e)};Rt.prototype.handleText=function(e){var t=this.element,n=Hn(t),i=n.bodyProperty;if(!i)throw ci("unexpected body text <"+e+">");Cr.prototype.handleText.call(this,e)};Rt.prototype.handleEnd=function(){var e=this.body,t=this.element,n=Hn(t),i=n.bodyProperty;i&&e!==void 0&&(e=vp(i.type,e),t.set(i.name,e))};Rt.prototype.createElement=function(e){var t=e.attributes,n=this.type,i=Hn(n),a=this.context,r=new n({}),o=this.model,s;return j(t,function(l,c){var p=i.propertiesByName[c],f;p&&p.isReference?p.isMany?(f=l.split(" "),j(f,function(h){a.addReference({element:r,property:p.ns.name,id:h})})):a.addReference({element:r,property:p.ns.name,id:l}):(p?l=vp(p.type,l):c!=="xmlns"&&(s=Nt(c,i.ns.prefix),o.getPackage(s.prefix)&&a.addWarning({message:"unknown attribute <"+c+">",element:r,property:c,value:l})),r.set(c,l))}),r};Rt.prototype.getPropertyForNode=function(e){var t=e.name,n=Nt(t),i=this.type,a=this.model,r=Hn(i),o=n.name,s=r.propertiesByName[o],l,c;if(s&&!s.isAttr)return iy(s)&&(l=e.attributes[Ts],l)?(l=W_(l,a),c=a.getType(l),q({},s,{effectiveType:Hn(c).name})):s;var p=a.getPackage(n.prefix);if(p){if(l=ry(n,p),c=a.getType(l),s=Ue(r.properties,function(f){return!f.isVirtual&&!f.isReference&&!f.isAttribute&&c.hasType(f.type)}),s)return q({},s,{effectiveType:Hn(c).name})}else if(s=Ue(r.properties,function(f){return!f.isReference&&!f.isAttribute&&f.type==="Element"}),s)return s;throw ci("unrecognized element <"+n.name+">")};Rt.prototype.toString=function(){return"ElementDescriptor["+Hn(this.type).name+"]"};Rt.prototype.valueHandler=function(e,t){return new yp(e,t)};Rt.prototype.referenceHandler=function(e){return new wa(e,this.context)};Rt.prototype.handler=function(e){return e==="Element"?new fr(this.model,e,this.context):new Rt(this.model,e,this.context)};Rt.prototype.handleChild=function(e){var t,n,i,a;if(t=this.getPropertyForNode(e),i=this.element,n=t.effectiveType||t.type,Jg(n))return this.valueHandler(t,i);t.isReference?a=this.referenceHandler(t).handleNode(e):a=this.handler(n).handleNode(e);var r=a.element;return r!==void 0&&(t.isMany?i.get(t.name).push(r):i.set(t.name,r),t.isReference?(q(r,{element:i}),this.context.addReference(r)):r.$parent=i),a};function Ep(e,t,n){Rt.call(this,e,t,n)}Ep.prototype=Object.create(Rt.prototype);Ep.prototype.createElement=function(e){var t=e.name,n=Nt(t),i=this.model,a=this.type,r=i.getPackage(n.prefix),o=r&&ry(n,r)||t;if(!a.hasType(o))throw ci("unexpected element <"+e.originalName+">");return Rt.prototype.createElement.call(this,e)};function fr(e,t,n){this.model=e,this.context=n}fr.prototype=Object.create(Cs.prototype);fr.prototype.createElement=function(e){var t=e.name,n=Nt(t),i=n.prefix,a=e.ns[i+"$uri"],r=e.attributes;return this.model.createAny(t,a,r)};fr.prototype.handleChild=function(e){var t=new fr(this.model,"Element",this.context).handleNode(e),n=this.element,i=t.element,a;return i!==void 0&&(a=n.$children=n.$children||[],a.push(i),i.$parent=n),t};fr.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)};function bp(e){e instanceof on&&(e={model:e}),q(this,{lax:!1},e)}bp.prototype.fromXML=function(e,t,n){var i=t.rootHandler;t instanceof Rt?(i=t,t={}):typeof t=="string"?(i=this.handler(t),t={}):typeof i=="string"&&(i=this.handler(i));var a=this.model,r=this.lax,o=new Y_(q({},t,{rootHandler:i})),s=new ey({proxy:!0}),l=K_();i.context=o,l.push(i);function c(T,N,B){var $=N(),H=$.line,Z=$.column,Y=$.data;Y.charAt(0)==="<"&&Y.indexOf(" ")!==-1&&(Y=Y.slice(0,Y.indexOf(" "))+">");var z="unparsable content "+(Y?Y+" ":"")+`detected
	line: `+H+`
	column: `+Z+`
	nested error: `+T.message;if(B)return o.addWarning({message:z,error:T}),!0;throw ci(z)}function p(T,N){return c(T,N,!0)}function f(){var T=o.elementsById,N=o.references,B,$;for(B=0;$=N[B];B++){var H=$.element,Z=T[$.id],Y=Hn(H).propertiesByName[$.property];if(Z||o.addWarning({message:"unresolved reference <"+$.id+">",element:$.element,property:$.property,value:$.id}),Y.isMany){var z=H.get(Y.name),G=z.indexOf($);G===-1&&(G=z.length),Z?z[G]=Z:z.splice(G,1)}else H.set(Y.name,Z)}}function h(){l.pop().handleEnd()}var v=/^<\?xml /i,m=/ encoding="([^"]+)"/i,_=/^utf-8$/i;function b(T){if(v.test(T)){var N=m.exec(T),B=N&&N[1];!B||_.test(B)||o.addWarning({message:"unsupported document encoding <"+B+">, falling back to UTF-8"})}}function M(T,N){var B=l.peek();try{l.push(B.handleNode(T))}catch($){c($,N,r)&&l.push(new gp)}}function P(T,N){try{l.peek().handleText(T)}catch(B){p(B,N)}}function S(T,N){T.trim()&&P(T,N)}var w=a.getPackages().reduce(function(T,N){return T[N.uri]=N.prefix,T},{"http://www.w3.org/XML/1998/namespace":"xml"});return s.ns(w).on("openTag",function(T,N,B,$){var H=T.attrs||{},Z=Object.keys(H).reduce(function(z,G){var se=N(H[G]);return z[G]=se,z},{}),Y={name:T.name,originalName:T.originalName,attributes:Z,ns:T.ns};M(Y,$)}).on("question",b).on("closeTag",h).on("cdata",P).on("text",function(T,N,B){S(N(T),B)}).on("error",c).on("warn",p),new Promise(function(T,N){var B;try{s.parse(e),f()}catch(z){B=z}var $=i.element;!B&&!$&&(B=ci("failed to parse document as <"+i.type.$descriptor.name+">"));var H=o.warnings,Z=o.references,Y=o.elementsById;return B?(B.warnings=H,N(B)):T({rootElement:$,elementsById:Y,references:Z,warnings:H})})};bp.prototype.handler=function(e){return new Ep(this.model,e)};function K_(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}var X_=`<?xml version="1.0" encoding="UTF-8"?>
`,Z_=/<|>|'|"|&|\n\r|\n/g,ay=/<|>|&/g;function J_(e){var t={},n={},i={},a=[],r=[];this.byUri=function(o){return n[o]||e&&e.byUri(o)},this.add=function(o,s){n[o.uri]=o,s?a.push(o):r.push(o),this.mapPrefix(o.prefix,o.uri)},this.uriByPrefix=function(o){return t[o||"xmlns"]},this.mapPrefix=function(o,s){t[o||"xmlns"]=s},this.getNSKey=function(o){return o.prefix!==void 0?o.uri+"|"+o.prefix:o.uri},this.logUsed=function(o){var s=o.uri,l=this.getNSKey(o);i[l]=this.byUri(s),e&&e.logUsed(o)},this.getUsed=function(o){function s(p){var f=l.getNSKey(p);return i[f]}var l=this,c=[].concat(a,r);return c.filter(s)}}function Q_(e){return e.charAt(0).toLowerCase()+e.slice(1)}function eS(e,t){return ty(t)?Q_(e):e}function oy(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function sy(e){return $t(e)?e:(e.prefix?e.prefix+":":"")+e.localName}function tS(e){return e.getUsed().filter(function(t){return t.prefix!=="xml"}).map(function(t){var n="xmlns"+(t.prefix?":"+t.prefix:"");return{name:n,value:t.uri}})}function nS(e,t){return t.isGeneric?q({localName:t.ns.localName},e):q({localName:eS(t.ns.localName,t.$pkg)},e)}function iS(e,t){return q({localName:t.ns.localName},e)}function rS(e){var t=e.$descriptor;return Ie(t.properties,function(n){var i=n.name;if(n.isVirtual||!Cn(e,i))return!1;var a=e[i];return a===n.default||a===null?!1:n.isMany?a.length:!0})}var aS={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},oS={"<":"lt",">":"gt","&":"amp"};function ly(e,t,n){return e=$t(e)?e:""+e,e.replace(t,function(i){return"&"+n[i]+";"})}function sS(e){return ly(e,Z_,aS)}function lS(e){return ly(e,ay,oS)}function uS(e){return Ie(e,function(t){return t.isAttr})}function cS(e){return Ie(e,function(t){return!t.isAttr})}function xp(e){this.tagName=e}xp.prototype.build=function(e){return this.element=e,this};xp.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()};function Bi(){}Bi.prototype.serializeValue=Bi.prototype.serializeTo=function(e){e.append(this.escape?lS(this.value):this.value)};Bi.prototype.build=function(e,t){return this.value=t,e.type==="String"&&t.search(ay)!==-1&&(this.escape=!0),this};function _p(e){this.tagName=e}oy(_p,Bi);_p.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()};function et(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}et.prototype.build=function(e){this.element=e;var t=e.$descriptor,n=this.propertyDescriptor,i,a,r=t.isGeneric;return r?i=this.parseGeneric(e):i=this.parseNsAttributes(e),n?this.ns=this.nsPropertyTagName(n):this.ns=this.nsTagName(t),this.tagName=this.addTagName(this.ns),r||(a=rS(e),this.parseAttributes(uS(a)),this.parseContainments(cS(a))),this.parseGenericAttributes(e,i),this};et.prototype.nsTagName=function(e){var t=this.logNamespaceUsed(e.ns);return nS(t,e)};et.prototype.nsPropertyTagName=function(e){var t=this.logNamespaceUsed(e.ns);return iS(t,e)};et.prototype.isLocalNs=function(e){return e.uri===this.ns.uri};et.prototype.nsAttributeName=function(e){var t;if($t(e)?t=Nt(e):t=e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:q({localName:t.localName},n)};et.prototype.parseGeneric=function(e){var t=this,n=this.body,i=[];return j(e,function(a,r){var o;r==="$body"?n.push(new Bi().build({type:"String"},a)):r==="$children"?j(a,function(s){n.push(new et(t).build(s))}):r.indexOf("$")!==0&&(o=t.parseNsAttribute(e,r,a),o&&i.push({name:r,value:a}))}),i};et.prototype.parseNsAttribute=function(e,t,n){var i=e.$model,a=Nt(t),r;if(a.prefix==="xmlns"&&(r={prefix:a.localName,uri:n}),!a.prefix&&a.localName==="xmlns"&&(r={uri:n}),!r)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(r,!0,!0);else{var o=this.logNamespaceUsed(r,!0);this.getNamespaces().logUsed(o)}};et.prototype.parseNsAttributes=function(e,t){var n=this,i=e.$attrs,a=[];return j(i,function(r,o){var s=n.parseNsAttribute(e,o,r);s&&a.push(s)}),a};et.prototype.parseGenericAttributes=function(e,t){var n=this;j(t,function(i){if(i.name!==Ts)try{n.addAttribute(n.nsAttributeName(i.name),i.value)}catch(a){console.warn("missing namespace information for ",i.name,"=",i.value,"on",e,a)}})};et.prototype.parseContainments=function(e){var t=this,n=this.body,i=this.element;j(e,function(a){var r=i.get(a.name),o=a.isReference,s=a.isMany;if(s||(r=[r]),a.isBody)n.push(new Bi().build(a,r[0]));else if(Jg(a.type))j(r,function(p){n.push(new _p(t.addTagName(t.nsPropertyTagName(a))).build(a,p))});else if(o)j(r,function(p){n.push(new xp(t.addTagName(t.nsPropertyTagName(a))).build(p))});else{var l=iy(a),c=z_(a);j(r,function(p){var f;l?f=new As(t,a):c?f=new et(t,a):f=new et(t),n.push(f.build(p))})}})};et.prototype.getNamespaces=function(e){var t=this.namespaces,n=this.parent,i;return t||(i=n&&n.getNamespaces(),e||!i?this.namespaces=t=new J_(i):t=i),t};et.prototype.logNamespace=function(e,t,n){var i=this.getNamespaces(n),a=e.uri,r=e.prefix,o=i.byUri(a);return(!o||n)&&i.add(e,t),i.mapPrefix(r,a),e};et.prototype.logNamespaceUsed=function(e,t){var n=this.element,i=n.$model,a=this.getNamespaces(t),r=e.prefix,o=e.uri,s,l,c;if(!r&&!o)return{localName:e.localName};if(c=G_[r]||i&&(i.getPackage(r)||{}).uri,o=o||c||a.uriByPrefix(r),!o)throw new Error("no namespace uri given for prefix <"+r+">");if(e=a.byUri(o),!e){for(s=r,l=1;a.uriByPrefix(s);)s=r+"_"+l++;e=this.logNamespace({prefix:s,uri:o},c===o)}return r&&a.mapPrefix(r,o),e};et.prototype.parseAttributes=function(e){var t=this,n=this.element;j(e,function(i){var a=n.get(i.name);if(i.isReference)if(!i.isMany)a=a.id;else{var r=[];j(a,function(o){r.push(o.id)}),a=r.join(" ")}t.addAttribute(t.nsAttributeName(i),a)})};et.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),sy(e)};et.prototype.addAttribute=function(e,t){var n=this.attrs;$t(t)&&(t=sS(t));var i=ip(n,function(r){return r.name.localName===e.localName&&r.name.uri===e.uri&&r.name.prefix===e.prefix}),a={name:e,value:t};i!==-1?n.splice(i,1,a):n.push(a)};et.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=tS(n).concat(t)),j(t,function(i){e.append(" ").append(sy(i.name)).append('="').append(i.value).append('"')})};et.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==Bi;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),j(this.body,function(i){i.serializeTo(e)}),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()};function As(e,t){et.call(this,e,t)}oy(As,et);As.prototype.parseNsAttributes=function(e){var t=et.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var i=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var a=e.$model.getPackage(i.uri),r=a.xml&&a.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Ts),(i.prefix?i.prefix+":":"")+r+n.ns.localName),t};As.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri};function pS(){this.value="",this.write=function(e){this.value+=e}}function fS(e,t){var n=[""];this.append=function(i){return e.write(i),this},this.appendNewLine=function(){return t&&e.write(`
`),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function dS(e){e=q({format:!1,preamble:!0},e||{});function t(n,i){var a=i||new pS,r=new fS(a,e.format);if(e.preamble&&r.append(X_),new et().build(n).serializeTo(r),!i)return a.value}return{toXML:t}}function Ps(e,t){on.call(this,e,t)}Ps.prototype=Object.create(on.prototype);Ps.prototype.fromXML=function(e,t,n){$t(t)||(n=t,t="bpmn:Definitions");var i=new bp(q({model:this,lax:!0},n)),a=i.handler(t);return i.fromXML(e,a)};Ps.prototype.toXML=function(e,t){var n=new dS(t);return new Promise(function(i,a){try{var r=n.toXML(e);return i({xml:r})}catch(o){return a(o)}})};var hS="BPMN20",mS="http://www.omg.org/spec/BPMN/20100524/MODEL",vS="bpmn",gS=[],yS=[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",isAttr:!0,type:"String"}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"processType",type:"ProcessType",isAttr:!0},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"properties",type:"Property",isMany:!0},{name:"laneSets",isMany:!0,replaces:"FlowElementsContainer#laneSets",type:"LaneSet"},{name:"flowElements",isMany:!0,replaces:"FlowElementsContainer#flowElements",type:"FlowElement"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"resources",type:"ResourceRole",isMany:!0},{name:"correlationSubscriptions",type:"CorrelationSubscription",isMany:!0},{name:"supports",type:"Process",isMany:!0,isReference:!0},{name:"definitionalCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"isExecutable",isAttr:!0,type:"Boolean"}]},{name:"LaneSet",superClass:["BaseElement"],properties:[{name:"lanes",type:"Lane",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Lane",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"partitionElementRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"partitionElement",type:"BaseElement"},{name:"flowNodeRef",type:"FlowNode",isMany:!0,isReference:!0},{name:"childLaneSet",type:"LaneSet",xml:{serialize:"xsi:type"}}]},{name:"GlobalManualTask",superClass:["GlobalTask"]},{name:"ManualTask",superClass:["Task"]},{name:"UserTask",superClass:["Task"],properties:[{name:"renderings",type:"Rendering",isMany:!0},{name:"implementation",isAttr:!0,type:"String"}]},{name:"Rendering",superClass:["BaseElement"]},{name:"HumanPerformer",superClass:["Performer"]},{name:"PotentialOwner",superClass:["HumanPerformer"]},{name:"GlobalUserTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"renderings",type:"Rendering",isMany:!0}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"ComplexGateway",superClass:["Gateway"],properties:[{name:"activationCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ExclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"InclusiveGateway",superClass:["Gateway"],properties:[{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0}]},{name:"ParallelGateway",superClass:["Gateway"]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"extensionElements",type:"ExtensionElements"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Documentation",superClass:["BaseElement"],properties:[{name:"text",type:"String",isBody:!0},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Event",isAbstract:!0,superClass:["FlowNode","InteractionNode"],properties:[{name:"properties",type:"Property",isMany:!0}]},{name:"IntermediateCatchEvent",superClass:["CatchEvent"]},{name:"IntermediateThrowEvent",superClass:["ThrowEvent"]},{name:"EndEvent",superClass:["ThrowEvent"]},{name:"StartEvent",superClass:["CatchEvent"],properties:[{name:"isInterrupting",default:!0,isAttr:!0,type:"Boolean"}]},{name:"ThrowEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"inputSet",type:"InputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"CatchEvent",isAbstract:!0,superClass:["Event"],properties:[{name:"parallelMultiple",isAttr:!0,type:"Boolean",default:!1},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"outputSet",type:"OutputSet"},{name:"eventDefinitions",type:"EventDefinition",isMany:!0},{name:"eventDefinitionRef",type:"EventDefinition",isMany:!0,isReference:!0}]},{name:"BoundaryEvent",superClass:["CatchEvent"],properties:[{name:"cancelActivity",default:!0,isAttr:!0,type:"Boolean"},{name:"attachedToRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"EventDefinition",isAbstract:!0,superClass:["RootElement"]},{name:"CancelEventDefinition",superClass:["EventDefinition"]},{name:"ErrorEventDefinition",superClass:["EventDefinition"],properties:[{name:"errorRef",type:"Error",isAttr:!0,isReference:!0}]},{name:"TerminateEventDefinition",superClass:["EventDefinition"]},{name:"EscalationEventDefinition",superClass:["EventDefinition"],properties:[{name:"escalationRef",type:"Escalation",isAttr:!0,isReference:!0}]},{name:"Escalation",properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"escalationCode",isAttr:!0,type:"String"}],superClass:["RootElement"]},{name:"CompensateEventDefinition",superClass:["EventDefinition"],properties:[{name:"waitForCompletion",isAttr:!0,type:"Boolean",default:!0},{name:"activityRef",type:"Activity",isAttr:!0,isReference:!0}]},{name:"TimerEventDefinition",superClass:["EventDefinition"],properties:[{name:"timeDate",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeCycle",type:"Expression",xml:{serialize:"xsi:type"}},{name:"timeDuration",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"LinkEventDefinition",superClass:["EventDefinition"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"target",type:"LinkEventDefinition",isAttr:!0,isReference:!0},{name:"source",type:"LinkEventDefinition",isMany:!0,isReference:!0}]},{name:"MessageEventDefinition",superClass:["EventDefinition"],properties:[{name:"messageRef",type:"Message",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"ConditionalEventDefinition",superClass:["EventDefinition"],properties:[{name:"condition",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"SignalEventDefinition",superClass:["EventDefinition"],properties:[{name:"signalRef",type:"Signal",isAttr:!0,isReference:!0}]},{name:"Signal",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ImplicitThrowEvent",superClass:["ThrowEvent"]},{name:"DataState",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"ItemAwareElement",superClass:["BaseElement"],properties:[{name:"itemSubjectRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"dataState",type:"DataState"}]},{name:"DataAssociation",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"ItemAwareElement",isMany:!0,isReference:!0},{name:"targetRef",type:"ItemAwareElement",isReference:!0},{name:"transformation",type:"FormalExpression",xml:{serialize:"property"}},{name:"assignment",type:"Assignment",isMany:!0}]},{name:"DataInput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"inputSetRef",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithOptional",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"inputSetWithWhileExecuting",type:"InputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"DataOutput",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"outputSetRef",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithOptional",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0},{name:"outputSetWithWhileExecuting",type:"OutputSet",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"InputSet",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"dataInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"optionalInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"whileExecutingInputRefs",type:"DataInput",isMany:!0,isReference:!0},{name:"outputSetRefs",type:"OutputSet",isMany:!0,isReference:!0}]},{name:"OutputSet",superClass:["BaseElement"],properties:[{name:"dataOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"inputSetRefs",type:"InputSet",isMany:!0,isReference:!0},{name:"optionalOutputRefs",type:"DataOutput",isMany:!0,isReference:!0},{name:"whileExecutingOutputRefs",type:"DataOutput",isMany:!0,isReference:!0}]},{name:"Property",superClass:["ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"}]},{name:"DataInputAssociation",superClass:["DataAssociation"]},{name:"DataOutputAssociation",superClass:["DataAssociation"]},{name:"InputOutputSpecification",superClass:["BaseElement"],properties:[{name:"dataInputs",type:"DataInput",isMany:!0},{name:"dataOutputs",type:"DataOutput",isMany:!0},{name:"inputSets",type:"InputSet",isMany:!0},{name:"outputSets",type:"OutputSet",isMany:!0}]},{name:"DataObject",superClass:["FlowElement","ItemAwareElement"],properties:[{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"}]},{name:"InputOutputBinding",properties:[{name:"inputDataRef",type:"InputSet",isAttr:!0,isReference:!0},{name:"outputDataRef",type:"OutputSet",isAttr:!0,isReference:!0},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"Assignment",superClass:["BaseElement"],properties:[{name:"from",type:"Expression",xml:{serialize:"xsi:type"}},{name:"to",type:"Expression",xml:{serialize:"xsi:type"}}]},{name:"DataStore",superClass:["RootElement","ItemAwareElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"capacity",isAttr:!0,type:"Integer"},{name:"isUnlimited",default:!0,isAttr:!0,type:"Boolean"}]},{name:"DataStoreReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataStoreRef",type:"DataStore",isAttr:!0,isReference:!0}]},{name:"DataObjectReference",superClass:["ItemAwareElement","FlowElement"],properties:[{name:"dataObjectRef",type:"DataObject",isAttr:!0,isReference:!0}]},{name:"ConversationLink",superClass:["BaseElement"],properties:[{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"ConversationAssociation",superClass:["BaseElement"],properties:[{name:"innerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0},{name:"outerConversationNodeRef",type:"ConversationNode",isAttr:!0,isReference:!0}]},{name:"CallConversation",superClass:["ConversationNode"],properties:[{name:"calledCollaborationRef",type:"Collaboration",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"Conversation",superClass:["ConversationNode"]},{name:"SubConversation",superClass:["ConversationNode"],properties:[{name:"conversationNodes",type:"ConversationNode",isMany:!0}]},{name:"ConversationNode",isAbstract:!0,superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"messageFlowRefs",type:"MessageFlow",isMany:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0}]},{name:"GlobalConversation",superClass:["Collaboration"]},{name:"PartnerEntity",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"PartnerRole",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"participantRef",type:"Participant",isMany:!0,isReference:!0}]},{name:"CorrelationProperty",superClass:["RootElement"],properties:[{name:"correlationPropertyRetrievalExpression",type:"CorrelationPropertyRetrievalExpression",isMany:!0},{name:"name",isAttr:!0,type:"String"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Error",superClass:["RootElement"],properties:[{name:"structureRef",type:"ItemDefinition",isAttr:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"},{name:"errorCode",isAttr:!0,type:"String"}]},{name:"CorrelationKey",superClass:["BaseElement"],properties:[{name:"correlationPropertyRef",type:"CorrelationProperty",isMany:!0,isReference:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Expression",superClass:["BaseElement"],isAbstract:!1,properties:[{name:"body",isBody:!0,type:"String"}]},{name:"FormalExpression",superClass:["Expression"],properties:[{name:"language",isAttr:!0,type:"String"},{name:"evaluatesToTypeRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"Message",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"itemRef",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"ItemDefinition",superClass:["RootElement"],properties:[{name:"itemKind",type:"ItemKind",isAttr:!0},{name:"structureRef",isAttr:!0,type:"String"},{name:"isCollection",default:!1,isAttr:!0,type:"Boolean"},{name:"import",type:"Import",isAttr:!0,isReference:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"incoming",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"outgoing",type:"SequenceFlow",isMany:!0,isReference:!0},{name:"lanes",type:"Lane",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isMany:!0,isVirtual:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Group",superClass:["Artifact"],properties:[{name:"categoryValueRef",type:"CategoryValue",isAttr:!0,isReference:!0}]},{name:"Association",superClass:["Artifact"],properties:[{name:"associationDirection",type:"AssociationDirection",isAttr:!0},{name:"sourceRef",type:"BaseElement",isAttr:!0,isReference:!0},{name:"targetRef",type:"BaseElement",isAttr:!0,isReference:!0}]},{name:"Category",superClass:["RootElement"],properties:[{name:"categoryValue",type:"CategoryValue",isMany:!0},{name:"name",isAttr:!0,type:"String"}]},{name:"Artifact",isAbstract:!0,superClass:["BaseElement"]},{name:"CategoryValue",superClass:["BaseElement"],properties:[{name:"categorizedFlowElements",type:"FlowElement",isMany:!0,isVirtual:!0,isReference:!0},{name:"value",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"default",type:"SequenceFlow",isAttr:!0,isReference:!0},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"},{name:"loopCharacteristics",type:"LoopCharacteristics"}]},{name:"ServiceTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0}]},{name:"SubProcess",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"LoopCharacteristics",isAbstract:!0,superClass:["BaseElement"]},{name:"MultiInstanceLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"isSequential",default:!1,isAttr:!0,type:"Boolean"},{name:"behavior",type:"MultiInstanceBehavior",default:"All",isAttr:!0},{name:"loopCardinality",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopDataInputRef",type:"ItemAwareElement",isReference:!0},{name:"loopDataOutputRef",type:"ItemAwareElement",isReference:!0},{name:"inputDataItem",type:"DataInput",xml:{serialize:"property"}},{name:"outputDataItem",type:"DataOutput",xml:{serialize:"property"}},{name:"complexBehaviorDefinition",type:"ComplexBehaviorDefinition",isMany:!0},{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"oneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0},{name:"noneBehaviorEventRef",type:"EventDefinition",isAttr:!0,isReference:!0}]},{name:"StandardLoopCharacteristics",superClass:["LoopCharacteristics"],properties:[{name:"testBefore",default:!1,isAttr:!0,type:"Boolean"},{name:"loopCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"loopMaximum",type:"Integer",isAttr:!0}]},{name:"CallActivity",superClass:["Activity","InteractionNode"],properties:[{name:"calledElement",type:"String",isAttr:!0}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"SendTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ReceiveTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"},{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"operationRef",type:"Operation",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"ScriptTask",superClass:["Task"],properties:[{name:"scriptFormat",isAttr:!0,type:"String"},{name:"script",type:"String"}]},{name:"BusinessRuleTask",superClass:["Task"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"AdHocSubProcess",superClass:["SubProcess"],properties:[{name:"completionCondition",type:"Expression",xml:{serialize:"xsi:type"}},{name:"ordering",type:"AdHocOrdering",isAttr:!0},{name:"cancelRemainingInstances",default:!0,isAttr:!0,type:"Boolean"}]},{name:"Transaction",superClass:["SubProcess"],properties:[{name:"protocol",isAttr:!0,type:"String"},{name:"method",isAttr:!0,type:"String"}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Definitions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],ES=[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],bS={tagAlias:"lowerCase",typePrefix:"t"},xS={name:hS,uri:mS,prefix:vS,associations:gS,types:yS,enumerations:ES,xml:bS},_S="BPMNDI",SS="http://www.omg.org/spec/BPMN/20100524/DI",wS="bpmndi",TS=[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],CS=[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],AS=[],PS={name:_S,uri:SS,prefix:wS,types:TS,enumerations:CS,associations:AS},RS="DC",IS="http://www.omg.org/spec/DD/20100524/DC",NS="dc",MS=[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],DS=[],kS={name:RS,uri:IS,prefix:NS,types:MS,associations:DS},OS="DI",LS="http://www.omg.org/spec/DD/20100524/DI",BS="di",$S=[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isMany:!0,isVirtual:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isMany:!0,isVirtual:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",isAttr:!0,isId:!0,type:"String"}]},{name:"Extension",properties:[{name:"values",isMany:!0,type:"Element"}]}],VS=[],FS={tagAlias:"lowerCase"},jS={name:OS,uri:LS,prefix:BS,types:$S,associations:VS,xml:FS},HS="bpmn.io colors for BPMN",GS="http://bpmn.io/schema/bpmn/biocolor/1.0",zS="bioc",US=[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],qS=[],WS=[],YS={name:HS,uri:GS,prefix:zS,types:US,enumerations:qS,associations:WS},KS="BPMN in Color",XS="http://www.omg.org/spec/BPMN/non-normative/color/1.0",ZS="color",JS=[{name:"ColoredLabel",extends:["bpmndi:BPMNLabel"],properties:[{name:"color",isAttr:!0,type:"String"}]},{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"background-color",isAttr:!0,type:"String"},{name:"border-color",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"border-color",isAttr:!0,type:"String"}]}],QS=[],ew=[],tw={name:KS,uri:XS,prefix:ZS,types:JS,enumerations:QS,associations:ew},nw={bpmn:xS,bpmndi:PS,dc:kS,di:jS,bioc:YS,color:tw};function iw(e,t){var n=q({},nw,e);return new Ps(n,t)}function bt(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}var rw=new _r({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function Ot(e,t){return e.$instanceOf(t)}function aw(e){return Ue(e.rootElements,function(t){return Ot(t,"bpmn:Process")||Ot(t,"bpmn:Collaboration")})}function ow(e,t){var n={},i=[];function a(D,L){return function(X){D(X,L)}}function r(D){n[D.id]=D}function o(D){return n[D.id]}function s(D,L){var X=D.gfx;if(X)throw new Error(t("already rendered {element}",{element:bt(D)}));return e.element(D,L)}function l(D,L){return e.root(D,L)}function c(D,L){try{var X=D.di&&s(D,L);return r(D),X}catch(K){p(K.message,{element:D,error:K}),console.error(t("failed to import {element}",{element:bt(D)})),console.error(K)}}function p(D,L){e.error(D,L)}function f(D){var L=D.bpmnElement;L?L.di?p(t("multiple DI elements defined for {element}",{element:bt(L)}),{element:L}):(rw.bind(L,"di"),L.di=D):p(t("no bpmnElement referenced in {element}",{element:bt(D)}),{element:D})}function h(D){v(D.plane)}function v(D){f(D),j(D.planeElement,m)}function m(D){f(D)}function _(D,L){var X=D.diagrams;if(L&&X.indexOf(L)===-1)throw new Error(t("diagram not part of bpmn:Definitions"));if(!L&&X&&X.length&&(L=X[0]),!L)throw new Error(t("no diagram to display"));h(L);var K=L.plane;if(!K)throw new Error(t("no plane for {element}",{element:bt(L)}));var W=K.bpmnElement;if(!W)if(W=aw(D),W)p(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:bt(K),rootElement:bt(W)})),K.bpmnElement=W,f(K);else throw new Error(t("no process or collaboration to display"));var oe=l(W,K);if(Ot(W,"bpmn:Process"))M(W,oe);else if(Ot(W,"bpmn:Collaboration"))x(W),P(D.rootElements,oe);else throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:bt(K),rootElement:bt(W)}));b()}function b(){for(var D;i.length;)D=i.shift(),D()}function M(D,L){y(D,L),Z(D.ioSpecification,L),H(D.artifacts,L),r(D)}function P(D,L){var X=Ie(D,function(K){return!o(K)&&Ot(K,"bpmn:Process")&&K.laneSets});X.forEach(a(M,L))}function S(D,L){c(D,L)}function w(D,L){j(D,a(S,L))}function T(D,L){c(D,L)}function N(D,L){c(D,L)}function B(D,L){c(D,L)}function $(D,L){c(D,L)}function H(D,L){j(D,function(X){Ot(X,"bpmn:Association")?i.push(function(){$(X,L)}):$(X,L)})}function Z(D,L){D&&(j(D.dataInputs,a(N,L)),j(D.dataOutputs,a(B,L)))}function Y(D,L){y(D,L),H(D.artifacts,L)}function z(D,L){var X=c(D,L);Ot(D,"bpmn:SubProcess")&&Y(D,X||L),Ot(D,"bpmn:Activity")&&Z(D.ioSpecification,L),i.push(function(){j(D.dataInputAssociations,a(T,L)),j(D.dataOutputAssociations,a(T,L))})}function G(D,L){c(D,L)}function se(D,L){c(D,L)}function u(D,L){i.push(function(){var X=c(D,L);D.childLaneSet&&d(D.childLaneSet,X||L),R(D)})}function d(D,L){j(D.lanes,a(u,L))}function E(D,L){j(D,a(d,L))}function y(D,L){g(D.flowElements,L),D.laneSets&&E(D.laneSets,L)}function g(D,L){j(D,function(X){Ot(X,"bpmn:SequenceFlow")?i.push(function(){G(X,L)}):Ot(X,"bpmn:BoundaryEvent")?i.unshift(function(){z(X,L)}):Ot(X,"bpmn:FlowNode")?z(X,L):Ot(X,"bpmn:DataObject")||(Ot(X,"bpmn:DataStoreReference")||Ot(X,"bpmn:DataObjectReference")?se(X,L):p(t("unrecognized flowElement {element} in context {context}",{element:bt(X),context:L?bt(L.businessObject):"null"}),{element:X,context:L}))})}function C(D,L){var X=c(D,L),K=D.processRef;K&&M(K,X||L)}function x(D){j(D.participants,a(C)),H(D.artifacts),i.push(function(){w(D.messageFlows)})}function R(D){j(D.flowNodeRef,function(L){var X=L.get("lanes");X&&X.push(D)})}return{handleDeferred:b,handleDefinitions:_,handleSubProcess:Y,registerDi:f}}function sw(e,t,n){var i,a,r,o,s=[];function l(c,p){var f={root:function(v){return i.add(v)},element:function(v,m){return i.add(v,m)},error:function(v,m){s.push({message:v,context:m})}},h=new ow(f,r);h.handleDefinitions(c,p)}return new Promise(function(c,p){try{return i=e.get("bpmnImporter"),a=e.get("eventBus"),r=e.get("translate"),a.fire("import.render.start",{definitions:t}),l(t,n),a.fire("import.render.complete",{error:o,warnings:s}),c({warnings:s})}catch(f){return f.warnings=s,p(f)}})}function Ar(e){return function(){if(!window.Promise)throw new Error("Promises is not supported in this environment. Please polyfill Promise.");var t=arguments.length;if(t>=1&&xt(arguments[t-1])){var n=arguments[t-1];console.warn(new Error("Passing callbacks to "+e.name+" is deprecated and will be removed in a future major release. Please switch to promises: https://bpmn.io/l/moving-to-promises.html"));var i=Array.prototype.slice.call(arguments,0,-1);e.apply(this,i).then(function(a){var r=Object.keys(a)[0];return n(null,a[r])},function(a){return n(a,a.warnings)})}else return e.apply(this,arguments)}}var lw='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14.02 5.57" width="53" height="21" style="vertical-align:middle"><path fill="currentColor" d="M1.88.92v.14c0 .41-.13.68-.4.8.33.14.46.44.46.86v.33c0 .61-.33.95-.95.95H0V0h.95c.65 0 .93.3.93.92zM.63.57v1.06h.24c.24 0 .38-.1.38-.43V.98c0-.28-.1-.4-.32-.4zm0 1.63v1.22h.36c.2 0 .32-.1.32-.39v-.35c0-.37-.12-.48-.4-.48H.63zM4.18.99v.52c0 .64-.31.98-.94.98h-.3V4h-.62V0h.92c.63 0 .94.35.94.99zM2.94.57v1.35h.3c.2 0 .3-.09.3-.37v-.6c0-.29-.1-.38-.3-.38h-.3zm2.89 2.27L6.25 0h.88v4h-.6V1.12L6.1 3.99h-.6l-.46-2.82v2.82h-.55V0h.87zM8.14 1.1V4h-.56V0h.79L9 2.4V0h.56v4h-.64zm2.49 2.29v.6h-.6v-.6zM12.12 1c0-.63.33-1 .95-1 .61 0 .95.37.95 1v2.04c0 .64-.34 1-.95 1-.62 0-.95-.37-.95-1zm.62 2.08c0 .28.13.39.33.39s.32-.1.32-.4V.98c0-.29-.12-.4-.32-.4s-.33.11-.33.4z"/><path fill="currentColor" d="M0 4.53h14.02v1.04H0zM11.08 0h.63v.62h-.63zm.63 4V1h-.63v2.98z"/></svg>',uy=lw;function Rs(e){return e.join(";")}var cy=Rs(["color: #404040"]),uw=Rs(["z-index: 1001","position: fixed","top: 0","left: 0","right: 0","bottom: 0"]),cw=Rs(["width: 100%","height: 100%","background: rgba(40,40,40,0.2)"]),pw=Rs(["position: absolute","left: 50%","top: 40%","transform: translate(-50%)","width: 260px","padding: 10px","background: white","box-shadow: 0 1px 4px rgba(0,0,0,0.3)","font-family: Helvetica, Arial, sans-serif","font-size: 14px","display: flex","line-height: 1.3"]),fw='<div class="bjs-powered-by-lightbox" style="'+uw+'"><div class="backdrop" style="'+cw+'"></div><div class="notice" style="'+pw+'"><a href="https://bpmn.io" target="_blank" rel="noopener" style="margin: 15px 20px 15px 10px; align-self: center;'+cy+'">'+uy+'</a><span>Web-based tooling for BPMN, DMN and CMMN diagrams powered by <a href="https://bpmn.io" target="_blank" rel="noopener">bpmn.io</a>.</span></div></div>',qr;function dw(){qr||(qr=Qe(fw),Ht.bind(qr,".backdrop","click",function(e){document.body.removeChild(qr)})),document.body.appendChild(qr)}function tt(e){e=q({},mw,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),gw(this._container),this._init(this._container,this._moddle,e)}ye(tt,wr);tt.prototype.importXML=Ar(function(t,n){var i=this;function a(r){var o=i.get("eventBus").createEvent(r);return Object.defineProperty(o,"context",{enumerable:!0,get:function(){return console.warn(new Error("import.parse.complete <context> is deprecated and will be removed in future library versions")),{warnings:r.warnings,references:r.references,elementsById:r.elementsById}}}),o}return new Promise(function(r,o){t=i._emit("import.parse.start",{xml:t})||t,i._moddle.fromXML(t,"bpmn:Definitions").then(function(s){var l=s.rootElement,c=s.references,p=s.warnings,f=s.elementsById;l=i._emit("import.parse.complete",a({error:null,definitions:l,elementsById:f,references:c,warnings:p}))||l,i.importDefinitions(l,n).then(function(h){var v=[].concat(p,h.warnings||[]);return i._emit("import.done",{error:null,warnings:v}),r({warnings:v})}).catch(function(h){var v=[].concat(p,h.warnings||[]);return i._emit("import.done",{error:h,warnings:v}),o(Wo(h,v))})}).catch(function(s){return i._emit("import.parse.complete",{error:s}),s=hw(s),i._emit("import.done",{error:s,warnings:s.warnings}),o(s)})})});tt.prototype.importDefinitions=Ar(function(t,n){var i=this;return new Promise(function(a,r){i._setDefinitions(t),i.open(n).then(function(o){var s=o.warnings;return a({warnings:s})}).catch(function(o){return r(o)})})});tt.prototype.open=Ar(function(t){var n=this._definitions,i=t,a=this;return new Promise(function(r,o){if(!n){var s=new Error("no XML imported");return o(Wo(s,[]))}if(typeof t=="string"&&(i=vw(n,t),!i)){var l=new Error("BPMNDiagram <"+t+"> not found");return o(Wo(l,[]))}try{a.clear()}catch(c){return o(Wo(c,[]))}sw(a,n,i).then(function(c){var p=c.warnings;return r({warnings:p})}).catch(function(c){return o(c)})})});tt.prototype.saveXML=Ar(function(t){t=t||{};var n=this,i=this._definitions;return new Promise(function(a){if(!i)return a({error:new Error("no definitions loaded")});i=n._emit("saveXML.start",{definitions:i})||i,n._moddle.toXML(i,t).then(function(r){var o=r.xml;return o=n._emit("saveXML.serialized",{xml:o})||o,a({xml:o})})}).catch(function(a){return{error:a}}).then(function(a){n._emit("saveXML.done",a);var r=a.error;return r?Promise.reject(r):a})});tt.prototype.saveSVG=Ar(function(t){var n=this;return new Promise(function(i,a){n._emit("saveSVG.start");var r,o;try{var s=n.get("canvas"),l=s.getDefaultLayer(),c=it("defs",s._svg),p=ud(l),f=c?"<defs>"+ud(c)+"</defs>":"",h=l.getBBox();r=`<?xml version="1.0" encoding="utf-8"?>
<!-- created with bpmn-js / http://bpmn.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="`+h.width+'" height="'+h.height+'" viewBox="'+h.x+" "+h.y+" "+h.width+" "+h.height+'" version="1.1">'+f+p+"</svg>"}catch(v){o=v}return n._emit("saveSVG.done",{error:o,svg:r}),o?a(o):i({svg:r})})});tt.prototype._setDefinitions=function(e){this._definitions=e};tt.prototype.getModules=function(){return this._modules};tt.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach(function(e){var t=e.businessObject;t&&t.di&&delete t.di}),wr.prototype.clear.call(this))};tt.prototype.destroy=function(){wr.prototype.destroy.call(this),Nn(this._container)};tt.prototype.on=function(e,t,n,i){return this.get("eventBus").on(e,t,n,i)};tt.prototype.off=function(e,t){this.get("eventBus").off(e,t)};tt.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),typeof e=="string"&&(e=it(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()};tt.prototype.getDefinitions=function(){return this._definitions};tt.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))};tt.prototype._init=function(e,t,n){var i=n.modules||this.getModules(),a=n.additionalModules||[],r=[{bpmnjs:["value",this],moddle:["value",t]}],o=[].concat(r,i,a),s=q(Un(n,["additionalModules"]),{canvas:q({},n.canvas,{container:e}),modules:o});wr.call(this,s),n&&n.container&&this.attachTo(n.container)};tt.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)};tt.prototype._createContainer=function(e){var t=Qe('<div class="bjs-container"></div>');return q(t.style,{width:wd(e.width),height:wd(e.height),position:e.position}),t};tt.prototype._createModdle=function(e){var t=q({},this._moddleExtensions,e.moddleExtensions);return new iw(t)};tt.prototype._modules=[];function Wo(e,t){return e.warnings=t,e}function hw(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/,n=t.exec(e.message);return n&&(e.message="unparsable content <"+n[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+n[2]),e}var mw={width:"100%",height:"100%",position:"relative"};function wd(e){return e+(Re(e)?"px":"")}function vw(e,t){return t&&Ue(e.diagrams,function(n){return n.id===t})||null}function gw(e){var t=uy,n='<a href="http://bpmn.io" target="_blank" class="bjs-powered-by" title="Powered by bpmn.io" style="position: absolute; bottom: 15px; right: 15px; z-index: 100; '+cy+'">'+t+"</a>",i=Qe(n);e.appendChild(i),Se.bind(i,"click",function(a){dw(),a.preventDefault()})}function Ta(e){tt.call(this,e),this.on("import.parse.complete",function(t){t.error||this._collectIds(t.definitions,t.elementsById)},this),this.on("diagram.destroy",function(){this.get("moddle").ids.clear()},this)}ye(Ta,tt);Ta.prototype._createModdle=function(e){var t=tt.prototype._createModdle.call(this,e);return t.ids=new In([32,36,1]),t};Ta.prototype._collectIds=function(e,t){var n=e.$model,i=n.ids,a;i.clear();for(a in t)i.claim(a,t[a])};function A(e,t){var n=he(e);return n&&typeof n.$instanceOf=="function"&&n.$instanceOf(t)}function he(e){return e&&e.businessObject||e}function We(e){return A(e,"bpmn:CallActivity")?!1:A(e,"bpmn:SubProcess")?he(e).di&&!!he(e).di.isExpanded:A(e,"bpmn:Participant")?!!he(e).processRef:!0}function yw(e){return e&&he(e).isInterrupting!==!1}function Gt(e){return e&&!!he(e).triggeredByEvent}function Is(e,t){var n=he(e),i=!1;return n.eventDefinitions&&j(n.eventDefinitions,function(a){A(a,t)&&(i=!0)}),i}function Ew(e){return Is(e,"bpmn:ErrorEventDefinition")}function bw(e){return Is(e,"bpmn:EscalationEventDefinition")}function xw(e){return Is(e,"bpmn:CompensateEventDefinition")}function py(e){if(A(e,"bpmn:FlowElement")||A(e,"bpmn:Participant")||A(e,"bpmn:Lane")||A(e,"bpmn:SequenceFlow")||A(e,"bpmn:MessageFlow")||A(e,"bpmn:DataInput")||A(e,"bpmn:DataOutput"))return"name";if(A(e,"bpmn:TextAnnotation"))return"text";if(A(e,"bpmn:Group"))return"categoryValueRef"}function _w(e){var t=e.categoryValueRef;return t&&t.value||""}function En(e){var t=e.businessObject,n=py(t);if(n)return n==="categoryValueRef"?_w(t):t[n]||""}function Sw(e,t,n){var i=e.businessObject,a=py(i);return a&&(a==="categoryValueRef"?i.categoryValueRef.value=t:i[a]=t),e}function Tn(e,t,n){function i(a,r){return $i(r,function(o,s){return a[s]==o})}return fi(e.eventDefinitions,function(a){return a.$type===t&&i(e,n)})}function ww(e){return e.$type==="bpmn:IntermediateThrowEvent"||e.$type==="bpmn:EndEvent"}function Tw(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}function dr(e){return e.businessObject.di}function At(e){return e.businessObject}function Be(e,t){var n=dr(e);return n.get("color:background-color")||n.get("bioc:fill")||t||"white"}function le(e,t){var n=dr(e);return n.get("color:border-color")||n.get("bioc:stroke")||t||"black"}function Wr(e,t,n){var i=dr(e),a=i.get("label");return a&&a.get("color:color")||t||le(e,n)}function Cw(e){var t=e.x+e.width/2,n=e.y+e.height/2,i=e.width/2,a=[["M",t,n],["m",0,-i],["a",i,i,0,1,1,0,2*i],["a",i,i,0,1,1,0,-2*i],["z"]];return xr(a)}function Aw(e,t){var n=e.x,i=e.y,a=e.width,r=e.height,o=[["M",n+t,i],["l",a-t*2,0],["a",t,t,0,0,1,t,t],["l",0,r-t*2],["a",t,t,0,0,1,-10,t],["l",t*2-a,0],["a",t,t,0,0,1,-10,-10],["l",0,t*2-r],["a",t,t,0,0,1,t,-10],["z"]];return xr(o)}function Pw(e){var t=e.width,n=e.height,i=e.x,a=e.y,r=t/2,o=n/2,s=[["M",i+r,a],["l",r,o],["l",-r,o],["l",-r,-o],["z"]];return xr(s)}function Rw(e){var t=e.x,n=e.y,i=e.width,a=e.height,r=[["M",t,n],["l",i,0],["l",0,a],["l",-i,0],["z"]];return xr(r)}var Iw=new In,Yo=10,Rl=3,tr=.95,Nw=.35,Mw=10;function Hi(e,t,n,i,a,r,o){qn.call(this,t,o);var s=e&&e.defaultFillColor,l=e&&e.defaultStrokeColor,c=e&&e.defaultLabelColor,p=Iw.next(),f={},h=n.computeStyle;function v(y,g){var C=q({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},g.attrs),x=g.ref||{x:0,y:0},R=g.scale||1;C.strokeDasharray==="none"&&(C.strokeDasharray=[1e4,1]);var D=be("marker");ae(g.element,C),Ce(D,g.element),ae(D,{id:y,viewBox:"0 0 20 20",refX:x.x,refY:x.y,markerWidth:20*R,markerHeight:20*R,orient:"auto"});var L=it("defs",a._svg);L||(L=be("defs"),Ce(a._svg,L)),Ce(L,D),f[y]=D}function m(y){return y.replace(/[^0-9a-zA-z]+/g,"_")}function _(y,g,C){var x=y+"-"+m(g)+"-"+m(C)+"-"+p;return f[x]||b(x,y,g,C),"url(#"+x+")"}function b(y,g,C,x){if(g==="sequenceflow-end"){var R=be("path");ae(R,{d:"M 1 5 L 11 10 L 1 15 Z"}),v(y,{element:R,ref:{x:11,y:10},scale:.5,attrs:{fill:x,stroke:x}})}if(g==="messageflow-start"){var D=be("circle");ae(D,{cx:6,cy:6,r:3.5}),v(y,{element:D,attrs:{fill:C,stroke:x},ref:{x:6,y:6}})}if(g==="messageflow-end"){var L=be("path");ae(L,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),v(y,{element:L,attrs:{fill:C,stroke:x,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if(g==="association-start"){var X=be("path");ae(X,{d:"M 11 5 L 1 10 L 11 15"}),v(y,{element:X,attrs:{fill:"none",stroke:x,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if(g==="association-end"){var K=be("path");ae(K,{d:"M 1 5 L 11 10 L 1 15"}),v(y,{element:K,attrs:{fill:"none",stroke:x,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if(g==="conditional-flow-marker"){var W=be("path");ae(W,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),v(y,{element:W,attrs:{fill:C,stroke:x},ref:{x:-1,y:10},scale:.5})}if(g==="conditional-default-flow-marker"){var oe=be("path");ae(oe,{d:"M 6 4 L 10 16"}),v(y,{element:oe,attrs:{stroke:x},ref:{x:0,y:10},scale:.5})}}function M(y,g,C,x,R){st(x)&&(R=x,x=0),x=x||0,R=h(R,{stroke:"black",strokeWidth:2,fill:"white"}),R.fill==="none"&&delete R.fillOpacity;var D=g/2,L=C/2,X=be("circle");return ae(X,{cx:D,cy:L,r:Math.round((g+C)/4-x)}),ae(X,R),Ce(y,X),X}function P(y,g,C,x,R,D){st(R)&&(D=R,R=0),R=R||0,D=h(D,{stroke:"black",strokeWidth:2,fill:"white"});var L=be("rect");return ae(L,{x:R,y:R,width:g-R*2,height:C-R*2,rx:x,ry:x}),ae(L,D),Ce(y,L),L}function S(y,g,C,x){var R=g/2,D=C/2,L=[{x:R,y:0},{x:g,y:D},{x:R,y:C},{x:0,y:D}],X=L.map(function(W){return W.x+","+W.y}).join(" ");x=h(x,{stroke:"black",strokeWidth:2,fill:"white"});var K=be("polygon");return ae(K,{points:X}),ae(K,x),Ce(y,K),K}function w(y,g,C){C=h(C,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var x=pp(g,C);return Ce(y,x),x}function T(y,g,C){C=h(C,["no-fill"],{strokeWidth:2,stroke:"black"});var x=be("path");return ae(x,{d:g}),ae(x,C),Ce(y,x),x}function N(y,g,C,x){return T(g,C,q({"data-marker":y},x))}function B(y){return function(g,C){return u[y](g,C)}}function $(y){return u[y]}function H(y,g){var C=At(y),x=ww(C);return C.eventDefinitions&&C.eventDefinitions.length>1?C.parallelMultiple?$("bpmn:ParallelMultipleEventDefinition")(g,y,x):$("bpmn:MultipleEventDefinition")(g,y,x):Tn(C,"bpmn:MessageEventDefinition")?$("bpmn:MessageEventDefinition")(g,y,x):Tn(C,"bpmn:TimerEventDefinition")?$("bpmn:TimerEventDefinition")(g,y,x):Tn(C,"bpmn:ConditionalEventDefinition")?$("bpmn:ConditionalEventDefinition")(g,y):Tn(C,"bpmn:SignalEventDefinition")?$("bpmn:SignalEventDefinition")(g,y,x):Tn(C,"bpmn:EscalationEventDefinition")?$("bpmn:EscalationEventDefinition")(g,y,x):Tn(C,"bpmn:LinkEventDefinition")?$("bpmn:LinkEventDefinition")(g,y,x):Tn(C,"bpmn:ErrorEventDefinition")?$("bpmn:ErrorEventDefinition")(g,y,x):Tn(C,"bpmn:CancelEventDefinition")?$("bpmn:CancelEventDefinition")(g,y,x):Tn(C,"bpmn:CompensateEventDefinition")?$("bpmn:CompensateEventDefinition")(g,y,x):Tn(C,"bpmn:TerminateEventDefinition")?$("bpmn:TerminateEventDefinition")(g,y,x):null}function Z(y,g,C){C=q({size:{width:100}},C);var x=r.createText(g||"",C);return Le(x).add("djs-label"),Ce(y,x),x}function Y(y,g,C){var x=At(g);return Z(y,x.name,{box:g,align:C,padding:5,style:{fill:Wr(g,c,l)}})}function z(y,g){var C={width:90,height:30,x:g.width/2+g.x,y:g.height/2+g.y};return Z(y,En(g),{box:C,fitBox:!0,style:q({},r.getExternalStyle(),{fill:Wr(g,c,l)})})}function G(y,g,C){var x=Z(y,g,{box:{height:30,width:C.height},align:"center-middle",style:{fill:Wr(C,c,l)}}),R=-1*C.height;Ic(x,0,-R,270)}function se(y){for(var g=y.waypoints,C="m  "+g[0].x+","+g[0].y,x=1;x<g.length;x++)C+="L"+g[x].x+","+g[x].y+" ";return C}var u=this.handlers={"bpmn:Event":function(y,g,C){return"fillOpacity"in C||(C.fillOpacity=tr),M(y,g.width,g.height,C)},"bpmn:StartEvent":function(y,g){var C={fill:Be(g,s),stroke:le(g,l)},x=At(g);x.isInterrupting||(C={strokeDasharray:"6",strokeLinecap:"round",fill:Be(g,s),stroke:le(g,l)});var R=$("bpmn:Event")(y,g,C);return H(g,y),R},"bpmn:MessageEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:g.width,containerHeight:g.height,position:{mx:.235,my:.315}}),R=C?le(g,l):Be(g,s),D=C?Be(g,s):le(g,l),L=T(y,x,{strokeWidth:1,fill:R,stroke:D});return L},"bpmn:TimerEventDefinition":function(y,g){var C=M(y,g.width,g.height,.2*g.height,{strokeWidth:2,fill:Be(g,s),stroke:le(g,l)}),x=i.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:g.width,containerHeight:g.height,position:{mx:.5,my:.5}});T(y,x,{strokeWidth:2,strokeLinecap:"square",stroke:le(g,l)});for(var R=0;R<12;R++){var D=i.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:g.width,containerHeight:g.height,position:{mx:.5,my:.5}}),L=g.width/2,X=g.height/2;T(y,D,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+R*30+","+X+","+L+")",stroke:le(g,l)})}return C},"bpmn:EscalationEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.5,my:.2}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)})},"bpmn:ConditionalEventDefinition":function(y,g){var C=i.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.5,my:.222}});return T(y,C,{strokeWidth:1,stroke:le(g,l)})},"bpmn:LinkEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.57,my:.263}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)})},"bpmn:ErrorEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:g.width,containerHeight:g.height,position:{mx:.2,my:.722}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)})},"bpmn:CancelEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.638,my:-.055}}),R=C?le(g,l):"none",D=T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)});return Yg(D,45),D},"bpmn:CompensateEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.22,my:.5}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)})},"bpmn:SignalEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:g.width,containerHeight:g.height,position:{mx:.5,my:.2}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R,stroke:le(g,l)})},"bpmn:MultipleEventDefinition":function(y,g,C){var x=i.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:g.width,containerHeight:g.height,position:{mx:.222,my:.36}}),R=C?le(g,l):"none";return T(y,x,{strokeWidth:1,fill:R})},"bpmn:ParallelMultipleEventDefinition":function(y,g){var C=i.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:g.width,containerHeight:g.height,position:{mx:.458,my:.194}});return T(y,C,{strokeWidth:1,fill:le(g,l),stroke:le(g,l)})},"bpmn:EndEvent":function(y,g){var C=$("bpmn:Event")(y,g,{strokeWidth:4,fill:Be(g,s),stroke:le(g,l)});return H(g,y),C},"bpmn:TerminateEventDefinition":function(y,g){var C=M(y,g.width,g.height,8,{strokeWidth:4,fill:le(g,l),stroke:le(g,l)});return C},"bpmn:IntermediateEvent":function(y,g){var C=$("bpmn:Event")(y,g,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)});return M(y,g.width,g.height,Rl,{strokeWidth:1,fill:Be(g,"none"),stroke:le(g,l)}),H(g,y),C},"bpmn:IntermediateCatchEvent":B("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":B("bpmn:IntermediateEvent"),"bpmn:Activity":function(y,g,C){return C=C||{},"fillOpacity"in C||(C.fillOpacity=tr),P(y,g.width,g.height,Yo,C)},"bpmn:Task":function(y,g){var C={fill:Be(g,s),stroke:le(g,l)},x=$("bpmn:Activity")(y,g,C);return Y(y,g,"center-middle"),d(y,g),x},"bpmn:ServiceTask":function(y,g){var C=$("bpmn:Task")(y,g),x=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}});T(y,x,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)});var R=i.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}});T(y,R,{strokeWidth:0,fill:Be(g,s)});var D=i.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}});return T(y,D,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)}),C},"bpmn:UserTask":function(y,g){var C=$("bpmn:Task")(y,g),x=15,R=12,D=i.getScaledPath("TASK_TYPE_USER_1",{abspos:{x,y:R}});T(y,D,{strokeWidth:.5,fill:Be(g,s),stroke:le(g,l)});var L=i.getScaledPath("TASK_TYPE_USER_2",{abspos:{x,y:R}});T(y,L,{strokeWidth:.5,fill:Be(g,s),stroke:le(g,l)});var X=i.getScaledPath("TASK_TYPE_USER_3",{abspos:{x,y:R}});return T(y,X,{strokeWidth:.5,fill:le(g,l),stroke:le(g,l)}),C},"bpmn:ManualTask":function(y,g){var C=$("bpmn:Task")(y,g),x=i.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}});return T(y,x,{strokeWidth:.5,fill:Be(g,s),stroke:le(g,l)}),C},"bpmn:SendTask":function(y,g){var C=$("bpmn:Task")(y,g),x=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}});return T(y,x,{strokeWidth:1,fill:le(g,l),stroke:Be(g,s)}),C},"bpmn:ReceiveTask":function(y,g){var C=At(g),x=$("bpmn:Task")(y,g),R;return C.instantiate?(M(y,28,28,20*.22,{strokeWidth:1}),R=i.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):R=i.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),T(y,R,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)}),x},"bpmn:ScriptTask":function(y,g){var C=$("bpmn:Task")(y,g),x=i.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}});return T(y,x,{strokeWidth:1,stroke:le(g,l)}),C},"bpmn:BusinessRuleTask":function(y,g){var C=$("bpmn:Task")(y,g),x=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}),R=T(y,x);ae(R,{strokeWidth:1,fill:Be(g,"#aaaaaa"),stroke:le(g,l)});var D=i.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}),L=T(y,D);return ae(L,{strokeWidth:1,stroke:le(g,l)}),C},"bpmn:SubProcess":function(y,g,C){C=q({fill:Be(g,s),stroke:le(g,l)},C);var x=$("bpmn:Activity")(y,g,C),R=We(g);return Gt(g)&&ae(x,{strokeDasharray:"1,2"}),Y(y,g,R?"center-top":"center-middle"),R?d(y,g):d(y,g,["SubProcessMarker"]),x},"bpmn:AdHocSubProcess":function(y,g){return $("bpmn:SubProcess")(y,g)},"bpmn:Transaction":function(y,g){var C=$("bpmn:SubProcess")(y,g),x=n.style(["no-fill","no-events"],{stroke:le(g,l)});return P(y,g.width,g.height,Yo-2,Rl,x),C},"bpmn:CallActivity":function(y,g){return $("bpmn:SubProcess")(y,g,{strokeWidth:5})},"bpmn:Participant":function(y,g){var C={fillOpacity:tr,fill:Be(g,s),stroke:le(g,l)},x=$("bpmn:Lane")(y,g,C),R=We(g);if(R){w(y,[{x:30,y:0},{x:30,y:g.height}],{stroke:le(g,l)});var D=At(g).name;G(y,D,g)}else{var L=At(g).name;Z(y,L,{box:g,align:"center-middle",style:{fill:Wr(g,c,l)}})}var X=!!At(g).participantMultiplicity;return X&&$("ParticipantMultiplicityMarker")(y,g),x},"bpmn:Lane":function(y,g,C){var x=P(y,g.width,g.height,0,q({fill:Be(g,s),fillOpacity:Nw,stroke:le(g,l)},C)),R=At(g);if(R.$type==="bpmn:Lane"){var D=R.name;G(y,D,g)}return x},"bpmn:InclusiveGateway":function(y,g){var C=$("bpmn:Gateway")(y,g);return M(y,g.width,g.height,g.height*.24,{strokeWidth:2.5,fill:Be(g,s),stroke:le(g,l)}),C},"bpmn:ExclusiveGateway":function(y,g){var C=$("bpmn:Gateway")(y,g),x=i.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:g.width,containerHeight:g.height,position:{mx:.32,my:.3}});return dr(g).isMarkerVisible&&T(y,x,{strokeWidth:1,fill:le(g,l),stroke:le(g,l)}),C},"bpmn:ComplexGateway":function(y,g){var C=$("bpmn:Gateway")(y,g),x=i.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:g.width,containerHeight:g.height,position:{mx:.46,my:.26}});return T(y,x,{strokeWidth:1,fill:le(g,l),stroke:le(g,l)}),C},"bpmn:ParallelGateway":function(y,g){var C=$("bpmn:Gateway")(y,g),x=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:g.width,containerHeight:g.height,position:{mx:.46,my:.2}});return T(y,x,{strokeWidth:1,fill:le(g,l),stroke:le(g,l)}),C},"bpmn:EventBasedGateway":function(y,g){var C=At(g),x=$("bpmn:Gateway")(y,g);M(y,g.width,g.height,g.height*.2,{strokeWidth:1,fill:"none",stroke:le(g,l)});var R=C.eventGatewayType,D=!!C.instantiate;function L(){var oe=i.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:g.width,containerHeight:g.height,position:{mx:.36,my:.44}}),ee={strokeWidth:2,fill:Be(g,"none"),stroke:le(g,l)};T(y,oe,ee)}if(R==="Parallel"){var X=i.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:g.width,containerHeight:g.height,position:{mx:.474,my:.296}}),K=T(y,X);ae(K,{strokeWidth:1,fill:"none"})}else if(R==="Exclusive"){if(!D){var W=M(y,g.width,g.height,g.height*.26);ae(W,{strokeWidth:1,fill:"none",stroke:le(g,l)})}L()}return x},"bpmn:Gateway":function(y,g){var C={fill:Be(g,s),fillOpacity:tr,stroke:le(g,l)};return S(y,g.width,g.height,C)},"bpmn:SequenceFlow":function(y,g){var C=se(g),x=Be(g,s),R=le(g,l),D={strokeLinejoin:"round",markerEnd:_("sequenceflow-end",x,R),stroke:le(g,l)},L=T(y,C,D),X=At(g),K;return g.source&&(K=g.source.businessObject,X.conditionExpression&&K.$instanceOf("bpmn:Activity")&&ae(L,{markerStart:_("conditional-flow-marker",x,R)}),K.default&&(K.$instanceOf("bpmn:Gateway")||K.$instanceOf("bpmn:Activity"))&&K.default===X&&ae(L,{markerStart:_("conditional-default-flow-marker",x,R)})),L},"bpmn:Association":function(y,g,C){var x=At(g),R=Be(g,s),D=le(g,l);return C=q({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:le(g,l)},C||{}),(x.associationDirection==="One"||x.associationDirection==="Both")&&(C.markerEnd=_("association-end",R,D)),x.associationDirection==="Both"&&(C.markerStart=_("association-start",R,D)),w(y,g.waypoints,C)},"bpmn:DataInputAssociation":function(y,g){var C=Be(g,s),x=le(g,l);return $("bpmn:Association")(y,g,{markerEnd:_("association-end",C,x)})},"bpmn:DataOutputAssociation":function(y,g){var C=Be(g,s),x=le(g,l);return $("bpmn:Association")(y,g,{markerEnd:_("association-end",C,x)})},"bpmn:MessageFlow":function(y,g){var C=At(g),x=dr(g),R=Be(g,s),D=le(g,l),L=se(g),X={markerEnd:_("messageflow-end",R,D),markerStart:_("messageflow-start",R,D),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:le(g,l)},K=T(y,L,X);if(C.messageRef){var W=K.getPointAtLength(K.getTotalLength()/2),oe=i.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:W.x,y:W.y}}),ee={strokeWidth:1};x.messageVisibleKind==="initiating"?(ee.fill="white",ee.stroke="black"):(ee.fill="#888",ee.stroke="white");var te=T(y,oe,ee),de=C.messageRef.name,ge=Z(y,de,{align:"center-top",fitBox:!0,style:{fill:le(g,c)}}),fe=te.getBBox(),Q=ge.getBBox(),ne=W.x-Q.width/2,we=W.y+fe.height/2+Mw;Ic(ge,ne,we,0)}return K},"bpmn:DataObject":function(y,g){var C=i.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.474,my:.296}}),x=T(y,C,{fill:Be(g,s),fillOpacity:tr,stroke:le(g,l)}),R=At(g);return Tw(R)&&E(y,g),x},"bpmn:DataObjectReference":B("bpmn:DataObject"),"bpmn:DataInput":function(y,g){var C=i.getRawPath("DATA_ARROW"),x=$("bpmn:DataObject")(y,g);return T(y,C,{strokeWidth:1}),x},"bpmn:DataOutput":function(y,g){var C=i.getRawPath("DATA_ARROW"),x=$("bpmn:DataObject")(y,g);return T(y,C,{strokeWidth:1,fill:"black"}),x},"bpmn:DataStoreReference":function(y,g){var C=i.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:0,my:.133}}),x=T(y,C,{strokeWidth:2,fill:Be(g,s),fillOpacity:tr,stroke:le(g,l)});return x},"bpmn:BoundaryEvent":function(y,g){var C=At(g),x=C.cancelActivity,R={strokeWidth:1,fill:Be(g,s),stroke:le(g,l)};x||(R.strokeDasharray="6",R.strokeLinecap="round");var D=q({},R,{fillOpacity:1}),L=q({},R,{fill:"none"}),X=$("bpmn:Event")(y,g,D);return M(y,g.width,g.height,Rl,L),H(g,y),X},"bpmn:Group":function(y,g){var C=P(y,g.width,g.height,Yo,{stroke:le(g,l),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"});return C},label:function(y,g){return z(y,g)},"bpmn:TextAnnotation":function(y,g){var C={fill:"none",stroke:"none"},x=P(y,g.width,g.height,0,0,C),R=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:0,my:0}});T(y,R,{stroke:le(g,l)});var D=At(g).text||"";return Z(y,D,{box:g,align:"left-top",padding:5,style:{fill:Wr(g,c,l)}}),x},ParticipantMultiplicityMarker:function(y,g){var C=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:g.width/2/g.width,my:(g.height-15)/g.height}});N("participant-multiplicity",y,C,{strokeWidth:2,fill:Be(g,s),stroke:le(g,l)})},SubProcessMarker:function(y,g){var C=P(y,14,14,0,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)});Bt(C,g.width/2-7.5,g.height-20);var x=i.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2-7.5)/g.width,my:(g.height-20)/g.height}});N("sub-process",y,x,{fill:Be(g,s),stroke:le(g,l)})},ParallelMarker:function(y,g,C){var x=i.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2+C.parallel)/g.width,my:(g.height-20)/g.height}});N("parallel",y,x,{fill:Be(g,s),stroke:le(g,l)})},SequentialMarker:function(y,g,C){var x=i.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2+C.seq)/g.width,my:(g.height-19)/g.height}});N("sequential",y,x,{fill:Be(g,s),stroke:le(g,l)})},CompensationMarker:function(y,g,C){var x=i.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2+C.compensation)/g.width,my:(g.height-13)/g.height}});N("compensation",y,x,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l)})},LoopMarker:function(y,g,C){var x=i.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2+C.loop)/g.width,my:(g.height-7)/g.height}});N("loop",y,x,{strokeWidth:1,fill:Be(g,s),stroke:le(g,l),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(y,g,C){var x=i.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:(g.width/2+C.adhoc)/g.width,my:(g.height-15)/g.height}});N("adhoc",y,x,{strokeWidth:1,fill:le(g,l),stroke:le(g,l)})}};function d(y,g,C){var x=At(g),R=C&&C.indexOf("SubProcessMarker")!==-1,D;R?D={seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:D={seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},j(C,function(K){$(K)(y,g,D)}),x.isForCompensation&&$("CompensationMarker")(y,g,D),x.$type==="bpmn:AdHocSubProcess"&&$("AdhocMarker")(y,g,D);var L=x.loopCharacteristics,X=L&&L.isSequential;L&&(X===void 0&&$("LoopMarker")(y,g,D),X===!1&&$("ParallelMarker")(y,g,D),X===!0&&$("SequentialMarker")(y,g,D))}function E(y,g){var C=(g.height-18)/g.height,x=i.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:g.width,containerHeight:g.height,position:{mx:.33,my:C}});T(y,x,{strokeWidth:2})}this._drawPath=T}ye(Hi,qn);Hi.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"];Hi.prototype.canRender=function(e){return A(e,"bpmn:BaseElement")};Hi.prototype.drawShape=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};Hi.prototype.drawConnection=function(e,t){var n=t.type,i=this.handlers[n];return i(e,t)};Hi.prototype.getShapePath=function(e){return A(e,"bpmn:Event")?Cw(e):A(e,"bpmn:Activity")?Aw(e,Yo):A(e,"bpmn:Gateway")?Pw(e):Rw(e)};var Dw=0,kw={width:150,height:50};function Ow(e){var t=e.split("-");return{horizontal:t[0]||"center",vertical:t[1]||"top"}}function Lw(e){return st(e)?q({top:0,left:0,right:0,bottom:0},e):{top:e,left:e,right:e,bottom:e}}function Bw(e,t){t.textContent=e;var n;try{var i,a=e==="";return t.textContent=a?"dummy":e,n=t.getBBox(),i={width:n.width+n.x*2,height:n.height},a&&(i.width=0),i}catch{return{width:0,height:0}}}function $w(e,t,n){for(var i=e.shift(),a=i,r;;){if(r=Bw(a,n),r.width=a?r.width:0,a===" "||a===""||r.width<Math.round(t)||a.length<2)return Vw(e,a,i,r);a=jw(a,r.width,t)}}function Vw(e,t,n,i){if(t.length<n.length){var a=n.slice(t.length).trim();e.unshift(a)}return{width:i.width,height:i.height,text:t}}var Td="­";function Fw(e,t){var n=e.split(/(\s|-|\u00AD)/g),i,a=[],r=0;if(n.length>1)for(;i=n.shift();)if(i.length+r<t)a.push(i),r+=i.length;else{(i==="-"||i===Td)&&a.pop();break}var o=a[a.length-1];return o&&o===Td&&(a[a.length-1]="-"),a.join("")}function jw(e,t,n){var i=Math.max(e.length*(n/t),1),a=Fw(e,i);return a||(a=e.slice(0,Math.max(Math.round(i-1),1))),a}function Hw(){var e=document.getElementById("helper-svg");return e||(e=be("svg"),ae(e,{id:"helper-svg",width:0,height:0,style:"visibility: hidden; position: fixed"}),document.body.appendChild(e)),e}function Ns(e){this._config=q({},{size:kw,padding:Dw,style:{},align:"center-top"},e||{})}Ns.prototype.createText=function(e,t){return this.layoutText(e,t).element};Ns.prototype.getDimensions=function(e,t){return this.layoutText(e,t).dimensions};Ns.prototype.layoutText=function(e,t){var n=q({},this._config.size,t.box),i=q({},this._config.style,t.style),a=Ow(t.align||this._config.align),r=Lw(t.padding!==void 0?t.padding:this._config.padding),o=t.fitBox||!1,s=Gw(i),l=e.split(/\u00AD?\r?\n/),c=[],p=n.width-r.left-r.right,f=be("text");ae(f,{x:0,y:0}),ae(f,i);var h=Hw();for(Ce(h,f);l.length;)c.push($w(l,p,f));a.vertical==="middle"&&(r.top=r.bottom=0);var v=Vt(c,function(P,S,w){return P+(s||S.height)},0)+r.top+r.bottom,m=Vt(c,function(P,S,w){return S.width>P?S.width:P},0),_=r.top;a.vertical==="middle"&&(_+=(n.height-v)/2),_-=(s||c[0].height)/4;var b=be("text");ae(b,i),j(c,function(P){var S;switch(_+=s||P.height,a.horizontal){case"left":S=r.left;break;case"right":S=(o?m:p)-r.right-P.width;break;default:S=Math.max(((o?m:p)-P.width)/2+r.left,0)}var w=be("tspan");ae(w,{x:S,y:_}),w.textContent=P.text,Ce(b,w)}),ot(f);var M={width:m,height:v};return{dimensions:M,element:b}};function Gw(e){if("fontSize"in e&&"lineHeight"in e)return e.lineHeight*parseInt(e.fontSize,10)}var zw=12,Uw=1.2,qw=30;function fy(e){var t=q({fontFamily:"Arial, sans-serif",fontSize:zw,fontWeight:"normal",lineHeight:Uw},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,i=q({},t,{fontSize:n},e&&e.externalStyle||{}),a=new Ns({style:t});this.getExternalLabelBounds=function(r,o){var s=a.getDimensions(o,{box:{width:90,height:30,x:r.width/2+r.x,y:r.height/2+r.y},style:i});return{x:Math.round(r.x+r.width/2-s.width/2),y:Math.round(r.y),width:Math.ceil(s.width),height:Math.ceil(s.height)}},this.getTextAnnotationBounds=function(r,o){var s=a.getDimensions(o,{box:r,style:t,align:"left-top",padding:5});return{x:r.x,y:r.y,width:r.width,height:Math.max(qw,Math.round(s.height))}},this.createText=function(r,o){return a.createText(r,o||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return i}}fy.$inject=["config.textRenderer"];function Ww(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my} m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(t){return this.pathMap[t].d},this.getScaledPath=function(t,n){var i=this.pathMap[t],a,r;n.abspos?(a=n.abspos.x,r=n.abspos.y):(a=n.containerWidth*n.position.mx,r=n.containerHeight*n.position.my);var o={};if(n.position){for(var s=n.containerHeight/i.height*n.yScaleFactor,l=n.containerWidth/i.width*n.xScaleFactor,c=0;c<i.heightElements.length;c++)o["y"+c]=i.heightElements[c]*s;for(var p=0;p<i.widthElements.length;p++)o["x"+p]=i.widthElements[p]*l}var f=Zw(i.d,{mx:a,my:r,e:o});return f}}var Yw=/\{([^{}]+)\}/g,Kw=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;function Xw(e,t,n){var i=n;return t.replace(Kw,function(a,r,o,s,l){r=r||s,i&&(r in i&&(i=i[r]),typeof i=="function"&&l&&(i=i()))}),i=(i==null||i==n?e:i)+"",i}function Zw(e,t){return String(e).replace(Yw,function(n,i){return Xw(n,i,t)})}const Jw={__init__:["bpmnRenderer"],bpmnRenderer:["type",Hi],textRenderer:["type",fy],pathMap:["type",Ww]};function Qw(e,t){return t=t||{},e.replace(/{([^}]+)}/g,function(n,i){return t[i]||"{"+i+"}"})}const Ms={translate:["value",Qw]};var da={width:90,height:20},Cd=15;function hr(e){return A(e,"bpmn:Event")||A(e,"bpmn:Gateway")||A(e,"bpmn:DataStoreReference")||A(e,"bpmn:DataObjectReference")||A(e,"bpmn:DataInput")||A(e,"bpmn:DataOutput")||A(e,"bpmn:SequenceFlow")||A(e,"bpmn:MessageFlow")||A(e,"bpmn:Group")}function Ds(e){return _t(e.label)}function e0(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)],a=t0(e),r=Math.atan((i.y-n.y)/(i.x-n.x)),o=a.x,s=a.y;return Math.abs(r)<Math.PI/2?s-=Cd:o+=Cd,{x:o,y:s}}function t0(e){var t=e.length/2-1,n=e[Math.floor(t)],i=e[Math.ceil(t+.01)];return{x:n.x+(i.x-n.x)/2,y:n.y+(i.y-n.y)/2}}function ks(e){return e.waypoints?e0(e.waypoints):A(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+da.height/2}:{x:e.x+e.width/2,y:e.y+e.height+da.height/2}}function n0(e,t){var n,i,a,r=e.di,o=r.label;return o&&o.bounds?(a=o.bounds,i={width:Math.max(da.width,a.width),height:a.height},n={x:a.x+a.width/2,y:a.y+a.height/2}):(n=ks(t),i=da),q({x:n.x-i.width/2,y:n.y-i.height/2},i)}function _t(e){return e&&!!e.labelTarget}function Ko(e,t){return q({id:e.id,type:e.$type,businessObject:e},t)}function i0(e,t,n){var i=e.di.waypoint;return!i||i.length<2?[Me(t),Me(n)]:i.map(function(a){return{x:a.x,y:a.y}})}function dy(e,t,n,i){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:bt(n),referenced:bt(t),property:i}))}function Yn(e,t,n,i,a,r){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=i,this._translate=a,this._textRenderer=r}Yn.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"];Yn.prototype.add=function(e,t){var n=e.di,i,a=this._translate,r,o;if(A(n,"bpmndi:BPMNPlane"))i=this._elementFactory.createRoot(Ko(e)),this._canvas.setRootElement(i);else if(A(n,"bpmndi:BPMNShape")){var s=!We(e),l=a0(e);r=t&&(t.hidden||t.collapsed);var c=e.di.bounds;i=this._elementFactory.createShape(Ko(e,{collapsed:s,hidden:r,x:Math.round(c.x),y:Math.round(c.y),width:Math.round(c.width),height:Math.round(c.height),isFrame:l})),A(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,i),A(e,"bpmn:Lane")&&(o=0),A(e,"bpmn:DataStoreReference")&&(r0(t,Me(c))||(t=this._canvas.getRootElement())),this._canvas.addShape(i,t,o)}else if(A(n,"bpmndi:BPMNEdge")){var p=this._getSource(e),f=this._getTarget(e);r=t&&(t.hidden||t.collapsed),i=this._elementFactory.createConnection(Ko(e,{hidden:r,source:p,target:f,waypoints:i0(e,p,f)})),A(e,"bpmn:DataAssociation")&&(t=null),A(e,"bpmn:SequenceFlow")&&(o=0),this._canvas.addConnection(i,t,o)}else throw new Error(a("unknown di {di} for element {semantic}",{di:bt(n),semantic:bt(e)}));return hr(e)&&En(i)&&this.addLabel(e,i),this._eventBus.fire("bpmnElement.added",{element:i}),i};Yn.prototype._attachBoundary=function(e,t){var n=this._translate,i=e.attachedToRef;if(!i)throw new Error(n("missing {semantic}#attachedToRef",{semantic:bt(e)}));var a=this._elementRegistry.get(i.id),r=a&&a.attachers;if(!a)throw dy(n,e,i,"attachedToRef");t.host=a,r||(a.attachers=r=[]),r.indexOf(t)===-1&&r.push(t)};Yn.prototype.addLabel=function(e,t){var n,i,a;return n=n0(e,t),i=En(t),i&&(n=this._textRenderer.getExternalLabelBounds(n,i)),a=this._elementFactory.createLabel(Ko(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!En(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(a,t.parent)};Yn.prototype._getEnd=function(e,t){var n,i,a=e.$type,r=this._translate;if(i=e[t+"Ref"],t==="source"&&a==="bpmn:DataInputAssociation"&&(i=i&&i[0]),(t==="source"&&a==="bpmn:DataOutputAssociation"||t==="target"&&a==="bpmn:DataInputAssociation")&&(i=e.$parent),n=i&&this._getElement(i),n)return n;throw i?dy(r,e,i,t+"Ref"):new Error(r("{semantic}#{side} Ref not specified",{semantic:bt(e),side:t}))};Yn.prototype._getSource=function(e){return this._getEnd(e,"source")};Yn.prototype._getTarget=function(e){return this._getEnd(e,"target")};Yn.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};function r0(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function a0(e){return A(e,"bpmn:Group")}const o0={__depends__:[Ms],bpmnImporter:["type",Yn]},s0={__depends__:[Jw,o0]};function Ad(e){!e||typeof e.stopPropagation!="function"||e.stopPropagation()}function Pr(e){return e.originalEvent||e.srcEvent}function Il(e,t){Ad(e),Ad(Pr(e))}function pi(e){return e.pointers&&e.pointers.length&&(e=e.pointers[0]),e.touches&&e.touches.length&&(e=e.touches[0]),e?{x:e.clientX,y:e.clientY}:null}function l0(){return/mac/i.test(navigator.platform)}function hy(e,t){return(Pr(e)||e).button===t}function mi(e){return hy(e,0)}function u0(e){return hy(e,1)}function mr(e){var t=Pr(e)||e;return mi(e)?l0()?t.metaKey:t.ctrlKey:!1}function my(e){var t=Pr(e)||e;return mi(e)&&t.shiftKey}function c0(e){return!0}function bo(e){return mi(e)||u0(e)}var Pd=500;function vy(e,t,n){var i=this;function a(B,$,H){if(!s(B,$)){var Z,Y,z;H?Y=t.getGraphics(H):(Z=$.delegateTarget||$.target,Z&&(Y=Z,H=t.get(Y))),!(!Y||!H)&&(z=e.fire(B,{element:H,gfx:Y,originalEvent:$}),z===!1&&($.stopPropagation(),$.preventDefault()))}}var r={};function o(B){return r[B]}function s(B,$){var H=c[B]||mi;return!H($)}var l={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},c={"element.contextmenu":c0,"element.mousedown":bo,"element.mouseup":bo,"element.click":bo,"element.dblclick":bo};function p(B,$,H){var Z=l[B];if(!Z)throw new Error("unmapped DOM event name <"+B+">");return a(Z,$,H)}var f="svg, .djs-element";function h(B,$,H,Z){var Y=r[H]=function(z){a(H,z)};Z&&(c[H]=Z),Y.$delegate=Ht.bind(B,f,$,Y)}function v(B,$,H){var Z=o(H);Z&&Ht.unbind(B,$,Z.$delegate)}function m(B){j(l,function($,H){h(B,H,$)})}function _(B){j(l,function($,H){v(B,H,$)})}e.on("canvas.destroy",function(B){_(B.svg)}),e.on("canvas.init",function(B){m(B.svg)}),e.on(["shape.added","connection.added"],function(B){var $=B.element,H=B.gfx;e.fire("interactionEvents.createHit",{element:$,gfx:H})}),e.on(["shape.changed","connection.changed"],Pd,function(B){var $=B.element,H=B.gfx;e.fire("interactionEvents.updateHit",{element:$,gfx:H})}),e.on("interactionEvents.createHit",Pd,function(B){var $=B.element,H=B.gfx;i.createDefaultHit($,H)}),e.on("interactionEvents.updateHit",function(B){var $=B.element,H=B.gfx;i.updateDefaultHit($,H)});var b=w("djs-hit djs-hit-stroke"),M=w("djs-hit djs-hit-click-stroke"),P=w("djs-hit djs-hit-all"),S={all:P,"click-stroke":M,stroke:b};function w(B,$){return $=q({stroke:"white",strokeWidth:15},$||{}),n.cls(B,["no-fill","no-border"],$)}function T(B,$){var H=S[$];if(!H)throw new Error("invalid hit type <"+$+">");return ae(B,H),B}function N(B,$){Ce(B,$)}this.removeHits=function(B){var $=_c(".djs-hit",B);j($,ot)},this.createDefaultHit=function(B,$){var H=B.waypoints,Z=B.isFrame,Y;return H?this.createWaypointsHit($,H):(Y=Z?"stroke":"all",this.createBoxHit($,Y,{width:B.width,height:B.height}))},this.createWaypointsHit=function(B,$){var H=pp($);return T(H,"stroke"),N(B,H),H},this.createBoxHit=function(B,$,H){H=q({x:0,y:0},H);var Z=be("rect");return T(Z,$),ae(Z,H),N(B,Z),Z},this.updateDefaultHit=function(B,$){var H=it(".djs-hit",$);if(H)return B.waypoints?a_(H,B.waypoints):ae(H,{width:B.width,height:B.height}),H},this.fire=a,this.triggerMouseEvent=p,this.mouseHandler=o,this.registerEvent=h,this.unregisterEvent=v}vy.$inject=["eventBus","elementRegistry","styles"];const Ca={__init__:["interactionEvents"],interactionEvents:["type",vy]};var p0=500;function Os(e,t,n){this.offset=6;var i=t.cls("djs-outline",["no-fill"]),a=this;function r(o,s){var l=be("rect");return ae(l,q({x:10,y:10,width:100,height:100},i)),Ce(o,l),l}e.on(["shape.added","shape.changed"],p0,function(o){var s=o.element,l=o.gfx,c=it(".djs-outline",l);c||(c=r(l)),a.updateShapeOutline(c,s)}),e.on(["connection.added","connection.changed"],function(o){var s=o.element,l=o.gfx,c=it(".djs-outline",l);c||(c=r(l)),a.updateConnectionOutline(c,s)})}Os.prototype.updateShapeOutline=function(e,t){ae(e,{x:-this.offset,y:-this.offset,width:t.width+this.offset*2,height:t.height+this.offset*2})};Os.prototype.updateConnectionOutline=function(e,t){var n=St(t);ae(e,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+this.offset*2,height:n.height+this.offset*2})};Os.$inject=["eventBus","styles","elementRegistry"];const gy={__init__:["outline"],outline:["type",Os]};function Rr(e,t){this._eventBus=e,this._canvas=t,this._selectedElements=[];var n=this;e.on(["shape.remove","connection.remove"],function(i){var a=i.element;n.deselect(a)}),e.on(["diagram.clear","plane.set"],function(i){n.select(null)})}Rr.$inject=["eventBus","canvas"];Rr.prototype.deselect=function(e){var t=this._selectedElements,n=t.indexOf(e);if(n!==-1){var i=t.slice();t.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:t})}};Rr.prototype.get=function(){return this._selectedElements};Rr.prototype.isSelected=function(e){return this._selectedElements.indexOf(e)!==-1};Rr.prototype.select=function(e,t){var n=this._selectedElements,i=n.slice();Oe(e)||(e=e?[e]:[]);var a=this._canvas;e=e.filter(function(r){var o=a.findPlane(r);return o===a.getActivePlane()}),t?j(e,function(r){n.indexOf(r)===-1&&n.push(r)}):this._selectedElements=n=e.slice(),this._eventBus.fire("selection.changed",{oldSelection:i,newSelection:n})};var Rd="hover",Id="selected";function yy(e,t,n,i){this._multiSelectionBox=null;function a(o,s){t.addMarker(o,s)}function r(o,s){t.removeMarker(o,s)}e.on("element.hover",function(o){a(o.element,Rd)}),e.on("element.out",function(o){r(o.element,Rd)}),e.on("selection.changed",function(o){function s(f){r(f,Id)}function l(f){a(f,Id)}var c=o.oldSelection,p=o.newSelection;j(c,function(f){p.indexOf(f)===-1&&s(f)}),j(p,function(f){c.indexOf(f)===-1&&l(f)})})}yy.$inject=["eventBus","canvas","selection","styles"];function Ey(e,t,n,i){e.on("create.end",500,function(a){var r=a.context,o=r.canExecute,s=r.elements,l=r.hints||{},c=l.autoSelect;if(o){if(c===!1)return;Oe(c)?t.select(c):t.select(s.filter(f0))}}),e.on("connect.end",500,function(a){var r=a.context,o=r.canExecute,s=r.hover;o&&s&&t.select(s)}),e.on("shape.move.end",500,function(a){var r=a.previousSelection||[],o=i.get(a.context.shape.id),s=Ue(r,function(l){return o.id===l.id});s||t.select(o)}),e.on("element.click",function(a){if(mi(a)){var r=a.element;r===n.getRootElement()&&(r=null);var o=t.isSelected(r),s=t.get().length>1,l=mr(a)||my(a);if(o&&s)return l?t.deselect(r):t.select(r);o?t.deselect(r):t.select(r,l)}})}Ey.$inject=["eventBus","selection","canvas","elementRegistry"];function f0(e){return!e.hidden}const Dn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[Ca,gy],selection:["type",Rr],selectionVisuals:["type",yy],selectionBehavior:["type",Ey]};function Sp(e){this._counter=0,this._prefix=(e?e+"-":"")+Math.floor(Math.random()*1e9)+"-"}Sp.prototype.next=function(){return this._prefix+ ++this._counter};var d0=new Sp("ov"),h0=500;function gt(e,t,n,i){this._eventBus=t,this._canvas=n,this._elementRegistry=i,this._ids=d0,this._overlayDefaults=q({show:null,scale:!0},e&&e.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=m0(n.getContainer()),this._init()}gt.$inject=["config.overlays","eventBus","canvas","elementRegistry"];gt.prototype.get=function(e){if($t(e)&&(e={id:e}),$t(e.element)&&(e.element=this._elementRegistry.get(e.element)),e.element){var t=this._getOverlayContainer(e.element,!0);return t?e.type?Ie(t.overlays,en({type:e.type})):t.overlays.slice():[]}else return e.type?Ie(this._overlays,en({type:e.type})):e.id?this._overlays[e.id]:null};gt.prototype.add=function(e,t,n){if(st(t)&&(n=t,t=null),e.id||(e=this._elementRegistry.get(e)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!e)throw new Error("invalid element specified");var i=this._ids.next();return n=q({},this._overlayDefaults,n,{id:i,type:t,element:e,html:n.html}),this._addOverlay(n),i};gt.prototype.remove=function(e){var t=this.get(e)||[];Oe(t)||(t=[t]);var n=this;j(t,function(i){var a=n._getOverlayContainer(i.element,!0);if(i&&(Nn(i.html),Nn(i.htmlContainer),delete i.htmlContainer,delete i.element,delete n._overlays[i.id]),a){var r=a.overlays.indexOf(i);r!==-1&&a.overlays.splice(r,1)}})};gt.prototype.show=function(){Aa(this._overlayRoot)};gt.prototype.hide=function(){Aa(this._overlayRoot,!1)};gt.prototype.clear=function(){this._overlays={},this._overlayContainers=[],_s(this._overlayRoot)};gt.prototype._updateOverlayContainer=function(e){var t=e.element,n=e.html,i=t.x,a=t.y;if(t.waypoints){var r=St(t);i=r.x,a=r.y}by(n,i,a),Ut(e.html,"data-container-id",t.id)};gt.prototype._updateOverlay=function(e){var t=e.position,n=e.htmlContainer,i=e.element,a=t.left,r=t.top;if(t.right!==void 0){var o;i.waypoints?o=St(i).width:o=i.width,a=t.right*-1+o}if(t.bottom!==void 0){var s;i.waypoints?s=St(i).height:s=i.height,r=t.bottom*-1+s}by(n,a||0,r||0)};gt.prototype._createOverlayContainer=function(e){var t=Qe('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(t);var n={html:t,element:e,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n};gt.prototype._updateRoot=function(e){var t=e.scale||1,n="matrix("+[t,0,0,t,-1*e.x*t,-1*e.y*t].join(",")+")";xy(this._overlayRoot,n)};gt.prototype._getOverlayContainer=function(e,t){var n=Ue(this._overlayContainers,function(i){return i.element===e});return!n&&!t?this._createOverlayContainer(e):n};gt.prototype._addOverlay=function(e){var t=e.id,n=e.element,i=e.html,a,r;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),$t(i)&&(i=Qe(i)),r=this._getOverlayContainer(n),a=Qe('<div class="djs-overlay" data-overlay-id="'+t+'" style="position: absolute">'),a.appendChild(i),e.type&&dt(a).add("djs-overlay-"+e.type);var o=this._canvas.findPlane(n),s=this._canvas.getActivePlane();e.plane=o,o!==s&&Aa(a,!1),e.htmlContainer=a,r.overlays.push(e),r.html.appendChild(a),this._overlays[t]=e,this._updateOverlay(e),this._updateOverlayVisibilty(e,this._canvas.viewbox())};gt.prototype._updateOverlayVisibilty=function(e,t){var n=e.show,i=e.plane,a=n&&n.minZoom,r=n&&n.maxZoom,o=e.htmlContainer,s=this._canvas.getActivePlane(),l=!0;(i!==s||n&&(Qt(a)&&a>t.scale||Qt(r)&&r<t.scale))&&(l=!1),Aa(o,l),this._updateOverlayScale(e,t)};gt.prototype._updateOverlayScale=function(e,t){var n=e.scale,i,a,r=e.htmlContainer,o,s="";n!==!0&&(n===!1?(i=1,a=1):(i=n.min,a=n.max),Qt(i)&&t.scale<i&&(o=(1/t.scale||1)*i),Qt(a)&&t.scale>a&&(o=(1/t.scale||1)*a)),Qt(o)&&(s="scale("+o+","+o+")"),xy(r,s)};gt.prototype._updateOverlaysVisibilty=function(e){var t=this;j(this._overlays,function(n){t._updateOverlayVisibilty(n,e)})};gt.prototype._init=function(){var e=this._eventBus,t=this;function n(i){t._updateRoot(i),t._updateOverlaysVisibilty(i),t.show()}e.on("canvas.viewbox.changing",function(i){t.hide()}),e.on("canvas.viewbox.changed",function(i){n(i.viewbox)}),e.on(["shape.remove","connection.remove"],function(i){var a=i.element,r=t.get({element:a});j(r,function(l){t.remove(l.id)});var o=t._getOverlayContainer(a);if(o){Nn(o.html);var s=t._overlayContainers.indexOf(o);s!==-1&&t._overlayContainers.splice(s,1)}}),e.on("element.changed",h0,function(i){var a=i.element,r=t._getOverlayContainer(a,!0);r&&(j(r.overlays,function(o){t._updateOverlay(o)}),t._updateOverlayContainer(r))}),e.on("element.marker.update",function(i){var a=t._getOverlayContainer(i.element,!0);a&&dt(a.html)[i.add?"add":"remove"](i.marker)}),e.on("plane.set",function(i){j(t._overlays,function(a){Aa(a.htmlContainer,a.plane===i.plane)})}),e.on("diagram.clear",this.clear,this)};function m0(e){var t=Qe('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function by(e,t,n){q(e.style,{left:t+"px",top:n+"px"})}function Aa(e,t){e.style.display=t===!1?"none":""}function xy(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}const wp={__init__:["overlays"],overlays:["type",gt]};function Kn(e){tt.call(this,e)}ye(Kn,tt);Kn.prototype._modules=[s0,Ms,Dn,wp];Kn.prototype._moddleExtensions={};var v0=67,g0=86,y0=89,E0=90,b0=["c","C",v0],x0=["v","V",g0],_0=["y","Y",y0],_y=["z","Z",E0];function S0(e){return e.ctrlKey||e.metaKey||e.shiftKey||e.altKey}function zt(e){return e.altKey?!1:e.ctrlKey||e.metaKey}function gn(e,t){return e=Oe(e)?e:[e],e.indexOf(t.key)!==-1||e.indexOf(t.keyCode)!==-1}function Tp(e){return e.shiftKey}function w0(e){return zt(e)&&gn(b0,e)}function T0(e){return zt(e)&&gn(x0,e)}function C0(e){return zt(e)&&!Tp(e)&&gn(_y,e)}function A0(e){return zt(e)&&(gn(_0,e)||gn(_y,e)&&Tp(e))}var Ls="keyboard.keydown",P0="keyboard.keyup",Nd="input-handle-modified-keys",R0=1e3;function yt(e,t){var n=this;this._config=e||{},this._eventBus=t,this._keydownHandler=this._keydownHandler.bind(this),this._keyupHandler=this._keyupHandler.bind(this),t.on("diagram.destroy",function(){n._fire("destroy"),n.unbind()}),t.on("diagram.init",function(){n._fire("init")}),t.on("attach",function(){e&&e.bindTo&&n.bind(e.bindTo)}),t.on("detach",function(){n.unbind()})}yt.$inject=["config.keyboard","eventBus"];yt.prototype._keydownHandler=function(e){this._keyHandler(e,Ls)};yt.prototype._keyupHandler=function(e){this._keyHandler(e,P0)};yt.prototype._keyHandler=function(e,t){var n;if(!this._isEventIgnored(e)){var i={keyEvent:e};n=this._eventBus.fire(t||Ls,i),n&&e.preventDefault()}};yt.prototype._isEventIgnored=function(e){return I0(e.target)&&this._isModifiedKeyIgnored(e)};yt.prototype._isModifiedKeyIgnored=function(e){if(!zt(e))return!0;var t=this._getAllowedModifiers(e.target);return!t.includes(e.key)};yt.prototype._getAllowedModifiers=function(e){var t=Fi(e,"["+Nd+"]",!0);return!t||this._node&&!this._node.contains(t)?[]:t.getAttribute(Nd).split(",")};yt.prototype.bind=function(e){this.unbind(),this._node=e,Se.bind(e,"keydown",this._keydownHandler,!0),Se.bind(e,"keyup",this._keyupHandler,!0),this._fire("bind")};yt.prototype.getBinding=function(){return this._node};yt.prototype.unbind=function(){var e=this._node;e&&(this._fire("unbind"),Se.unbind(e,"keydown",this._keydownHandler,!0),Se.unbind(e,"keyup",this._keyupHandler,!0)),this._node=null};yt.prototype._fire=function(e){this._eventBus.fire("keyboard."+e,{node:this._node})};yt.prototype.addListener=function(e,t,n){xt(e)&&(n=t,t=e,e=R0),this._eventBus.on(n||Ls,e,t)};yt.prototype.removeListener=function(e,t){this._eventBus.off(t||Ls,e)};yt.prototype.hasModifier=S0;yt.prototype.isCmd=zt;yt.prototype.isShift=Tp;yt.prototype.isKey=gn;function I0(e){return e&&(rs(e,"input, textarea")||e.contentEditable==="true")}var N0=500;function Ir(e,t){var n=this;e.on("editorActions.init",N0,function(i){var a=i.editorActions;n.registerBindings(t,a)})}Ir.$inject=["eventBus","keyboard"];Ir.prototype.registerBindings=function(e,t){function n(i,a){t.isRegistered(i)&&e.addListener(a)}n("undo",function(i){var a=i.keyEvent;if(C0(a))return t.trigger("undo"),!0}),n("redo",function(i){var a=i.keyEvent;if(A0(a))return t.trigger("redo"),!0}),n("copy",function(i){var a=i.keyEvent;if(w0(a))return t.trigger("copy"),!0}),n("paste",function(i){var a=i.keyEvent;if(T0(a))return t.trigger("paste"),!0}),n("stepZoom",function(i){var a=i.keyEvent;if(gn(["+","Add","="],a)&&zt(a))return t.trigger("stepZoom",{value:1}),!0}),n("stepZoom",function(i){var a=i.keyEvent;if(gn(["-","Subtract"],a)&&zt(a))return t.trigger("stepZoom",{value:-1}),!0}),n("zoom",function(i){var a=i.keyEvent;if(gn("0",a)&&zt(a))return t.trigger("zoom",{value:1}),!0}),n("removeSelection",function(i){var a=i.keyEvent;if(gn(["Backspace","Delete","Del"],a))return t.trigger("removeSelection"),!0})};const Cp={__init__:["keyboard","keyboardBindings"],keyboard:["type",yt],keyboardBindings:["type",Ir]};var M0={moveSpeed:50,moveSpeedAccelerated:200};function Sy(e,t,n){var i=this;this._config=q({},M0,e||{}),t.addListener(a);function a(r){var o=r.keyEvent,s=i._config;if(t.isCmd(o)&&t.isKey(["ArrowLeft","Left","ArrowUp","Up","ArrowDown","Down","ArrowRight","Right"],o)){var l=t.isShift(o)?s.moveSpeedAccelerated:s.moveSpeed,c;switch(o.key){case"ArrowLeft":case"Left":c="left";break;case"ArrowUp":case"Up":c="up";break;case"ArrowRight":case"Right":c="right";break;case"ArrowDown":case"Down":c="down";break}return i.moveCanvas({speed:l,direction:c}),!0}}this.moveCanvas=function(r){var o=0,s=0,l=r.speed,c=l/Math.min(Math.sqrt(n.viewbox().scale),1);switch(r.direction){case"left":o=c;break;case"up":s=c;break;case"right":o=-c;break;case"down":s=-c;break}n.scroll({dx:o,dy:s})}}Sy.$inject=["config.keyboardMove","keyboard","canvas"];const wy={__depends__:[Cp],__init__:["keyboardMove"],keyboardMove:["type",Sy]};var D0=/^djs-cursor-.*$/;function Bs(e){var t=dt(document.body);t.removeMatching(D0),e&&t.add("djs-cursor-"+e)}function Ty(){Bs(null)}var k0=5e3;function Cy(e,t){t=t||"element.click";function n(){return!1}return e.once(t,k0,n),function(){e.off(t,n)}}function ra(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function Pn(e,t){return{x:e.x-t.x,y:e.y-t.y}}var O0=15;function Ay(e,t){var n;e.on("element.mousedown",500,function(o){return r(o.originalEvent)});function i(o){var s=n.start,l=n.button,c=pi(o),p=Pn(c,s);if(!n.dragging&&L0(p)>O0&&(n.dragging=!0,l===0&&Cy(e),Bs("grab")),n.dragging){var f=n.last||n.start;p=Pn(c,f),t.scroll({dx:p.x,dy:p.y}),n.last=c}o.preventDefault()}function a(o){Se.unbind(document,"mousemove",i),Se.unbind(document,"mouseup",a),n=null,Ty()}function r(o){if(!Fi(o.target,".djs-draggable")){var s=o.button;if(!(s>=2||o.ctrlKey||o.shiftKey||o.altKey))return n={button:s,start:pi(o)},Se.bind(document,"mousemove",i),Se.bind(document,"mouseup",a),!0}}this.isActive=function(){return!!n}}Ay.$inject=["eventBus","canvas"];function L0(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}const Py={__init__:["moveCanvas"],moveCanvas:["type",Ay]};function Dc(e){return Math.log(e)/Math.log(10)}function Ry(e,t){var n=Dc(e.min),i=Dc(e.max),a=Math.abs(n)+Math.abs(i);return a/t}function B0(e,t){return Math.max(e.min,Math.min(e.max,t))}var $0=Math.sign||function(e){return e>=0?1:-1},Ap={min:.2,max:4},Iy=10,V0=.1,F0=.75;function kn(e,t,n){e=e||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=Pt(this._handleWheel,this),this._totalDelta=0,this._scale=e.scale||F0;var i=this;t.on("canvas.init",function(a){i._init(e.enabled!==!1)})}kn.$inject=["config.zoomScroll","eventBus","canvas"];kn.prototype.scroll=function(t){this._canvas.scroll(t)};kn.prototype.reset=function(){this._canvas.zoom("fit-viewport")};kn.prototype.zoom=function(t,n){var i=Ry(Ap,Iy*2);this._totalDelta+=t,Math.abs(this._totalDelta)>V0&&(this._zoom(t,n,i),this._totalDelta=0)};kn.prototype._handleWheel=function(t){if(!Fi(t.target,".djs-scrollable",!0)){var n=this._container;t.preventDefault();var i=t.ctrlKey,a=t.shiftKey,r=-1*this._scale,o;if(i?r*=t.deltaMode===0?.02:.32:r*=t.deltaMode===0?1:16,i){var s=n.getBoundingClientRect(),l={x:t.clientX-s.left,y:t.clientY-s.top};o=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*$0(t.deltaY)*r,this.zoom(o,l)}else a?o={dx:r*t.deltaY,dy:0}:o={dx:r*t.deltaX,dy:r*t.deltaY},this.scroll(o)}};kn.prototype.stepZoom=function(t,n){var i=Ry(Ap,Iy);this._zoom(t,n,i)};kn.prototype._zoom=function(e,t,n){var i=this._canvas,a=e>0?1:-1,r=Dc(i.zoom()),o=Math.round(r/n)*n;o+=n*a;var s=Math.pow(10,o);i.zoom(B0(Ap,s),t)};kn.prototype.toggle=function(t){var n=this._container,i=this._handleWheel,a=this._enabled;return typeof t>"u"&&(t=!a),a!==t&&Se[t?"bind":"unbind"](n,"wheel",i,!1),this._enabled=t,t};kn.prototype._init=function(e){this.toggle(e)};const Ny={__init__:["zoomScroll"],zoomScroll:["type",kn]};function ha(e){Kn.call(this,e)}ye(ha,Kn);ha.prototype._navigationModules=[wy,Py,Ny];ha.prototype._modules=[].concat(Kn.prototype._modules,ha.prototype._navigationModules);var Nl={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var Md;function j0(){return Md||(Md=1,function(e){(function(t,n,i,a){var r=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),s="function",l=Math.round,c=Math.abs,p=Date.now;function f(I,k,F){return setTimeout(S(I,F),k)}function h(I,k,F){return Array.isArray(I)?(v(I,F[k],F),!0):!1}function v(I,k,F){var J;if(I)if(I.forEach)I.forEach(k,F);else if(I.length!==a)for(J=0;J<I.length;)k.call(F,I[J],J,I),J++;else for(J in I)I.hasOwnProperty(J)&&k.call(F,I[J],J,I)}function m(I,k,F){var J="DEPRECATED METHOD: "+k+`
`+F+` AT 
`;return function(){var re=new Error("get-stack-trace"),me=re&&re.stack?re.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",$e=t.console&&(t.console.warn||t.console.log);return $e&&$e.call(t.console,J,me),I.apply(this,arguments)}}var _;typeof Object.assign!="function"?_=function(k){if(k===a||k===null)throw new TypeError("Cannot convert undefined or null to object");for(var F=Object(k),J=1;J<arguments.length;J++){var re=arguments[J];if(re!==a&&re!==null)for(var me in re)re.hasOwnProperty(me)&&(F[me]=re[me])}return F}:_=Object.assign;var b=m(function(k,F,J){for(var re=Object.keys(F),me=0;me<re.length;)(!J||J&&k[re[me]]===a)&&(k[re[me]]=F[re[me]]),me++;return k},"extend","Use `assign`."),M=m(function(k,F){return b(k,F,!0)},"merge","Use `assign`.");function P(I,k,F){var J=k.prototype,re;re=I.prototype=Object.create(J),re.constructor=I,re._super=J,F&&_(re,F)}function S(I,k){return function(){return I.apply(k,arguments)}}function w(I,k){return typeof I==s?I.apply(k&&k[0]||a,k):I}function T(I,k){return I===a?k:I}function N(I,k,F){v(Z(k),function(J){I.addEventListener(J,F,!1)})}function B(I,k,F){v(Z(k),function(J){I.removeEventListener(J,F,!1)})}function $(I,k){for(;I;){if(I==k)return!0;I=I.parentNode}return!1}function H(I,k){return I.indexOf(k)>-1}function Z(I){return I.trim().split(/\s+/g)}function Y(I,k,F){if(I.indexOf&&!F)return I.indexOf(k);for(var J=0;J<I.length;){if(F&&I[J][F]==k||!F&&I[J]===k)return J;J++}return-1}function z(I){return Array.prototype.slice.call(I,0)}function G(I,k,F){for(var J=[],re=[],me=0;me<I.length;){var $e=I[me][k];Y(re,$e)<0&&J.push(I[me]),re[me]=$e,me++}return J=J.sort(function(Et,It){return Et[k]>It[k]}),J}function se(I,k){for(var F,J,re=k[0].toUpperCase()+k.slice(1),me=0;me<r.length;){if(F=r[me],J=F?F+re:k,J in I)return J;me++}return a}var u=1;function d(){return u++}function E(I){var k=I.ownerDocument||I;return k.defaultView||k.parentWindow||t}var y=/mobile|tablet|ip(ad|hone|od)|android/i,g="ontouchstart"in t,C=se(t,"PointerEvent")!==a,x=g&&y.test(navigator.userAgent),R="touch",D="pen",L="mouse",X="kinect",K=25,W=1,oe=2,ee=4,te=8,de=1,ge=2,fe=4,Q=8,ne=16,we=ge|fe,Pe=Q|ne,Te=we|Pe,qe=["x","y"],xe=["clientX","clientY"];function ke(I,k){var F=this;this.manager=I,this.callback=k,this.element=I.element,this.target=I.options.inputTarget,this.domHandler=function(J){w(I.options.enable,[I])&&F.handler(J)},this.init()}ke.prototype={handler:function(){},init:function(){this.evEl&&N(this.element,this.evEl,this.domHandler),this.evTarget&&N(this.target,this.evTarget,this.domHandler),this.evWin&&N(E(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&B(this.element,this.evEl,this.domHandler),this.evTarget&&B(this.target,this.evTarget,this.domHandler),this.evWin&&B(E(this.element),this.evWin,this.domHandler)}};function Ve(I){var k,F=I.options.inputClass;return F?k=F:C?k=jr:x?k=so:g?k=vl:k=fn,new k(I,Ze)}function Ze(I,k,F){var J=F.pointers.length,re=F.changedPointers.length,me=k&W&&J-re===0,$e=k&(ee|te)&&J-re===0;F.isFirst=!!me,F.isFinal=!!$e,me&&(I.session={}),F.eventType=k,ue(I,F),I.emit("hammer.input",F),I.recognize(F),I.session.prevInput=F}function ue(I,k){var F=I.session,J=k.pointers,re=J.length;F.firstInput||(F.firstInput=Ya(k)),re>1&&!F.firstMultiple?F.firstMultiple=Ya(k):re===1&&(F.firstMultiple=!1);var me=F.firstInput,$e=F.firstMultiple,mt=$e?$e.center:me.center,Et=k.center=Ka(J);k.timeStamp=p(),k.deltaTime=k.timeStamp-me.timeStamp,k.angle=Vr(mt,Et),k.distance=Ki(mt,Et),Ee(F,k),k.offsetDirection=Za(k.deltaX,k.deltaY);var It=Xa(k.deltaTime,k.deltaX,k.deltaY);k.overallVelocityX=It.x,k.overallVelocityY=It.y,k.overallVelocity=c(It.x)>c(It.y)?It.x:It.y,k.scale=$e?Ja($e.pointers,J):1,k.rotation=$e?hl($e.pointers,J):0,k.maxPointers=F.prevInput?k.pointers.length>F.prevInput.maxPointers?k.pointers.length:F.prevInput.maxPointers:k.pointers.length,Bn(F,k);var wn=I.element;$(k.srcEvent.target,wn)&&(wn=k.srcEvent.target),k.target=wn}function Ee(I,k){var F=k.center,J=I.offsetDelta||{},re=I.prevDelta||{},me=I.prevInput||{};(k.eventType===W||me.eventType===ee)&&(re=I.prevDelta={x:me.deltaX||0,y:me.deltaY||0},J=I.offsetDelta={x:F.x,y:F.y}),k.deltaX=re.x+(F.x-J.x),k.deltaY=re.y+(F.y-J.y)}function Bn(I,k){var F=I.lastInterval||k,J=k.timeStamp-F.timeStamp,re,me,$e,mt;if(k.eventType!=te&&(J>K||F.velocity===a)){var Et=k.deltaX-F.deltaX,It=k.deltaY-F.deltaY,wn=Xa(J,Et,It);me=wn.x,$e=wn.y,re=c(wn.x)>c(wn.y)?wn.x:wn.y,mt=Za(Et,It),I.lastInterval=k}else re=F.velocity,me=F.velocityX,$e=F.velocityY,mt=F.direction;k.velocity=re,k.velocityX=me,k.velocityY=$e,k.direction=mt}function Ya(I){for(var k=[],F=0;F<I.pointers.length;)k[F]={clientX:l(I.pointers[F].clientX),clientY:l(I.pointers[F].clientY)},F++;return{timeStamp:p(),pointers:k,center:Ka(k),deltaX:I.deltaX,deltaY:I.deltaY}}function Ka(I){var k=I.length;if(k===1)return{x:l(I[0].clientX),y:l(I[0].clientY)};for(var F=0,J=0,re=0;re<k;)F+=I[re].clientX,J+=I[re].clientY,re++;return{x:l(F/k),y:l(J/k)}}function Xa(I,k,F){return{x:k/I||0,y:F/I||0}}function Za(I,k){return I===k?de:c(I)>=c(k)?I<0?ge:fe:k<0?Q:ne}function Ki(I,k,F){F||(F=qe);var J=k[F[0]]-I[F[0]],re=k[F[1]]-I[F[1]];return Math.sqrt(J*J+re*re)}function Vr(I,k,F){F||(F=qe);var J=k[F[0]]-I[F[0]],re=k[F[1]]-I[F[1]];return Math.atan2(re,J)*180/Math.PI}function hl(I,k){return Vr(k[1],k[0],xe)+Vr(I[1],I[0],xe)}function Ja(I,k){return Ki(k[0],k[1],xe)/Ki(I[0],I[1],xe)}var Qa={mousedown:W,mousemove:oe,mouseup:ee},eo="mousedown",to="mousemove mouseup";function fn(){this.evEl=eo,this.evWin=to,this.pressed=!1,ke.apply(this,arguments)}P(fn,ke,{handler:function(k){var F=Qa[k.type];F&W&&k.button===0&&(this.pressed=!0),F&oe&&k.which!==1&&(F=ee),this.pressed&&(F&ee&&(this.pressed=!1),this.callback(this.manager,F,{pointers:[k],changedPointers:[k],pointerType:L,srcEvent:k}))}});var no={pointerdown:W,pointermove:oe,pointerup:ee,pointercancel:te,pointerout:te},io={2:R,3:D,4:L,5:X},Fr="pointerdown",dn="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Fr="MSPointerDown",dn="MSPointerMove MSPointerUp MSPointerCancel");function jr(){this.evEl=Fr,this.evWin=dn,ke.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(jr,ke,{handler:function(k){var F=this.store,J=!1,re=k.type.toLowerCase().replace("ms",""),me=no[re],$e=io[k.pointerType]||k.pointerType,mt=$e==R,Et=Y(F,k.pointerId,"pointerId");me&W&&(k.button===0||mt)?Et<0&&(F.push(k),Et=F.length-1):me&(ee|te)&&(J=!0),!(Et<0)&&(F[Et]=k,this.callback(this.manager,me,{pointers:F,changedPointers:[k],pointerType:$e,srcEvent:k}),J&&F.splice(Et,1))}});var ro={touchstart:W,touchmove:oe,touchend:ee,touchcancel:te},ao="touchstart",Xi="touchstart touchmove touchend touchcancel";function oo(){this.evTarget=ao,this.evWin=Xi,this.started=!1,ke.apply(this,arguments)}P(oo,ke,{handler:function(k){var F=ro[k.type];if(F===W&&(this.started=!0),!!this.started){var J=ml.call(this,k,F);F&(ee|te)&&J[0].length-J[1].length===0&&(this.started=!1),this.callback(this.manager,F,{pointers:J[0],changedPointers:J[1],pointerType:R,srcEvent:k})}}});function ml(I,k){var F=z(I.touches),J=z(I.changedTouches);return k&(ee|te)&&(F=G(F.concat(J),"identifier")),[F,J]}var qb={touchstart:W,touchmove:oe,touchend:ee,touchcancel:te},Wb="touchstart touchmove touchend touchcancel";function so(){this.evTarget=Wb,this.targetIds={},ke.apply(this,arguments)}P(so,ke,{handler:function(k){var F=qb[k.type],J=Yb.call(this,k,F);J&&this.callback(this.manager,F,{pointers:J[0],changedPointers:J[1],pointerType:R,srcEvent:k})}});function Yb(I,k){var F=z(I.touches),J=this.targetIds;if(k&(W|oe)&&F.length===1)return J[F[0].identifier]=!0,[F,F];var re,me,$e=z(I.changedTouches),mt=[],Et=this.target;if(me=F.filter(function(It){return $(It.target,Et)}),k===W)for(re=0;re<me.length;)J[me[re].identifier]=!0,re++;for(re=0;re<$e.length;)J[$e[re].identifier]&&mt.push($e[re]),k&(ee|te)&&delete J[$e[re].identifier],re++;if(mt.length)return[G(me.concat(mt),"identifier"),mt]}var Kb=2500,zf=25;function vl(){ke.apply(this,arguments);var I=S(this.handler,this);this.touch=new so(this.manager,I),this.mouse=new fn(this.manager,I),this.primaryTouch=null,this.lastTouches=[]}P(vl,ke,{handler:function(k,F,J){var re=J.pointerType==R,me=J.pointerType==L;if(!(me&&J.sourceCapabilities&&J.sourceCapabilities.firesTouchEvents)){if(re)Xb.call(this,F,J);else if(me&&Zb.call(this,J))return;this.callback(k,F,J)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Xb(I,k){I&W?(this.primaryTouch=k.changedPointers[0].identifier,Uf.call(this,k)):I&(ee|te)&&Uf.call(this,k)}function Uf(I){var k=I.changedPointers[0];if(k.identifier===this.primaryTouch){var F={x:k.clientX,y:k.clientY};this.lastTouches.push(F);var J=this.lastTouches,re=function(){var me=J.indexOf(F);me>-1&&J.splice(me,1)};setTimeout(re,Kb)}}function Zb(I){for(var k=I.srcEvent.clientX,F=I.srcEvent.clientY,J=0;J<this.lastTouches.length;J++){var re=this.lastTouches[J],me=Math.abs(k-re.x),$e=Math.abs(F-re.y);if(me<=zf&&$e<=zf)return!0}return!1}var qf=se(o.style,"touchAction"),Wf=qf!==a,Yf="compute",Kf="auto",gl="manipulation",Ci="none",Hr="pan-x",Gr="pan-y",lo=Qb();function yl(I,k){this.manager=I,this.set(k)}yl.prototype={set:function(I){I==Yf&&(I=this.compute()),Wf&&this.manager.element.style&&lo[I]&&(this.manager.element.style[qf]=I),this.actions=I.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var I=[];return v(this.manager.recognizers,function(k){w(k.options.enable,[k])&&(I=I.concat(k.getTouchAction()))}),Jb(I.join(" "))},preventDefaults:function(I){var k=I.srcEvent,F=I.offsetDirection;if(this.manager.session.prevented){k.preventDefault();return}var J=this.actions,re=H(J,Ci)&&!lo[Ci],me=H(J,Gr)&&!lo[Gr],$e=H(J,Hr)&&!lo[Hr];if(re){var mt=I.pointers.length===1,Et=I.distance<2,It=I.deltaTime<250;if(mt&&Et&&It)return}if(!($e&&me)&&(re||me&&F&we||$e&&F&Pe))return this.preventSrc(k)},preventSrc:function(I){this.manager.session.prevented=!0,I.preventDefault()}};function Jb(I){if(H(I,Ci))return Ci;var k=H(I,Hr),F=H(I,Gr);return k&&F?Ci:k||F?k?Hr:Gr:H(I,gl)?gl:Kf}function Qb(){if(!Wf)return!1;var I={},k=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(F){I[F]=k?t.CSS.supports("touch-action",F):!0}),I}var uo=1,Yt=2,Zi=4,ni=8,$n=ni,zr=16,Sn=32;function Vn(I){this.options=_({},this.defaults,I||{}),this.id=d(),this.manager=null,this.options.enable=T(this.options.enable,!0),this.state=uo,this.simultaneous={},this.requireFail=[]}Vn.prototype={defaults:{},set:function(I){return _(this.options,I),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(I){if(h(I,"recognizeWith",this))return this;var k=this.simultaneous;return I=co(I,this),k[I.id]||(k[I.id]=I,I.recognizeWith(this)),this},dropRecognizeWith:function(I){return h(I,"dropRecognizeWith",this)?this:(I=co(I,this),delete this.simultaneous[I.id],this)},requireFailure:function(I){if(h(I,"requireFailure",this))return this;var k=this.requireFail;return I=co(I,this),Y(k,I)===-1&&(k.push(I),I.requireFailure(this)),this},dropRequireFailure:function(I){if(h(I,"dropRequireFailure",this))return this;I=co(I,this);var k=Y(this.requireFail,I);return k>-1&&this.requireFail.splice(k,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(I){return!!this.simultaneous[I.id]},emit:function(I){var k=this,F=this.state;function J(re){k.manager.emit(re,I)}F<ni&&J(k.options.event+Xf(F)),J(k.options.event),I.additionalEvent&&J(I.additionalEvent),F>=ni&&J(k.options.event+Xf(F))},tryEmit:function(I){if(this.canEmit())return this.emit(I);this.state=Sn},canEmit:function(){for(var I=0;I<this.requireFail.length;){if(!(this.requireFail[I].state&(Sn|uo)))return!1;I++}return!0},recognize:function(I){var k=_({},I);if(!w(this.options.enable,[this,k])){this.reset(),this.state=Sn;return}this.state&($n|zr|Sn)&&(this.state=uo),this.state=this.process(k),this.state&(Yt|Zi|ni|zr)&&this.tryEmit(k)},process:function(I){},getTouchAction:function(){},reset:function(){}};function Xf(I){return I&zr?"cancel":I&ni?"end":I&Zi?"move":I&Yt?"start":""}function Zf(I){return I==ne?"down":I==Q?"up":I==ge?"left":I==fe?"right":""}function co(I,k){var F=k.manager;return F?F.get(I):I}function hn(){Vn.apply(this,arguments)}P(hn,Vn,{defaults:{pointers:1},attrTest:function(I){var k=this.options.pointers;return k===0||I.pointers.length===k},process:function(I){var k=this.state,F=I.eventType,J=k&(Yt|Zi),re=this.attrTest(I);return J&&(F&te||!re)?k|zr:J||re?F&ee?k|ni:k&Yt?k|Zi:Yt:Sn}});function po(){hn.apply(this,arguments),this.pX=null,this.pY=null}P(po,hn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Te},getTouchAction:function(){var I=this.options.direction,k=[];return I&we&&k.push(Gr),I&Pe&&k.push(Hr),k},directionTest:function(I){var k=this.options,F=!0,J=I.distance,re=I.direction,me=I.deltaX,$e=I.deltaY;return re&k.direction||(k.direction&we?(re=me===0?de:me<0?ge:fe,F=me!=this.pX,J=Math.abs(I.deltaX)):(re=$e===0?de:$e<0?Q:ne,F=$e!=this.pY,J=Math.abs(I.deltaY))),I.direction=re,F&&J>k.threshold&&re&k.direction},attrTest:function(I){return hn.prototype.attrTest.call(this,I)&&(this.state&Yt||!(this.state&Yt)&&this.directionTest(I))},emit:function(I){this.pX=I.deltaX,this.pY=I.deltaY;var k=Zf(I.direction);k&&(I.additionalEvent=this.options.event+k),this._super.emit.call(this,I)}});function El(){hn.apply(this,arguments)}P(El,hn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ci]},attrTest:function(I){return this._super.attrTest.call(this,I)&&(Math.abs(I.scale-1)>this.options.threshold||this.state&Yt)},emit:function(I){if(I.scale!==1){var k=I.scale<1?"in":"out";I.additionalEvent=this.options.event+k}this._super.emit.call(this,I)}});function bl(){Vn.apply(this,arguments),this._timer=null,this._input=null}P(bl,Vn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Kf]},process:function(I){var k=this.options,F=I.pointers.length===k.pointers,J=I.distance<k.threshold,re=I.deltaTime>k.time;if(this._input=I,!J||!F||I.eventType&(ee|te)&&!re)this.reset();else if(I.eventType&W)this.reset(),this._timer=f(function(){this.state=$n,this.tryEmit()},k.time,this);else if(I.eventType&ee)return $n;return Sn},reset:function(){clearTimeout(this._timer)},emit:function(I){this.state===$n&&(I&&I.eventType&ee?this.manager.emit(this.options.event+"up",I):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function xl(){hn.apply(this,arguments)}P(xl,hn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ci]},attrTest:function(I){return this._super.attrTest.call(this,I)&&(Math.abs(I.rotation)>this.options.threshold||this.state&Yt)}});function _l(){hn.apply(this,arguments)}P(_l,hn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:we|Pe,pointers:1},getTouchAction:function(){return po.prototype.getTouchAction.call(this)},attrTest:function(I){var k=this.options.direction,F;return k&(we|Pe)?F=I.overallVelocity:k&we?F=I.overallVelocityX:k&Pe&&(F=I.overallVelocityY),this._super.attrTest.call(this,I)&&k&I.offsetDirection&&I.distance>this.options.threshold&&I.maxPointers==this.options.pointers&&c(F)>this.options.velocity&&I.eventType&ee},emit:function(I){var k=Zf(I.offsetDirection);k&&this.manager.emit(this.options.event+k,I),this.manager.emit(this.options.event,I)}});function fo(){Vn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(fo,Vn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gl]},process:function(I){var k=this.options,F=I.pointers.length===k.pointers,J=I.distance<k.threshold,re=I.deltaTime<k.time;if(this.reset(),I.eventType&W&&this.count===0)return this.failTimeout();if(J&&re&&F){if(I.eventType!=ee)return this.failTimeout();var me=this.pTime?I.timeStamp-this.pTime<k.interval:!0,$e=!this.pCenter||Ki(this.pCenter,I.center)<k.posThreshold;this.pTime=I.timeStamp,this.pCenter=I.center,!$e||!me?this.count=1:this.count+=1,this._input=I;var mt=this.count%k.taps;if(mt===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=$n,this.tryEmit()},k.interval,this),Yt):$n}return Sn},failTimeout:function(){return this._timer=f(function(){this.state=Sn},this.options.interval,this),Sn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==$n&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ii(I,k){return k=k||{},k.recognizers=T(k.recognizers,ii.defaults.preset),new Sl(I,k)}ii.VERSION="2.0.7",ii.defaults={domEvents:!1,touchAction:Yf,enable:!0,inputTarget:null,inputClass:null,preset:[[xl,{enable:!1}],[El,{enable:!1},["rotate"]],[_l,{direction:we}],[po,{direction:we},["swipe"]],[fo],[fo,{event:"doubletap",taps:2},["tap"]],[bl]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ex=1,Jf=2;function Sl(I,k){this.options=_({},ii.defaults,k||{}),this.options.inputTarget=this.options.inputTarget||I,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=I,this.input=Ve(this),this.touchAction=new yl(this,this.options.touchAction),Qf(this,!0),v(this.options.recognizers,function(F){var J=this.add(new F[0](F[1]));F[2]&&J.recognizeWith(F[2]),F[3]&&J.requireFailure(F[3])},this)}Sl.prototype={set:function(I){return _(this.options,I),I.touchAction&&this.touchAction.update(),I.inputTarget&&(this.input.destroy(),this.input.target=I.inputTarget,this.input.init()),this},stop:function(I){this.session.stopped=I?Jf:ex},recognize:function(I){var k=this.session;if(!k.stopped){this.touchAction.preventDefaults(I);var F,J=this.recognizers,re=k.curRecognizer;(!re||re&&re.state&$n)&&(re=k.curRecognizer=null);for(var me=0;me<J.length;)F=J[me],k.stopped!==Jf&&(!re||F==re||F.canRecognizeWith(re))?F.recognize(I):F.reset(),!re&&F.state&(Yt|Zi|ni)&&(re=k.curRecognizer=F),me++}},get:function(I){if(I instanceof Vn)return I;for(var k=this.recognizers,F=0;F<k.length;F++)if(k[F].options.event==I)return k[F];return null},add:function(I){if(h(I,"add",this))return this;var k=this.get(I.options.event);return k&&this.remove(k),this.recognizers.push(I),I.manager=this,this.touchAction.update(),I},remove:function(I){if(h(I,"remove",this))return this;if(I=this.get(I),I){var k=this.recognizers,F=Y(k,I);F!==-1&&(k.splice(F,1),this.touchAction.update())}return this},on:function(I,k){if(I!==a&&k!==a){var F=this.handlers;return v(Z(I),function(J){F[J]=F[J]||[],F[J].push(k)}),this}},off:function(I,k){if(I!==a){var F=this.handlers;return v(Z(I),function(J){k?F[J]&&F[J].splice(Y(F[J],k),1):delete F[J]}),this}},emit:function(I,k){this.options.domEvents&&tx(I,k);var F=this.handlers[I]&&this.handlers[I].slice();if(!(!F||!F.length)){k.type=I,k.preventDefault=function(){k.srcEvent.preventDefault()};for(var J=0;J<F.length;)F[J](k),J++}},destroy:function(){this.element&&Qf(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Qf(I,k){var F=I.element;if(F.style){var J;v(I.options.cssProps,function(re,me){J=se(F.style,me),k?(I.oldCssProps[J]=F.style[J],F.style[J]=re):F.style[J]=I.oldCssProps[J]||""}),k||(I.oldCssProps={})}}function tx(I,k){var F=n.createEvent("Event");F.initEvent(I,!0,!0),F.gesture=k,k.target.dispatchEvent(F)}_(ii,{INPUT_START:W,INPUT_MOVE:oe,INPUT_END:ee,INPUT_CANCEL:te,STATE_POSSIBLE:uo,STATE_BEGAN:Yt,STATE_CHANGED:Zi,STATE_ENDED:ni,STATE_RECOGNIZED:$n,STATE_CANCELLED:zr,STATE_FAILED:Sn,DIRECTION_NONE:de,DIRECTION_LEFT:ge,DIRECTION_RIGHT:fe,DIRECTION_UP:Q,DIRECTION_DOWN:ne,DIRECTION_HORIZONTAL:we,DIRECTION_VERTICAL:Pe,DIRECTION_ALL:Te,Manager:Sl,Input:ke,TouchAction:yl,TouchInput:so,MouseInput:fn,PointerEventInput:jr,TouchMouseInput:vl,SingleTouchInput:oo,Recognizer:Vn,AttrRecognizer:hn,Tap:fo,Pan:po,Swipe:_l,Pinch:El,Rotate:xl,Press:bl,on:N,off:B,each:v,merge:M,extend:b,assign:_,inherit:P,bindFn:S,prefixed:se});var nx=typeof t<"u"?t:typeof self<"u"?self:{};nx.Hammer=ii,e.exports?e.exports=ii:t[i]=ii})(window,document,"Hammer")}(Nl)),Nl.exports}var H0=j0();const Pi=Er(H0);var G0=.2,z0=4,Dd=["mousedown","mouseup","mouseover","mouseout","click","dblclick"];function xo(e,t){return t.get(e,!1)}function kc(e){e.preventDefault(),typeof e.stopPropagation=="function"?e.stopPropagation():e.srcEvent&&typeof e.srcEvent.stopPropagation=="function"&&e.srcEvent.stopPropagation(),typeof e.stopImmediatePropagation=="function"&&e.stopImmediatePropagation()}function Ml(e){function t(c){j(Dd,function(p){Se.bind(e,p,kc,!0)})}function n(c){setTimeout(function(){j(Dd,function(p){Se.unbind(e,p,kc,!0)})},500)}Se.bind(e,"touchstart",t,!0),Se.bind(e,"touchend",n,!0),Se.bind(e,"touchcancel",n,!0);var i=new Pi.Manager(e,{inputClass:Pi.TouchInput,recognizers:[],domEvents:!0}),a=new Pi.Tap,r=new Pi.Pan({threshold:10}),o=new Pi.Press,s=new Pi.Pinch,l=new Pi.Tap({event:"doubletap",taps:2});return s.requireFailure(r),s.requireFailure(o),i.add([r,o,s,l,a]),i.reset=function(c){var p=this.recognizers,f=this.session;f.stopped||(i.stop(c),setTimeout(function(){var h,v;for(h=0;v=p[h];h++)v.reset(),v.state=8;f.curRecognizer=null},0))},i.on("hammer.input",function(c){c.srcEvent.defaultPrevented&&i.reset(!0)}),i}function My(e,t,n,i,a){var r=xo("dragging",e),o=xo("move",e),s=xo("contextPad",e),l=xo("palette",e),c;function p(v,m){return function(_){var b=f(_.target),M=b&&i.get(b);return m&&(_.srcEvent.button=m),a.fire(v,_,M)}}function f(v){var m=Fi(v,"svg, .djs-element",!0);return m}function h(v){c=Ml(v);function m(M){var P=0,S=0;function w(N){var B=N.deltaX-P,$=N.deltaY-S;t.scroll({dx:B,dy:$}),P=N.deltaX,S=N.deltaY}function T(N){c.off("panmove",w),c.off("panend",T),c.off("pancancel",T)}c.on("panmove",w),c.on("panend",T),c.on("pancancel",T)}function _(M){var P=f(M.target),S=P&&i.get(P);if(o&&t.getRootElement()!==S)return o.start(M,S,!0);m()}function b(M){var P=t.zoom(),S=M.center;function w(N){var B=1-(1-N.scale)/1.5,$=Math.max(G0,Math.min(z0,B*P));t.zoom($,S),kc(N)}function T(N){c.off("pinchmove",w),c.off("pinchend",T),c.off("pinchcancel",T),c.reset(!0)}c.on("pinchmove",w),c.on("pinchend",T),c.on("pinchcancel",T)}c.on("tap",p("element.click")),c.on("doubletap",p("element.dblclick",1)),c.on("panstart",_),c.on("press",_),c.on("pinchstart",b)}r&&n.on("drag.move",function(v){var m=v.originalEvent;if(!(!m||m instanceof MouseEvent)){var _=pi(m),b=document.elementFromPoint(_.x,_.y),M=f(b),P=M&&i.get(M);P!==v.hover&&(v.hover&&r.out(v),P&&(r.hover({element:P,gfx:M}),v.hover=P,v.hoverGfx=M))}}),s&&n.on("contextPad.create",function(v){var m=v.pad.html,_=Ml(m);_.on("panstart",function(b){s.trigger("dragstart",b,!0)}),_.on("press",function(b){s.trigger("dragstart",b,!0)}),_.on("tap",function(b){s.trigger("click",b)})}),l&&n.on("palette.create",function(v){var m=v.container,_=Ml(m);_.on("panstart",function(b){l.trigger("dragstart",b,!0)}),_.on("press",function(b){l.trigger("dragstart",b,!0)}),_.on("tap",function(b){l.trigger("click",b)})}),n.on("canvas.init",function(v){h(v.svg)})}My.$inject=["injector","canvas","eventBus","elementRegistry","interactionEvents","touchFix"];function Pp(e,t){var n=this;t.on("canvas.init",function(i){n.addBBoxMarker(i.svg)})}Pp.$inject=["canvas","eventBus"];Pp.prototype.addBBoxMarker=function(e){var t={fill:"none",class:"outer-bound-marker"},n=be("rect");ae(n,{x:-1e4,y:1e4,width:10,height:10}),ae(n,t),Ce(e,n);var i=be("rect");ae(i,{x:1e4,y:1e4,width:10,height:10}),ae(i,t),Ce(e,i)};const U0={__depends__:[Ca],__init__:["touchInteractionEvents"],touchInteractionEvents:["type",My],touchFix:["type",Pp]},q0={__depends__:[U0]};function Dl(e){return e&&e[e.length-1]}function kd(e){return e.y}function Od(e){return e.x}var W0={left:Od,center:Od,right:function(e){return e.x+e.width},top:kd,middle:kd,bottom:function(e){return e.y+e.height}};function Nr(e){this._modeling=e}Nr.$inject=["modeling"];Nr.prototype._getOrientationDetails=function(e){var t=["top","bottom","middle"],n="x",i="width";return t.indexOf(e)!==-1&&(n="y",i="height"),{axis:n,dimension:i}};Nr.prototype._isType=function(e,t){return t.indexOf(e)!==-1};Nr.prototype._alignmentPosition=function(e,t){var n=this._getOrientationDetails(e),i=n.axis,a=n.dimension,r={},o={},s=!1,l,c,p;function f(h,v){return Math.round((h[i]+v[i]+v[a])/2)}if(this._isType(e,["left","top"]))r[e]=t[0][i];else if(this._isType(e,["right","bottom"]))p=Dl(t),r[e]=p[i]+p[a];else if(this._isType(e,["center","middle"])){if(j(t,function(h){var v=h[i]+Math.round(h[a]/2);o[v]?o[v].elements.push(h):o[v]={elements:[h],center:v}}),l=nn(o,function(h){return h.elements.length>1&&(s=!0),h.elements.length}),s)return r[e]=Dl(l).center,r;c=t[0],t=nn(t,function(h){return h[i]+h[a]}),p=Dl(t),r[e]=f(c,p)}return r};Nr.prototype.trigger=function(e,t){var n=this._modeling,i=Ie(e,function(s){return!(s.waypoints||s.host||s.labelTarget)});if(!(i.length<2)){var a=W0[t],r=nn(i,a),o=this._alignmentPosition(t,r);n.alignElements(r,o)}};const Y0={__init__:["alignElements"],alignElements:["type",Nr]};var K0=10,Dy=50,X0=250;function Rp(e,t,n,i){for(var a;a=Z0(e,n,t);)n=i(t,n,a);return n}function Ip(e){return function(t,n,i){var a={x:n.x,y:n.y};return["x","y"].forEach(function(r){var o=e[r];if(o){var s=r==="x"?"width":"height",l=o.margin,c=o.minDistance;l<0?a[r]=Math.min(i[r]+l-t[s]/2,n[r]-c+l):a[r]=Math.max(i[r]+i[s]+l+t[s]/2,n[r]+c+l)}}),a}}function Z0(e,t,n){var i={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},a=Q0(e);return Ue(a,function(r){if(r===n)return!1;var o=wt(r,i,K0);return o==="intersect"})}function J0(e,t){t||(t={});function n(m){return m.source===e?1:-1}var i=t.defaultDistance||Dy,a=t.direction||"e",r=t.filter,o=t.getWeight||n,s=t.maxDistance||X0,l=t.reference||"start";r||(r=nT);function c(m,_){return a==="n"?l==="start"?_e(m).top-_e(_).bottom:l==="center"?_e(m).top-Me(_).y:_e(m).top-_e(_).top:a==="w"?l==="start"?_e(m).left-_e(_).right:l==="center"?_e(m).left-Me(_).x:_e(m).left-_e(_).left:a==="s"?l==="start"?_e(_).top-_e(m).bottom:l==="center"?Me(_).y-_e(m).bottom:_e(_).bottom-_e(m).bottom:l==="start"?_e(_).left-_e(m).right:l==="center"?Me(_).x-_e(m).right:_e(_).right-_e(m).right}var p=e.incoming.filter(r).map(function(m){var _=o(m),b=_<0?c(m.source,e):c(e,m.source);return{id:m.source.id,distance:b,weight:_}}),f=e.outgoing.filter(r).map(function(m){var _=o(m),b=_>0?c(e,m.target):c(m.target,e);return{id:m.target.id,distance:b,weight:_}}),h=p.concat(f).reduce(function(m,_){return m[_.id+"__weight_"+_.weight]=_,m},{}),v=Vt(h,function(m,_){var b=_.distance,M=_.weight;return b<0||b>s||(m[String(b)]||(m[String(b)]=0),m[String(b)]+=1*M,(!m.distance||m[m.distance]<m[String(b)])&&(m.distance=b)),m},{});return v.distance||i}function Q0(e){var t=kl(e);return e.host&&(t=t.concat(kl(e.host))),e.attachers&&(t=t.concat(e.attachers.reduce(function(n,i){return n.concat(kl(i))},[]))),t}function kl(e){return tT(e).concat(eT(e))}function eT(e){return e.incoming.map(function(t){return t.source})}function tT(e){return e.outgoing.map(function(t){return t.target})}function nT(){return!0}var iT=100;function ky(e,t,n){e.on("autoPlace",iT,function(i){var a=i.shape,r=i.source;return rT(r,a)}),e.on("autoPlace.end",function(i){n.scrollToElement(i.shape)}),this.append=function(i,a,r){e.fire("autoPlace.start",{source:i,shape:a});var o=e.fire("autoPlace",{source:i,shape:a}),s=t.appendShape(i,a,o,i.parent,r);return e.fire("autoPlace.end",{source:i,shape:s}),s}}ky.$inject=["eventBus","modeling","canvas"];function rT(e,t,n){n||(n={});var i=n.defaultDistance||Dy,a=Me(e),r=_e(e);return{x:r.right+i+t.width/2,y:a.y}}function Oy(e,t){e.on("autoPlace.end",500,function(n){t.select(n.shape)})}Oy.$inject=["eventBus","selection"];const aT={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",ky],autoPlaceSelectionBehavior:["type",Oy]};function je(e,t){return fi(t,function(n){return A(e,n)})}function ls(e,t){for(typeof t=="string"&&(t=[t]);e=e.parent;)if(je(e,t))return e;return null}function Ly(e,t){if(A(t,"bpmn:TextAnnotation"))return lT(e,t);if(je(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"]))return uT(e,t);if(A(t,"bpmn:FlowNode"))return oT(e,t)}function oT(e,t){var n=_e(e),i=Me(e),a=J0(e,{filter:function(p){return A(p,"bpmn:SequenceFlow")}}),r=30,o=80,s="left";A(e,"bpmn:BoundaryEvent")&&(s=wt(e,e.host,-25),s.indexOf("top")!==-1&&(r*=-1));var l={x:n.right+a+t.width/2,y:i.y+sT(s,o)},c={y:{margin:r,minDistance:o}};return Rp(e,t,l,Ip(c))}function sT(e,t){return e.indexOf("top")!=-1?-1*t:e.indexOf("bottom")!=-1?t:0}function lT(e,t){var n=_e(e),i={x:n.right+t.width/2,y:n.top-50-t.height/2},a={y:{margin:-30,minDistance:20}};return Rp(e,t,i,Ip(a))}function uT(e,t){var n=_e(e),i={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2},a={x:{margin:30,minDistance:30}};return Rp(e,t,i,Ip(a))}function By(e){e.on("autoPlace",function(t){var n=t.shape,i=t.source;return Ly(i,n)})}By.$inject=["eventBus"];const cT={__depends__:[aT],__init__:["bpmnAutoPlace"],bpmnAutoPlace:["type",By]};var pT=1e3;function pe(e){this._eventBus=e}pe.$inject=["eventBus"];function fT(e,t){return function(n){return e.call(t||null,n.context,n.command,n)}}pe.prototype.on=function(e,t,n,i,a,r){if((xt(t)||Re(t))&&(r=a,a=i,i=n,n=t,t=null),xt(n)&&(r=a,a=i,i=n,n=pT),st(a)&&(r=a,a=!1),!xt(i))throw new Error("handlerFn must be a function");Oe(e)||(e=[e]);var o=this._eventBus;j(e,function(s){var l=["commandStack",s,t].filter(function(c){return c}).join(".");o.on(l,n,a?fT(i,r):i,r)})};var dT=["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"];j(dT,function(e){pe.prototype[e]=function(t,n,i,a,r){(xt(t)||Re(t))&&(r=a,a=i,i=n,n=t,t=null),this.on(t,e,n,i,a,r)}});function Xn(e,t,n,i){pe.call(this,e),this._elementRegistry=t,this._modeling=n,this._rules=i;var a=this;this.postExecuted(["shape.create"],function(r){var o=r.context,s=o.hints||{},l=o.shape,c=o.parent||o.newParent;s.autoResize!==!1&&a._expand([l],c)}),this.postExecuted(["elements.move"],function(r){var o=r.context,s=ua(xs(o.closure.topLevel)),l=o.hints,c=l?l.autoResize:!0;if(c!==!1){var p=Vi(s,function(f){return f.parent.id});j(p,function(f,h){Oe(c)&&(f=f.filter(function(v){return Ue(c,en({id:v.id}))})),a._expand(f,h)})}}),this.postExecuted(["shape.toggleCollapse"],function(r){var o=r.context,s=o.hints,l=o.shape;s&&s.autoResize===!1||l.collapsed||a._expand(l.children||[],l)}),this.postExecuted(["shape.resize"],function(r){var o=r.context,s=o.hints,l=o.shape,c=l.parent;s&&s.autoResize===!1||c&&a._expand([l],c)})}Xn.$inject=["eventBus","elementRegistry","modeling","rules"];ye(Xn,pe);Xn.prototype._getOptimalBounds=function(e,t){var n=this.getOffset(t),i=this.getPadding(t),a=_e(St(e)),r=_e(t),o={};return a.top-r.top<i.top&&(o.top=a.top-n.top),a.left-r.left<i.left&&(o.left=a.left-n.left),r.right-a.right<i.right&&(o.right=a.right+n.right),r.bottom-a.bottom<i.bottom&&(o.bottom=a.bottom+n.bottom),hp(q({},r,o))};Xn.prototype._expand=function(e,t){typeof t=="string"&&(t=this._elementRegistry.get(t));var n=this._rules.allowed("element.autoResize",{elements:e,target:t});if(n){var i=this._getOptimalBounds(e,t);if(hT(i,t)){var a=mT(rn(t,["x","y","width","height"]),i);this.resize(t,i,{autoResize:a});var r=t.parent;r&&this._expand([t],r)}}};Xn.prototype.getOffset=function(e){return{top:60,bottom:60,left:100,right:100}};Xn.prototype.getPadding=function(e){return{top:2,bottom:2,left:15,right:15}};Xn.prototype.resize=function(e,t,n){this._modeling.resizeShape(e,t,null,n)};function hT(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function mT(e,t){var n="";return e=_e(e),t=_e(t),e.top>t.top&&(n=n.concat("n")),e.right<t.right&&(n=n.concat("w")),e.bottom<t.bottom&&(n=n.concat("s")),e.left>t.left&&(n=n.concat("e")),n}function $s(e){e.invoke(Xn,this)}$s.$inject=["injector"];ye($s,Xn);$s.prototype.resize=function(e,t,n){A(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};function vi(e){pe.call(this,e),this.init()}vi.$inject=["eventBus"];ye(vi,pe);vi.prototype.addRule=function(e,t,n){var i=this;typeof e=="string"&&(e=[e]),e.forEach(function(a){i.canExecute(a,t,function(r,o,s){return n(r)},!0)})};vi.prototype.init=function(){};function Pa(e){vi.call(this,e);var t=this;this.addRule("element.autoResize",function(n){return t.canResize(n.elements,n.target)})}Pa.$inject=["eventBus"];ye(Pa,vi);Pa.prototype.canResize=function(e,t){return!1};function Vs(e,t){Pa.call(this,e),this._modeling=t}ye(Vs,Pa);Vs.$inject=["eventBus","modeling"];Vs.prototype.canResize=function(e,t){if(!A(t,"bpmn:Participant")&&!A(t,"bpmn:Lane")&&!A(t,"bpmn:SubProcess"))return!1;var n=!0;return j(e,function(i){if(A(i,"bpmn:Lane")||i.labelTarget){n=!1;return}}),n};const vT={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",$s],bpmnAutoResizeProvider:["type",Vs]};var Ld=1500;function $y(e,t,n){var i=this,a=n.get("dragging",!1);function r(o){if(!o.hover){var s=o.originalEvent,l=i._findTargetGfx(s),c=l&&e.get(l);l&&c&&(o.stopPropagation(),a.hover({element:c,gfx:l}),a.move(s))}}a&&t.on("drag.start",function(o){t.once("drag.move",Ld,function(s){r(s)})}),function(){var o,s;t.on("element.hover",function(l){o=l.gfx,s=l.element}),t.on("element.hover",Ld,function(l){s&&t.fire("element.out",{element:s,gfx:o})}),t.on("element.out",function(){o=null,s=null})}(),this._findTargetGfx=function(o){var s,l;if(o instanceof MouseEvent)return s=pi(o),l=document.elementFromPoint(s.x,s.y),gT(l)}}$y.$inject=["elementRegistry","eventBus","injector"];function gT(e){return Fi(e,"svg, .djs-element",!0)}const yT={__init__:["hoverFix"],hoverFix:["type",$y]};var nr=Math.round,Bd="djs-drag-active";function Ri(e){e.preventDefault()}function ET(e){return typeof TouchEvent<"u"&&e instanceof TouchEvent}function bT(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function Vy(e,t,n,i){var a={threshold:5,trapClick:!0},r;function o(S){var w=t.viewbox(),T=t._container.getBoundingClientRect();return{x:w.x+(S.x-T.left)/w.scale,y:w.y+(S.y-T.top)/w.scale}}function s(S,w){w=w||r;var T=e.createEvent(q({},w.payload,w.data,{isTouch:w.isTouch}));return e.fire("drag."+S,T)===!1?!1:e.fire(w.prefix+"."+S,T)}function l(S){var w=S.filter(function(T){return i.get(T.id)});w.length&&n.select(w)}function c(S,w){var T=r.payload,N=r.displacement,B=r.globalStart,$=pi(S),H=Pn($,B),Z=r.localStart,Y=o($),z=Pn(Y,Z);if(!r.active&&(w||bT(H)>r.threshold)){if(q(T,{x:nr(Z.x+N.x),y:nr(Z.y+N.y),dx:0,dy:0},{originalEvent:S}),s("start")===!1)return b();r.active=!0,r.keepSelection||(T.previousSelection=n.get(),n.select(null)),r.cursor&&Bs(r.cursor),t.addMarker(t.getRootElement(),Bd)}Il(S),r.active&&(q(T,{x:nr(Y.x+N.x),y:nr(Y.y+N.y),dx:nr(z.x),dy:nr(z.y)},{originalEvent:S}),s("move"))}function p(S){var w,T=!0;r.active&&(S&&(r.payload.originalEvent=S,Il(S)),T=s("end")),T===!1&&s("rejected"),w=M(T!==!0),s("ended",w)}function f(S){S.which===27&&(Ri(S),b())}function h(S){var w;r.active&&(w=Cy(e),setTimeout(w,400),Ri(S)),p(S)}function v(S){c(S)}function m(S){var w=r.payload;w.hoverGfx=S.gfx,w.hover=S.element,s("hover")}function _(S){s("out");var w=r.payload;w.hoverGfx=null,w.hover=null}function b(S){var w;if(r){var T=r.active;T&&s("cancel"),w=M(S),T&&s("canceled",w)}}function M(S){var w,T;s("cleanup"),Ty(),r.trapClick?T=h:T=p,Se.unbind(document,"mousemove",c),Se.unbind(document,"dragstart",Ri),Se.unbind(document,"selectstart",Ri),Se.unbind(document,"mousedown",T,!0),Se.unbind(document,"mouseup",T,!0),Se.unbind(document,"keyup",f),Se.unbind(document,"touchstart",v,!0),Se.unbind(document,"touchcancel",b,!0),Se.unbind(document,"touchmove",c,!0),Se.unbind(document,"touchend",p,!0),e.off("element.hover",m),e.off("element.out",_),t.removeMarker(t.getRootElement(),Bd);var N=r.payload.previousSelection;return S!==!1&&N&&!n.get().length&&l(N),w=r,r=null,w}function P(S,w,T,N){r&&b(!1),typeof w=="string"&&(N=T,T=w,w=null),N=q({},a,N||{});var B=N.data||{},$,H,Z,Y,z;N.trapClick?Y=h:Y=p,S?($=Pr(S)||S,H=pi(S),Il(S),$.type==="dragstart"&&Ri($)):($=null,H={x:0,y:0}),Z=o(H),w||(w=Z),z=ET($),r=q({prefix:T,data:B,payload:{},globalStart:H,displacement:Pn(w,Z),localStart:Z,isTouch:z},N),N.manual||(z?(Se.bind(document,"touchstart",v,!0),Se.bind(document,"touchcancel",b,!0),Se.bind(document,"touchmove",c,!0),Se.bind(document,"touchend",p,!0)):(Se.bind(document,"mousemove",c),Se.bind(document,"dragstart",Ri),Se.bind(document,"selectstart",Ri),Se.bind(document,"mousedown",Y,!0),Se.bind(document,"mouseup",Y,!0)),Se.bind(document,"keyup",f),e.on("element.hover",m),e.on("element.out",_)),s("init"),N.autoActivate&&c(S,!0)}e.on("diagram.destroy",b),this.init=P,this.move=c,this.hover=m,this.out=_,this.end=p,this.cancel=b,this.context=function(){return r},this.setOptions=function(S){q(a,S)}}Vy.$inject=["eventBus","canvas","selection","elementRegistry"];const Zn={__depends__:[yT,Dn],dragging:["type",Vy]};function Mr(e,t,n){this._canvas=n,this._opts=q({scrollThresholdIn:[20,20,20,20],scrollThresholdOut:[0,0,0,0],scrollRepeatTimeout:15,scrollStep:10},e);var i=this;t.on("drag.move",function(a){var r=i._toBorderPoint(a);i.startScroll(r)}),t.on(["drag.cleanup"],function(){i.stopScroll()})}Mr.$inject=["config.autoScroll","eventBus","canvas"];Mr.prototype.startScroll=function(e){var t=this._canvas,n=this._opts,i=this,a=t.getContainer().getBoundingClientRect(),r=[e.x,e.y,a.width-e.x,a.height-e.y];this.stopScroll();for(var o=0,s=0,l=0;l<4;l++)xT(r[l],n.scrollThresholdOut[l],n.scrollThresholdIn[l])&&(l===0?o=n.scrollStep:l==1?s=n.scrollStep:l==2?o=-n.scrollStep:l==3&&(s=-n.scrollStep));(o!==0||s!==0)&&(t.scroll({dx:o,dy:s}),this._scrolling=setTimeout(function(){i.startScroll(e)},n.scrollRepeatTimeout))};function xT(e,t,n){return t<e&&e<n}Mr.prototype.stopScroll=function(){clearTimeout(this._scrolling)};Mr.prototype.setOptions=function(e){this._opts=q({},this._opts,e)};Mr.prototype._toBorderPoint=function(e){var t=this._canvas._container.getBoundingClientRect(),n=pi(e.originalEvent);return{x:n.x-t.left,y:n.y-t.top}};const _T={__depends__:[Zn],__init__:["autoScroll"],autoScroll:["type",Mr]};function Np(e){this._commandStack=e.get("commandStack",!1)}Np.$inject=["injector"];Np.prototype.allowed=function(e,t){var n=!0,i=this._commandStack;return i&&(n=i.canExecute(e,t)),n===void 0?!0:n};const On={__init__:["rules"],rules:["type",Np]};var _o=Math.round,ST=Math.max;function wT(e,t){var n=e.x,i=e.y;return[["M",n,i],["m",0,-10],["a",t,t,0,1,1,0,2*t],["a",t,t,0,1,1,0,-2*t],["z"]]}function TT(e){var t=[];return e.forEach(function(n,i){t.push([i===0?"M":"L",n.x,n.y])}),t}var Fy=10;function CT(e,t){var n,i;for(n=0;i=e[n];n++)if(ba(i,t)<=Fy)return{point:e[n],bendpoint:!0,index:n};return null}function AT(e,t){var n=Og(wT(t,Fy),TT(e)),i=n[0],a=n[n.length-1],r;return i?i!==a?i.segment2!==a.segment2?(r=ST(i.segment2,a.segment2)-1,{point:e[r],bendpoint:!0,index:r}):{point:{x:_o(i.x+a.x)/2,y:_o(i.y+a.y)/2},index:i.segment2}:{point:{x:_o(i.x),y:_o(i.y)},index:i.segment2}:null}function Oc(e,t){return CT(e,t)||AT(e,t)}var jy="djs-bendpoint",Hy="djs-segment-dragger";function PT(e,t){var n=pi(t),i=e._container.getBoundingClientRect(),a;a={x:i.left,y:i.top};var r=e.viewbox();return{x:r.x+(n.x-a.x)/r.scale,y:r.y+(n.y-a.y)/r.scale}}function Lc(e,t,n){var i=PT(e,n),a=Oc(t,i);return a}function Bc(e,t){var n=be("g");Le(n).add(jy),Ce(e,n);var i=be("circle");ae(i,{cx:0,cy:0,r:4}),Le(i).add("djs-visual"),Ce(n,i);var a=be("circle");return ae(a,{cx:0,cy:0,r:10}),Le(a).add("djs-hit"),Ce(n,a),t&&Le(n).add(t),n}function RT(e,t,n,i){var a=be("g");Ce(e,a);var r=14,o=3,s=11,l=IT(t,n,i),c=o+s,p=be("rect");ae(p,{x:-14/2,y:-3/2,width:r,height:o}),Le(p).add("djs-visual"),Ce(a,p);var f=be("rect");return ae(f,{x:-l/2,y:-14/2,width:l,height:c}),Le(f).add("djs-hit"),Ce(a,f),Yg(a,i==="v"?90:0),a}function Gy(e,t,n){var i=be("g"),a=Ac(t,n),r=jn(t,n);return Ce(e,i),RT(i,t,n,r),Le(i).add(Hy),Le(i).add(r==="h"?"horizontal":"vertical"),Bt(i,a.x,a.y),i}function $c(e){return Math.abs(Math.round(e*2/3))}function IT(e,t,n){var i=t.x-e.x,a=t.y-e.y;return $c(n==="h"?i:a)}var Xo={exports:{}};/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */var NT=Xo.exports,$d;function MT(){return $d||($d=1,function(e,t){(function(n,i){e.exports=i(n)})(typeof ed<"u"?ed:NT,function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var i=function(a){if(arguments.length==0)throw new TypeError("`CSS.escape` requires an argument.");for(var r=String(a),o=r.length,s=-1,l,c="",p=r.charCodeAt(0);++s<o;){if(l=r.charCodeAt(s),l==0){c+="�";continue}if(l>=1&&l<=31||l==127||s==0&&l>=48&&l<=57||s==1&&l>=48&&l<=57&&p==45){c+="\\"+l.toString(16)+" ";continue}if(s==0&&o==1&&l==45){c+="\\"+r.charAt(s);continue}if(l>=128||l==45||l==95||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122){c+=r.charAt(s);continue}c+="\\"+r.charAt(s)}return c};return n.CSS||(n.CSS={}),n.CSS.escape=i,i})}(Xo)),Xo.exports}var DT=MT();const Vc=Er(DT);var kT={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Vd(e){return e=""+e,e&&e.replace(/[&<>"']/g,function(t){return kT[t]})}function zy(e,t,n,i,a){function r(S,w,T){var N=S.index,B=S.point,$,H,Z,Y,z,G;return N<=0||S.bendpoint?!1:($=w[N-1],H=w[N],Z=Ac($,H),Y=jn($,H),z=Math.abs(B.x-Z.x),G=Math.abs(B.y-Z.y),Y&&z<=T&&G<=T)}function o(S,w){var T=S.waypoints,N,B,$,H;return w.index<=0||w.bendpoint||(N={start:T[w.index-1],end:T[w.index]},B=jn(N.start,N.end),!B)?null:(B==="h"?$=N.end.x-N.start.x:$=N.end.y-N.start.y,H=$c($)/2,H)}function s(S,w){var T=w.waypoints,N=Lc(t,T,S),B;if(N)return B=o(w,N),r(N,T,B)?a.start(S,w,N.index):i.start(S,w,N.index,!N.bendpoint),!0}function l(S,w,T){Se.bind(S,w,function(N){n.triggerMouseEvent(w,N,T),N.stopPropagation()})}function c(S,w){var T=t.getLayer("overlays"),N=it('.djs-bendpoints[data-element-id="'+Vc(S.id)+'"]',T);return!N&&w&&(N=be("g"),ae(N,{"data-element-id":S.id}),Le(N).add("djs-bendpoints"),Ce(T,N),l(N,"mousedown",S),l(N,"click",S),l(N,"dblclick",S)),N}function p(S,w){return it('.djs-segment-dragger[data-segment-idx="'+S+'"]',w)}function f(S,w){w.waypoints.forEach(function(T,N){var B=Bc(S);Ce(S,B),Bt(B,T.x,T.y)}),Bc(S,"floating")}function h(S,w){for(var T=w.waypoints,N,B,$,H=1;H<T.length;H++)N=T[H-1],B=T[H],jn(N,B)&&($=Gy(S,N,B),ae($,{"data-segment-idx":H}),l($,"mousemove",w))}function v(S){j(_c("."+jy,S),function(w){ot(w)})}function m(S){j(_c("."+Hy,S),function(w){ot(w)})}function _(S){var w=c(S);return w||(w=c(S,!0),f(w,S),h(w,S)),w}function b(S){var w=c(S);w&&(m(w),v(w),h(w,S),f(w,S))}function M(S,w){var T=it(".floating",S),N=w.point;T&&Bt(T,N.x,N.y)}function P(S,w,T){var N=p(w.index,S),B=T[w.index-1],$=T[w.index],H=w.point,Z=Ac(B,$),Y=jn(B,$),z,G;N&&(z=OT(N),G={x:H.x-Z.x,y:H.y-Z.y},Y==="v"&&(G={x:G.y,y:G.x}),Bt(z,G.x,G.y))}e.on("connection.changed",function(S){b(S.element)}),e.on("connection.remove",function(S){var w=c(S.element);w&&ot(w)}),e.on("element.marker.update",function(S){var w=S.element,T;w.waypoints&&(T=_(w),S.add?Le(T).add(S.marker):Le(T).remove(S.marker))}),e.on("element.mousemove",function(S){var w=S.element,T=w.waypoints,N,B;if(T){if(N=c(w,!0),B=Lc(t,T,S.originalEvent),!B)return;M(N,B),B.bendpoint||P(N,B,T)}}),e.on("element.mousedown",function(S){if(mi(S)){var w=S.originalEvent,T=S.element;if(T.waypoints)return s(w,T)}}),e.on("selection.changed",function(S){var w=S.newSelection,T=w[0];T&&T.waypoints&&_(T)}),e.on("element.hover",function(S){var w=S.element;w.waypoints&&(_(w),n.registerEvent(S.gfx,"mousemove","element.mousemove"))}),e.on("element.out",function(S){n.unregisterEvent(S.gfx,"mousemove","element.mousemove")}),e.on("element.updateId",function(S){var w=S.element,T=S.newId;if(w.waypoints){var N=c(w);N&&ae(N,{"data-element-id":T})}}),this.addHandles=_,this.updateHandles=b,this.getBendpointsContainer=c,this.getSegmentDragger=p}zy.$inject=["eventBus","canvas","interactionEvents","bendpointMove","connectionSegmentMove"];function OT(e){return it(".djs-visual",e)}var Fd=Math.round,Mi="reconnectStart",Di="reconnectEnd",Yr="updateWaypoints";function Mp(e,t,n,i,a,r){this._injector=e,this.start=function(o,s,l,c){var p=n.getGraphics(s),f=s.source,h=s.target,v=s.waypoints,m;!c&&l===0?m=Mi:!c&&l===v.length-1?m=Di:m=Yr;var _=m===Yr?"connection.updateWaypoints":"connection.reconnect",b=a.allowed(_,{connection:s,source:f,target:h});b===!1&&(b=a.allowed(_,{connection:s,source:h,target:f})),b!==!1&&i.init(o,"bendpoint.move",{data:{connection:s,connectionGfx:p,context:{allowed:b,bendpointIndex:l,connection:s,source:f,target:h,insert:c,type:m}}})},t.on("bendpoint.move.hover",function(o){var s=o.context,l=s.connection,c=l.source,p=l.target,f=o.hover,h=s.type;s.hover=f;var v;if(f){var m=h===Yr?"connection.updateWaypoints":"connection.reconnect";if(v=s.allowed=a.allowed(m,{connection:l,source:h===Mi?f:c,target:h===Di?f:p}),v){s.source=h===Mi?f:c,s.target=h===Di?f:p;return}v===!1&&(v=s.allowed=a.allowed(m,{connection:l,source:h===Di?f:p,target:h===Mi?f:c})),v&&(s.source=h===Di?f:p,s.target=h===Mi?f:c)}}),t.on(["bendpoint.move.out","bendpoint.move.cleanup"],function(o){var s=o.context,l=s.type;s.hover=null,s.source=null,s.target=null,l!==Yr&&(s.allowed=!1)}),t.on("bendpoint.move.end",function(o){var s=o.context,l=s.allowed,c=s.bendpointIndex,p=s.connection,f=s.insert,h=p.waypoints.slice(),v=s.source,m=s.target,_=s.type,b=s.hints||{},M={x:Fd(o.x),y:Fd(o.y)};if(!l)return!1;_===Yr?(f?h.splice(c,0,M):h[c]=M,b.bendpointMove={insert:f,bendpointIndex:c},h=this.cropWaypoints(p,h),r.updateWaypoints(p,g_(h),b)):(_===Mi?(b.docking="source",us(s)&&(b.docking="target",b.newWaypoints=h.reverse())):_===Di&&(b.docking="target",us(s)&&(b.docking="source",b.newWaypoints=h.reverse())),r.reconnect(p,v,m,M,b))},this)}Mp.$inject=["injector","eventBus","canvas","dragging","rules","modeling"];Mp.prototype.cropWaypoints=function(e,t){var n=this._injector.get("connectionDocking",!1);if(!n)return t;var i=e.waypoints;return e.waypoints=t,e.waypoints=n.getCroppedWaypoints(e),t=e.waypoints,e.waypoints=i,t};function us(e){var t=e.hover,n=e.source,i=e.target,a=e.type;if(a===Mi)return t&&i&&t===i&&n!==i;if(a===Di)return t&&n&&t===n&&n!==i}var LT="reconnectStart",BT="reconnectEnd",jd="updateWaypoints",Kr="connect-ok",So="connect-not-ok",Hd="connect-hover",Gd="djs-updating",zd="djs-element-hidden",Ud=1100;function Uy(e,t,n,i){this._injector=t;var a=t.get("connectionPreview",!1);n.on("bendpoint.move.start",function(r){var o=r.context,s=o.bendpointIndex,l=o.connection,c=o.insert,p=l.waypoints,f=p.slice();o.waypoints=p,c&&f.splice(s,0,{x:r.x,y:r.y}),l.waypoints=f;var h=o.draggerGfx=Bc(i.getLayer("overlays"));Le(h).add("djs-dragging"),i.addMarker(l,zd),i.addMarker(l,Gd)}),n.on("bendpoint.move.hover",function(r){var o=r.context,s=o.allowed,l=o.hover,c=o.type;if(l){if(i.addMarker(l,Hd),c===jd)return;s?(i.removeMarker(l,So),i.addMarker(l,Kr)):s===!1&&(i.removeMarker(l,Kr),i.addMarker(l,So))}}),n.on(["bendpoint.move.out","bendpoint.move.cleanup"],Ud,function(r){var o=r.context,s=o.hover,l=o.target;s&&(i.removeMarker(s,Hd),i.removeMarker(s,l?Kr:So))}),n.on("bendpoint.move.move",function(r){var o=r.context,s=o.allowed,l=o.bendpointIndex,c=o.draggerGfx,p=o.hover,f=o.type,h=o.connection,v=h.source,m=h.target,_=h.waypoints.slice(),b={x:r.x,y:r.y},M=o.hints||{},P={};a&&(M.connectionStart&&(P.connectionStart=M.connectionStart),M.connectionEnd&&(P.connectionEnd=M.connectionEnd),f===LT?us(o)?(P.connectionEnd=P.connectionEnd||b,P.source=m,P.target=p||v,_=_.reverse()):(P.connectionStart=P.connectionStart||b,P.source=p||v,P.target=m):f===BT?us(o)?(P.connectionStart=P.connectionStart||b,P.source=p||m,P.target=v,_=_.reverse()):(P.connectionEnd=P.connectionEnd||b,P.source=v,P.target=p||m):(P.noCropping=!0,P.noLayout=!0,_[l]=b),f===jd&&(_=e.cropWaypoints(h,_)),P.waypoints=_,a.drawPreview(o,s,P)),Bt(c,r.x,r.y)},this),n.on(["bendpoint.move.end","bendpoint.move.cancel"],Ud,function(r){var o=r.context,s=o.connection,l=o.draggerGfx,c=o.hover,p=o.target,f=o.waypoints;s.waypoints=f,ot(l),i.removeMarker(s,Gd),i.removeMarker(s,zd),c&&(i.removeMarker(c,Kr),i.removeMarker(c,p?Kr:So)),a&&a.cleanUp(o)})}Uy.$inject=["bendpointMove","injector","eventBus","canvas"];var qd="connect-hover",Wd="djs-updating";function Yd(e,t,n){return Dp(e,t,e[t]+n)}function Dp(e,t,n){return{x:t==="x"?n:e.x,y:t==="y"?n:e.y}}function $T(e,t,n,i){var a=Math.max(t[i],n[i]),r=Math.min(t[i],n[i]),o=20,s=Math.min(Math.max(r+o,e[i]),a-o);return Dp(t,i,s)}function qy(e){return e==="x"?"y":"x"}function Kd(e,t,n){var i,a;return e.original?e.original:(i=Me(t),a=qy(n),Dp(e,a,i[a]))}function Wy(e,t,n,i,a,r){var o=e.get("connectionDocking",!1);this.start=function(f,h,v){var m,_=n.getGraphics(h),b=v-1,M=v,P=h.waypoints,S=P[b],w=P[M],T=Lc(n,P,f),N,B,$;N=jn(S,w),N&&(B=N==="v"?"x":"y",b===0&&(S=Kd(S,h.source,B)),M===P.length-1&&(w=Kd(w,h.target,B)),T?$=T.point:$={x:(S.x+w.x)/2,y:(S.y+w.y)/2},m={connection:h,segmentStartIndex:b,segmentEndIndex:M,segmentStart:S,segmentEnd:w,axis:B,dragPosition:$},i.init(f,$,"connectionSegment.move",{cursor:B==="x"?"resize-ew":"resize-ns",data:{connection:h,connectionGfx:_,context:m}}))};function s(f,h){if(!o)return h;var v=f.waypoints,m;return f.waypoints=h,m=o.getCroppedWaypoints(f),f.waypoints=v,m}function l(f){a.update("connection",f.connection,f.connectionGfx)}function c(f,h,v){var m=f.newWaypoints,_=f.segmentStartIndex+h,b=m[_],M=f.segmentEndIndex+h,P=m[M],S=qy(f.axis),w=$T(v,b,P,S);Bt(f.draggerGfx,w.x,w.y)}function p(f,h){var v=0,m=f.filter(function(_,b){return dp(f[b-1],f[b+1],_)?(v=b<=h?v-1:v,!1):!0});return{waypoints:m,segmentOffset:v}}t.on("connectionSegment.move.start",function(f){var h=f.context,v=f.connection,m=n.getLayer("overlays");h.originalWaypoints=v.waypoints.slice(),h.draggerGfx=Gy(m,h.segmentStart,h.segmentEnd),Le(h.draggerGfx).add("djs-dragging"),n.addMarker(v,Wd)}),t.on("connectionSegment.move.move",function(f){var h=f.context,v=h.connection,m=h.segmentStartIndex,_=h.segmentEndIndex,b=h.segmentStart,M=h.segmentEnd,P=h.axis,S=h.originalWaypoints.slice(),w=Yd(b,P,f["d"+P]),T=Yd(M,P,f["d"+P]),N=S.length,B=0;S[m]=w,S[_]=T;var $,H;m<2&&($=wt(v.source,w),m===1?$==="intersect"&&(S.shift(),S[0]=w,B--):$!=="intersect"&&(S.unshift(b),B++)),_>N-3&&(H=wt(v.target,T),_===N-2?H==="intersect"&&(S.pop(),S[S.length-1]=T):H!=="intersect"&&S.push(M)),h.newWaypoints=v.waypoints=s(v,S),c(h,B,f),h.newSegmentStartIndex=m+B,l(f)}),t.on("connectionSegment.move.hover",function(f){f.context.hover=f.hover,n.addMarker(f.hover,qd)}),t.on(["connectionSegment.move.out","connectionSegment.move.cleanup"],function(f){var h=f.context.hover;h&&n.removeMarker(h,qd)}),t.on("connectionSegment.move.cleanup",function(f){var h=f.context,v=h.connection;h.draggerGfx&&ot(h.draggerGfx),n.removeMarker(v,Wd)}),t.on(["connectionSegment.move.cancel","connectionSegment.move.end"],function(f){var h=f.context,v=h.connection;v.waypoints=h.originalWaypoints,l(f)}),t.on("connectionSegment.move.end",function(f){var h=f.context,v=h.connection,m=h.newWaypoints,_=h.newSegmentStartIndex;m=m.map(function(T){return{original:T.original,x:Math.round(T.x),y:Math.round(T.y)}});var b=p(m,_),M=b.waypoints,P=s(v,M),S=b.segmentOffset,w={segmentMove:{segmentStartIndex:h.segmentStartIndex,newSegmentStartIndex:_+S}};r.updateWaypoints(v,P,w)})}Wy.$inject=["injector","eventBus","canvas","dragging","graphicsFactory","modeling"];var VT=Math.abs,Xd=Math.round;function FT(e,t,n){n=n===void 0?10:n;var i,a;for(i=0;i<t.length;i++)if(a=t[i],VT(a-e)<=n)return a}function Yy(e){return{x:e.x,y:e.y}}function Ky(e){return{x:e.x+e.width,y:e.y+e.height}}function Jt(e,t){return!e||isNaN(e.x)||isNaN(e.y)?t:{x:Xd(e.x+e.width/2),y:Xd(e.y+e.height/2)}}function vr(e,t){var n=e.snapped;return n?typeof t=="string"?n[t]:n.x&&n.y:!1}function ft(e,t,n){if(typeof t!="string")throw new Error("axis must be in [x, y]");if(typeof n!="number"&&n!==!1)throw new Error("value must be Number or false");var i,a=e[t],r=e.snapped=e.snapped||{};return n===!1?r[t]=!1:(r[t]=!0,i=n-a,e[t]+=i,e["d"+t]+=i),a}function Xy(e){return e.children||[]}var jT=Math.abs,Zd=Math.round,Ol=10;function Zy(e){function t(r,o){if(Oe(r)){for(var s=r.length;s--;)if(jT(r[s]-o)<=Ol)return r[s]}else{r=+r;var l=o%r;if(l<Ol)return o-l;if(l>r-Ol)return o-l+r}return o}function n(r){if(r.width)return{x:Zd(r.width/2+r.x),y:Zd(r.height/2+r.y)}}function i(r){var o=r.snapPoints,s=r.connection,l=s.waypoints,c=r.segmentStart,p=r.segmentStartIndex,f=r.segmentEnd,h=r.segmentEndIndex,v=r.axis;if(o)return o;var m=[l[p-1],c,f,l[h+1]];return p<2&&m.unshift(n(s.source)),h>l.length-3&&m.unshift(n(s.target)),r.snapPoints=o={horizontal:[],vertical:[]},j(m,function(_){_&&(_=_.original||_,v==="y"&&o.horizontal.push(_.y),v==="x"&&o.vertical.push(_.x))}),o}e.on("connectionSegment.move.move",1500,function(r){var o=r.context,s=i(o),l=r.x,c=r.y,p,f;if(s){p=t(s.vertical,l),f=t(s.horizontal,c);var h=l-p,v=c-f;q(r,{dx:r.dx-h,dy:r.dy-v,x:p,y:f}),(h||s.vertical.indexOf(l)!==-1)&&ft(r,"x",p),(v||s.horizontal.indexOf(c)!==-1)&&ft(r,"y",f)}});function a(r){var o=r.snapPoints,s=r.connection.waypoints,l=r.bendpointIndex;if(o)return o;var c=[s[l-1],s[l+1]];return r.snapPoints=o={horizontal:[],vertical:[]},j(c,function(p){p&&(p=p.original||p,o.horizontal.push(p.y),o.vertical.push(p.x))}),o}e.on(["bendpoint.move.move","bendpoint.move.end"],1500,function(r){var o=r.context,s=a(o),l=o.hover,c=l&&n(l),p=r.x,f=r.y,h,v;if(s){h=t(c?s.vertical.concat([c.x]):s.vertical,p),v=t(c?s.horizontal.concat([c.y]):s.horizontal,f);var m=p-h,_=f-v;q(r,{dx:r.dx-m,dy:r.dy-_,x:r.x-m,y:r.y-_}),(m||s.vertical.indexOf(p)!==-1)&&ft(r,"x",h),(_||s.horizontal.indexOf(f)!==-1)&&ft(r,"y",v)}})}Zy.$inject=["eventBus"];const HT={__depends__:[Zn,On],__init__:["bendpoints","bendpointSnapping","bendpointMovePreview"],bendpoints:["type",zy],bendpointMove:["type",Mp],bendpointMovePreview:["type",Uy],connectionSegmentMove:["type",Wy],bendpointSnapping:["type",Zy]};function Jy(e,t,n,i){function a(o,s){return i.allowed("connection.create",{source:o,target:s})}function r(o,s){return a(s,o)}e.on("connect.hover",function(o){var s=o.context,l=s.start,c=o.hover,p;if(s.hover=c,p=s.canExecute=a(l,c),!ca(p)){if(p!==!1){s.source=l,s.target=c;return}p=s.canExecute=r(l,c),!ca(p)&&p!==!1&&(s.source=c,s.target=l)}}),e.on(["connect.out","connect.cleanup"],function(o){var s=o.context;s.hover=null,s.source=null,s.target=null,s.canExecute=!1}),e.on("connect.end",function(o){var s=o.context,l=s.canExecute,c=s.connectionStart,p={x:o.x,y:o.y},f=s.source,h=s.target;if(!l)return!1;var v=null,m={connectionStart:Fc(s)?p:c,connectionEnd:Fc(s)?c:p};st(l)&&(v=l),n.connect(f,h,v,m)}),this.start=function(o,s,l,c){st(l)||(c=l,l=Me(s)),t.init(o,"connect",{autoActivate:c,data:{shape:s,context:{start:s,connectionStart:l}}})}}Jy.$inject=["eventBus","dragging","modeling","rules"];function Fc(e){var t=e.hover,n=e.source,i=e.target;return t&&n&&t===n&&n!==i}var GT=1100,zT=900,Jd="connect-ok",Qd="connect-not-ok";function Qy(e,t,n){var i=e.get("connectionPreview",!1);i&&t.on("connect.move",function(a){var r=a.context,o=r.canExecute,s=r.hover,l=r.source,c=r.start,p=r.startPosition,f=r.target,h=r.connectionStart||p,v=r.connectionEnd||{x:a.x,y:a.y},m=h,_=v;Fc(r)&&(m=v,_=h),i.drawPreview(r,o,{source:l||c,target:f||s,connectionStart:m,connectionEnd:_})}),t.on("connect.hover",zT,function(a){var r=a.context,o=a.hover,s=r.canExecute;s!==null&&n.addMarker(o,s?Jd:Qd)}),t.on(["connect.out","connect.cleanup"],GT,function(a){var r=a.hover;r&&(n.removeMarker(r,Jd),n.removeMarker(r,Qd))}),i&&t.on("connect.cleanup",function(a){i.cleanUp(a.context)})}Qy.$inject=["injector","eventBus","canvas"];const kp={__depends__:[Dn,On,Zn],__init__:["connectPreview"],connect:["type",Jy],connectPreview:["type",Qy]};var UT="djs-connection-preview";function Jn(e,t,n,i){this._canvas=t,this._graphicsFactory=n,this._elementFactory=i,this._connectionDocking=e.get("connectionDocking",!1),this._layouter=e.get("layouter",!1)}Jn.$inject=["injector","canvas","graphicsFactory","elementFactory"];Jn.prototype.drawPreview=function(e,t,n){n=n||{};var i=e.connectionPreviewGfx,a=e.getConnection,r=n.source,o=n.target,s=n.waypoints,l=n.connectionStart,c=n.connectionEnd,p=n.noLayout,f=n.noCropping,h=n.noNoop,v,m=this;if(i||(i=e.connectionPreviewGfx=this.createConnectionPreviewGfx()),Tg(i),a||(a=e.getConnection=qT(function(_,b,M){return m.getConnection(_,b,M)})),t&&(v=a(t,r,o)),!v){!h&&this.drawNoopPreview(i,n);return}v.waypoints=s||[],this._layouter&&!p&&(v.waypoints=this._layouter.layoutConnection(v,{source:r,target:o,connectionStart:l,connectionEnd:c,waypoints:n.waypoints||v.waypoints})),(!v.waypoints||!v.waypoints.length)&&(v.waypoints=[r?Me(r):l,o?Me(o):c]),this._connectionDocking&&(r||o)&&!f&&(v.waypoints=this._connectionDocking.getCroppedWaypoints(v,r,o)),this._graphicsFactory.drawConnection(i,v)};Jn.prototype.drawNoopPreview=function(e,t){var n=t.source,i=t.target,a=t.connectionStart||Me(n),r=t.connectionEnd||Me(i),o=this.cropWaypoints(a,r,n,i),s=this.createNoopConnection(o[0],o[1]);Ce(e,s)};Jn.prototype.cropWaypoints=function(e,t,n,i){var a=this._graphicsFactory,r=n&&a.getShapePath(n),o=i&&a.getShapePath(i),s=a.getConnectionPath({waypoints:[e,t]});return e=n&&Pc(r,s,!0)||e,t=i&&Pc(o,s,!1)||t,[e,t]};Jn.prototype.cleanUp=function(e){e&&e.connectionPreviewGfx&&ot(e.connectionPreviewGfx)};Jn.prototype.getConnection=function(e){var t=WT(e);return this._elementFactory.createConnection(t)};Jn.prototype.createConnectionPreviewGfx=function(){var e=be("g");return ae(e,{pointerEvents:"none"}),Le(e).add(UT),Ce(this._canvas.getActiveLayer(),e),e};Jn.prototype.createNoopConnection=function(e,t){var n=be("polyline");return ae(n,{stroke:"#333",strokeDasharray:[1],strokeWidth:2,"pointer-events":"none"}),ae(n,{points:[e.x,e.y,t.x,t.y]}),n};function qT(e){var t={};return function(n){var i=JSON.stringify(n),a=t[i];return a||(a=t[i]=e.apply(null,arguments)),a}}function WT(e){return st(e)?e:{}}const YT={__init__:["connectionPreview"],connectionPreview:["type",Jn]};var eh=Math.min,th=Math.max;function Ll(e){e.preventDefault()}function aa(e){e.stopPropagation()}function KT(e){return e.nodeType===Node.TEXT_NODE}function XT(e){return[].slice.call(e)}function bn(e){this.container=e.container,this.parent=Qe('<div class="djs-direct-editing-parent"><div class="djs-direct-editing-content" contenteditable="true"></div></div>'),this.content=it("[contenteditable]",this.parent),this.keyHandler=e.keyHandler||function(){},this.resizeHandler=e.resizeHandler||function(){},this.autoResize=Pt(this.autoResize,this),this.handlePaste=Pt(this.handlePaste,this)}bn.prototype.create=function(e,t,n,i){var a=this,r=this.parent,o=this.content,s=this.container;i=this.options=i||{},t=this.style=t||{};var l=rn(t,["width","height","maxWidth","maxHeight","minWidth","minHeight","left","top","backgroundColor","position","overflow","border","wordWrap","textAlign","outline","transform"]);q(r.style,{width:e.width+"px",height:e.height+"px",maxWidth:e.maxWidth+"px",maxHeight:e.maxHeight+"px",minWidth:e.minWidth+"px",minHeight:e.minHeight+"px",left:e.x+"px",top:e.y+"px",backgroundColor:"#ffffff",position:"absolute",overflow:"visible",border:"1px solid #ccc",boxSizing:"border-box",wordWrap:"normal",textAlign:"center",outline:"none"},l);var c=rn(t,["fontFamily","fontSize","fontWeight","lineHeight","padding","paddingTop","paddingRight","paddingBottom","paddingLeft"]);return q(o.style,{boxSizing:"border-box",width:"100%",outline:"none",wordWrap:"break-word"},c),i.centerVertically&&q(o.style,{position:"absolute",top:"50%",transform:"translate(0, -50%)"},c),o.innerText=n,Se.bind(o,"keydown",this.keyHandler),Se.bind(o,"mousedown",aa),Se.bind(o,"paste",a.handlePaste),i.autoResize&&Se.bind(o,"input",this.autoResize),i.resizable&&this.resizable(t),s.appendChild(r),this.setSelection(o.lastChild,o.lastChild&&o.lastChild.length),r};bn.prototype.handlePaste=function(e){var t=this.options,n=this.style;e.preventDefault();var i;if(e.clipboardData?i=e.clipboardData.getData("text/plain"):i=window.clipboardData.getData("Text"),this.insertText(i),t.autoResize){var a=this.autoResize(n);a&&this.resizeHandler(a)}};bn.prototype.insertText=function(e){e=ZT(e);var t=document.execCommand("insertText",!1,e);t||this._insertTextIE(e)};bn.prototype._insertTextIE=function(e){var t=this.getSelection(),n=t.startContainer,i=t.endContainer,a=t.startOffset,r=t.endOffset,o=t.commonAncestorContainer,s=XT(o.childNodes),l,c;if(KT(o)){var p=n.textContent;n.textContent=p.substring(0,a)+e+p.substring(r),l=n,c=a+e.length}else if(n===this.content&&i===this.content){var f=document.createTextNode(e);this.content.insertBefore(f,s[a]),l=f,c=f.textContent.length}else{var h=s.indexOf(n),v=s.indexOf(i);s.forEach(function(m,_){_===h?m.textContent=n.textContent.substring(0,a)+e+i.textContent.substring(r):_>h&&_<=v&&Nn(m)}),l=n,c=a+e.length}l&&c!==void 0&&setTimeout(function(){self.setSelection(l,c)})};bn.prototype.autoResize=function(){var e=this.parent,t=this.content,n=parseInt(this.style.fontSize)||12;if(t.scrollHeight>e.offsetHeight||t.scrollHeight<e.offsetHeight-n){var i=e.getBoundingClientRect(),a=t.scrollHeight;e.style.height=a+"px",this.resizeHandler({width:i.width,height:i.height,dx:0,dy:a-i.height})}};bn.prototype.resizable=function(){var e=this,t=this.parent,n=this.resizeHandle,i=parseInt(this.style.minWidth)||0,a=parseInt(this.style.minHeight)||0,r=parseInt(this.style.maxWidth)||1/0,o=parseInt(this.style.maxHeight)||1/0;if(!n){n=this.resizeHandle=Qe('<div class="djs-direct-editing-resize-handle"></div>');var s,l,c,p,f=function(m){Ll(m),aa(m),s=m.clientX,l=m.clientY;var _=t.getBoundingClientRect();c=_.width,p=_.height,Se.bind(document,"mousemove",h),Se.bind(document,"mouseup",v)},h=function(m){Ll(m),aa(m);var _=eh(th(c+m.clientX-s,i),r),b=eh(th(p+m.clientY-l,a),o);t.style.width=_+"px",t.style.height=b+"px",e.resizeHandler({width:c,height:p,dx:m.clientX-s,dy:m.clientY-l})},v=function(m){Ll(m),aa(m),Se.unbind(document,"mousemove",h,!1),Se.unbind(document,"mouseup",v,!1)};Se.bind(n,"mousedown",f)}q(n.style,{position:"absolute",bottom:"0px",right:"0px",cursor:"nwse-resize",width:"0",height:"0",borderTop:(parseInt(this.style.fontSize)/4||3)+"px solid transparent",borderRight:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderBottom:(parseInt(this.style.fontSize)/4||3)+"px solid #ccc",borderLeft:(parseInt(this.style.fontSize)/4||3)+"px solid transparent"}),t.appendChild(n)};bn.prototype.destroy=function(){var e=this.parent,t=this.content,n=this.resizeHandle;t.innerText="",e.removeAttribute("style"),t.removeAttribute("style"),Se.unbind(t,"keydown",this.keyHandler),Se.unbind(t,"mousedown",aa),Se.unbind(t,"input",this.autoResize),Se.unbind(t,"paste",this.handlePaste),n&&(n.removeAttribute("style"),Nn(n)),Nn(e)};bn.prototype.getValue=function(){return this.content.innerText.trim()};bn.prototype.getSelection=function(){var e=window.getSelection(),t=e.getRangeAt(0);return t};bn.prototype.setSelection=function(e,t){var n=document.createRange();e===null?n.selectNodeContents(this.content):(n.setStart(e,t),n.setEnd(e,t));var i=window.getSelection();i.removeAllRanges(),i.addRange(n)};function ZT(e){return e.replace(/\r\n|\r|\n/g,`
`)}function sn(e,t){this._eventBus=e,this._providers=[],this._textbox=new bn({container:t.getContainer(),keyHandler:Pt(this._handleKey,this),resizeHandler:Pt(this._handleResize,this)})}sn.$inject=["eventBus","canvas"];sn.prototype.registerProvider=function(e){this._providers.push(e)};sn.prototype.isActive=function(e){return!!(this._active&&(!e||this._active.element===e))};sn.prototype.cancel=function(){this._active&&(this._fire("cancel"),this.close())};sn.prototype._fire=function(e,t){this._eventBus.fire("directEditing."+e,t||{active:this._active})};sn.prototype.close=function(){this._textbox.destroy(),this._fire("deactivate"),this._active=null,this.resizable=void 0};sn.prototype.complete=function(){var e=this._active;if(e){var t,n=e.context.bounds,i=this.$textbox.getBoundingClientRect(),a=this.getValue(),r=e.context.text;(a!==r||i.height!==n.height||i.width!==n.width)&&(t=this._textbox.container.getBoundingClientRect(),e.provider.update(e.element,a,e.context.text,{x:i.left-t.left,y:i.top-t.top,width:i.width,height:i.height})),this._fire("complete"),this.close()}};sn.prototype.getValue=function(){return this._textbox.getValue()};sn.prototype._handleKey=function(e){e.stopPropagation();var t=e.keyCode||e.charCode;if(t===27)return e.preventDefault(),this.cancel();if(t===13&&!e.shiftKey)return e.preventDefault(),this.complete()};sn.prototype._handleResize=function(e){this._fire("resize",e)};sn.prototype.activate=function(e){this.isActive()&&this.cancel();var t,n=Ue(this._providers,function(i){return(t=i.activate(e))?i:null});return t&&(this.$textbox=this._textbox.create(t.bounds,t.style,t.text,t.options),this._active={element:e,context:t,provider:n},t.options&&t.options.resizable&&(this.resizable=!0),this._fire("activate")),!!t};const eE={__depends__:[Ca],__init__:["directEditing"],directEditing:["type",sn]};var nh=".entry",JT=1e3;function ln(e,t,n){this._eventBus=t,this._overlays=n;var i=Qt(e&&e.scale)?e.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:i},this._current=null,this._init()}ln.$inject=["config.contextPad","eventBus","overlays"];ln.prototype._init=function(){var e=this._eventBus,t=this;e.on("selection.changed",function(n){var i=n.newSelection;i.length===1?t.open(i[0]):t.close()}),e.on("elements.delete",function(n){var i=n.elements;j(i,function(a){t.isOpen(a)&&t.close()})}),e.on("element.changed",function(n){var i=n.element,a=t._current;a&&a.element===i&&t.open(i,!0)})};ln.prototype.registerProvider=function(e,t){t||(t=e,e=JT),this._eventBus.on("contextPad.getProviders",e,function(n){n.providers.push(t)})};ln.prototype.getEntries=function(e){var t=this._getProviders(),n={};return j(t,function(i){var a=i.getContextPadEntries(e);xt(a)?n=a(n):j(a,function(r,o){n[o]=r})}),n};ln.prototype.trigger=function(e,t,n){var i=this._current.element,a=this._current.entries,r,o,s,l=t.delegateTarget||t.target;if(!l)return t.preventDefault();if(r=a[Ut(l,"data-action")],o=r.action,s=t.originalEvent||t,xt(o)){if(e==="click")return o(s,i,n)}else if(o[e])return o[e](s,i,n);t.preventDefault()};ln.prototype.open=function(e,t){!t&&this.isOpen(e)||(this.close(),this._updateAndOpen(e))};ln.prototype._getProviders=function(){var e=this._eventBus.createEvent({type:"contextPad.getProviders",providers:[]});return this._eventBus.fire(e),e.providers};ln.prototype._updateAndOpen=function(e){var t=this.getEntries(e),n=this.getPad(e),i=n.html;j(t,function(a,r){var o=a.group||"default",s=Qe(a.html||'<div class="entry" draggable="true"></div>'),l;Ut(s,"data-action",r),l=it("[data-group="+o+"]",i),l||(l=Qe('<div class="group" data-group="'+o+'"></div>'),i.appendChild(l)),l.appendChild(s),a.className&&QT(s,a.className),a.title&&Ut(s,"title",a.title),a.imageUrl&&s.appendChild(Qe('<img src="'+a.imageUrl+'">'))}),dt(i).add("open"),this._current={element:e,pad:n,entries:t},this._eventBus.fire("contextPad.open",{current:this._current})};ln.prototype.getPad=function(e){if(this.isOpen())return this._current.pad;var t=this,n=this._overlays,i=Qe('<div class="djs-context-pad"></div>'),a=q({html:i},this._overlaysConfig);Ht.bind(i,nh,"click",function(o){t.trigger("click",o)}),Ht.bind(i,nh,"dragstart",function(o){t.trigger("dragstart",o)}),Se.bind(i,"mousedown",function(o){o.stopPropagation()}),this._overlayId=n.add(e,"context-pad",a);var r=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:e,pad:r}),r};ln.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)};ln.prototype.isOpen=function(e){return!!this._current&&(e?this._current.element===e:!0)};function QT(e,t){var n=dt(e),i=Oe(t)?t:t.split(/\s+/g);i.forEach(function(a){n.add(a)})}const e1={__depends__:[Ca,wp],contextPad:["type",ln]};var t1=["marker-start","marker-mid","marker-end"],n1=["circle","ellipse","line","path","polygon","polyline","rect"];function Gi(e,t,n,i){this._elementRegistry=e,this._canvas=n,this._styles=i,this._clonedMarkers={};var a=this;t.on("drag.cleanup",function(){j(a._clonedMarkers,function(r){ot(r)}),a._clonedMarkers={}})}Gi.$inject=["elementRegistry","eventBus","canvas","styles"];Gi.prototype.getGfx=function(e){return this._elementRegistry.getGraphics(e)};Gi.prototype.addDragger=function(e,t,n){n=n||this.getGfx(e);var i=Cg(n),a=n.getBoundingClientRect();return this._cloneMarkers(ss(i)),ae(i,this._styles.cls("djs-dragger",[],{x:a.top,y:a.left})),Ce(t,i),i};Gi.prototype.addFrame=function(e,t){var n=be("rect",{class:"djs-resize-overlay",width:e.width,height:e.height,x:e.x,y:e.y});return Ce(t,n),n};Gi.prototype._cloneMarkers=function(e){var t=this;if(e.childNodes)for(var n=0;n<e.childNodes.length;n++)t._cloneMarkers(e.childNodes[n]);o1(e)&&t1.forEach(function(i){if(ae(e,i)){var a=i1(e,i,t._canvas.getContainer());t._cloneMarker(e,a,i)}})};Gi.prototype._cloneMarker=function(e,t,n){var i=t.id,a=this._clonedMarkers[i];if(!a){a=Cg(t);var r=i+"-clone";a.id=r,Le(a).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[i]=a;var o=it("defs",this._canvas._svg);o||(o=be("defs"),Ce(this._canvas._svg,o)),Ce(o,a)}var s=a1(this._clonedMarkers[i].id);ae(e,n,s)};function i1(e,t,n){var i=r1(ae(e,t));return it("marker#"+i,n||document)}function r1(e){return e.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]}function a1(e){return"url(#"+e+")"}function o1(e){return n1.indexOf(e.nodeName)!==-1}const Ra={__init__:["previewSupport"],previewSupport:["type",Gi]};var s1="drop-ok",ih="drop-not-ok",rh="attach-ok",ah="new-parent",oh="create",l1=2e3;function tE(e,t,n,i,a){function r(l,c,p,f,h){if(!c)return!1;l=Ie(l,function(P){var S=P.labelTarget;return!P.parent&&!(u1(P)&&l.indexOf(S)!==-1)});var v=Ue(l,function(P){return!ta(P)}),m=!1,_=!1,b=!1;lh(l)&&(m=a.allowed("shape.attach",{position:p,shape:v,target:c})),m||(lh(l)?b=a.allowed("shape.create",{position:p,shape:v,source:f,target:c}):b=a.allowed("elements.create",{elements:l,position:p,target:c}));var M=h.connectionTarget;return b||m?(v&&f&&(_=a.allowed("connection.create",{source:M===f?v:f,target:M===f?f:v,hints:{targetParent:c,targetAttach:m}})),{attach:m,connect:_}):b===null||m===null?null:!1}function o(l,c){[rh,s1,ih,ah].forEach(function(p){p===c?e.addMarker(l,p):e.removeMarker(l,p)})}n.on(["create.move","create.hover"],function(l){var c=l.context,p=c.elements,f=l.hover,h=c.source,v=c.hints||{};if(!f){c.canExecute=!1,c.target=null;return}sh(l);var m={x:l.x,y:l.y},_=c.canExecute=f&&r(p,f,m,h,v);f&&_!==null&&(c.target=f,_&&_.attach?o(f,rh):o(f,_?ah:ih))}),n.on(["create.end","create.out","create.cleanup"],function(l){var c=l.hover;c&&o(c,null)}),n.on("create.end",function(l){var c=l.context,p=c.source,f=c.shape,h=c.elements,v=c.target,m=c.canExecute,_=m&&m.attach,b=m&&m.connect,M=c.hints||{};if(m===!1||!v)return!1;sh(l);var P={x:l.x,y:l.y};b?f=i.appendShape(p,f,P,v,{attach:_,connection:b===!0?{}:b,connectionTarget:M.connectionTarget}):(h=i.createElements(h,P,v,q({},M,{attach:_})),f=Ue(h,function(S){return!ta(S)})),q(c,{elements:h,shape:f}),q(l,{elements:h,shape:f})});function s(){var l=t.context();l&&l.prefix===oh&&t.cancel()}n.on("create.init",function(){n.on("elements.changed",s),n.once(["create.cancel","create.end"],l1,function(){n.off("elements.changed",s)})}),this.start=function(l,c,p){Oe(c)||(c=[c]);var f=Ue(c,function(v){return!ta(v)});if(f){p=q({elements:c,hints:{},shape:f},p||{}),j(c,function(v){Re(v.x)||(v.x=0),Re(v.y)||(v.y=0)});var h=St(c);j(c,function(v){ta(v)&&(v.waypoints=ht(v.waypoints,function(m){return{x:m.x-h.x-h.width/2,y:m.y-h.y-h.height/2}})),q(v,{x:v.x-h.x-h.width/2,y:v.y-h.y-h.height/2})}),t.init(l,oh,{cursor:"grabbing",autoActivate:!0,data:{shape:f,elements:c,context:p}})}}}tE.$inject=["canvas","dragging","eventBus","modeling","rules"];function sh(e){var t=e.context,n=t.createConstraints;n&&(n.left&&(e.x=Math.max(e.x,n.left)),n.right&&(e.x=Math.min(e.x,n.right)),n.top&&(e.y=Math.max(e.y,n.top)),n.bottom&&(e.y=Math.min(e.y,n.bottom)))}function ta(e){return!!e.waypoints}function lh(e){return e&&e.length===1&&!ta(e[0])}function u1(e){return!!e.labelTarget}var c1=750;function nE(e,t,n,i,a){function r(o){var s=be("g");ae(s,a.cls("djs-drag-group",["no-events"]));var l=be("g");return o.forEach(function(c){var p;c.hidden||(c.waypoints?(p=n._createContainer("connection",l),n.drawConnection(ss(p),c)):(p=n._createContainer("shape",l),n.drawShape(ss(p),c),Bt(p,c.x,c.y)),i.addDragger(c,s,p))}),s}t.on("create.move",c1,function(o){var s=o.hover,l=o.context,c=l.elements,p=l.dragGroup;p||(p=l.dragGroup=r(c));var f;s?(p.parentNode||(f=e.getActiveLayer(),Ce(f,p)),Bt(p,o.x,o.y)):ot(p)}),t.on("create.cleanup",function(o){var s=o.context,l=s.dragGroup;l&&ot(l)})}nE.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];const Fs={__depends__:[Zn,Ra,On,Dn],__init__:["create","createPreview"],create:["type",tE],createPreview:["type",nE]};var iE="data-id",rE=["contextPad.close","canvas.viewbox.changing","commandStack.changed"],p1=1e3;function ut(e,t,n){var i=Qt(e&&e.scale)?e.scale:{min:1,max:1.5};this._config={scale:i},this._eventBus=t,this._canvas=n,this._providers={},this._current={}}ut.$inject=["config.popupMenu","eventBus","canvas"];ut.prototype.registerProvider=function(e,t,n){n||(n=t,t=p1),this._eventBus.on("popupMenu.getProviders."+e,t,function(i){i.providers.push(n)})};ut.prototype.isEmpty=function(e,t){if(!e)throw new Error("element parameter is missing");if(!t)throw new Error("providerId parameter is missing");var n=this._getProviders(t);if(!n)return!0;var i=this._getEntries(e,n),a=this._getHeaderEntries(e,n),r=cr(i)>0,o=a&&cr(a)>0;return!r&&!o};ut.prototype.open=function(e,t,n){var i=this._getProviders(t);if(!e)throw new Error("Element is missing");if(!i||!i.length)throw new Error("No registered providers for: "+t);if(!n)throw new Error("the position argument is missing");this.isOpen()&&this.close(),this._emit("open");var a=this._current={className:t,element:e,position:n},r=this._getEntries(e,i),o=this._getHeaderEntries(e,i);a.entries=q({},r,o),a.container=this._createContainer(),cr(o)&&a.container.appendChild(this._createEntries(o,"djs-popup-header")),cr(r)&&a.container.appendChild(this._createEntries(r,"djs-popup-body"));var s=this._canvas,l=s.getContainer();this._attachContainer(a.container,l,n.cursor),this._bindAutoClose()};ut.prototype.close=function(){this.isOpen()&&(this._emit("close"),this._unbindAutoClose(),Nn(this._current.container),this._current.container=null)};ut.prototype.isOpen=function(){return!!this._current.container};ut.prototype.trigger=function(e){e.preventDefault();var t=e.delegateTarget||e.target,n=Ut(t,iE),i=this._getEntry(n);if(i.action)return i.action.call(null,e,i)};ut.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"popupMenu.getProviders."+e,providers:[]});return this._eventBus.fire(t),t.providers};ut.prototype._getEntries=function(e,t){var n={};return j(t,function(i){if(!i.getPopupMenuEntries){j(i.getEntries(e),function(r){var o=r.id;if(!o)throw new Error("every entry must have the id property set");n[o]=Un(r,["id"])});return}var a=i.getPopupMenuEntries(e);xt(a)?n=a(n):j(a,function(r,o){n[o]=r})}),n};ut.prototype._getHeaderEntries=function(e,t){var n={};return j(t,function(i){if(!i.getPopupMenuHeaderEntries){if(!i.getHeaderEntries)return;j(i.getHeaderEntries(e),function(r){var o=r.id;if(!o)throw new Error("every entry must have the id property set");n[o]=Un(r,["id"])});return}var a=i.getPopupMenuHeaderEntries(e);xt(a)?n=a(n):j(a,function(r,o){n[o]=r})}),n};ut.prototype._getEntry=function(e){var t=this._current.entries[e];if(!t)throw new Error("entry not found");return t};ut.prototype._emit=function(e){this._eventBus.fire("popupMenu."+e)};ut.prototype._createContainer=function(){var e=Qe('<div class="djs-popup">'),t=this._current.position,n=this._current.className;return q(e.style,{position:"absolute",left:t.x+"px",top:t.y+"px",visibility:"hidden"}),dt(e).add(n),e};ut.prototype._attachContainer=function(e,t,n){var i=this;Ht.bind(e,".entry","click",function(a){i.trigger(a)}),this._updateScale(e),t.appendChild(e),n&&this._assureIsInbounds(e,n)};ut.prototype._updateScale=function(e){var t=this._canvas.zoom(),n=this._config.scale,i,a,r=t;n!==!0&&(n===!1?(i=1,a=1):(i=n.min,a=n.max),Qt(i)&&t<i&&(r=i),Qt(a)&&t>a&&(r=a)),f1(e,"scale("+r+")")};ut.prototype._assureIsInbounds=function(e,t){var n=this._canvas,i=n._container.getBoundingClientRect(),a=e.offsetLeft,r=e.offsetTop,o=e.scrollWidth,s=e.scrollHeight,l={},c,p,f={x:t.x-i.left,y:t.y-i.top};a+o>i.width&&(l.x=!0),r+s>i.height&&(l.y=!0),l.x&&l.y?(c=f.x-o+"px",p=f.y-s+"px"):l.x?(c=f.x-o+"px",p=f.y+"px"):l.y&&f.y<s?(c=f.x+"px",p="10px"):l.y&&(c=f.x+"px",p=f.y-s+"px"),q(e.style,{left:c,top:p},{visibility:"visible","z-index":1e3})};ut.prototype._createEntries=function(e,t){var n=Qe("<div>"),i=this;return dt(n).add(t),j(e,function(a,r){var o=i._createEntry(a,r);n.appendChild(o)}),n};ut.prototype._createEntry=function(e,t){var n=Qe("<div>"),i=dt(n);if(i.add("entry"),e.className&&e.className.split(" ").forEach(function(r){i.add(r)}),Ut(n,iE,t),e.label){var a=Qe("<span>");a.textContent=e.label,n.appendChild(a)}return e.imageUrl&&n.appendChild(Qe('<img src="'+e.imageUrl+'" />')),e.active===!0&&i.add("active"),e.disabled===!0&&i.add("disabled"),e.title&&(n.title=e.title),n};ut.prototype._bindAutoClose=function(){this._eventBus.once(rE,this.close,this)};ut.prototype._unbindAutoClose=function(){this._eventBus.off(rE,this.close,this)};function f1(e,t){e.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){e.style[n+"transform"]=t})}const d1={__init__:["popupMenu"],popupMenu:["type",ut]};function Ia(){}Ia.prototype.get=function(){return this._data};Ia.prototype.set=function(e){this._data=e};Ia.prototype.clear=function(){var e=this._data;return delete this._data,e};Ia.prototype.isEmpty=function(){return!this._data};const h1={clipboard:["type",Ia]};function Op(e){var t=this;this._lastMoveEvent=null;function n(i){t._lastMoveEvent=i}e.on("canvas.init",function(i){var a=t._svg=i.svg;a.addEventListener("mousemove",n)}),e.on("canvas.destroy",function(){t._lastMouseEvent=null,t._svg.removeEventListener("mousemove",n)})}Op.$inject=["eventBus"];Op.prototype.getLastMoveEvent=function(){return this._lastMoveEvent||m1(0,0)};function m1(e,t){var n=document.createEvent("MouseEvent"),i=e,a=t,r=e,o=t;return n.initMouseEvent&&n.initMouseEvent("mousemove",!0,!0,window,0,i,a,r,o,!1,!1,!1,!1,0,null),n}const Na={__init__:["mouse"],mouse:["type",Op]};function xn(e,t,n,i,a,r,o,s){this._canvas=e,this._create=t,this._clipboard=n,this._elementFactory=i,this._eventBus=a,this._modeling=r,this._mouse=o,this._rules=s,a.on("copyPaste.copyElement",function(l){var c=l.descriptor,p=l.element,f=l.elements;c.priority=1,c.id=p.id;var h=Ue(f,function(v){return v===p.parent});h&&(c.parent=p.parent.id),v1(p)&&(c.priority=2,c.host=p.host.id),js(p)&&(c.priority=3,c.source=p.source.id,c.target=p.target.id,c.waypoints=g1(p)),Hs(p)&&(c.priority=4,c.labelTarget=p.labelTarget.id),j(["x","y","width","height"],function(v){Re(p[v])&&(c[v]=p[v])}),c.hidden=p.hidden,c.collapsed=p.collapsed}),a.on("copyPaste.pasteElements",function(l){var c=l.hints;q(c,{createElementsBehavior:!1})})}xn.$inject=["canvas","create","clipboard","elementFactory","eventBus","modeling","mouse","rules"];xn.prototype.copy=function(e){var t,n;return Oe(e)||(e=e?[e]:[]),t=this._eventBus.fire("copyPaste.canCopyElements",{elements:e}),t===!1?n={}:n=this.createTree(Oe(t)?t:e),this._clipboard.set(n),this._eventBus.fire("copyPaste.elementsCopied",{elements:e,tree:n}),n};xn.prototype.paste=function(e){var t=this._clipboard.get();if(!this._clipboard.isEmpty()){var n=e&&e.hints||{};this._eventBus.fire("copyPaste.pasteElements",{hints:n});var i=this._createElements(t);if(e&&e.element&&e.point)return this._paste(i,e.element,e.point,n);this._create.start(this._mouse.getLastMoveEvent(),i,{hints:n||{}})}};xn.prototype._paste=function(e,t,n,i){j(e,function(r){Re(r.x)||(r.x=0),Re(r.y)||(r.y=0)});var a=St(e);return j(e,function(r){js(r)&&(r.waypoints=ht(r.waypoints,function(o){return{x:o.x-a.x-a.width/2,y:o.y-a.y-a.height/2}})),q(r,{x:r.x-a.x-a.width/2,y:r.y-a.y-a.height/2})}),this._modeling.createElements(e,n,t,q({},i))};xn.prototype._createElements=function(e){var t=this,n=this._eventBus,i={},a=[];return j(e,function(r,o){r=nn(r,"priority"),j(r,function(s){var l=q({},Un(s,["priority"]));i[s.parent]?l.parent=i[s.parent]:delete l.parent,n.fire("copyPaste.pasteElement",{cache:i,descriptor:l});var c;if(js(l)){l.source=i[s.source],l.target=i[s.target],c=i[s.id]=t.createConnection(l),a.push(c);return}if(Hs(l)){l.labelTarget=i[l.labelTarget],c=i[s.id]=t.createLabel(l),a.push(c);return}l.host&&(l.host=i[l.host]),c=i[s.id]=t.createShape(l),a.push(c)})}),a};xn.prototype.createConnection=function(e){var t=this._elementFactory.createConnection(Un(e,["id"]));return t};xn.prototype.createLabel=function(e){var t=this._elementFactory.createLabel(Un(e,["id"]));return t};xn.prototype.createShape=function(e){var t=this._elementFactory.createShape(Un(e,["id"]));return t};xn.prototype.hasRelations=function(e,t){var n,i,a;return!(js(e)&&(i=Ue(t,en({id:e.source.id})),a=Ue(t,en({id:e.target.id})),!i||!a)||Hs(e)&&(n=Ue(t,en({id:e.labelTarget.id})),!n))};xn.prototype.createTree=function(e){var t=this._rules,n=this,i={},a=[],r=Ig(e);function o(c,p){return t.allowed("element.copy",{element:c,elements:p})}function s(c,p){var f=Ue(a,function(h){return c===h.element});if(!f){a.push({element:c,depth:p});return}f.depth<p&&(a=l(f,a),a.push({element:f.element,depth:p}))}function l(c,p){var f=p.indexOf(c);return f!==-1&&p.splice(f,1),p}return ji(r,function(c,p,f){if(Hs(c))return;j(c.labels,function(v){s(v,f)});function h(v){v&&v.length&&j(v,function(m){j(m.labels,function(_){s(_,f)}),s(m,f)})}return j([c.attachers,c.incoming,c.outgoing],h),s(c,f),c.children}),e=ht(a,function(c){return c.element}),a=ht(a,function(c){return c.descriptor={},n._eventBus.fire("copyPaste.copyElement",{descriptor:c.descriptor,element:c.element,elements:e}),c}),a=nn(a,function(c){return c.descriptor.priority}),e=ht(a,function(c){return c.element}),j(a,function(c){var p=c.depth;if(!n.hasRelations(c.element,e)){ch(c.element,e);return}if(!o(c.element,e)){ch(c.element,e);return}i[p]||(i[p]=[]),i[p].push(c.descriptor)}),i};function v1(e){return!!e.host}function js(e){return!!e.waypoints}function Hs(e){return!!e.labelTarget}function g1(e){return ht(e.waypoints,function(t){return t=uh(t),t.original&&(t.original=uh(t.original)),t})}function uh(e){return q({},e)}function ch(e,t){var n=t.indexOf(e);return n===-1?t:t.splice(n,1)}const y1={__depends__:[h1,Fs,Na,On],__init__:["copyPaste"],copyPaste:["type",xn]};function wo(e,t,n){Oe(n)||(n=[n]),j(n,function(i){zn(e[i])||(t[i]=e[i])})}function E1(e,t){Oe(t)||(t=[t]),j(t,function(n){e[n]&&delete e[n]})}var b1=750;function aE(e,t,n){t.on("copyPaste.copyElement",b1,function(r){var o=r.descriptor,s=r.element,l=o.oldBusinessObject=he(s);if(o.type=s.type,wo(l,o,"name"),o.di={},wo(l.di,o.di,["fill","stroke","background-color","border-color","color"]),wo(l.di,o,"isExpanded"),ph(o))return o;l.default&&(o.default=l.default.id)}),t.on("moddleCopy.canCopyProperty",function(r){var o=r.parent,s=r.property,l=r.propertyName,c;if(l==="processRef"&&A(o,"bpmn:Participant")&&A(s,"bpmn:Process"))return c=e.create("bpmn:Process"),n.copyElement(s,c)});var i;function a(r,o){var s=he(r);r.default&&(i[r.default]={element:s,property:"default"}),r.host&&(he(r).attachedToRef=he(o[r.host])),i=Un(i,Vt(i,function(l,c,p){var f=c.element,h=c.property;return p===r.id&&(f[h]=s,l.push(r.id)),l},[]))}t.on("copyPaste.pasteElements",function(){i={}}),t.on("copyPaste.pasteElement",function(r){var o=r.cache,s=r.descriptor,l=s.oldBusinessObject,c;if(ph(s)){s.businessObject=he(o[s.labelTarget]);return}c=e.create(l.$type),s.businessObject=n.copyElement(l,c),a(s,o),wo(s,c,["isExpanded","name"]),E1(s,"oldBusinessObject")})}aE.$inject=["bpmnFactory","eventBus","moddleCopy"];function ph(e){return!!e.labelTarget}var x1=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function Ma(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",function(i){var a=i.propertyNames;if(!(!a||!a.length))return nn(a,function(r){return r==="extensionElements"})}),e.on("moddleCopy.canCopyProperty",function(i){var a=i.parent,r=st(a)&&a.$descriptor,o=i.propertyName;if(o&&x1.indexOf(o)!==-1||o&&r&&!Ue(r.properties,en({name:o})))return!1}),e.on("moddleCopy.canSetCopiedProperty",function(i){var a=i.property;if(_1(a,"bpmn:ExtensionElements")&&(!a.values||!a.values.length))return!1})}Ma.$inject=["eventBus","bpmnFactory","moddle"];Ma.prototype.copyElement=function(e,t,n){var i=this;n&&!Oe(n)&&(n=[n]),n=n||jc(e.$descriptor);var a=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return a===!1||(Oe(a)&&(n=a),j(n,function(r){var o;Cn(e,r)&&(o=e.get(r));var s=i.copyProperty(o,t,r),l=i._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:s,propertyName:r});l!==!1&&Qt(s)&&t.set(r,s)})),t};Ma.prototype.copyProperty=function(e,t,n){var i=this,a=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(a!==!1){if(a)return st(a)&&a.$type&&!a.$parent&&(a.$parent=t),a;var r=this._moddle.getPropertyDescriptor(t,n);if(!r.isReference)return r.isId?this._copyId(e,t):Oe(e)?Vt(e,function(o,s){return a=i.copyProperty(s,t,n),a?(a.$parent=t,o.concat(a)):o},[]):st(e)&&e.$type?this._moddle.getElementDescriptor(e).isGeneric?void 0:(a=i._bpmnFactory.create(e.$type),a.$parent=t,a=i.copyElement(e,a),a):e}};Ma.prototype._copyId=function(e,t){if(!this._moddle.ids.assigned(e))return this._moddle.ids.claim(e,t),e};function jc(e,t){return Vt(e.properties,function(n,i){return t&&i.default?n:n.concat(i.name)},[])}function _1(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}const oE={__depends__:[y1],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",aE],moddleCopy:["type",Ma]};var fh=Math.round;function Lp(e){this._modeling=e}Lp.$inject=["modeling"];Lp.prototype.replaceElement=function(e,t,n){if(e.waypoints)return null;var i=this._modeling,a=t.width||e.width,r=t.height||e.height,o=t.x||e.x,s=t.y||e.y,l=fh(o+a/2),c=fh(s+r/2);return i.replaceShape(e,q({},t,{x:l,y:c,width:a,height:r}),n)};const S1={__init__:["replace"],replace:["type",Lp]};function w1(e,t,n){Oe(n)||(n=[n]),j(n,function(i){zn(e[i])||(t[i]=e[i])})}var T1=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function C1(e,t){var n=e&&Cn(e,"collapsed")?e.collapsed:!We(e),i;return t&&(Cn(t,"collapsed")||Cn(t,"isExpanded"))?i=Cn(t,"collapsed")?t.collapsed:!t.isExpanded:i=n,n!==i?(e.collapsed=n,!0):!1}function sE(e,t,n,i,a,r,o){function s(l,c,p){p=p||{};var f=c.type,h=l.businessObject;if(To(h)&&f==="bpmn:SubProcess"&&C1(l,c))return i.toggleCollapse(l),l;var v=e.create(f),m={type:f,businessObject:v},_=jc(h.$descriptor),b=jc(v.$descriptor,!0),M=A1(_,b);q(v,rn(c,T1));var P=Ie(M,function(S){return S==="eventDefinitions"?dh(l,c.eventDefinitionType):S==="loopCharacteristics"?!Gt(v):!(Cn(v,S)||S==="processRef"&&c.isExpanded===!1||S==="triggeredByEvent")});return v=n.copyElement(h,v,P),c.eventDefinitionType&&(dh(v,c.eventDefinitionType)||(m.eventDefinitionType=c.eventDefinitionType,m.eventDefinitionAttrs=c.eventDefinitionAttrs)),A(h,"bpmn:Activity")&&(To(h)?m.isExpanded=We(h):c&&Cn(c,"isExpanded")&&(m.isExpanded=c.isExpanded),We(h)&&!A(h,"bpmn:Task")&&m.isExpanded&&(m.width=l.width,m.height=l.height)),To(h)&&!To(v)&&(p.moveChildren=!1),A(h,"bpmn:Participant")&&(c.isExpanded===!0?v.processRef=e.create("bpmn:Process"):p.moveChildren=!1,m.width=l.width,m.height=t._getDefaultSize(v).height),r.allowed("shape.resize",{shape:v})||(m.height=t._getDefaultSize(v).height,m.width=t._getDefaultSize(v).width),v.name=h.name,je(h,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&je(v,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(v.default=h.default),c.host&&!A(h,"bpmn:BoundaryEvent")&&A(v,"bpmn:BoundaryEvent")&&(m.host=c.host),(m.type==="bpmn:DataStoreReference"||m.type==="bpmn:DataObjectReference")&&(m.x=l.x+(l.width-m.width)/2),m.di={},w1(h.di,m.di,["fill","stroke","background-color","border-color","color"]),m=a.replaceElement(l,m,p),p.select!==!1&&o.select(m),m}this.replaceElement=s}sE.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","rules","selection"];function To(e){return A(e,"bpmn:SubProcess")}function dh(e,t){var n=he(e);return t&&n.get("eventDefinitions").some(function(i){return A(i,t)})}function A1(e,t){return e.filter(function(n){return t.indexOf(n)!==-1})}const lE={__depends__:[oE,S1,Dn],bpmnReplace:["type",sE]};function hh(e){return function(t){var n=t.target,i=he(e),a=i.eventDefinitions&&i.eventDefinitions[0],r=i.$type===n.type,o=(a&&a.$type)===n.eventDefinitionType,s=i.triggeredByEvent===n.triggeredByEvent,l=n.isExpanded===void 0||n.isExpanded===We(i);return!r||!o||!s||!l}}var P1=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],R1=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}}],I1=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition",eventDefinitionAttrs:{name:""}}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],N1=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],M1=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],D1=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}}],k1=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-subprocess",className:"bpmn-icon-event-subprocess-expanded",target:{type:"bpmn:SubProcess",triggeredByEvent:!0,isExpanded:!0}}],O1=[{label:"Sub Process",actionName:"replace-with-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],mh=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-subprocess",className:"bpmn-icon-subprocess-collapsed",target:{type:"bpmn:SubProcess",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-subprocess",className:"bpmn-icon-subprocess-expanded",target:{type:"bpmn:SubProcess",isExpanded:!0}}],L1=[{label:"Data Store Reference",actionName:"replace-with-data-store-reference",className:"bpmn-icon-data-store",target:{type:"bpmn:DataStoreReference"}}],B1=[{label:"Data Object Reference",actionName:"replace-with-data-object-reference",className:"bpmn-icon-data-object",target:{type:"bpmn:DataObjectReference"}}],$1=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],V1=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],F1=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],j1=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:function(e){var t="Empty Pool";return e.children&&e.children.length&&(t+=" (removes content)"),t},actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function un(e,t,n,i,a,r,o){this._bpmnFactory=e,this._popupMenu=t,this._modeling=n,this._moddle=i,this._bpmnReplace=a,this._rules=r,this._translate=o,this.register()}un.$inject=["bpmnFactory","popupMenu","modeling","moddle","bpmnReplace","rules","translate"];un.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)};un.prototype.getEntries=function(e){var t=e.businessObject,n=this._rules,i;if(!n.allowed("shape.replace",{element:e}))return[];var a=hh(e);return A(t,"bpmn:DataObjectReference")?this._createEntries(e,L1):A(t,"bpmn:DataStoreReference")?this._createEntries(e,B1):A(t,"bpmn:StartEvent")&&!A(t.$parent,"bpmn:SubProcess")?(i=Ie(P1,a),this._createEntries(e,i)):A(t,"bpmn:Participant")?(i=Ie(j1,function(r){return We(t)!==r.target.isExpanded}),this._createEntries(e,i)):A(t,"bpmn:StartEvent")&&Gt(t.$parent)?(i=Ie(V1,function(r){var o=r.target,s=o.isInterrupting!==!1,l=he(e).isInterrupting===s;return a(r)||!a(r)&&!l}),this._createEntries(e,i)):A(t,"bpmn:StartEvent")&&!Gt(t.$parent)&&A(t.$parent,"bpmn:SubProcess")?(i=Ie(R1,a),this._createEntries(e,i)):A(t,"bpmn:EndEvent")?(i=Ie(N1,function(r){var o=r.target;return o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!A(t.$parent,"bpmn:Transaction")?!1:a(r)}),this._createEntries(e,i)):A(t,"bpmn:BoundaryEvent")?(i=Ie($1,function(r){var o=r.target;if(o.eventDefinitionType=="bpmn:CancelEventDefinition"&&!A(t.attachedToRef,"bpmn:Transaction"))return!1;var s=o.cancelActivity!==!1,l=t.cancelActivity==s;return a(r)||!a(r)&&!l}),this._createEntries(e,i)):A(t,"bpmn:IntermediateCatchEvent")||A(t,"bpmn:IntermediateThrowEvent")?(i=Ie(I1,a),this._createEntries(e,i)):A(t,"bpmn:Gateway")?(i=Ie(M1,a),this._createEntries(e,i)):A(t,"bpmn:Transaction")?(i=Ie(k1,a),this._createEntries(e,i)):Gt(t)&&We(t)?(i=Ie(O1,a),this._createEntries(e,i)):A(t,"bpmn:SubProcess")&&We(t)?(i=Ie(D1,a),this._createEntries(e,i)):A(t,"bpmn:AdHocSubProcess")&&!We(t)?(i=Ie(mh,function(r){var o=r.target,s=o.type==="bpmn:SubProcess",l=o.isExpanded===!0;return hh(e)&&(!s||l)}),this._createEntries(e,i)):A(t,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,F1):A(t,"bpmn:FlowNode")?(i=Ie(mh,a),A(t,"bpmn:SubProcess")&&!We(t)&&(i=Ie(i,function(r){return r.label!=="Sub Process (collapsed)"})),this._createEntries(e,i)):[]};un.prototype.getHeaderEntries=function(e){var t=[];return A(e,"bpmn:Activity")&&!Gt(e)&&(t=t.concat(this._getLoopEntries(e))),A(e,"bpmn:DataObjectReference")&&(t=t.concat(this._getDataObjectIsCollection(e))),A(e,"bpmn:Participant")&&(t=t.concat(this._getParticipantMultiplicity(e))),A(e,"bpmn:SubProcess")&&!A(e,"bpmn:Transaction")&&!Gt(e)&&t.push(this._getAdHocEntry(e)),t};un.prototype._createEntries=function(e,t){var n=[],i=this;return j(t,function(a){var r=i._createMenuEntry(a,e);n.push(r)}),n};un.prototype._createSequenceFlowEntries=function(e,t){var n=he(e),i=[],a=this._modeling,r=this._moddle,o=this;return j(t,function(s){switch(s.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(A(n.sourceRef,"bpmn:ExclusiveGateway")||A(n.sourceRef,"bpmn:InclusiveGateway")||A(n.sourceRef,"bpmn:ComplexGateway")||A(n.sourceRef,"bpmn:Activity"))&&i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e.source,{default:n})}));break;case"replace-with-conditional-flow":!n.conditionExpression&&A(n.sourceRef,"bpmn:Activity")&&i.push(o._createMenuEntry(s,e,function(){var l=r.create("bpmn:FormalExpression",{body:""});a.updateProperties(e,{conditionExpression:l})}));break;default:if(A(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e,{conditionExpression:void 0})}));if((A(n.sourceRef,"bpmn:ExclusiveGateway")||A(n.sourceRef,"bpmn:InclusiveGateway")||A(n.sourceRef,"bpmn:ComplexGateway")||A(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return i.push(o._createMenuEntry(s,e,function(){a.updateProperties(e.source,{default:void 0})}))}}),i};un.prototype._createMenuEntry=function(e,t,n){var i=this._translate,a=this._bpmnReplace.replaceElement,r=function(){return a(t,e.target)},o=e.label;o&&typeof o=="function"&&(o=o(t)),n=n||r;var s={label:i(o),className:e.className,id:e.actionName,action:n};return s};un.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function i(p,f){var h;f.active?h=void 0:(h=t._moddle.create(f.options.loopCharacteristics),f.options.isSequential&&(h.isSequential=f.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:h})}var a=he(e),r=a.loopCharacteristics,o,s,l;r&&(o=r.isSequential,s=r.isSequential===void 0,l=r.isSequential!==void 0&&!r.isSequential);var c=[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:l,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:o,action:i,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:s,action:i,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}];return c};un.prototype._getDataObjectIsCollection=function(e){var t=this,n=this._translate;function i(s,l){t._modeling.updateModdleProperties(e,a,{isCollection:!l.active})}var a=e.businessObject.dataObjectRef,r=a.isCollection,o=[{id:"toggle-is-collection",className:"bpmn-icon-parallel-mi-marker",title:n("Collection"),active:r,action:i}];return o};un.prototype._getParticipantMultiplicity=function(e){var t=this,n=this._bpmnFactory,i=this._translate;function a(s,l){var c=l.active,p;c||(p=n.create("bpmn:ParticipantMultiplicity")),t._modeling.updateProperties(e,{participantMultiplicity:p})}var r=e.businessObject.participantMultiplicity,o=[{id:"toggle-participant-multiplicity",className:"bpmn-icon-parallel-mi-marker",title:i("Participant Multiplicity"),active:!!r,action:a}];return o};un.prototype._getAdHocEntry=function(e){var t=this._translate,n=he(e),i=A(n,"bpmn:AdHocSubProcess"),a=this._bpmnReplace.replaceElement,r={id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:i,action:function(o,s){return i?a(e,{type:"bpmn:SubProcess"},{autoResize:!1,layoutConnection:!1}):a(e,{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}};return r};const H1={__depends__:[d1,lE],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",un]};var cs=Math.max,ps=Math.min,G1=20;function uE(e,t){return{top:e.top-t.top,right:e.right-t.right,bottom:e.bottom-t.bottom,left:e.left-t.left}}function z1(e,t,n){var i=n.x,a=n.y,r={x:e.x,y:e.y,width:e.width,height:e.height};return t.indexOf("n")!==-1?(r.y=e.y+a,r.height=e.height-a):t.indexOf("s")!==-1&&(r.height=e.height+a),t.indexOf("e")!==-1?r.width=e.width+i:t.indexOf("w")!==-1&&(r.x=e.x+i,r.width=e.width-i),r}function U1(e,t){return{x:e.x+(t.left||0),y:e.y+(t.top||0),width:e.width-(t.left||0)+(t.right||0),height:e.height-(t.top||0)+(t.bottom||0)}}function Co(e,t,n){var i=t[e],a=n.min&&n.min[e],r=n.max&&n.max[e];return Re(a)&&(i=(/top|left/.test(e)?ps:cs)(i,a)),Re(r)&&(i=(/top|left/.test(e)?cs:ps)(i,r)),i}function q1(e,t){if(!t)return e;var n=_e(e);return hp({top:Co("top",n,t),right:Co("right",n,t),bottom:Co("bottom",n,t),left:Co("left",n,t)})}function W1(e,t,n,i){var a=_e(t),r={top:/n/.test(e)?a.bottom-n.height:a.top,left:/w/.test(e)?a.right-n.width:a.left,bottom:/s/.test(e)?a.top+n.height:a.bottom,right:/e/.test(e)?a.left+n.width:a.right},o=i?_e(i):r,s={top:ps(r.top,o.top),left:ps(r.left,o.left),bottom:cs(r.bottom,o.bottom),right:cs(r.right,o.right)};return hp(s)}function Xr(e,t){return typeof e<"u"?e:G1}function Y1(e,t){var n,i,a,r;return typeof t=="object"?(n=Xr(t.left),i=Xr(t.right),a=Xr(t.top),r=Xr(t.bottom)):n=i=a=r=Xr(t),{x:e.x-n,y:e.y-a,width:e.width+n+i,height:e.height+a+r}}function K1(e){return!(e.waypoints||e.type==="label")}function cE(e,t){var n;if(e.length===void 0?n=Ie(e.children,K1):n=e,n.length)return Y1(St(n),t)}var Ao=Math.abs;function X1(e,t){return uE(_e(t),_e(e))}var Z1=["bpmn:Participant","bpmn:Process","bpmn:SubProcess"],ar=30;function Gs(e,t){return t=t||[],e.children.filter(function(n){A(n,"bpmn:Lane")&&(Gs(n,t),t.push(n))}),t}function zi(e){return e.children.filter(function(t){return A(t,"bpmn:Lane")})}function vn(e){return ls(e,Z1)||e}function J1(e,t){var n=vn(e),i=A(n,"bpmn:Process")?[]:[n],a=Gs(n,i),r=_e(e),o=_e(t),s=X1(e,t),l=[];return a.forEach(function(c){if(c!==e){var p=0,f=s.right,h=0,v=s.left,m=_e(c);s.top&&(Ao(m.bottom-r.top)<10&&(h=o.top-m.bottom),Ao(m.top-r.top)<5&&(p=o.top-m.top)),s.bottom&&(Ao(m.top-r.bottom)<10&&(p=o.bottom-m.top),Ao(m.bottom-r.bottom)<5&&(h=o.bottom-m.bottom)),(p||f||h||v)&&l.push({shape:c,newBounds:U1(c,{top:p,right:f,bottom:h,left:v})})}}),l}function Bp(e,t,n,i,a,r,o,s,l,c,p,f){e=e||{},i.registerProvider(this),this._contextPad=i,this._modeling=a,this._elementFactory=r,this._connect=o,this._create=s,this._popupMenu=l,this._canvas=c,this._rules=p,this._translate=f,e.autoPlace!==!1&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,function(h){var v=h.context,m=v.shape;if(!(!mr(h)||!i.isOpen(m))){var _=i.getEntries(m);_.replace&&_.replace.action.click(h,m)}})}Bp.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];Bp.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,i=this._elementFactory,a=this._connect,r=this._create,o=this._popupMenu,s=this._canvas,l=this._rules,c=this._autoPlace,p=this._translate,f={};if(e.type==="label")return f;var h=e.businessObject;function v(w,T){a.start(w,T)}function m(w){n.removeElements([e])}function _(w){var T=5,N=s.getContainer(),B=t.getPad(w).html,$=N.getBoundingClientRect(),H=B.getBoundingClientRect(),Z=H.top-$.top,Y=H.left-$.left,z={x:Y,y:Z+H.height+T};return z}function b(w,T,N,B){typeof N!="string"&&(B=N,N=p("Append {type}",{type:w.replace(/^bpmn:/,"")}));function $(Z,Y){var z=i.createShape(q({type:w},B));r.start(Z,z,{source:Y})}var H=c?function(Z,Y){var z=i.createShape(q({type:w},B));c.append(Y,z)}:$;return{group:"model",className:T,title:N,action:{dragstart:$,click:H}}}function M(w){return function(T,N){n.splitLane(N,w),t.open(N,!0)}}if(je(h,["bpmn:Lane","bpmn:Participant"])&&We(h)){var P=zi(e);q(f,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:p("Add Lane above"),action:{click:function(w,T){n.addLane(T,"top")}}}}),P.length<2&&(e.height>=120&&q(f,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:p("Divide into two Lanes"),action:{click:M(2)}}}),e.height>=180&&q(f,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:p("Divide into three Lanes"),action:{click:M(3)}}})),q(f,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:p("Add Lane below"),action:{click:function(w,T){n.addLane(T,"bottom")}}}})}A(h,"bpmn:FlowNode")&&(A(h,"bpmn:EventBasedGateway")?q(f,{"append.receive-task":b("bpmn:ReceiveTask","bpmn-icon-receive-task",p("Append ReceiveTask")),"append.message-intermediate-event":b("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",p("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":b("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",p("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":b("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",p("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":b("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",p("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):vh(h,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?q(f,{"append.compensation-activity":b("bpmn:Task","bpmn-icon-task",p("Append compensation activity"),{isForCompensation:!0})}):!A(h,"bpmn:EndEvent")&&!h.isForCompensation&&!vh(h,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")&&!Gt(h)&&q(f,{"append.end-event":b("bpmn:EndEvent","bpmn-icon-end-event-none",p("Append EndEvent")),"append.gateway":b("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",p("Append Gateway")),"append.append-task":b("bpmn:Task","bpmn-icon-task",p("Append Task")),"append.intermediate-event":b("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",p("Append Intermediate/Boundary Event"))})),o.isEmpty(e,"bpmn-replace")||q(f,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:p("Change type"),action:{click:function(w,T){var N=q(_(T),{cursor:{x:w.x,y:w.y}});o.open(T,"bpmn-replace",N)}}}}),je(h,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&q(f,{"append.text-annotation":b("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using "+(h.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:v,dragstart:v}}}),A(h,"bpmn:TextAnnotation")&&q(f,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using Association"),action:{click:v,dragstart:v}}}),je(h,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&q(f,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:p("Connect using DataInputAssociation"),action:{click:v,dragstart:v}}}),A(h,"bpmn:Group")&&q(f,{"append.text-annotation":b("bpmn:TextAnnotation","bpmn-icon-text-annotation")});var S=l.allowed("elements.delete",{elements:[e]});return Oe(S)&&(S=S[0]===e),S&&q(f,{delete:{group:"edit",className:"bpmn-icon-trash",title:p("Remove"),action:{click:m}}}),f};function vh(e,t,n){var i=e.$instanceOf(t),a=!1,r=e.eventDefinitions||[];return j(r,function(o){o.$type===n&&(a=!0)}),i&&a}const Q1={__depends__:[eE,e1,Dn,kp,Fs,H1],__init__:["contextPadProvider"],contextPadProvider:["type",Bp]};var eC={horizontal:["x","width"],vertical:["y","height"]},gh=5;function Qn(e){this._modeling=e,this._filters=[],this.registerFilter(function(t,n,i){var a=0,r=0,o;return j(t,function(s){s.waypoints||s.labelTarget||(a+=s[i],r+=1)}),o=Math.round(a/r),Ie(t,function(s){return s[i]<o+50})})}Qn.$inject=["modeling"];Qn.prototype.registerFilter=function(e){if(typeof e!="function")throw new Error("the filter has to be a function");this._filters.push(e)};Qn.prototype.trigger=function(e,t){var n=this._modeling,i,a;if(!(e.length<3)&&(this._setOrientation(t),a=this._filterElements(e),i=this._createGroups(a),!(i.length<=2)))return n.distributeElements(i,this._axis,this._dimension),i};Qn.prototype._filterElements=function(e){var t=this._filters,n=this._axis,i=this._dimension,a=[].concat(e);return t.length?(j(t,function(r){a=r(a,n,i)}),a):e};Qn.prototype._createGroups=function(e){var t=[],n=this,i=this._axis,a=this._dimension;if(!i)throw new Error('must have a defined "axis" and "dimension"');var r=nn(e,i);return j(r,function(o,s){var l=n._findRange(o,i,a),c,p=t[t.length-1];p&&n._hasIntersection(p.range,l)?t[t.length-1].elements.push(o):(c={range:l,elements:[o]},t.push(c))}),t};Qn.prototype._setOrientation=function(e){var t=eC[e];this._axis=t[0],this._dimension=t[1]};Qn.prototype._hasIntersection=function(e,t){return Math.max(e.min,e.max)>=Math.min(t.min,t.max)&&Math.min(e.min,e.max)<=Math.max(t.min,t.max)};Qn.prototype._findRange=function(e){var t=e[this._axis],n=e[this._dimension];return{min:t+gh,max:t+n-gh}};const tC={__init__:["distributeElements"],distributeElements:["type",Qn]};function pE(e){e.registerFilter(function(t){return Ie(t,function(n){var i=je(n,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(n.labelTarget||i)})})}pE.$inject=["distributeElements"];const nC={__depends__:[tC],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",pE]};var fE="is not a registered action",iC="is already registered";function cn(e,t){this._actions={};var n=this;e.on("diagram.init",function(){n._registerDefaultActions(t),e.fire("editorActions.init",{editorActions:n})})}cn.$inject=["eventBus","injector"];cn.prototype._registerDefaultActions=function(e){var t=e.get("commandStack",!1),n=e.get("modeling",!1),i=e.get("selection",!1),a=e.get("zoomScroll",!1),r=e.get("copyPaste",!1),o=e.get("canvas",!1),s=e.get("rules",!1),l=e.get("keyboardMove",!1),c=e.get("keyboardMoveSelection",!1);t&&(this.register("undo",function(){t.undo()}),this.register("redo",function(){t.redo()})),r&&i&&this.register("copy",function(){var p=i.get();r.copy(p)}),r&&this.register("paste",function(){r.paste()}),a&&this.register("stepZoom",function(p){a.stepZoom(p.value)}),o&&this.register("zoom",function(p){o.zoom(p.value)}),n&&i&&s&&this.register("removeSelection",function(){var p=i.get();if(p.length){var f=s.allowed("elements.delete",{elements:p}),h;f!==!1&&(Oe(f)?h=f:h=p,h.length&&n.removeElements(h.slice()))}}),l&&this.register("moveCanvas",function(p){l.moveCanvas(p)}),c&&this.register("moveSelection",function(p){c.moveSelection(p.direction,p.accelerated)})};cn.prototype.trigger=function(e,t){if(!this._actions[e])throw $p(e,fE);return this._actions[e](t)};cn.prototype.register=function(e,t){var n=this;if(typeof e=="string")return this._registerAction(e,t);j(e,function(i,a){n._registerAction(a,i)})};cn.prototype._registerAction=function(e,t){if(this.isRegistered(e))throw $p(e,iC);this._actions[e]=t};cn.prototype.unregister=function(e){if(!this.isRegistered(e))throw $p(e,fE);this._actions[e]=void 0};cn.prototype.getActions=function(){return Object.keys(this._actions)};cn.prototype.isRegistered=function(e){return!!this._actions[e]};function $p(e,t){return new Error(e+" "+t)}const rC={__init__:["editorActions"],editorActions:["type",cn]};function zs(e){e.invoke(cn,this)}ye(zs,cn);zs.$inject=["injector"];zs.prototype._registerDefaultActions=function(e){cn.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),i=e.get("selection",!1),a=e.get("spaceTool",!1),r=e.get("lassoTool",!1),o=e.get("handTool",!1),s=e.get("globalConnect",!1),l=e.get("distributeElements",!1),c=e.get("alignElements",!1),p=e.get("directEditing",!1),f=e.get("searchPad",!1),h=e.get("modeling",!1);t&&n&&i&&this._registerAction("selectElements",function(){var v=t.getRootElement(),m=n.filter(function(_){return _!==v});return i.select(m),m}),a&&this._registerAction("spaceTool",function(){a.toggle()}),r&&this._registerAction("lassoTool",function(){r.toggle()}),o&&this._registerAction("handTool",function(){o.toggle()}),s&&this._registerAction("globalConnectTool",function(){s.toggle()}),i&&l&&this._registerAction("distributeElements",function(v){var m=i.get(),_=v.type;m.length&&l.trigger(m,_)}),i&&c&&this._registerAction("alignElements",function(v){var m=i.get(),_=[],b=v.type;m.length&&(_=Ie(m,function(M){return!A(M,"bpmn:Lane")}),c.trigger(_,b))}),i&&h&&this._registerAction("setColor",function(v){var m=i.get();m.length&&h.setColor(m,v)}),i&&p&&this._registerAction("directEditing",function(){var v=i.get();v.length&&p.activate(v[0])}),f&&this._registerAction("find",function(){f.toggle()}),t&&h&&this._registerAction("moveToOrigin",function(){var v=t.getRootElement(),m,_;A(v,"bpmn:Collaboration")?_=n.filter(function(b){return A(b.parent,"bpmn:Collaboration")}):_=n.filter(function(b){return b!==v&&!A(b.parent,"bpmn:SubProcess")}),m=St(_),h.moveElements(_,{x:-m.x,y:-m.y},v)})};const aC={__depends__:[rC],editorActions:["type",zs]};function dE(e){e.on(["create.init","shape.move.init"],function(t){var n=t.context,i=t.shape;je(i,["bpmn:Participant","bpmn:SubProcess","bpmn:TextAnnotation"])&&(n.gridSnappingContext||(n.gridSnappingContext={}),n.gridSnappingContext.snapLocation="top-left")})}dE.$inject=["eventBus"];var Zo=10;function Bl(e,t,n){return n||(n="round"),Math[n](e/t)*t}var oC=1200,sC=800;function gi(e,t,n){var i=!n||n.active!==!1;this._eventBus=t;var a=this;t.on("diagram.init",sC,function(){a.setActive(i)}),t.on(["create.move","create.end","bendpoint.move.move","bendpoint.move.end","connect.move","connect.end","connectionSegment.move.move","connectionSegment.move.end","resize.move","resize.end","shape.move.move","shape.move.end"],oC,function(r){var o=r.originalEvent;if(!(!a.active||o&&zt(o))){var s=r.context,l=s.gridSnappingContext;l||(l=s.gridSnappingContext={}),["x","y"].forEach(function(c){var p={},f=uC(r,c,e);f&&(p.offset=f);var h=lC(r,c);h&&q(p,h),vr(r,c)||a.snapEvent(r,c,p)})}})}gi.prototype.snapEvent=function(e,t,n){var i=this.snapValue(e[t],n);ft(e,t,i)};gi.prototype.getGridSpacing=function(){return Zo};gi.prototype.snapValue=function(e,t){var n=0;t&&t.offset&&(n=t.offset),e+=n,e=Bl(e,Zo);var i,a;return t&&t.min&&(i=t.min,Re(i)&&(i=Bl(i+n,Zo,"ceil"),e=Math.max(e,i))),t&&t.max&&(a=t.max,Re(a)&&(a=Bl(a+n,Zo,"floor"),e=Math.min(e,a))),e-=n,e};gi.prototype.isActive=function(){return this.active};gi.prototype.setActive=function(e){this.active=e,this._eventBus.fire("gridSnapping.toggle",{active:e})};gi.prototype.toggleActive=function(){this.setActive(!this.active)};gi.$inject=["elementRegistry","eventBus","config.gridSnapping"];function lC(e,t){var n=e.context,i=n.createConstraints,a=n.resizeConstraints||{},r=n.gridSnappingContext,o=r.snapConstraints;if(o&&o[t])return o[t];o||(o=r.snapConstraints={}),o[t]||(o[t]={});var s=n.direction;i&&(Jo(t)?(o.x.min=i.left,o.x.max=i.right):(o.y.min=i.top,o.y.max=i.bottom));var l=a.min,c=a.max;return l&&(Jo(t)?Eh(s)?o.x.max=l.left:o.x.min=l.right:yh(s)?o.y.max=l.top:o.y.min=l.bottom),c&&(Jo(t)?Eh(s)?o.x.min=c.left:o.x.max=c.right:yh(s)?o.y.min=c.top:o.y.max=c.bottom),o[t]}function uC(e,t,n){var i=e.context,a=e.shape,r=i.gridSnappingContext,o=r.snapLocation,s=r.snapOffset;return s&&Re(s[t])||(s||(s=r.snapOffset={}),Re(s[t])||(s[t]=0),!a)||(n.get(a.id)||(Jo(t)?s[t]+=a[t]+a.width/2:s[t]+=a[t]+a.height/2),!o)||(t==="x"?/left/.test(o)?s[t]-=a.width/2:/right/.test(o)&&(s[t]+=a.width/2):/top/.test(o)?s[t]-=a.height/2:/bottom/.test(o)&&(s[t]+=a.height/2)),s[t]}function Jo(e){return e==="x"}function yh(e){return e.indexOf("n")!==-1}function Eh(e){return e.indexOf("w")!==-1}function Ui(e,t){pe.call(this,e),this._gridSnapping=t;var n=this;this.preExecute("shape.resize",function(i){var a=i.context,r=a.hints||{},o=r.autoResize;if(o){var s=a.shape,l=a.newBounds;$t(o)?a.newBounds=n.snapComplex(l,o):a.newBounds=n.snapSimple(s,l)}})}Ui.$inject=["eventBus","gridSnapping","modeling"];ye(Ui,pe);Ui.prototype.snapSimple=function(e,t){var n=this._gridSnapping;return t.width=n.snapValue(t.width,{min:t.width}),t.height=n.snapValue(t.height,{min:t.height}),t.x=e.x+e.width/2-t.width/2,t.y=e.y+e.height/2-t.height/2,t};Ui.prototype.snapComplex=function(e,t){return/w|e/.test(t)&&(e=this.snapHorizontally(e,t)),/n|s/.test(t)&&(e=this.snapVertically(e,t)),e};Ui.prototype.snapHorizontally=function(e,t){var n=this._gridSnapping,i=/w/.test(t),a=/e/.test(t),r={};return r.width=n.snapValue(e.width,{min:e.width}),a&&(i?(r.x=n.snapValue(e.x,{max:e.x}),r.width+=n.snapValue(e.x-r.x,{min:e.x-r.x})):e.x=e.x+e.width-r.width),q(e,r),e};Ui.prototype.snapVertically=function(e,t){var n=this._gridSnapping,i=/n/.test(t),a=/s/.test(t),r={};return r.height=n.snapValue(e.height,{min:e.height}),i&&(a?(r.y=n.snapValue(e.y,{max:e.y}),r.height+=n.snapValue(e.y-r.y,{min:e.y-r.y})):e.y=e.y+e.height-r.height),q(e,r),e};var cC=2e3;function hE(e,t){e.on(["spaceTool.move","spaceTool.end"],cC,function(n){var i=n.context;if(i.initialized){var a=i.axis,r;a==="x"?(r=t.snapValue(n.dx),n.x=n.x+r-n.dx,n.dx=r):(r=t.snapValue(n.dy),n.y=n.y+r-n.dy,n.dy=r)}})}hE.$inject=["eventBus","gridSnapping"];const pC={__init__:["gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior"],gridSnappingResizeBehavior:["type",Ui],gridSnappingSpaceToolBehavior:["type",hE]},fC={__depends__:[pC],__init__:["gridSnapping"],gridSnapping:["type",gi]};var dC=2e3;function mE(e,t){e.on("autoPlace",dC,function(n){var i=n.source,a=Me(i),r=n.shape,o=Ly(i,r);return["x","y"].forEach(function(s){var l={};o[s]!==a[s]&&(o[s]>a[s]?l.min=o[s]:l.max=o[s],A(r,"bpmn:TextAnnotation")&&(hC(s)?l.offset=-r.width/2:l.offset=-r.height/2),o[s]=t.snapValue(o[s],l))}),o})}mE.$inject=["eventBus","gridSnapping"];function hC(e){return e==="x"}var mC=1750;function vE(e,t,n){t.on(["create.start","shape.move.start"],mC,function(i){var a=i.context,r=a.shape,o=e.getRootElement();if(!(!A(r,"bpmn:Participant")||!A(o,"bpmn:Process")||!o.children.length)){var s=a.createConstraints;s&&(r.width=n.snapValue(r.width,{min:r.width}),r.height=n.snapValue(r.height,{min:r.height}))}})}vE.$inject=["canvas","eventBus","gridSnapping"];var vC=3e3;function Us(e,t,n){pe.call(this,e),this._gridSnapping=t;var i=this;this.postExecuted(["connection.create","connection.layout"],vC,function(a){var r=a.context,o=r.connection,s=r.hints||{},l=o.waypoints;s.connectionStart||s.connectionEnd||s.createElementsBehavior===!1||gC(l)&&n.updateWaypoints(o,i.snapMiddleSegments(l))})}Us.$inject=["eventBus","gridSnapping","modeling"];ye(Us,pe);Us.prototype.snapMiddleSegments=function(e){var t=this._gridSnapping,n;e=e.slice();for(var i=1;i<e.length-2;i++)n=bC(t,e[i],e[i+1]),e[i]=n[0],e[i+1]=n[1];return e};function gC(e){return e.length>3}function yC(e){return e==="h"}function EC(e){return e==="v"}function bC(e,t,n){var i=jn(t,n),a={};return yC(i)&&(a.y=e.snapValue(t.y)),EC(i)&&(a.x=e.snapValue(t.x)),("x"in a||"y"in a)&&(t=q({},t,a),n=q({},n,a)),[t,n]}const xC={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",mE],gridSnappingCreateParticipantBehavior:["type",vE],gridSnappingLayoutConnectionBehavior:["type",Us]},_C={__depends__:[fC,xC],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",dE]};var SC=30,wC=30;function Da(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],function(i){var a=i.element,r=i.gfx;if(A(a,"bpmn:Lane"))return n.createParticipantHit(a,r);if(A(a,"bpmn:Participant"))return We(a)?n.createParticipantHit(a,r):n.createDefaultHit(a,r);if(A(a,"bpmn:SubProcess"))return We(a)?n.createSubProcessHit(a,r):n.createDefaultHit(a,r)})}Da.$inject=["eventBus","interactionEvents"];Da.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0};Da.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:SC,height:e.height}),!0};Da.prototype.createSubProcessHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:wC}),!0};const TC={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",Da]};function qs(e){e.invoke(Ir,this)}ye(qs,Ir);qs.$inject=["injector"];qs.prototype.registerBindings=function(e,t){Ir.prototype.registerBindings.call(this,e,t);function n(i,a){t.isRegistered(i)&&e.addListener(a)}n("selectElements",function(i){var a=i.keyEvent;if(e.isKey(["a","A"],a)&&e.isCmd(a))return t.trigger("selectElements"),!0}),n("find",function(i){var a=i.keyEvent;if(e.isKey(["f","F"],a)&&e.isCmd(a))return t.trigger("find"),!0}),n("spaceTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["s","S"],a))return t.trigger("spaceTool"),!0}),n("lassoTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["l","L"],a))return t.trigger("lassoTool"),!0}),n("handTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["h","H"],a))return t.trigger("handTool"),!0}),n("globalConnectTool",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["c","C"],a))return t.trigger("globalConnectTool"),!0}),n("directEditing",function(i){var a=i.keyEvent;if(!e.hasModifier(a)&&e.isKey(["e","E"],a))return t.trigger("directEditing"),!0})};const CC={__depends__:[Cp],__init__:["keyboardBindings"],keyboardBindings:["type",qs]};var AC={moveSpeed:1,moveSpeedAccelerated:10},PC=1500,bh="left",xh="up",_h="right",Sh="down",RC={ArrowLeft:bh,Left:bh,ArrowUp:xh,Up:xh,ArrowRight:_h,Right:_h,ArrowDown:Sh,Down:Sh},IC={left:function(e){return{x:-e,y:0}},up:function(e){return{x:0,y:-e}},right:function(e){return{x:e,y:0}},down:function(e){return{x:0,y:e}}};function gE(e,t,n,i,a){var r=this;this._config=q({},AC,e||{}),t.addListener(PC,function(o){var s=o.keyEvent,l=RC[s.key];if(l&&!t.isCmd(s)){var c=t.isShift(s);return r.moveSelection(l,c),!0}}),this.moveSelection=function(o,s){var l=a.get();if(l.length){var c=this._config[s?"moveSpeedAccelerated":"moveSpeed"],p=IC[o](c),f=i.allowed("elements.move",{shapes:l});f&&n.moveElements(l,p)}}}gE.$inject=["config.keyboardMoveSelection","keyboard","modeling","rules","selection"];const NC={__depends__:[Cp,Dn],__init__:["keyboardMoveSelection"],keyboardMoveSelection:["type",gE]};function yE(e,t,n,i){e.on("element.changed",function(a){var r=a.element;(r.parent||r===t.getRootElement())&&(a.gfx=n.getGraphics(r)),a.gfx&&e.fire(Mg(r)+".changed",a)}),e.on("elements.changed",function(a){var r=a.elements;r.forEach(function(o){e.fire("element.changed",{element:o})}),i.updateContainments(r)}),e.on("shape.changed",function(a){i.update("shape",a.element,a.gfx)}),e.on("connection.changed",function(a){i.update("connection",a.element,a.gfx)})}yE.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];const EE={__init__:["changeSupport"],changeSupport:["type",yE]};var wh=10;function ka(e,t,n,i){this._dragging=i,this._rules=t;var a=this;function r(l,c){var p=l.shape,f=l.direction,h=l.resizeConstraints,v;l.delta=c,v=z1(p,f,c),l.newBounds=q1(v,h),l.canExecute=a.canResize(l)}function o(l){var c=l.resizeConstraints,p=l.minBounds;c===void 0&&(p===void 0&&(p=a.computeMinResizeBox(l)),l.resizeConstraints={min:_e(p)})}function s(l){var c=l.shape,p=l.canExecute,f=l.newBounds;if(p){if(f=Lg(f),!MC(c,f))return;n.resizeShape(c,f)}}e.on("resize.start",function(l){o(l.context)}),e.on("resize.move",function(l){var c={x:l.dx,y:l.dy};r(l.context,c)}),e.on("resize.end",function(l){s(l.context)})}ka.prototype.canResize=function(e){var t=this._rules,n=rn(e,["newBounds","shape","delta","direction"]);return t.allowed("shape.resize",n)};ka.prototype.activate=function(e,t,n){var i=this._dragging,a,r;if(typeof n=="string"&&(n={direction:n}),a=q({shape:t},n),r=a.direction,!r)throw new Error("must provide a direction (n|w|s|e|nw|se|ne|sw)");i.init(e,bE(t,r),"resize",{autoActivate:!0,cursor:DC(r),data:{shape:t,context:a}})};ka.prototype.computeMinResizeBox=function(e){var t=e.shape,n=e.direction,i,a;return i=e.minDimensions||{width:wh,height:wh},a=cE(t,e.childrenBoxPadding),W1(n,t,i,a)};ka.$inject=["eventBus","rules","modeling","dragging"];function MC(e,t){return e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height}function bE(e,t){var n=Me(e),i=_e(e),a={x:n.x,y:n.y};return t.indexOf("n")!==-1?a.y=i.top:t.indexOf("s")!==-1&&(a.y=i.bottom),t.indexOf("e")!==-1?a.x=i.right:t.indexOf("w")!==-1&&(a.x=i.left),a}function DC(e){var t="resize-";return e==="n"||e==="s"?t+"ns":e==="e"||e==="w"?t+"ew":e==="nw"||e==="se"?t+"nwse":t+"nesw"}var Th="djs-resizing",Ch="resize-not-ok",kC=500;function xE(e,t,n){function i(r){var o=r.shape,s=r.newBounds,l=r.frame;l||(l=r.frame=n.addFrame(o,t.getActiveLayer()),t.addMarker(o,Th)),s.width>5&&ae(l,{x:s.x,width:s.width}),s.height>5&&ae(l,{y:s.y,height:s.height}),r.canExecute?Le(l).remove(Ch):Le(l).add(Ch)}function a(r){var o=r.shape,s=r.frame;s&&ot(r.frame),t.removeMarker(o,Th)}e.on("resize.move",kC,function(r){i(r.context)}),e.on("resize.cleanup",function(r){a(r.context)})}xE.$inject=["eventBus","canvas","previewSupport"];var Ah=-6,Ph=4,Rh=20,Zr="djs-resizer",OC=["n","w","s","e","nw","ne","se","sw"];function yi(e,t,n,i){this._resize=i,this._canvas=t;var a=this;e.on("selection.changed",function(r){var o=r.newSelection;a.removeResizers(),o.length===1&&j(o,Pt(a.addResizer,a))}),e.on("shape.changed",function(r){var o=r.element;n.isSelected(o)&&(a.removeResizers(),a.addResizer(o))})}yi.prototype.makeDraggable=function(e,t,n){var i=this._resize;function a(r){mi(r)&&i.activate(r,e,n)}Se.bind(t,"mousedown",a),Se.bind(t,"touchstart",a)};yi.prototype._createResizer=function(e,t,n,i){var a=this._getResizersParent(),r=LC(i),o=be("g");Le(o).add(Zr),Le(o).add(Zr+"-"+e.id),Le(o).add(Zr+"-"+i),Ce(a,o);var s=be("rect");ae(s,{x:-4/2+r.x,y:-4/2+r.y,width:Ph,height:Ph}),Le(s).add(Zr+"-visual"),Ce(o,s);var l=be("rect");return ae(l,{x:-20/2+r.x,y:-20/2+r.y,width:Rh,height:Rh}),Le(l).add(Zr+"-hit"),Ce(o,l),Ic(o,t,n),o};yi.prototype.createResizer=function(e,t){var n=bE(e,t),i=this._createResizer(e,n.x,n.y,t);this.makeDraggable(e,i,t)};yi.prototype.addResizer=function(e){var t=this,n=this._resize;n.canResize({shape:e})&&j(OC,function(i){t.createResizer(e,i)})};yi.prototype.removeResizers=function(){var e=this._getResizersParent();Tg(e)};yi.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")};yi.$inject=["eventBus","canvas","selection","resize"];function LC(e){var t={x:0,y:0};return e.indexOf("e")!==-1?t.x=6:e.indexOf("w")!==-1&&(t.x=Ah),e.indexOf("s")!==-1?t.y=6:e.indexOf("n")!==-1&&(t.y=Ah),t}const _E={__depends__:[On,Zn,Ra],__init__:["resize","resizePreview","resizeHandles"],resize:["type",ka],resizePreview:["type",xE],resizeHandles:["type",yi]};function Hc(e,t){var n=t.create("bpmn:CategoryValue"),i=t.create("bpmn:Category",{categoryValue:[n]});return at(e.get("rootElements"),i),he(i).$parent=e,he(n).$parent=i,n}function Oa(e,t,n,i,a,r,o){this._bpmnFactory=t,this._canvas=n,this._modeling=a,this._textRenderer=o,i.registerProvider(this),e.on("element.dblclick",function(l){s(l.element,!0)}),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],function(l){i.isActive()&&i.complete()}),e.on(["commandStack.changed"],function(l){i.isActive()&&i.cancel()}),e.on("directEditing.activate",function(l){r.removeResizers()}),e.on("create.end",500,function(l){var c=l.context,p=c.shape,f=l.context.canExecute,h=l.isTouch;h||f&&(c.hints&&c.hints.createElementsBehavior===!1||s(p))}),e.on("autoPlace.end",500,function(l){s(l.shape)});function s(l,c){(c||je(l,["bpmn:Task","bpmn:TextAnnotation"])||Vp(l))&&i.activate(l)}}Oa.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"];Oa.prototype.activate=function(e){var t=En(e);if(t!==void 0){var n={text:t},i=this.getEditingBBox(e);q(n,i);var a={};return(je(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Vp(e))&&q(a,{centerVertically:!0}),hr(e)&&q(a,{autoResize:!0}),A(e,"bpmn:TextAnnotation")&&q(a,{resizable:!0,autoResize:!0}),q(n,{options:a}),n}};Oa.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,i=t.getAbsoluteBBox(n),a={x:i.x+i.width/2,y:i.y+i.height/2},r={x:i.x,y:i.y},o=t.zoom(),s=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),c=l.fontSize*o,p=l.lineHeight,f=s.fontSize*o,h=s.lineHeight,v={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(A(e,"bpmn:Lane")||VC(e))&&(q(r,{width:i.height,height:30*o,x:i.x-i.height/2+15*o,y:a.y-30*o/2}),q(v,{fontSize:f+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px",transform:"rotate(-90deg)"})),(je(e,["bpmn:Task","bpmn:CallActivity"])||$C(e)||Vp(e))&&(q(r,{width:i.width,height:i.height}),q(v,{fontSize:f+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"})),BC(e)&&(q(r,{width:i.width,x:i.x}),q(v,{fontSize:f+"px",lineHeight:h,paddingTop:7*o+"px",paddingBottom:7*o+"px",paddingLeft:5*o+"px",paddingRight:5*o+"px"}));var m=90*o,_=7*o,b=4*o;if(n.labelTarget&&(q(r,{width:m,height:i.height+_+b,x:a.x-m/2,y:i.y-_}),q(v,{fontSize:c+"px",lineHeight:p,paddingTop:_+"px",paddingBottom:b+"px"})),hr(n)&&!Ds(n)&&!_t(n)){var M=ks(e),P=t.getAbsoluteBBox({x:M.x,y:M.y,width:0,height:0}),S=c+_+b;q(r,{width:m,height:S,x:P.x-m/2,y:P.y-S/2}),q(v,{fontSize:c+"px",lineHeight:p,paddingTop:_+"px",paddingBottom:b+"px"})}return A(e,"bpmn:TextAnnotation")&&(q(r,{width:i.width,height:i.height,minWidth:30*o,minHeight:10*o}),q(v,{textAlign:"left",paddingTop:5*o+"px",paddingBottom:7*o+"px",paddingLeft:7*o+"px",paddingRight:5*o+"px",fontSize:f+"px",lineHeight:h})),{bounds:r,style:v}};Oa.prototype.update=function(e,t,n,i){var a,r;if(A(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),a={x:e.x,y:e.y,width:e.width/r.width*i.width,height:e.height/r.height*i.height}),A(e,"bpmn:Group")){var o=he(e);if(!o.categoryValueRef){var s=this._canvas.getRootElement(),l=he(s).$parent,c=Hc(l,this._bpmnFactory);he(e).categoryValueRef=c}}FC(t)&&(t=null),this._modeling.updateLabel(e,t,a)};function Vp(e){return A(e,"bpmn:SubProcess")&&!We(e)}function BC(e){return A(e,"bpmn:SubProcess")&&We(e)}function $C(e){return A(e,"bpmn:Participant")&&!We(e)}function VC(e){return A(e,"bpmn:Participant")&&We(e)}function FC(e){return!e||!e.trim()}var Ih="djs-element-hidden",Nh="djs-label-hidden";function SE(e,t,n,i){var a=this,r=t.getDefaultLayer(),o,s,l;e.on("directEditing.activate",function(c){var p=c.active;if(o=p.element.label||p.element,A(o,"bpmn:TextAnnotation")){s=t.getAbsoluteBBox(o),l=be("g");var f=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:o.height,position:{mx:0,my:0}}),h=a.path=be("path");ae(h,{d:f,strokeWidth:2,stroke:jC(o)}),Ce(l,h),Ce(r,l),Bt(l,o.x,o.y)}A(o,"bpmn:TextAnnotation")||o.labelTarget?t.addMarker(o,Ih):(A(o,"bpmn:Task")||A(o,"bpmn:CallActivity")||A(o,"bpmn:SubProcess")||A(o,"bpmn:Participant"))&&t.addMarker(o,Nh)}),e.on("directEditing.resize",function(c){if(A(o,"bpmn:TextAnnotation")){var p=c.height,f=c.dy,h=Math.max(o.height/s.height*(p+f),0),v=i.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:o.width,containerHeight:h,position:{mx:0,my:0}});ae(a.path,{d:v})}}),e.on(["directEditing.complete","directEditing.cancel"],function(c){var p=c.active;p&&(t.removeMarker(p.element.label||p.element,Ih),t.removeMarker(o,Nh)),o=void 0,s=void 0,l&&(ot(l),l=void 0)})}SE.$inject=["eventBus","canvas","elementRegistry","pathMap"];function jC(e,t){var n=he(e);return n.di.get("stroke")||t||"black"}const HC={__depends__:[EE,_E,eE],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",Oa],labelEditingPreview:["type",SE]};var Fp=["top","bottom","left","right"],Po=10;function jp(e,t){pe.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],function(a){var r=a.context,o=r.connection,s=o.source,l=o.target,c=r.hints||{};c.createElementsBehavior!==!1&&(n(s),n(l))}),this.postExecuted(["label.create"],function(a){var r=a.context,o=r.shape,s=r.hints||{};s.createElementsBehavior!==!1&&n(o.labelTarget)}),this.postExecuted(["elements.create"],function(a){var r=a.context,o=r.elements,s=r.hints||{};s.createElementsBehavior!==!1&&o.forEach(function(l){n(l)})});function n(a){if(Ds(a)){var r=UC(a);r&&i(a,r)}}function i(a,r){var o=Me(a),s=a.label,l=Me(s);if(s.parent){var c=_e(a),p;switch(r){case"top":p={x:o.x,y:c.top-Po-s.height/2};break;case"left":p={x:c.left-Po-s.width/2,y:o.y};break;case"bottom":p={x:o.x,y:c.bottom+Po+s.height/2};break;case"right":p={x:c.right+Po+s.width/2,y:o.y};break}var f=Pn(p,l);t.moveShape(s,f)}}}ye(jp,pe);jp.$inject=["eventBus","modeling"];function GC(e){var t=e.host,n=Me(e),i=wt(n,t),a;i.indexOf("-")>=0?a=i.split("-"):a=[i];var r=Fp.filter(function(o){return a.indexOf(o)===-1});return r}function zC(e){var t=Me(e),n=[].concat(e.incoming.map(function(i){return i.waypoints[i.waypoints.length-2]}),e.outgoing.map(function(i){return i.waypoints[1]})).map(function(i){return wE(t,i)});return n}function UC(e){var t=Me(e.label),n=Me(e),i=wE(n,t);if(qC(i)){var a=zC(e);if(e.host){var r=GC(e);a=a.concat(r)}var o=Fp.filter(function(s){return a.indexOf(s)===-1});if(o.indexOf(i)===-1)return o[0]}}function wE(e,t){return wt(t,e,5)}function qC(e){return Fp.indexOf(e)!==-1}function Hp(e,t,n){pe.call(this,e),this.preExecute("shape.append",function(i){var a=i.source,r=i.shape;i.position||(A(r,"bpmn:TextAnnotation")?i.position={x:a.x+a.width/2+75,y:a.y-50-r.height/2}:i.position={x:a.x+a.width+80+r.width/2,y:a.y+a.height/2})},!0)}ye(Hp,pe);Hp.$inject=["eventBus","elementFactory","bpmnRules"];function Gp(e,t){e.invoke(pe,this),this.postExecute("shape.move",function(n){var i=n.newParent,a=n.shape,r=Ie(a.incoming.concat(a.outgoing),function(o){return A(o,"bpmn:Association")});j(r,function(o){t.moveConnection(o,{x:0,y:0},i)})},!0)}ye(Gp,pe);Gp.$inject=["injector","modeling"];var Mh=500;function Ws(e,t){t.invoke(pe,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",Mh,function(i){var a=i.elements;a=a.filter(function(r){var o=r.host;return Dh(r,o)}),a.length===1&&a.map(function(r){return a.indexOf(r)}).forEach(function(r){var o=a[r];i.elements[r]=n.replaceShape(a[r],o)})},!0),this.preExecute("elements.move",Mh,function(i){var a=i.shapes,r=i.newHost;if(a.length===1){var o=a[0];Dh(o,r)&&(i.shapes=[n.replaceShape(o,r)])}},!0)}Ws.$inject=["bpmnReplace","injector"];ye(Ws,pe);Ws.prototype.replaceShape=function(e,t){var n=WC(e),i={type:"bpmn:BoundaryEvent",host:t};return n&&(i.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,i,{layoutConnection:!1})};function WC(e){var t=he(e),n=t.eventDefinitions;return n&&n[0]}function Dh(e,t){return!_t(e)&&je(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}var YC=2e3;function zp(e,t,n){pe.call(this,e);function i(a){return Ie(a.attachers,function(r){return A(r,"bpmn:BoundaryEvent")})}this.postExecute("connection.create",function(a){var r=a.context.source,o=a.context.target,s=i(o);A(r,"bpmn:EventBasedGateway")&&A(o,"bpmn:ReceiveTask")&&s.length>0&&n.removeElements(s)}),this.postExecute("connection.reconnect",function(a){var r=a.context.oldSource,o=a.context.newSource;A(r,"bpmn:Gateway")&&A(o,"bpmn:EventBasedGateway")&&j(o.outgoing,function(s){var l=s.target,c=i(l);A(l,"bpmn:ReceiveTask")&&c.length>0&&n.removeElements(c)})}),e.on("moddleCopy.canCopyProperty",YC,function(a){var r=a.parent,o=a.property,s=a.propertyName,l=t.getPropertyDescriptor(r,s);l&&l.isReference&&A(o,"bpmn:RootElement")&&r.set(s,o)})}zp.$inject=["eventBus","moddle","modeling"];ye(zp,pe);var KC=500;function Up(e,t,n,i,a){n.invoke(pe,this);function r(p){return je(p,["bpmn:ReceiveTask","bpmn:SendTask"])||XC(p,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(p){var f=e.getDefinitions(),h=f.get("rootElements");return!!Ue(h,en({id:p.id}))}function s(p){if(A(p,"bpmn:ErrorEventDefinition"))return"errorRef";if(A(p,"bpmn:EscalationEventDefinition"))return"escalationRef";if(A(p,"bpmn:MessageEventDefinition"))return"messageRef";if(A(p,"bpmn:SignalEventDefinition"))return"signalRef"}function l(p){if(je(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.get("messageRef");var f=p.get("eventDefinitions"),h=f[0];return h.get(s(h))}function c(p,f){if(je(p,["bpmn:ReceiveTask","bpmn:SendTask"]))return p.set("messageRef",f);var h=p.get("eventDefinitions"),v=h[0];return v.set(s(v),f)}this.executed("shape.create",function(p){var f=p.shape;if(r(f)){var h=he(f),v=l(h),m;v&&!o(v)&&(m=e.getDefinitions().get("rootElements"),at(m,v),p.addedRootElement=v)}},!0),this.reverted("shape.create",function(p){var f=p.addedRootElement;if(f){var h=e.getDefinitions().get("rootElements");rt(h,f)}},!0),t.on("copyPaste.copyElement",function(p){var f=p.descriptor,h=p.element;if(r(h)){var v=he(h),m=l(v);m&&(f.referencedRootElement=m)}}),t.on("copyPaste.pasteElement",KC,function(p){var f=p.descriptor,h=f.businessObject;if(r(h)){var v=f.referencedRootElement;v&&(o(v)||(v=i.copyElement(v,a.create(v.$type))),c(h,v))}})}Up.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"];ye(Up,pe);function XC(e,t){return Oe(t)||(t=[t]),fi(t,function(n){return Is(e,n)})}function qp(e){e.invoke(pe,this),this.preExecute("shape.create",1500,function(t){var n=t.context,i=n.parent,a=n.shape;A(i,"bpmn:Lane")&&!A(a,"bpmn:Lane")&&(n.parent=ls(i,"bpmn:Participant"))})}qp.$inject=["injector"];ye(qp,pe);var Ro=1500,ZC=2e3;function TE(e,t,n){t.on(["create.hover","create.move","create.out","create.end","shape.move.hover","shape.move.move","shape.move.out","shape.move.end"],Ro,function(i){var a=i.context,r=a.shape||i.shape,o=i.hover;A(o,"bpmn:Lane")&&!je(r,["bpmn:Lane","bpmn:Participant"])&&(i.hover=vn(o),i.hoverGfx=e.getGraphics(i.hover));var s=n.getRootElement();o!==s&&(r.labelTarget||A(r,"bpmn:Group"))&&(i.hover=s,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Ro,function(i){var a=i.hover;A(a,"bpmn:Lane")&&(i.hover=vn(a)||a,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["bendpoint.move.hover"],Ro,function(i){var a=i.context,r=i.hover,o=a.type;A(r,"bpmn:Lane")&&/reconnect/.test(o)&&(i.hover=vn(r)||r,i.hoverGfx=e.getGraphics(i.hover))}),t.on(["connect.start"],Ro,function(i){var a=i.context,r=a.start;A(r,"bpmn:Lane")&&(a.start=vn(r)||r)}),t.on("shape.move.start",ZC,function(i){var a=i.shape;A(a,"bpmn:Lane")&&(i.shape=vn(a)||a)})}TE.$inject=["elementRegistry","eventBus","canvas"];function Wp(e,t,n){pe.call(this,e),this.preExecute("shape.create",function(i){var a=i.context,r=a.shape;if(A(r,"bpmn:DataObjectReference")&&r.type!=="label"){var o=t.create("bpmn:DataObject");r.businessObject.dataObjectRef=o}})}Wp.$inject=["eventBus","bpmnFactory","moddle"];ye(Wp,pe);var Gc=20,zc=20,CE=30,Io=2e3;function Yp(e,t,n){pe.call(this,t),t.on(["create.start","shape.move.start"],Io,function(a){var r=a.context,o=r.shape,s=e.getRootElement();if(!(!A(o,"bpmn:Participant")||!A(s,"bpmn:Process")||!s.children.length)){var l=s.children.filter(function(f){return!A(f,"bpmn:Group")&&!_t(f)&&!eA(f)});if(l.length){var c=St(l),p=JC(o,c);q(o,p),r.createConstraints=QC(o,c)}}}),t.on("create.start",Io,function(a){var r=a.context,o=r.shape,s=e.getRootElement(),l=e.getGraphics(s);function c(p){p.element=s,p.gfx=l}A(o,"bpmn:Participant")&&A(s,"bpmn:Process")&&(t.on("element.hover",Io,c),t.once("create.cleanup",function(){t.off("element.hover",c)}))});function i(a){var r=a.parent,o,s=e.getRootElement();A(s,"bpmn:Collaboration")?o=s:(o=n.makeCollaboration(),a.process=r),a.parent=o}this.preExecute("shape.create",function(a){var r=a.parent,o=a.shape;A(o,"bpmn:Participant")&&A(r,"bpmn:Process")&&i(a)},!0),this.execute("shape.create",function(a){var r=a.process,o=a.shape;r&&(a.oldProcessRef=o.businessObject.processRef,o.businessObject.processRef=r.businessObject)},!0),this.revert("shape.create",function(a){var r=a.process,o=a.shape;r&&(o.businessObject.processRef=a.oldProcessRef)},!0),this.postExecute("shape.create",function(a){var r=a.process,o=a.shape;if(r){var s=r.children.slice();n.moveElements(s,{x:0,y:0},o)}},!0),this.preExecute("elements.create",Io,function(a){var r=a.elements,o=a.parent,s,l=No(r);l&&A(o,"bpmn:Process")&&(i(a),s=No(r),a.oldProcessRef=s.businessObject.processRef,s.businessObject.processRef=o.businessObject)},!0),this.revert("elements.create",function(a){var r=a.elements,o=a.process,s;o&&(s=No(r),s.businessObject.processRef=a.oldProcessRef)},!0),this.postExecute("elements.create",function(a){var r=a.elements,o=a.process,s;if(o){s=No(r);var l=o.children.slice();n.moveElements(l,{x:0,y:0},s)}},!0)}Yp.$inject=["canvas","eventBus","modeling"];ye(Yp,pe);function JC(e,t){t={width:t.width+Gc*2+CE,height:t.height+zc*2};var n=Math.max(e.width,t.width),i=Math.max(e.height,t.height);return{x:-n/2,y:-i/2,width:n,height:i}}function QC(e,t){return t=_e(t),{bottom:t.top+e.height/2-zc,left:t.right-e.width/2+Gc,top:t.bottom-e.height/2+zc,right:t.left+e.width/2-Gc-CE}}function eA(e){return!!e.waypoints}function No(e){return Ue(e,function(t){return A(t,"bpmn:Participant")})}var kh="__targetRef_placeholder";function Kp(e,t){pe.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],Oh(r)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],Oh(r));function n(o,s,l){var c=o.get("dataInputAssociations");return Ue(c,function(p){return p!==l&&p.targetRef===s})}function i(o,s){var l=o.get("properties"),c=Ue(l,function(p){return p.name===kh});return!c&&s&&(c=t.create("bpmn:Property",{name:kh}),at(l,c)),c}function a(o,s){var l=i(o);l&&(n(o,l,s)||rt(o.get("properties"),l))}function r(o){var s=o.context,l=s.connection,c=l.businessObject,p=l.target,f=p&&p.businessObject,h=s.newTarget,v=h&&h.businessObject,m=s.oldTarget||s.target,_=m&&m.businessObject,b=l.businessObject,M;_&&_!==f&&a(_,c),v&&v!==f&&a(v,c),f?(M=i(f,!0),b.targetRef=M):b.targetRef=null}}Kp.$inject=["eventBus","bpmnFactory"];ye(Kp,pe);function Oh(e){return function(t){var n=t.context,i=n.connection;if(A(i,"bpmn:DataInputAssociation"))return e(t)}}function Ys(e){this._bpmnUpdater=e}Ys.$inject=["bpmnUpdater"];Ys.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,i=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};Ys.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,i=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,i)};function Xp(e,t,n,i){pe.call(this,i),t.registerHandler("dataStore.updateContainment",Ys);function a(){return n.filter(function(s){return A(s,"bpmn:Participant")&&he(s).processRef})[0]}function r(s){return s.children.filter(function(l){return A(l,"bpmn:DataStoreReference")&&!l.labelTarget})}function o(s,l){var c=s.businessObject||s;if(l=l||a(),l){var p=l.businessObject||l;t.execute("dataStore.updateContainment",{dataStoreBo:c,newSemanticParent:p.processRef||p,newDiParent:p.di})}}this.preExecute("shape.create",function(s){var l=s.context,c=l.shape;A(c,"bpmn:DataStoreReference")&&c.type!=="label"&&(l.hints||(l.hints={}),l.hints.autoResize=!1)}),this.preExecute("elements.move",function(s){var l=s.context,c=l.shapes,p=c.filter(function(f){return A(f,"bpmn:DataStoreReference")});p.length&&(l.hints||(l.hints={}),l.hints.autoResize=c.filter(function(f){return!A(f,"bpmn:DataStoreReference")}))}),this.postExecute("shape.create",function(s){var l=s.context,c=l.shape,p=c.parent;A(c,"bpmn:DataStoreReference")&&c.type!=="label"&&A(p,"bpmn:Collaboration")&&o(c)}),this.postExecute("shape.move",function(s){var l=s.context,c=l.shape,p=l.oldParent,f=c.parent;if(!A(p,"bpmn:Collaboration")&&A(c,"bpmn:DataStoreReference")&&c.type!=="label"&&A(f,"bpmn:Collaboration")){var h=A(p,"bpmn:Participant")?p:nA(p,"bpmn:Participant");o(c,h)}}),this.postExecute("shape.delete",function(s){var l=s.context,c=l.shape,p=e.getRootElement();je(c,["bpmn:Participant","bpmn:SubProcess"])&&A(p,"bpmn:Collaboration")&&r(p).filter(function(f){return tA(f,c)}).forEach(function(f){o(f)})}),this.postExecute("canvas.updateRoot",function(s){var l=s.context,c=l.oldRoot,p=l.newRoot,f=r(c);f.forEach(function(h){A(p,"bpmn:Process")&&o(h,p)})})}Xp.$inject=["canvas","commandStack","elementRegistry","eventBus"];ye(Xp,pe);function tA(e,t){for(var n=e.businessObject||e,i=t.businessObject||t;n.$parent;){if(n.$parent===i.processRef||i)return!0;n=n.$parent}return!1}function nA(e,t){for(;e.parent;){if(A(e.parent,t))return e.parent;e=e.parent}}var iA=500;function Zp(e,t,n){pe.call(this,e);function i(a,r){var o=zi(r),s=[],l=[];if(ji(o,function(h){return h.y>a.y?l.push(h):s.push(h),h.children}),!!o.length){var c;l.length&&s.length?c=a.height/2:c=a.height;var p,f;s.length&&(p=n.calculateAdjustments(s,"y",c,a.y-10),n.makeSpace(p.movingShapes,p.resizingShapes,{x:0,y:c},"s")),l.length&&(f=n.calculateAdjustments(l,"y",-c,a.y+a.height+10),n.makeSpace(f.movingShapes,f.resizingShapes,{x:0,y:-c},"n"))}}this.postExecuted("shape.delete",iA,function(a){var r=a.context,o=r.hints,s=r.shape,l=r.oldParent;A(s,"bpmn:Lane")&&(o&&o.nested||i(s,l))})}Zp.$inject=["eventBus","modeling","spaceTool"];ye(Zp,pe);var Lh=500;function Ks(e,t){t.invoke(pe,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",Lh,function(i){var a=i.elements;a.filter(function(r){var o=r.host;return Bh(r,o)}).map(function(r){return a.indexOf(r)}).forEach(function(r){i.elements[r]=n.replaceShape(a[r])})},!0),this.preExecute("elements.move",Lh,function(i){var a=i.shapes,r=i.newHost;a.forEach(function(o,s){var l=o.host;Bh(o,aA(a,l)?l:r)&&(a[s]=n.replaceShape(o))})},!0)}Ks.$inject=["bpmnReplace","injector"];ye(Ks,pe);Ks.prototype.replaceShape=function(e){var t=rA(e),n;return t?n={type:"bpmn:IntermediateCatchEvent",eventDefinitionType:t.$type}:n={type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,n,{layoutConnection:!1})};function rA(e){var t=he(e),n=t.eventDefinitions;return n&&n[0]}function Bh(e,t){return!_t(e)&&A(e,"bpmn:BoundaryEvent")&&!t}function aA(e,t){return e.indexOf(t)!==-1}function Jp(e,t,n){pe.call(this,e);function i(a,r,o){var s=r.waypoints,l,c,p,f,h,v,m,_=a.outgoing.slice(),b=a.incoming.slice(),M;Re(o.width)?M=Me(o):M=o;var P=Oc(s,M);if(P){if(l=s.slice(0,P.index),c=s.slice(P.index+(P.bendpoint?1:0)),!l.length||!c.length)return;p=P.bendpoint?s[P.index]:M,(l.length===1||!$h(a,l[l.length-1]))&&l.push(Vh(p)),(c.length===1||!$h(a,c[0]))&&c.unshift(Vh(p))}f=r.source,h=r.target,t.canConnect(f,a,r)&&(n.reconnectEnd(r,a,l||M),v=r),t.canConnect(a,h,r)&&(v?m=n.connect(a,h,{type:r.type,waypoints:c}):(n.reconnectStart(r,a,c||M),m=r));var S=[].concat(v&&Ie(b,function(w){return w.source===v.source})||[],m&&Ie(_,function(w){return w.target===m.target})||[]);S.length&&n.removeElements(S)}this.preExecute("elements.move",function(a){var r=a.newParent,o=a.shapes,s=a.delta,l=o[0];if(!(!l||!r)){r&&r.waypoints&&(a.newParent=r=r.parent);var c=Me(l),p={x:c.x+s.x,y:c.y+s.y},f=Ue(r.children,function(h){var v=t.canInsert(o,h);return v&&Oc(h.waypoints,p)});f&&(a.targetFlow=f,a.position=p)}},!0),this.postExecuted("elements.move",function(a){var r=a.shapes,o=a.targetFlow,s=a.position;o&&i(r[0],o,s)},!0),this.preExecute("shape.create",function(a){var r=a.parent,o=a.shape;t.canInsert(o,r)&&(a.targetFlow=r,a.parent=r.parent)},!0),this.postExecuted("shape.create",function(a){var r=a.shape,o=a.targetFlow,s=a.position;o&&i(r,o,s)},!0)}ye(Jp,pe);Jp.$inject=["eventBus","bpmnRules","modeling"];function $h(e,t){var n=t.x,i=t.y;return n>=e.x&&n<=e.x+e.width&&i>=e.y&&i<=e.y+e.height}function Vh(e){return q({},e)}function Qp(e,t){pe.call(this,e),this.preExecuted("connection.create",function(n){var i=n.context,a=i.source,r=i.target,o=r.incoming.slice();i.hints&&i.hints.createElementsBehavior===!1||A(a,"bpmn:EventBasedGateway")&&r.incoming.length&&o.filter($l).forEach(function(s){t.removeConnection(s)})}),this.preExecuted("shape.replace",function(n){var i=n.context.newShape,a,r;A(i,"bpmn:EventBasedGateway")&&(a=i.outgoing.filter($l).map(function(o){return o.target}),r=a.reduce(function(o,s){var l=s.incoming.filter($l);return o.concat(l)},[]),r.forEach(function(o){o.source!==i&&t.removeConnection(o)}))})}Qp.$inject=["eventBus","modeling"];ye(Qp,pe);function $l(e){return A(e,"bpmn:SequenceFlow")}var oA=2e3;function ef(e,t,n,i,a,r){a.invoke(pe,this);function o(){var f=t.getRootElement(),h=he(f);return h.$parent}function s(f){var h=he(f),v=h.categoryValueRef;if(v){var m=v.$parent;v&&(rt(m.categoryValue,v),m&&!m.categoryValue.length&&l(m))}}function l(f){var h=o();rt(h.get("rootElements"),f)}function c(){return n.filter(function(f){return A(f,"bpmn:Group")})}function p(f,h){return f.some(function(v){var m=he(v);return m.categoryValueRef&&m.categoryValueRef===h})}this.executed("shape.delete",function(f){var h=f.context,v=h.shape;if(A(v,"bpmn:Group")){var m=he(v),_=m.categoryValueRef,b=c();p(b,_)||s(v)}}),this.reverted("shape.delete",function(f){var h=f.context,v=h.shape;if(A(v,"bpmn:Group")){var m=he(v),_=m.categoryValueRef,b=o(),M=_?_.$parent:null;at(M.get("categoryValue"),_),at(b.get("rootElements"),M)}}),this.execute("shape.create",function(f){var h=f.context,v=h.shape,m=he(v);if(A(m,"bpmn:Group")&&!m.categoryValueRef){var _=o(),b=Hc(_,e);m.categoryValueRef=b}}),this.revert("shape.create",function(f){var h=f.context,v=h.shape;A(v,"bpmn:Group")&&(s(v),delete he(v).categoryValueRef)}),i.on("moddleCopy.canCopyProperty",oA,function(f){var h=f.property,v;if(A(h,"bpmn:CategoryValue"))return v=Hc(o(),e),r.copyElement(h,v)})}ef.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"];ye(ef,pe);function Uc(e,t,n,i){var a,r,o,s,l;return a=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y),a==0?null:(r=e.y-n.y,o=e.x-n.x,l=(i.x-n.x)*r-(i.y-n.y)*o,s=l/a,{x:Math.round(e.x+s*(t.x-e.x)),y:Math.round(e.y+s*(t.y-e.y))})}function AE(e){function t(i,a,r){var o={x:r.x,y:r.y-50},s={x:r.x-50,y:r.y},l=Uc(i,a,r,o),c=Uc(i,a,r,s),p;l&&c?Fh(l,r)>Fh(c,r)?p=c:p=l:p=l||c,i.original=p}function n(i){var a=i.waypoints;t(a[0],a[1],Me(i.source)),t(a[a.length-1],a[a.length-2],Me(i.target))}e.on("bpmnElement.added",function(i){var a=i.element;a.waypoints&&n(a)})}AE.$inject=["eventBus"];function Fh(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function tf(e){pe.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],function(n){var i=he(n.context.shape);je(i,t)&&!i.di.get("isHorizontal")&&i.di.set("isHorizontal",!0)})}tf.$inject=["eventBus"];ye(tf,pe);function PE(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function jh(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function sA(e,t){return t?{x:Math.cos(t)*e.x-Math.sin(t)*e.y,y:Math.sin(t)*e.x+Math.cos(t)*e.y}:e}function lA(e,t,n){var i=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}],a=i[0].n*t[0]+i[1].n*t[1],r=i[0].lambda*t[0]+i[1].lambda*t[1];return-a/r}function RE(e,t){var n=t[0],i=t[1],a={x:i.x-n.x,y:i.y-n.y},r=lA([n.x,n.y],[a.x,a.y],[e.x,e.y]);return{x:n.x+r*a.x,y:n.y+r*a.y}}function uA(e,t){var n=RE(e,t),i={x:n.x-e.x,y:n.y-e.y};return PE(i)}function fs(e,t){return PE({x:e.x-t.x,y:e.y-t.y})}var IE=Math.sqrt,NE=Math.min,cA=Math.max,Hh=Math.abs;function Gh(e){return Math.pow(e,2)}function Jr(e,t){return IE(Gh(e.x-t.x)+Gh(e.y-t.y))}function pA(e,t){var n=0,i,a,r,o,s,l,c,p,f,h,v;for(n=0;n<t.length-1;n++){if(i=t[n],a=t[n+1],Uh(i,a)?c=[i]:(r=Jr(e,i),o=Jr(e,a),l=NE(r,o),c=fA(i,a,e,l)),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");c.length===1&&(p={type:"bendpoint",position:c[0],segmentIndex:n,bendpointIndex:Uh(i,c[0])?n:n+1}),c.length===2&&(s=hA(c[0],c[1]),p={type:"segment",position:s,segmentIndex:n,relativeLocation:Jr(i,s)/Jr(i,a)}),f=Jr(p.position,e),(!v||h>f)&&(v=p,h=f)}return v}function fA(e,t,n,i){var a=t.x-e.x,r=t.y-e.y,o=n.x-e.x,s=n.y-e.y,l=a*a+r*r,c=a*o+r*s,p=o*o+s*s-i*i,f=c/l,h=p/l,v=f*f-h;if(v<0&&v>-1e-6&&(v=0),v<0)return[];var m=IE(v),_=-f+m,b=-f-m,M={x:e.x-a*_,y:e.y-r*_};if(v===0)return[M];var P={x:e.x-a*b,y:e.y-r*b};return[M,P].filter(function(S){return dA(S,e,t)})}function dA(e,t,n){return zh(e.x,t.x,n.x)&&zh(e.y,t.y,n.y)}function zh(e,t,n){return e>=NE(t,n)-ds&&e<=cA(t,n)+ds}function hA(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}var ds=.1;function Uh(e,t){return Hh(e.x-t.x)<=ds&&Hh(e.y-t.y)<=ds}function mA(e,t,n,i){var a=n.segmentIndex,r=t.length-e.length;if(i.segmentMove){var o=i.segmentMove.segmentStartIndex,s=i.segmentMove.newSegmentStartIndex;return a===o?s:a>=s?a+r<s?s:a+r:a}if(i.bendpointMove){var l=i.bendpointMove.insert,c=i.bendpointMove.bendpointIndex,p;if(r===0)return a;if(a>=c&&(p=l?a+1:a-1),a<c&&(p=a,l&&n.type!=="bendpoint"&&c-1===a)){var f=ME(t,c);f<n.relativeLocation&&p++}return p}return r===0?a:i.connectionStart?a===0?0:null:i.connectionEnd&&a===e.length-2?t.length-2:null}function vA(e,t,n,i){var a=0,r=0,o=gA(e),s=pA(o,n),l=s.segmentIndex,c=mA(n,t,s,i);if(c===null)return{x:a,y:r};if(c<0||c>t.length-2)return{x:a,y:r};var p=qh(n,l),f=qh(t,c),h=s.position,v=EA(p,h),m=yA(p,f);if(s.type==="bendpoint"){var _=t.length-n.length,b=s.bendpointIndex,M=n[b];if(t.indexOf(M)!==-1)return{x:a,y:r};if(_===0){var P=t[b];return{x:P.x-s.position.x,y:P.y-s.position.y}}_<0&&b!==0&&b<n.length-1&&(v=ME(n,b))}var S={x:(f[1].x-f[0].x)*v+f[0].x,y:(f[1].y-f[0].y)*v+f[0].y},w=sA({x:o.x-h.x,y:o.y-h.y},m);return a=S.x+w.x-o.x,r=S.y+w.y-o.y,si({x:a,y:r})}function ME(e,t){var n=fs(e[t-1],e[t]),i=fs(e[t],e[t+1]),a=n/(n+i);return a}function gA(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}function yA(e,t){var n=jh(e),i=jh(t);return i-n}function qh(e,t){return[e[t],e[t+1]]}function EA(e,t){var n=fs(e[0],e[1]),i=fs(e[0],t);return n===0?0:i/n}function La(e,t,n){var i=ra(t),a=ra(n),r=Pn(e,i),o={x:r.x*(n.width/t.width),y:r.y*(n.height/t.height)};return si({x:a.x+o.x,y:a.y+o.y})}function Wh(e,t,n){var i=ra(e),a=ra(t),r=ra(n),o=Pn(e,i),s=Pn(i,a),l=bA(i,t,n);if(l)return l;var c={x:s.x*(n.width/t.width),y:s.y*(n.height/t.height)},p={x:r.x+c.x,y:r.y+c.y};return si({x:p.x+o.x-e.x,y:p.y+o.y-e.y})}function bA(e,t,n){var i=_e(t),a=_e(n);if(xA(i,a))return null;var r=wt(t,e),o,s,l;if(r==="top")o={x:0,y:a.bottom-i.bottom};else if(r==="bottom")o={x:0,y:a.top-i.top};else if(r==="right")o={x:a.left-i.left,y:0};else if(r==="left")o={x:a.right-i.right,y:0};else return null;return s={x:e.x+o.x,y:e.y+o.y},l=wt(n,s),l!==r?null:o}function xA(e,t){return _A(e,t)||SA(e,t)}function _A(e,t){return e.right!==t.right&&e.left!==t.left}function SA(e,t){return e.top!==t.top&&e.bottom!==t.bottom}var wA={width:90,height:20},Yh="name",Kh="text";function nf(e,t,n,i){pe.call(this,e),this.postExecute("element.updateProperties",function(r){var o=r.context,s=o.element,l=o.properties;if(Yh in l&&t.updateLabel(s,l[Yh]),Kh in l&&A(s,"bpmn:TextAnnotation")){var c=i.getTextAnnotationBounds({x:s.x,y:s.y,width:s.width,height:s.height},l[Kh]||"");t.updateLabel(s,l.text,c)}}),this.postExecute(["shape.create","connection.create"],function(r){var o=r.context,s=o.hints||{};if(s.createElementsBehavior!==!1){var l=o.shape||o.connection,c=l.businessObject;if(!(_t(l)||!hr(l))&&En(l)){var p=ks(l),f=i.getExternalLabelBounds(wA,En(l));t.createLabel(l,p,{id:c.id+"_label",businessObject:c,width:f.width,height:f.height})}}}),this.postExecute("shape.delete",function(r){var o=r.context,s=o.labelTarget,l=o.hints||{};s&&l.unsetLabel!==!1&&t.updateLabel(s,null,null,{removeShape:!1})}),this.postExecute(["label.create"],function(r){var o=r.context,s=o.shape,l,c;s.labelTarget&&A(s.labelTarget||s,"bpmn:BaseElement")&&(l=s.businessObject,c=l.di,c.label||(c.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),q(c.label.bounds,{x:s.x,y:s.y,width:s.width,height:s.height}))});function a(r){var o=r.context,s=o.connection,l=s.label,c=q({},o.hints),p=o.newWaypoints||s.waypoints,f=o.oldWaypoints;return typeof c.startChanged>"u"&&(c.startChanged=!!c.connectionStart),typeof c.endChanged>"u"&&(c.endChanged=!!c.connectionEnd),vA(l,p,f,c)}this.postExecute(["connection.layout","connection.updateWaypoints"],function(r){var o=r.context,s=o.hints||{};if(s.labelBehavior!==!1){var l=o.connection,c=l.label,p;!c||!c.parent||(p=a(r),t.moveShape(c,p))}}),this.postExecute(["shape.replace"],function(r){var o=r.context,s=o.newShape,l=o.oldShape,c=he(s);c&&hr(c)&&l.label&&s.label&&(s.label.x=l.label.x,s.label.y=l.label.y)}),this.postExecute("shape.resize",function(r){var o=r.context,s=o.shape,l=o.newBounds,c=o.oldBounds;if(Ds(s)){var p=s.label,f=Me(p),h=AA(c),v=CA(f,h),m=TA(v,c,l);t.moveShape(p,m)}})}ye(nf,pe);nf.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];function TA(e,t,n){var i=La(e,t,n);return si(Pn(i,e))}function CA(e,t){if(t.length){var n=PA(e,t);return RE(e,n)}}function AA(e){return[[{x:e.x,y:e.y},{x:e.x+(e.width||0),y:e.y}],[{x:e.x+(e.width||0),y:e.y},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y+(e.height||0)},{x:e.x+(e.width||0),y:e.y+(e.height||0)}],[{x:e.x,y:e.y},{x:e.x,y:e.y+(e.height||0)}]]}function PA(e,t){var n=t.map(function(a){return{line:a,distance:uA(e,a)}}),i=nn(n,"distance");return i[0].line}function Xs(e,t,n){var i=Js(e),a=kE(i,t),r=i[0];return a.length?a[a.length-1]:La(r.original||r,n,t)}function Zs(e,t,n){var i=Js(e),a=kE(i,t),r=i[i.length-1];return a.length?a[0]:La(r.original||r,n,t)}function rf(e,t,n){var i=Js(e),a=DE(t,n),r=i[0];return La(r.original||r,a,t)}function af(e,t,n){var i=Js(e),a=DE(t,n),r=i[i.length-1];return La(r.original||r,a,t)}function DE(e,t){return{x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}}function Js(e){var t=e.waypoints;if(!t.length)throw new Error("connection#"+e.id+": no waypoints");return t}function kE(e,t){var n=ht(e,IA);return Ie(n,function(i){return RA(i,t)})}function RA(e,t){return wt(t,e,1)==="intersect"}function IA(e){return e.original||e}function of(e,t){pe.call(this,e),this.postExecute("shape.replace",function(n){var i=n.oldShape,a=n.newShape;if(NA(i,a)){var r=MA(i);r.incoming.forEach(function(o){var s=Zs(o,a,i);t.reconnectEnd(o,a,s)}),r.outgoing.forEach(function(o){var s=Xs(o,a,i);t.reconnectStart(o,a,s)})}},!0)}of.$inject=["eventBus","modeling"];ye(of,pe);function NA(e,t){return A(e,"bpmn:Participant")&&We(e)&&A(t,"bpmn:Participant")&&!We(t)}function MA(e){var t=Ss([e],!1),n=[],i=[];return t.forEach(function(a){a!==e&&(a.incoming.forEach(function(r){A(r,"bpmn:MessageFlow")&&n.push(r)}),a.outgoing.forEach(function(r){A(r,"bpmn:MessageFlow")&&i.push(r)}))},[]),{incoming:n,outgoing:i}}var DA="flow elements must be children of pools/participants";function OE(e,t,n){function i(a,r,o){t.add({position:{x:a.x+5,y:a.y+5},type:"error",timeout:2e3,html:"<div>"+r+"</div>"})}e.on(["shape.move.rejected","create.rejected"],function(a){var r=a.context,o=r.shape,s=r.target;A(s,"bpmn:Collaboration")&&A(o,"bpmn:FlowNode")&&i(a,n(DA))})}OE.$inject=["eventBus","tooltips","translate"];function sf(e,t,n,i){pe.call(this,e);var a=i.get("dragging",!1);function r(l){var c=l.source,p=l.target,f=l.parent;if(f){var h,v;A(l,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(c,p)||(v=!0),n.canConnectMessageFlow(c,p)&&(h="bpmn:MessageFlow")),A(l,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(c,p)||(v=!0),n.canConnectSequenceFlow(c,p)&&(h="bpmn:SequenceFlow")),A(l,"bpmn:Association")&&!n.canConnectAssociation(c,p)&&(v=!0),v&&t.removeConnection(l),h&&t.connect(c,p,{type:h,waypoints:l.waypoints.slice()})}}function o(l){var c=l.context,p=c.connection,f=c.newSource||p.source,h=c.newTarget||p.target,v,m;v=n.canConnect(f,h),!(!v||v.type===p.type)&&(m=t.connect(f,h,{type:v.type,waypoints:p.waypoints.slice()}),t.removeConnection(p),c.connection=m,a&&s(p,m))}function s(l,c){var p=a.context(),f=p&&p.payload.previousSelection,h;!f||!f.length||(h=f.indexOf(l),h!==-1&&f.splice(h,1,c))}this.postExecuted("elements.move",function(l){var c=l.closure,p=c.allConnections;j(p,r)},!0),this.preExecute("connection.reconnect",o),this.postExecuted("element.updateProperties",function(l){var c=l.context,p=c.properties,f=c.element,h=f.businessObject,v;p.default&&(v=Ue(f.outgoing,en({id:f.businessObject.default.id})),v&&t.updateProperties(v,{conditionExpression:void 0})),p.conditionExpression&&h.sourceRef.default===h&&t.updateProperties(f.source,{default:void 0})})}ye(sf,pe);sf.$inject=["eventBus","modeling","bpmnRules","injector"];function lf(e,t){pe.call(this,e),this.preExecute("shape.delete",function(n){var i=n.shape,a=i.parent;A(i,"bpmn:Participant")&&(n.collaborationRoot=a)},!0),this.postExecute("shape.delete",function(n){var i=n.collaborationRoot;i&&!i.businessObject.participants.length&&t.makeProcess()},!0)}lf.$inject=["eventBus","modeling"];ye(lf,pe);function Qs(e,t,n,i,a,r){i.invoke(pe,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.create"],500,function(o){var s=o.context,l=s.parent,c=s.elements,p=t.canReplace(c,l);p&&this.replaceElements(c,p.replacements)},this),this.postExecuted(["elements.move"],500,function(o){var s=o.context,l=s.newParent,c=s.newHost,p=[];j(s.closure.topLevel,function(h){Gt(h)?p=p.concat(h.children):p=p.concat(h)}),p.length===1&&c&&(l=c);var f=t.canReplace(p,l);f&&this.replaceElements(p,f.replacements,c)},this),this.postExecute(["shape.replace"],1500,function(o){var s=o.context,l=s.oldShape,c=s.newShape,p=l.attachers,f;p&&p.length&&(f=t.canReplace(p,c),this.replaceElements(p,f.replacements))},this),this.postExecuted(["shape.replace"],1500,function(o){var s=o.context,l=s.oldShape,c=s.newShape;a.unclaimId(l.businessObject.id,l.businessObject),a.updateProperties(c,{id:l.id})})}ye(Qs,pe);Qs.prototype.replaceElements=function(e,t){var n=this._elementRegistry,i=this._bpmnReplace,a=this._selection;j(t,function(r){var o={type:r.newElementType},s=n.get(r.oldElementId),l=e.indexOf(s);e[l]=i.replaceElement(s,o,{select:!1})}),t&&a.select(e)};Qs.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var kA=1500,ki={width:300,height:60},ma={width:300,height:150},LE={width:140,height:120},BE={width:50,height:30};function $E(e){e.on("resize.start",kA,function(t){var n=t.context,i=n.shape,a=n.direction,r=n.balanced;(A(i,"bpmn:Lane")||A(i,"bpmn:Participant"))&&(n.resizeConstraints=jA(i,a,r)),A(i,"bpmn:Participant")&&(n.minDimensions=ma),A(i,"bpmn:SubProcess")&&We(i)&&(n.minDimensions=LE),A(i,"bpmn:TextAnnotation")&&(n.minDimensions=BE)})}$E.$inject=["eventBus"];var Mo=Math.abs,OA=Math.min,LA=Math.max;function VE(e,t,n,i){var a=e[t];e[t]=a===void 0?n:i(n,a)}function Do(e,t,n){return VE(e,t,n,OA)}function ko(e,t,n){return VE(e,t,n,LA)}var BA=20,$A=50,VA=20,FA=20;function jA(e,t,n){var i=vn(e),a=!0,r=!0,o=Gs(i,[i]),s=_e(e),l={},c={};/e/.test(t)?c.right=s.left+ki.width:/w/.test(t)&&(c.left=s.right-ki.width),o.forEach(function(f){var h=_e(f);/n/.test(t)&&(h.top<s.top-10&&(a=!1),n&&Mo(s.top-h.bottom)<10&&ko(l,"top",h.top+ki.height),Mo(s.top-h.top)<5&&Do(c,"top",h.bottom-ki.height)),/s/.test(t)&&(h.bottom>s.bottom+10&&(r=!1),n&&Mo(s.bottom-h.top)<10&&Do(l,"bottom",h.bottom-ki.height),Mo(s.bottom-h.bottom)<5&&ko(c,"bottom",h.top+ki.height))});var p=i.children.filter(function(f){return!f.hidden&&!f.waypoints&&(A(f,"bpmn:FlowElement")||A(f,"bpmn:Artifact"))});return p.forEach(function(f){var h=_e(f);a&&/n/.test(t)&&Do(c,"top",h.top-VA),/e/.test(t)&&ko(c,"right",h.right+BA),r&&/s/.test(t)&&ko(c,"bottom",h.bottom+FA),/w/.test(t)&&Do(c,"left",h.left-$A)}),{min:c,max:l}}var Xh=1001;function FE(e,t){e.on("resize.start",Xh+500,function(n){var i=n.context,a=i.shape;(A(a,"bpmn:Lane")||A(a,"bpmn:Participant"))&&(i.balanced=!mr(n))}),e.on("resize.end",Xh,function(n){var i=n.context,a=i.shape,r=i.canExecute,o=i.newBounds;if(A(a,"bpmn:Lane")||A(a,"bpmn:Participant"))return r&&(o=Lg(o),t.resizeLane(a,o,i.balanced)),!1})}FE.$inject=["eventBus","modeling"];function uf(e,t,n){pe.call(this,e),this.preExecute("shape.delete",function(i){var a=i.context.shape;if(!(a.incoming.length!==1||a.outgoing.length!==1)){var r=a.incoming[0],o=a.outgoing[0];if(!(!A(r,"bpmn:SequenceFlow")||!A(o,"bpmn:SequenceFlow"))&&t.canConnect(r.source,o.target,r)){var s=HA(r.waypoints,o.waypoints);n.reconnectEnd(r,o.target,s)}}})}ye(uf,pe);uf.$inject=["eventBus","bpmnRules","modeling"];function ir(e){return e.original||e}function HA(e,t){var n=Uc(ir(e[e.length-2]),ir(e[e.length-1]),ir(t[1]),ir(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[ir(e[0]),ir(t[t.length-1])]}var GA=Math.max;function jE(e){e.on("spaceTool.getMinDimensions",function(t){var n=t.shapes,i=t.axis,a=t.start,r={};return j(n,function(o){var s=o.id;A(o,"bpmn:Participant")&&(zA(i)?r[s]=ma:r[s]={width:ma.width,height:UA(o,a)}),A(o,"bpmn:SubProcess")&&We(o)&&(r[s]=LE),A(o,"bpmn:TextAnnotation")&&(r[s]=BE)}),r})}jE.$inject=["eventBus"];function zA(e){return e==="x"}function UA(e,t){var n;return qA(e)?(n=WA(e,t),GA(ma.height,n)):ma.height}function qA(e){return!!zi(e).length}function WA(e,t){var n=zi(e),i;return i=HE(n,t),e.height-i.height+ki.height}function HE(e,t){var n,i,a;for(n=0;n<e.length;n++)if(i=e[n],t>=i.y&&t<=i.y+i.height)return a=zi(i),a.length?HE(a,t):i}function cf(e,t){e.invoke(pe,this),this.postExecuted("shape.replace",function(n){var i=n.context.oldShape,a=n.context.newShape;if(!(!A(a,"bpmn:SubProcess")||!A(i,"bpmn:Task")||!We(a))){var r=YA(a);t.createShape({type:"bpmn:StartEvent"},r,a)}})}cf.$inject=["injector","modeling"];ye(cf,pe);function YA(e){return{x:e.x+e.width/6,y:e.y+e.height/2}}var Vl=500;function pf(e,t,n,i){pe.call(this,e);function a(s){s.length&&s.forEach(function(l){l.type==="label"&&!l.businessObject.name&&(l.hidden=!0)})}function r(s,l){var c=s.children,p=l,f,h;return f=KA(c).concat([s]),h=cE(f),h?(p.width=Math.max(h.width,p.width),p.height=Math.max(h.height,p.height),p.x=h.x+(h.width-p.width)/2,p.y=h.y+(h.height-p.height)/2):(p.x=s.x+(s.width-p.width)/2,p.y=s.y+(s.height-p.height)/2),p}function o(s,l){return{x:s.x+(s.width-l.width)/2,y:s.y+(s.height-l.height)/2,width:l.width,height:l.height}}this.executed(["shape.toggleCollapse"],Vl,function(s){var l=s.context,c=l.shape;A(c,"bpmn:SubProcess")&&(c.collapsed?he(c).di.isExpanded=!1:(a(c.children),he(c).di.isExpanded=!0))}),this.reverted(["shape.toggleCollapse"],Vl,function(s){var l=s.context,c=l.shape;c.collapsed?he(c).di.isExpanded=!1:he(c).di.isExpanded=!0}),this.postExecuted(["shape.toggleCollapse"],Vl,function(s){var l=s.context.shape,c=t._getDefaultSize(l),p;l.collapsed?p=o(l,c):p=r(l,c),n.resizeShape(l,p,null,{autoResize:l.collapsed?!1:"nwse"})})}ye(pf,pe);pf.$inject=["eventBus","elementFactory","modeling"];function KA(e){return e.filter(function(t){return!t.hidden})}function ff(e,t,n,i){t.invoke(pe,this),this.preExecute("shape.delete",function(a){var r=a.context,o=r.shape,s=o.businessObject;_t(o)||(A(o,"bpmn:Participant")&&We(o)&&n.ids.unclaim(s.processRef.id),i.unclaimId(s.id,s))}),this.preExecute("connection.delete",function(a){var r=a.context,o=r.connection,s=o.businessObject;i.unclaimId(s.id,s)}),this.preExecute("canvas.updateRoot",function(){var a=e.getRootElement(),r=a.businessObject;n.ids.unclaim(r.id)})}ye(ff,pe);ff.$inject=["canvas","injector","moddle","modeling"];var XA=500,ZA=5e3;function df(e,t,n){pe.call(this,e);var i;function a(){return i=i||new JA,i.enter(),i}function r(){if(!i)throw new Error(n("out of bounds release"));return i}function o(){if(!i)throw new Error(n("out of bounds release"));var l=i.leave();return l&&(t.updateLaneRefs(i.flowNodes,i.lanes),i=null),l}var s=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(s,ZA,function(l){a()}),this.postExecuted(s,XA,function(l){o()}),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],function(l){var c=l.context,p=c.shape,f=r();p.labelTarget||(A(p,"bpmn:Lane")&&f.addLane(p),A(p,"bpmn:FlowNode")&&f.addFlowNode(p))})}df.$inject=["eventBus","modeling","translate"];ye(df,pe);function JA(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function hf(e,t){pe.call(this,e),this.preExecute("connection.delete",function(n){var i=n.context,a=i.connection,r=a.source;QA(a,r)&&t.updateProperties(r,{default:null})})}ye(hf,pe);hf.$inject=["eventBus","modeling"];function QA(e,t){if(!A(e,"bpmn:SequenceFlow"))return!1;var n=he(t),i=he(e);return n.get("default")===i}const eP={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","messageFlowBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",jp],appendBehavior:["type",Hp],associationBehavior:["type",Gp],attachEventBehavior:["type",Ws],boundaryEventBehavior:["type",zp],rootElementReferenceBehavior:["type",Up],createBehavior:["type",qp],fixHoverBehavior:["type",TE],createDataObjectBehavior:["type",Wp],createParticipantBehavior:["type",Yp],dataInputAssociationBehavior:["type",Kp],dataStoreBehavior:["type",Xp],deleteLaneBehavior:["type",Zp],detachEventBehavior:["type",Ks],dropOnFlowBehavior:["type",Jp],eventBasedGatewayBehavior:["type",Qp],groupBehavior:["type",ef],importDockingFix:["type",AE],isHorizontalFix:["type",tf],labelBehavior:["type",nf],messageFlowBehavior:["type",of],modelingFeedback:["type",OE],replaceConnectionBehavior:["type",sf],removeParticipantBehavior:["type",lf],replaceElementBehaviour:["type",Qs],resizeBehavior:["type",$E],resizeLaneBehavior:["type",FE],removeElementBehavior:["type",uf],toggleElementCollapseBehaviour:["type",pf],spaceToolBehavior:["type",jE],subProcessStartEventBehavior:["type",cf],unclaimIdBehavior:["type",ff],updateFlowNodeRefsBehavior:["type",df],unsetDefaultFlowBehavior:["type",hf]};function GE(e,t){var n=wt(e,t,-15);return n!=="intersect"?n:null}function Tt(e){vi.call(this,e)}ye(Tt,vi);Tt.$inject=["eventBus"];Tt.prototype.init=function(){this.addRule("connection.start",function(e){var t=e.source;return tP(t)}),this.addRule("connection.create",function(e){var t=e.source,n=e.target,i=e.hints||{},a=i.targetParent,r=i.targetAttach;if(r)return!1;a&&(n.parent=a);try{return Qo(t,n)}finally{a&&(n.parent=null)}}),this.addRule("connection.reconnect",function(e){var t=e.connection,n=e.source,i=e.target;return Qo(n,i,t)}),this.addRule("connection.updateWaypoints",function(e){return{type:e.connection.type}}),this.addRule("shape.resize",function(e){var t=e.shape,n=e.newBounds;return XE(t,n)}),this.addRule("elements.create",function(e){var t=e.elements,n=e.position,i=e.target;return hs(i)&&!ms(t,i)?!1:$i(t,function(a){return hs(a)?Qo(a.source,a.target,a):a.host?oa(a,a.host,null,n):Kc(a,i,null)})}),this.addRule("elements.move",function(e){var t=e.target,n=e.shapes,i=e.position;return oa(n,t,null,i)||YE(n,t,i)||KE(n,t)||ms(n,t)}),this.addRule("shape.create",function(e){return Kc(e.shape,e.target,e.source,e.position)}),this.addRule("shape.attach",function(e){return oa(e.shape,e.target,null,e.position)}),this.addRule("element.copy",function(e){var t=e.element,n=e.elements;return eb(n,t)})};Tt.prototype.canConnectMessageFlow=JE;Tt.prototype.canConnectSequenceFlow=QE;Tt.prototype.canConnectDataAssociation=gf;Tt.prototype.canConnectAssociation=ZE;Tt.prototype.canMove=KE;Tt.prototype.canAttach=oa;Tt.prototype.canReplace=YE;Tt.prototype.canDrop=gr;Tt.prototype.canInsert=ms;Tt.prototype.canCreate=Kc;Tt.prototype.canConnect=Qo;Tt.prototype.canResize=XE;Tt.prototype.canCopy=eb;function tP(e){return qc(e)?null:je(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference","bpmn:Group","bpmn:TextAnnotation"])}function qc(e){return!e||_t(e)}function nP(e,t){return e===t}function Zh(e){do{if(A(e,"bpmn:Process"))return he(e);if(A(e,"bpmn:Participant"))return he(e).processRef||he(e)}while(e=e.parent)}function Wc(e){return A(e,"bpmn:TextAnnotation")}function mf(e){return A(e,"bpmn:Group")&&!e.labelTarget}function vf(e){return A(e,"bpmn:BoundaryEvent")&&An(e,"bpmn:CompensateEventDefinition")}function Dr(e){return he(e).isForCompensation}function iP(e,t){var n=Zh(e),i=Zh(t);return n===i}function rP(e){return A(e,"bpmn:InteractionNode")&&!A(e,"bpmn:BoundaryEvent")&&(!A(e,"bpmn:Event")||A(e,"bpmn:ThrowEvent")&&zE(e,"bpmn:MessageEventDefinition"))}function aP(e){return A(e,"bpmn:InteractionNode")&&!Dr(e)&&(!A(e,"bpmn:Event")||A(e,"bpmn:CatchEvent")&&zE(e,"bpmn:MessageEventDefinition"))&&!(A(e,"bpmn:BoundaryEvent")&&!An(e,"bpmn:MessageEventDefinition"))}function Jh(e){for(var t=e;t=t.parent;){if(A(t,"bpmn:FlowElementsContainer"))return he(t);if(A(t,"bpmn:Participant"))return he(t).processRef}return null}function oP(e,t){var n=Jh(e),i=Jh(t);return n===i}function An(e,t){var n=he(e);return!!Ue(n.eventDefinitions||[],function(i){return A(i,t)})}function zE(e,t){var n=he(e);return(n.eventDefinitions||[]).every(function(i){return A(i,t)})}function sP(e){return A(e,"bpmn:FlowNode")&&!A(e,"bpmn:EndEvent")&&!Gt(e)&&!(A(e,"bpmn:IntermediateThrowEvent")&&An(e,"bpmn:LinkEventDefinition"))&&!vf(e)&&!Dr(e)}function lP(e){return A(e,"bpmn:FlowNode")&&!A(e,"bpmn:StartEvent")&&!A(e,"bpmn:BoundaryEvent")&&!Gt(e)&&!(A(e,"bpmn:IntermediateCatchEvent")&&An(e,"bpmn:LinkEventDefinition"))&&!Dr(e)}function Qh(e){return A(e,"bpmn:ReceiveTask")||A(e,"bpmn:IntermediateCatchEvent")&&(An(e,"bpmn:MessageEventDefinition")||An(e,"bpmn:TimerEventDefinition")||An(e,"bpmn:ConditionalEventDefinition")||An(e,"bpmn:SignalEventDefinition"))}function hs(e){return e.waypoints}function uP(e){for(var t=[];e;)e=e.parent,e&&t.push(e);return t}function Yc(e,t){var n=uP(t);return n.indexOf(e)!==-1}function Qo(e,t,n){if(qc(e)||qc(t))return null;if(!A(n,"bpmn:DataAssociation")){if(JE(e,t))return{type:"bpmn:MessageFlow"};if(QE(e,t))return{type:"bpmn:SequenceFlow"}}var i=gf(e,t);return i||(vf(e)&&Dr(t)?{type:"bpmn:Association",associationDirection:"One"}:ZE(e,t)?{type:"bpmn:Association"}:!1)}function gr(e,t,n){return _t(e)||mf(e)?!0:A(t,"bpmn:Participant")&&!We(t)?!1:A(e,"bpmn:Participant")?A(t,"bpmn:Process")||A(t,"bpmn:Collaboration"):je(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:A(e,"bpmn:Lane")?A(t,"bpmn:Participant")||A(t,"bpmn:Lane"):A(e,"bpmn:BoundaryEvent")&&!cP(e)?!1:A(e,"bpmn:FlowElement")&&!A(e,"bpmn:DataStoreReference")?A(t,"bpmn:FlowElementsContainer")?We(t):je(t,["bpmn:Participant","bpmn:Lane"]):A(e,"bpmn:DataStoreReference")&&A(t,"bpmn:Collaboration")?fi(he(t).get("participants"),function(i){return!!i.get("processRef")}):je(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?je(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process","bpmn:SubProcess"]):A(e,"bpmn:MessageFlow")?A(t,"bpmn:Collaboration")||e.source.parent==t||e.target.parent==t:!1}function cP(e){return he(e).cancelActivity&&(UE(e)||qE(e))}function pP(e){return!_t(e)&&A(e,"bpmn:BoundaryEvent")}function fP(e){return A(e,"bpmn:Lane")}function dP(e){return pP(e)||A(e,"bpmn:IntermediateThrowEvent")&&UE(e)?!0:A(e,"bpmn:IntermediateCatchEvent")&&qE(e)}function UE(e){var t=he(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function qE(e){return WE(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function WE(e,t){return t.some(function(n){return An(e,n)})}function hP(e){return A(e,"bpmn:ReceiveTask")&&Ue(e.incoming,function(t){return A(t.source,"bpmn:EventBasedGateway")})}function oa(e,t,n,i){if(Array.isArray(e)||(e=[e]),e.length!==1)return!1;var a=e[0];return _t(a)||!dP(a)||Gt(t)||!A(t,"bpmn:Activity")||Dr(t)||i&&!GE(i,t)||hP(t)?!1:"attach"}function YE(e,t,n){if(!t)return!1;var i={replacements:[]};return j(e,function(a){Gt(t)||A(a,"bpmn:StartEvent")&&a.type!=="label"&&gr(a,t)&&(yw(a)||i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"}),(Ew(a)||bw(a)||xw(a))&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"}),WE(a,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])&&A(t,"bpmn:SubProcess")&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:StartEvent"})),A(t,"bpmn:Transaction")||An(a,"bpmn:CancelEventDefinition")&&a.type!=="label"&&(A(a,"bpmn:EndEvent")&&gr(a,t)&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:EndEvent"}),A(a,"bpmn:BoundaryEvent")&&oa(a,t,null,n)&&i.replacements.push({oldElementId:a.id,newElementType:"bpmn:BoundaryEvent"}))}),i.replacements.length?i:!1}function KE(e,t){return fi(e,fP)?!1:t?e.every(function(n){return gr(n,t)}):!0}function Kc(e,t,n,i){return t?_t(e)||mf(e)?!0:nP(n,t)||n&&Yc(n,t)?!1:gr(e,t)||ms(e,t):!1}function XE(e,t){return A(e,"bpmn:SubProcess")?We(e)&&(!t||t.width>=100&&t.height>=80):A(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:A(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!(Wc(e)||mf(e))}function mP(e,t){var n=Wc(e),i=Wc(t);return(n||i)&&n!==i}function ZE(e,t){return hs(e)||hs(t)?!1:vf(e)&&Dr(t)?!0:Yc(t,e)||Yc(e,t)?!1:mP(e,t)?!0:!!gf(e,t)}function JE(e,t){return em(e)&&!em(t)?!1:rP(e)&&aP(t)&&!iP(e,t)}function QE(e,t){return Qh(t)&&t.incoming.length>0&&yP(t.incoming)&&!A(e,"bpmn:EventBasedGateway")?!1:sP(e)&&lP(t)&&oP(e,t)&&!(A(e,"bpmn:EventBasedGateway")&&!Qh(t))}function gf(e,t){return je(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&je(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:je(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&je(e,["bpmn:Activity","bpmn:CatchEvent"])?{type:"bpmn:DataOutputAssociation"}:!1}function ms(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(e.length!==1)return!1;e=e[0]}return t.source===e||t.target===e?!1:je(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!_t(t)&&A(e,"bpmn:FlowNode")&&!A(e,"bpmn:BoundaryEvent")&&gr(e,t.parent)}function vP(e,t){return e&&t&&e.indexOf(t)!==-1}function eb(e,t){return _t(t)?!0:!(A(t,"bpmn:Lane")&&!vP(e,t.parent))}function gP(e){if(e&&e.source)return A(e.source,"bpmn:EventBasedGateway")}function yP(e){return e=e||[],e.some(gP)}function em(e){return ls(e,"bpmn:Process")||ls(e,"bpmn:Collaboration")}const EP={__depends__:[On],__init__:["bpmnRules"],bpmnRules:["type",Tt]};var bP=2e3;function tb(e,t){e.on("saveXML.start",bP,n);function n(){var i=t.getRootElement(),a=he(i).di,r,o;r=Ss([i],!1),r=Ie(r,function(s){return s!==i&&!s.labelTarget}),o=ht(r,dr),a.set("planeElement",o)}}tb.$inject=["eventBus","canvas"];const xP={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",tb]};function el(e){pe.call(this,e);var t=this;this.preExecute(["shape.create","connection.create"],function(n){var i=n.context,a=i.shape||i.connection,r=i.parent,o=t.getOrdering(a,r);o&&(o.parent!==void 0&&(i.parent=o.parent),i.parentIndex=o.index)}),this.preExecute(["shape.move","connection.move"],function(n){var i=n.context,a=i.shape||i.connection,r=i.newParent||a.parent,o=t.getOrdering(a,r);o&&(o.parent!==void 0&&(i.newParent=o.parent),i.newParentIndex=o.index)})}el.prototype.getOrdering=function(e,t){return null};ye(el,pe);function yf(e,t,n){el.call(this,e);var i=[{type:"bpmn:SubProcess",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function a(s){if(s.labelTarget)return{level:10};var l=Ue(i,function(c){return je(s,[c.type])});return l&&l.order||{level:1}}function r(s){var l=s.order;if(l||(s.order=l=a(s)),!l)throw new Error("no order for <"+s.id+">");return l}function o(s,l,c){for(var p=l;p&&!je(p,c);)p=p.parent;if(!p)throw new Error("no parent for <"+s.id+"> in <"+(l&&l.id)+">");return p}this.getOrdering=function(s,l){if(s.labelTarget)return{parent:t.getRootElement(),index:-1};var c=r(s);c.containers&&(l=o(s,l,c.containers));var p=l.children.indexOf(s),f=ip(l.children,function(h){return!s.labelTarget&&h.labelTarget?!1:c.level<r(h).level});return f!==-1&&p!==-1&&p<f&&(f-=1),{index:f,parent:l}}}yf.$inject=["eventBus","canvas","translate"];ye(yf,el);const _P={__depends__:[Ms],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",yf]};function nt(e,t){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[],trigger:null},this._injector=t,this._eventBus=e,this._uid=1,e.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}nt.$inject=["eventBus","injector"];nt.prototype.execute=function(e,t){if(!e)throw new Error("command required");this._currentExecution.trigger="execute";var n={command:e,context:t};this._pushAction(n),this._internalExecute(n),this._popAction(n)};nt.prototype.canExecute=function(e,t){var n={command:e,context:t},i=this._getHandler(e),a=this._fire(e,"canExecute",n);if(a===void 0){if(!i)return!1;i.canExecute&&(a=i.canExecute(t))}return a};nt.prototype.clear=function(e){this._stack.length=0,this._stackIdx=-1,e!==!1&&this._fire("changed",{trigger:"clear"})};nt.prototype.undo=function(){var e=this._getUndoAction(),t;if(e){for(this._currentExecution.trigger="undo",this._pushAction(e);e&&(this._internalUndo(e),t=this._getUndoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};nt.prototype.redo=function(){var e=this._getRedoAction(),t;if(e){for(this._currentExecution.trigger="redo",this._pushAction(e);e&&(this._internalExecute(e,!0),t=this._getRedoAction(),!(!t||t.id!==e.id));)e=t;this._popAction()}};nt.prototype.register=function(e,t){this._setHandler(e,t)};nt.prototype.registerHandler=function(e,t){if(!e||!t)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(t);this.register(e,n)};nt.prototype.canUndo=function(){return!!this._getUndoAction()};nt.prototype.canRedo=function(){return!!this._getRedoAction()};nt.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]};nt.prototype._getUndoAction=function(){return this._stack[this._stackIdx]};nt.prototype._internalUndo=function(e){var t=this,n=e.command,i=e.context,a=this._getHandler(n);this._atomicDo(function(){t._fire(n,"revert",e),a.revert&&t._markDirty(a.revert(i)),t._revertedAction(e),t._fire(n,"reverted",e)})};nt.prototype._fire=function(e,t,n){arguments.length<3&&(n=t,t=null);var i=t?[e+"."+t,t]:[e],a,r,o;for(n=this._eventBus.createEvent(n),a=0;(r=i[a])&&(o=this._eventBus.fire("commandStack."+r,n),!n.cancelBubble);a++);return o};nt.prototype._createId=function(){return this._uid++};nt.prototype._atomicDo=function(e){var t=this._currentExecution;t.atomic=!0;try{e()}finally{t.atomic=!1}};nt.prototype._internalExecute=function(e,t){var n=this,i=e.command,a=e.context,r=this._getHandler(i);if(!r)throw new Error("no command handler registered for <"+i+">");this._pushAction(e),t||(this._fire(i,"preExecute",e),r.preExecute&&r.preExecute(a),this._fire(i,"preExecuted",e)),this._atomicDo(function(){n._fire(i,"execute",e),r.execute&&n._markDirty(r.execute(a)),n._executedAction(e,t),n._fire(i,"executed",e)}),t||(this._fire(i,"postExecute",e),r.postExecute&&r.postExecute(a),this._fire(i,"postExecuted",e)),this._popAction(e)};nt.prototype._pushAction=function(e){var t=this._currentExecution,n=t.actions,i=n[0];if(t.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+e.command+")");e.id||(e.id=i&&i.id||this._createId()),n.push(e)};nt.prototype._popAction=function(){var e=this._currentExecution,t=e.trigger,n=e.actions,i=e.dirty;n.pop(),n.length||(this._eventBus.fire("elements.changed",{elements:rp("id",i.reverse())}),i.length=0,this._fire("changed",{trigger:t}),e.trigger=null)};nt.prototype._markDirty=function(e){var t=this._currentExecution;e&&(e=Oe(e)?e:[e],t.dirty=t.dirty.concat(e))};nt.prototype._executedAction=function(e,t){var n=++this._stackIdx;t||this._stack.splice(n,this._stack.length,e)};nt.prototype._revertedAction=function(e){this._stackIdx--};nt.prototype._getHandler=function(e){return this._handlerMap[e]};nt.prototype._setHandler=function(e,t){if(!e||!t)throw new Error("command and handler required");if(this._handlerMap[e])throw new Error("overriding handler for command <"+e+">");this._handlerMap[e]=t};const SP={commandStack:["type",nt]};var wP=new Sp("tt");function TP(e){var t=Qe('<div class="djs-tooltip-container" style="position: absolute; width: 0; height: 0;" />');return e.insertBefore(t,e.firstChild),t}function CP(e,t,n){q(e.style,{left:t+"px",top:n+"px"})}function Ef(e,t){e.style.display=t===!1?"none":""}var nb="djs-tooltip",Fl="."+nb;function Dt(e,t){this._eventBus=e,this._canvas=t,this._ids=wP,this._tooltipDefaults={show:{minZoom:.7,maxZoom:5}},this._tooltips={},this._tooltipRoot=TP(t.getContainer());var n=this;Ht.bind(this._tooltipRoot,Fl,"mousedown",function(i){i.stopPropagation()}),Ht.bind(this._tooltipRoot,Fl,"mouseover",function(i){n.trigger("mouseover",i)}),Ht.bind(this._tooltipRoot,Fl,"mouseout",function(i){n.trigger("mouseout",i)}),this._init()}Dt.$inject=["eventBus","canvas"];Dt.prototype.add=function(e){if(!e.position)throw new Error("must specifiy tooltip position");if(!e.html)throw new Error("must specifiy tooltip html");var t=this._ids.next();return e=q({},this._tooltipDefaults,e,{id:t}),this._addTooltip(e),e.timeout&&this.setTimeout(e),t};Dt.prototype.trigger=function(e,t){var n=t.delegateTarget||t.target,i=this.get(Ut(n,"data-tooltip-id"));i&&(e==="mouseover"&&i.timeout&&this.clearTimeout(i),e==="mouseout"&&i.timeout&&(i.timeout=1e3,this.setTimeout(i)))};Dt.prototype.get=function(e){return typeof e!="string"&&(e=e.id),this._tooltips[e]};Dt.prototype.clearTimeout=function(e){if(e=this.get(e),!!e){var t=e.removeTimer;t&&(clearTimeout(t),e.removeTimer=null)}};Dt.prototype.setTimeout=function(e){if(e=this.get(e),!!e){this.clearTimeout(e);var t=this;e.removeTimer=setTimeout(function(){t.remove(e)},e.timeout)}};Dt.prototype.remove=function(e){var t=this.get(e);t&&(Nn(t.html),Nn(t.htmlContainer),delete t.htmlContainer,delete this._tooltips[t.id])};Dt.prototype.show=function(){Ef(this._tooltipRoot)};Dt.prototype.hide=function(){Ef(this._tooltipRoot,!1)};Dt.prototype._updateRoot=function(e){var t=e.scale||1,n=e.scale||1,i="matrix("+t+",0,0,"+n+","+-1*e.x*t+","+-1*e.y*n+")";this._tooltipRoot.style.transform=i,this._tooltipRoot.style["-ms-transform"]=i};Dt.prototype._addTooltip=function(e){var t=e.id,n=e.html,i,a=this._tooltipRoot;n.get&&n.constructor.prototype.jquery&&(n=n.get(0)),$t(n)&&(n=Qe(n)),i=Qe('<div data-tooltip-id="'+t+'" class="'+nb+'" style="position: absolute">'),i.appendChild(n),e.type&&dt(i).add("djs-tooltip-"+e.type),e.className&&dt(i).add(e.className),e.htmlContainer=i,a.appendChild(i),this._tooltips[t]=e,this._updateTooltip(e)};Dt.prototype._updateTooltip=function(e){var t=e.position,n=e.htmlContainer;CP(n,t.x,t.y)};Dt.prototype._updateTooltipVisibilty=function(e){j(this._tooltips,function(t){var n=t.show,i=t.htmlContainer,a=!0;n&&((n.minZoom>e.scale||n.maxZoom<e.scale)&&(a=!1),Ef(i,a))})};Dt.prototype._init=function(){var e=this;function t(n){e._updateRoot(n),e._updateTooltipVisibilty(n),e.show()}this._eventBus.on("canvas.viewbox.changing",function(n){e.hide()}),this._eventBus.on("canvas.viewbox.changed",function(n){t(n.viewbox)})};const AP={__init__:["tooltips"],tooltips:["type",Dt]};function sr(e,t){if(typeof t!="function")throw new Error("removeFn iterator must be a function");if(e){for(var n;n=e[0];)t(n);return e}}var PP=250,tm=1400;function bf(e,t,n){pe.call(this,t);var i=e.get("movePreview",!1);t.on("shape.move.start",tm,function(a){var r=a.context,o=r.shapes,s=r.validatedShapes;r.shapes=nm(o),r.validatedShapes=nm(s)}),i&&t.on("shape.move.start",PP,function(a){var r=a.context,o=r.shapes,s=[];j(o,function(l){j(l.labels,function(c){!c.hidden&&r.shapes.indexOf(c)===-1&&s.push(c),l.labelTarget&&s.push(l)})}),j(s,function(l){i.makeDraggable(r,l,!0)})}),this.preExecuted("elements.move",tm,function(a){var r=a.context,o=r.closure,s=o.enclosedElements,l=[];j(s,function(c){j(c.labels,function(p){s[p.id]||l.push(p)})}),o.addAll(l)}),this.preExecute(["connection.delete","shape.delete"],function(a){var r=a.context,o=r.connection||r.shape;sr(o.labels,function(s){n.removeShape(s,{nested:!0})})}),this.execute("shape.delete",function(a){var r=a.context,o=r.shape,s=o.labelTarget;s&&(r.labelTargetIndex=fp(s.labels,o),r.labelTarget=s,o.labelTarget=null)}),this.revert("shape.delete",function(a){var r=a.context,o=r.shape,s=r.labelTarget,l=r.labelTargetIndex;s&&(at(s.labels,o,l),o.labelTarget=s)})}ye(bf,pe);bf.$inject=["injector","eventBus","modeling"];function nm(e){return Ie(e,function(t){return e.indexOf(t.labelTarget)===-1})}const RP={__init__:["labelSupport"],labelSupport:["type",bf]};var IP=251,im=1401,rm="attach-ok";function xf(e,t,n,i,a){pe.call(this,t);var r=e.get("movePreview",!1);t.on("shape.move.start",im,function(o){var s=o.context,l=s.shapes,c=s.validatedShapes;s.shapes=NP(l),s.validatedShapes=MP(c)}),r&&t.on("shape.move.start",IP,function(o){var s=o.context,l=s.shapes,c=Xc(l);j(c,function(p){r.makeDraggable(s,p,!0),j(p.labels,function(f){r.makeDraggable(s,f,!0)})})}),r&&t.on("shape.move.start",function(o){var s=o.context,l=s.shapes;if(l.length===1){var c=l[0],p=c.host;p&&(n.addMarker(p,rm),t.once(["shape.move.out","shape.move.cleanup"],function(){n.removeMarker(p,rm)}))}}),this.preExecuted("elements.move",im,function(o){var s=o.context,l=s.closure,c=s.shapes,p=Xc(c);j(p,function(f){l.add(f,l.topLevel[f.host.id])})}),this.postExecuted("elements.move",function(o){var s=o.context,l=s.shapes,c=s.newHost,p;c&&l.length!==1||(c?p=l:p=Ie(l,function(f){var h=f.host;return DP(f)&&!kP(l,h)}),j(p,function(f){a.updateAttachment(f,c)}))}),this.postExecuted("elements.move",function(o){var s=o.context.shapes;j(s,function(l){j(l.attachers,function(c){j(c.outgoing.slice(),function(p){var f=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});f||a.removeConnection(p)}),j(c.incoming.slice(),function(p){var f=i.allowed("connection.reconnect",{connection:p,source:p.source,target:p.target});f||a.removeConnection(p)})})})}),this.postExecute("shape.create",function(o){var s=o.context,l=s.shape,c=s.host;c&&a.updateAttachment(l,c)}),this.postExecute("shape.replace",function(o){var s=o.context,l=s.oldShape,c=s.newShape;sr(l.attachers,function(p){var f=i.allowed("elements.move",{target:c,shapes:[p]});f==="attach"?a.updateAttachment(p,c):a.removeShape(p)}),c.attachers.length&&j(c.attachers,function(p){var f=Wh(p,l,c);a.moveShape(p,f,p.parent)})}),this.postExecute("shape.resize",function(o){var s=o.context,l=s.shape,c=s.oldBounds,p=s.newBounds,f=l.attachers,h=s.hints||{};h.attachSupport!==!1&&j(f,function(v){var m=Wh(v,c,p);a.moveShape(v,m,v.parent),j(v.labels,function(_){a.moveShape(_,m,_.parent)})})}),this.preExecute("shape.delete",function(o){var s=o.context.shape;sr(s.attachers,function(l){a.removeShape(l)}),s.host&&a.updateAttachment(s,null)})}ye(xf,pe);xf.$inject=["injector","eventBus","canvas","rules","modeling"];function Xc(e){return ua(ht(e,function(t){return t.attachers||[]}))}function NP(e){var t=Xc(e);return gg("id",e,t)}function MP(e){var t=Vi(e,"id");return Ie(e,function(n){for(;n;){if(n.host&&t[n.host.id])return!1;n=n.parent}return!0})}function DP(e){return!!e.host}function kP(e,t){return e.indexOf(t)!==-1}const OP={__depends__:[On],__init__:["attachSupport"],attachSupport:["type",xf]};var LP=250;function qi(e,t){this._eventBus=e,this._dragging=t,this._tools=[],this._active=null}qi.$inject=["eventBus","dragging"];qi.prototype.registerTool=function(e,t){var n=this._tools;if(!t)throw new Error(`A tool has to be registered with it's "events"`);n.push(e),this.bindEvents(e,t)};qi.prototype.isActive=function(e){return e&&this._active===e};qi.prototype.length=function(e){return this._tools.length};qi.prototype.setActive=function(e){var t=this._eventBus;this._active!==e&&(this._active=e,t.fire("tool-manager.update",{tool:e}))};qi.prototype.bindEvents=function(e,t){var n=this._eventBus,i=this._dragging,a=[];n.on(t.tool+".init",function(r){var o=r.context;if(!o.reactivate&&this.isActive(e)){this.setActive(null),i.cancel();return}this.setActive(e)},this),j(t,function(r){a.push(r+".ended"),a.push(r+".canceled")}),n.on(a,LP,function(r){this._active&&(BP(r)||this.setActive(null))},this)};function BP(e){var t=e.originalEvent&&e.originalEvent.target;return t&&Fi(t,'.group[data-group="tools"]')}const tl={__depends__:[Zn],__init__:["toolManager"],toolManager:["type",qi]};function $P(e,t){if(e==="x"){if(t>0)return"e";if(t<0)return"w"}if(e==="y"){if(t>0)return"s";if(t<0)return"n"}return null}function VP(e,t){var n=[];return j(e.concat(t),function(i){var a=i.incoming,r=i.outgoing;j(a.concat(r),function(o){var s=o.source,l=o.target;(Qr(e,s)||Qr(e,l)||Qr(t,s)||Qr(t,l))&&(Qr(n,o)||n.push(o))})}),n}function Qr(e,t){return e.indexOf(t)!==-1}function FP(e,t,n){var i=e.x,a=e.y,r=e.width,o=e.height,s=n.x,l=n.y;switch(t){case"n":return{x:i,y:a+l,width:r,height:o-l};case"s":return{x:i,y:a,width:r,height:o+l};case"w":return{x:i+s,y:a,width:r-s,height:o};case"e":return{x:i,y:a,width:r+s,height:o};default:throw new Error("unknown direction: "+t)}}var jl=Math.abs,jP=Math.round,Fn={x:"width",y:"height"},ib="crosshair",Oo={n:"top",w:"left",s:"bottom",e:"right"},HP=1500,am={n:"s",w:"e",s:"n",e:"w"},Lo=20;function ei(e,t,n,i,a,r,o){this._canvas=e,this._dragging=t,this._eventBus=n,this._modeling=i,this._rules=a,this._toolManager=r,this._mouse=o;var s=this;r.registerTool("space",{tool:"spaceTool.selection",dragging:"spaceTool"}),n.on("spaceTool.selection.end",function(l){n.once("spaceTool.selection.ended",function(){s.activateMakeSpace(l.originalEvent)})}),n.on("spaceTool.move",HP,function(l){var c=l.context,p=c.initialized;p||(p=c.initialized=s.init(l,c)),p&&sm(l)}),n.on("spaceTool.end",function(l){var c=l.context,p=c.axis,f=c.direction,h=c.movingShapes,v=c.resizingShapes,m=c.start;if(c.initialized){sm(l);var _={x:0,y:0};_[p]=jP(l["d"+p]),s.makeSpace(h,v,_,f,m),n.once("spaceTool.ended",function(b){s.activateSelection(b.originalEvent,!0,!0)})}})}ei.$inject=["canvas","dragging","eventBus","modeling","rules","toolManager","mouse"];ei.prototype.activateSelection=function(e,t,n){this._dragging.init(e,"spaceTool.selection",{autoActivate:t,cursor:ib,data:{context:{reactivate:n}},trapClick:!1})};ei.prototype.activateMakeSpace=function(e){this._dragging.init(e,"spaceTool",{autoActivate:!0,cursor:ib,data:{context:{}}})};ei.prototype.makeSpace=function(e,t,n,i,a){return this._modeling.createSpace(e,t,n,i,a)};ei.prototype.init=function(e,t){var n=jl(e.dx)>jl(e.dy)?"x":"y",i=e["d"+n],a=e[n]-i;if(jl(i)<5)return!1;i<0&&(i*=-1),mr(e)&&(i*=-1);var r=$P(n,i),o=this._canvas.getRootElement(),s=Ss(o,!0),l=this.calculateAdjustments(s,n,i,a),c=this._eventBus.fire("spaceTool.getMinDimensions",{axis:n,direction:r,shapes:l.resizingShapes,start:a}),p=GP(l,n,r,a,c);return q(t,l,{axis:n,direction:r,spaceToolConstraints:p,start:a}),Bs("resize-"+(n==="x"?"ew":"ns")),!0};ei.prototype.calculateAdjustments=function(e,t,n,i){var a=this._rules,r=[],o=[];return j(e,function(s){if(!(!s.parent||Zc(s))){var l=s[t],c=l+s[Fn[t]];if(n>0&&l>i||n<0&&c<i)return r.push(s);if(l<i&&c>i&&a.allowed("shape.resize",{shape:s}))return o.push(s)}}),{movingShapes:r,resizingShapes:o}};ei.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};ei.prototype.isActive=function(){var e=this._dragging.context();return e&&/^spaceTool/.test(e.prefix)};function om(e){return{top:e.top-Lo,right:e.right+Lo,bottom:e.bottom+Lo,left:e.left-Lo}}function sm(e){var t=e.context,n=t.spaceToolConstraints;if(n){var i,a;Re(n.left)&&(i=Math.max(e.x,n.left),e.dx=e.dx+i-e.x,e.x=i),Re(n.right)&&(i=Math.min(e.x,n.right),e.dx=e.dx+i-e.x,e.x=i),Re(n.top)&&(a=Math.max(e.y,n.top),e.dy=e.dy+a-e.y,e.y=a),Re(n.bottom)&&(a=Math.min(e.y,n.bottom),e.dy=e.dy+a-e.y,e.y=a)}}function GP(e,t,n,i,a){var r=e.movingShapes,o=e.resizingShapes;if(o.length){var s={},l,c;return j(o,function(p){var f=_e(p),h=Ie(p.children,function(P){return!Zc(P)&&!lm(P)&&!Hl(r,P)&&!Hl(o,P)}),v=Ie(p.children,function(P){return!Zc(P)&&!lm(P)&&Hl(r,P)}),m,_,b;h.length&&(_=om(_e(St(h))),m=i-f[Oo[n]]+_[Oo[n]],n==="n"?s.bottom=c=Re(c)?Math.min(c,m):m:n==="w"?s.right=c=Re(c)?Math.min(c,m):m:n==="s"?s.top=l=Re(l)?Math.max(l,m):m:n==="e"&&(s.left=l=Re(l)?Math.max(l,m):m)),v.length&&(b=om(_e(St(v))),m=i-b[Oo[am[n]]]+f[Oo[am[n]]],n==="n"?s.bottom=c=Re(c)?Math.min(c,m):m:n==="w"?s.right=c=Re(c)?Math.min(c,m):m:n==="s"?s.top=l=Re(l)?Math.max(l,m):m:n==="e"&&(s.left=l=Re(l)?Math.max(l,m):m));var M=a&&a[p.id];M&&(n==="n"?(m=i+p[Fn[t]]-M[Fn[t]],s.bottom=c=Re(c)?Math.min(c,m):m):n==="w"?(m=i+p[Fn[t]]-M[Fn[t]],s.right=c=Re(c)?Math.min(c,m):m):n==="s"?(m=i-p[Fn[t]]+M[Fn[t]],s.top=l=Re(l)?Math.max(l,m):m):n==="e"&&(m=i-p[Fn[t]]+M[Fn[t]],s.left=l=Re(l)?Math.max(l,m):m))}),s}}function Hl(e,t){return e.indexOf(t)!==-1}function Zc(e){return!!e.waypoints}function lm(e){return!!e.labelTarget}var Gl="djs-dragging",um="djs-resizing",zP=250,Bo=Math.max;function rb(e,t,n,i,a){function r(o,s){j(o,function(l){a.addDragger(l,s),n.addMarker(l,Gl)})}e.on("spaceTool.selection.start",function(o){var s=n.getLayer("space"),l=o.context,c={x:"M 0,-10000 L 0,10000",y:"M -10000,0 L 10000,0"},p=be("g");ae(p,i.cls("djs-crosshair-group",["no-events"])),Ce(s,p);var f=be("path");ae(f,"d",c.x),Le(f).add("djs-crosshair"),Ce(p,f);var h=be("path");ae(h,"d",c.y),Le(h).add("djs-crosshair"),Ce(p,h),l.crosshairGroup=p}),e.on("spaceTool.selection.move",function(o){var s=o.context.crosshairGroup;Bt(s,o.x,o.y)}),e.on("spaceTool.selection.cleanup",function(o){var s=o.context,l=s.crosshairGroup;l&&ot(l)}),e.on("spaceTool.move",zP,function(o){var s=o.context,l=s.line,c=s.axis,p=s.movingShapes,f=s.resizingShapes;if(s.initialized){if(!s.dragGroup){var h=n.getLayer("space");l=be("path"),ae(l,"d","M0,0 L0,0"),Le(l).add("djs-crosshair"),Ce(h,l),s.line=l;var v=be("g");ae(v,i.cls("djs-drag-group",["no-events"])),Ce(n.getActiveLayer(),v),r(p,v);var m=s.movingConnections=t.filter(function(w){var T=!1;j(p,function(H){j(H.outgoing,function(Z){w===Z&&(T=!0)})});var N=!1;j(p,function(H){j(H.incoming,function(Z){w===Z&&(N=!0)})});var B=!1;j(f,function(H){j(H.outgoing,function(Z){w===Z&&(B=!0)})});var $=!1;return j(f,function(H){j(H.incoming,function(Z){w===Z&&($=!0)})}),UP(w)&&(T||B)&&(N||$)});r(m,v),s.dragGroup=v}if(!s.frameGroup){var _=be("g");ae(_,i.cls("djs-frame-group",["no-events"])),Ce(n.getActiveLayer(),_);var b=[];j(f,function(w){var T=a.addFrame(w,_),N=T.getBBox();b.push({element:T,initialBounds:N}),n.addMarker(w,um)}),s.frameGroup=_,s.frames=b}var M={x:"M"+o.x+", -10000 L"+o.x+", 10000",y:"M -10000, "+o.y+" L 10000, "+o.y};ae(l,{d:M[c]});var P={x:"y",y:"x"},S={x:o.dx,y:o.dy};S[P[s.axis]]=0,Bt(s.dragGroup,S.x,S.y),j(s.frames,function(w){var T=w.element,N=w.initialBounds,B,$;s.direction==="e"?ae(T,{width:Bo(N.width+S.x,5)}):(B=Bo(N.width-S.x,5),ae(T,{width:B,x:N.x+N.width-B})),s.direction==="s"?ae(T,{height:Bo(N.height+S.y,5)}):($=Bo(N.height-S.y,5),ae(T,{height:$,y:N.y+N.height-$}))})}}),e.on("spaceTool.cleanup",function(o){var s=o.context,l=s.movingShapes,c=s.movingConnections,p=s.resizingShapes,f=s.line,h=s.dragGroup,v=s.frameGroup;j(l,function(m){n.removeMarker(m,Gl)}),j(c,function(m){n.removeMarker(m,Gl)}),h&&(ot(f),ot(h)),j(p,function(m){n.removeMarker(m,um)}),v&&ot(v)})}rb.$inject=["eventBus","elementRegistry","canvas","styles","previewSupport"];function UP(e){return e.waypoints}const ab={__init__:["spaceToolPreview"],__depends__:[Zn,On,tl,Ra,Na],spaceTool:["type",ei],spaceToolPreview:["type",rb]};function pn(e){this._model=e}pn.$inject=["moddle"];pn.prototype._needsId=function(e){return je(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])};pn.prototype._ensureId=function(e){var t;A(e,"bpmn:Activity")?t="Activity":A(e,"bpmn:Event")?t="Event":A(e,"bpmn:Gateway")?t="Gateway":je(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?t="Flow":t=(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))};pn.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n};pn.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})};pn.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",q({bpmnElement:e,bounds:this.createDiBounds(t)},n))};pn.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)};pn.prototype.createDiWaypoints=function(e){var t=this;return ht(e,function(n){return t.createDiWaypoint(n)})};pn.prototype.createDiWaypoint=function(e){return this.create("dc:Point",rn(e,["x","y"]))};pn.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",q({bpmnElement:e,waypoint:this.createDiWaypoints(t)},n))};pn.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};function jt(e,t,n,i){pe.call(this,e),this._bpmnFactory=t,this._translate=i;var a=this;function r(v){var m=v.context,_=m.hints||{},b;!m.cropped&&_.createElementsBehavior!==!1&&(b=m.connection,b.waypoints=n.getCroppedWaypoints(b),m.cropped=!0)}this.executed(["connection.layout","connection.create"],r),this.reverted(["connection.layout"],function(v){delete v.context.cropped});function o(v){var m=v.context;a.updateParent(m.shape||m.connection,m.oldParent)}function s(v){var m=v.context,_=m.shape||m.connection,b=m.parent||m.newParent;a.updateParent(_,b)}this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Kt(o)),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],Kt(s));function l(v){var m=v.context,_=m.oldRoot,b=_.children;j(b,function(M){A(M,"bpmn:BaseElement")&&a.updateParent(M)})}this.executed(["canvas.updateRoot"],l),this.reverted(["canvas.updateRoot"],l);function c(v){var m=v.context.shape;A(m,"bpmn:BaseElement")&&a.updateBounds(m)}this.executed(["shape.move","shape.create","shape.resize"],Kt(function(v){v.context.shape.type!=="label"&&c(v)})),this.reverted(["shape.move","shape.create","shape.resize"],Kt(function(v){v.context.shape.type!=="label"&&c(v)})),e.on("shape.changed",function(v){v.element.type==="label"&&c({context:{shape:v.element}})});function p(v){a.updateConnection(v.context)}this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],Kt(p)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],Kt(p));function f(v){a.updateConnectionWaypoints(v.context.connection)}this.executed(["connection.layout","connection.move","connection.updateWaypoints"],Kt(f)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],Kt(f)),this.executed("connection.reconnect",Kt(function(v){var m=v.context,_=m.connection,b=m.oldSource,M=m.newSource,P=he(_),S=he(b),w=he(M);P.conditionExpression&&!je(w,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(m.oldConditionExpression=P.conditionExpression,delete P.conditionExpression),b!==M&&S.default===P&&(m.oldDefault=S.default,delete S.default)})),this.reverted("connection.reconnect",Kt(function(v){var m=v.context,_=m.connection,b=m.oldSource,M=m.newSource,P=he(_),S=he(b),w=he(M);m.oldConditionExpression&&(P.conditionExpression=m.oldConditionExpression),m.oldDefault&&(S.default=m.oldDefault,delete w.default)}));function h(v){a.updateAttachment(v.context)}this.executed(["element.updateAttachment"],Kt(h)),this.reverted(["element.updateAttachment"],Kt(h))}ye(jt,pe);jt.$inject=["eventBus","bpmnFactory","connectionDocking","translate"];jt.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,i=t.host;n.attachedToRef=i&&i.businessObject};jt.prototype.updateParent=function(e,t){if(!(e instanceof ws)&&!(A(e,"bpmn:DataStoreReference")&&e.parent&&A(e.parent,"bpmn:Collaboration"))){var n=e.parent,i=e.businessObject,a=n&&n.businessObject,r=a&&a.di;A(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(i,a,t&&t.businessObject),A(e,"bpmn:DataOutputAssociation")&&(e.source?a=e.source.businessObject:a=null),A(e,"bpmn:DataInputAssociation")&&(e.target?a=e.target.businessObject:a=null),this.updateSemanticParent(i,a),A(e,"bpmn:DataObjectReference")&&i.dataObjectRef&&this.updateSemanticParent(i.dataObjectRef,a),this.updateDiParent(i.di,r)}};jt.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof ws?this._getLabel(t):t,i=n.bounds;i||(i=this._bpmnFactory.createDiBounds(),n.set("bounds",i)),q(i,{x:e.x,y:e.y,width:e.width,height:e.height})};jt.prototype.updateFlowNodeRefs=function(e,t,n){if(n!==t){var i,a;A(n,"bpmn:Lane")&&(i=n.get("flowNodeRef"),rt(i,e)),A(t,"bpmn:Lane")&&(a=t.get("flowNodeRef"),at(a,e))}};jt.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)};jt.prototype.updateDiParent=function(e,t){if(t&&!A(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(rt(n,e),e.$parent=null)}};function qP(e){for(;e&&!A(e,"bpmn:Definitions");)e=e.$parent;return e}jt.prototype.getLaneSet=function(e){var t,n;return A(e,"bpmn:Lane")?(t=e.childLaneSet,t||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(A(e,"bpmn:Participant")&&(e=e.processRef),n=e.get("laneSets"),t=n[0],t||(t=this._bpmnFactory.create("bpmn:LaneSet"),t.$parent=e,n.push(t)),t)};jt.prototype.updateSemanticParent=function(e,t,n){var i,a=this._translate;if(e.$parent!==t&&!((A(e,"bpmn:DataInput")||A(e,"bpmn:DataOutput"))&&(A(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),"ioSpecification"in t&&t.ioSpecification===e.$parent))){if(A(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),i="lanes";else if(A(e,"bpmn:FlowElement")){if(t){if(A(t,"bpmn:Participant"))t=t.processRef;else if(A(t,"bpmn:Lane"))do t=t.$parent.$parent;while(A(t,"bpmn:Lane"))}i="flowElements"}else if(A(e,"bpmn:Artifact")){for(;t&&!A(t,"bpmn:Process")&&!A(t,"bpmn:SubProcess")&&!A(t,"bpmn:Collaboration");)if(A(t,"bpmn:Participant")){t=t.processRef;break}else t=t.$parent;i="artifacts"}else if(A(e,"bpmn:MessageFlow"))i="messageFlows";else if(A(e,"bpmn:Participant")){i="participants";var r=e.processRef,o;r&&(o=qP(e.$parent||t),e.$parent&&(rt(o.get("rootElements"),r),r.$parent=null),t&&(at(o.get("rootElements"),r),r.$parent=o))}else A(e,"bpmn:DataOutputAssociation")?i="dataOutputAssociations":A(e,"bpmn:DataInputAssociation")&&(i="dataInputAssociations");if(!i)throw new Error(a("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var s;if(e.$parent&&(s=e.$parent.get(i),rt(s,e)),t?(s=t.get(i),s.push(e),e.$parent=t):e.$parent=null,n){var l=n.get(i);rt(s,e),t&&(l||(l=[],t.set(i,l)),l.push(e))}}};jt.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))};jt.prototype.updateConnection=function(e){var t=e.connection,n=he(t),i=he(t.source),a=he(t.target),r;if(A(n,"bpmn:DataAssociation"))A(n,"bpmn:DataInputAssociation")?(n.get("sourceRef")[0]=i,r=e.parent||e.newParent||a,this.updateSemanticParent(n,a,r)):A(n,"bpmn:DataOutputAssociation")&&(r=e.parent||e.newParent||i,this.updateSemanticParent(n,i,r),n.targetRef=a);else{var o=A(n,"bpmn:SequenceFlow");n.sourceRef!==i&&(o&&(rt(n.sourceRef&&n.sourceRef.get("outgoing"),n),i&&i.get("outgoing")&&i.get("outgoing").push(n)),n.sourceRef=i),n.targetRef!==a&&(o&&(rt(n.targetRef&&n.targetRef.get("incoming"),n),a&&a.get("incoming")&&a.get("incoming").push(n)),n.targetRef=a)}this.updateConnectionWaypoints(t),this.updateDiConnection(n.di,i,a)};jt.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};function Kt(e){return function(t){var n=t.context,i=n.shape||n.connection;A(i,"bpmn:BaseElement")&&e(t)}}function Ei(e,t,n){Wn.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}ye(Ei,Wn);Ei.$inject=["bpmnFactory","moddle","translate"];Ei.prototype.baseCreate=Wn.prototype.create;Ei.prototype.create=function(e,t){return e==="label"?this.baseCreate(e,q({type:"label"},da,t)):this.createBpmnElement(e,t)};Ei.prototype.createBpmnElement=function(e,t){var n,i=this._translate;t=t||{};var a=t.businessObject;if(!a){if(!t.type)throw new Error(i("no shape type specified"));a=this._bpmnFactory.create(t.type)}a.di||(e==="root"?a.di=this._bpmnFactory.createDiPlane(a,[],{id:a.id+"_di"}):e==="connection"?a.di=this._bpmnFactory.createDiEdge(a,[],{id:a.id+"_di"}):a.di=this._bpmnFactory.createDiShape(a,{},{id:a.id+"_di"})),A(a,"bpmn:Group")&&(t=q({isFrame:!0},t)),t.di&&(q(a.di,t.di),delete t.di),WP(a,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&ob(a.di,t,"isExpanded"),A(a,"bpmn:ExclusiveGateway")&&(a.di.isMarkerVisible=!0);var r,o;return t.eventDefinitionType&&(r=a.get("eventDefinitions")||[],o=this._bpmnFactory.create(t.eventDefinitionType,t.eventDefinitionAttrs),t.eventDefinitionType==="bpmn:ConditionalEventDefinition"&&(o.condition=this._bpmnFactory.create("bpmn:FormalExpression")),r.push(o),o.$parent=a,a.eventDefinitions=r,delete t.eventDefinitionType),n=this._getDefaultSize(a),t=q({businessObject:a,id:a.id},n,t),this.baseCreate(e,t)};Ei.prototype._getDefaultSize=function(e){return A(e,"bpmn:SubProcess")?We(e)?{width:350,height:200}:{width:100,height:80}:A(e,"bpmn:Task")?{width:100,height:80}:A(e,"bpmn:Gateway")?{width:50,height:50}:A(e,"bpmn:Event")?{width:36,height:36}:A(e,"bpmn:Participant")?We(e)?{width:600,height:250}:{width:400,height:60}:A(e,"bpmn:Lane")?{width:400,height:100}:A(e,"bpmn:DataObjectReference")?{width:36,height:50}:A(e,"bpmn:DataStoreReference")?{width:50,height:50}:A(e,"bpmn:TextAnnotation")?{width:100,height:30}:A(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}};Ei.prototype.createParticipantShape=function(e){return st(e)||(e={isExpanded:e}),e=q({type:"bpmn:Participant"},e||{}),e.isExpanded!==!1&&(e.processRef=this._bpmnFactory.create("bpmn:Process")),this.createShape(e)};function WP(e,t,n){j(n,function(i){t[i]!==void 0&&ob(e,t,i)})}function ob(e,t,n){e[n]=t[n],delete t[n]}function nl(e,t){this._modeling=e,this._canvas=t}nl.$inject=["modeling","canvas"];nl.prototype.preExecute=function(e){var t=this._modeling,n=e.elements,i=e.alignment;j(n,function(a){var r={x:0,y:0};i.left?r.x=i.left-a.x:i.right?r.x=i.right-a.width-a.x:i.center?r.x=i.center-Math.round(a.width/2)-a.x:i.top?r.y=i.top-a.y:i.bottom?r.y=i.bottom-a.height-a.y:i.middle&&(r.y=i.middle-Math.round(a.height/2)-a.y),t.moveElements([a],r,a.parent)})};nl.prototype.postExecute=function(e){};function il(e){this._modeling=e}il.$inject=["modeling"];il.prototype.preExecute=function(e){var t=e.source;if(!t)throw new Error("source required");var n=e.target||t.parent,i=e.shape,a=e.hints||{};i=e.shape=this._modeling.createShape(i,e.position,n,{attach:a.attach}),e.shape=i};il.prototype.postExecute=function(e){var t=e.hints||{};YP(e.source,e.shape)||(t.connectionTarget===e.source?this._modeling.connect(e.shape,e.source,e.connection):this._modeling.connect(e.source,e.shape,e.connection))};function YP(e,t){return fi(e.outgoing,function(n){return n.target===t})}function rl(e,t){this._canvas=e,this._layouter=t}rl.$inject=["canvas","layouter"];rl.prototype.execute=function(e){var t=e.connection,n=e.source,i=e.target,a=e.parent,r=e.parentIndex,o=e.hints;if(!n||!i)throw new Error("source and target required");if(!a)throw new Error("parent required");return t.source=n,t.target=i,t.waypoints||(t.waypoints=this._layouter.layoutConnection(t,o)),this._canvas.addConnection(t,a,r),t};rl.prototype.revert=function(e){var t=e.connection;return this._canvas.removeConnection(t),t.source=null,t.target=null,t};var $o=Math.round;function _f(e){this._modeling=e}_f.$inject=["modeling"];_f.prototype.preExecute=function(e){var t=e.elements,n=e.parent,i=e.parentIndex,a=e.position,r=e.hints,o=this._modeling;j(t,function(p){Re(p.x)||(p.x=0),Re(p.y)||(p.y=0)});var s=St(t);j(t,function(p){cm(p)&&(p.waypoints=ht(p.waypoints,function(f){return{x:$o(f.x-s.x-s.width/2+a.x),y:$o(f.y-s.y-s.height/2+a.y)}})),q(p,{x:$o(p.x-s.x-s.width/2+a.x),y:$o(p.y-s.y-s.height/2+a.y)})});var l=Ig(t),c={};j(t,function(p){if(cm(p)){c[p.id]=Re(i)?o.createConnection(c[p.source.id],c[p.target.id],i,p,p.parent||n,r):o.createConnection(c[p.source.id],c[p.target.id],p,p.parent||n,r);return}var f=q({},r);l.indexOf(p)===-1&&(f.autoResize=!1),c[p.id]=Re(i)?o.createShape(p,rn(p,["x","y","width","height"]),p.parent||n,i,f):o.createShape(p,rn(p,["x","y","width","height"]),p.parent||n,f)}),e.elements=xs(c)};function cm(e){return!!e.waypoints}var pm=Math.round;function bi(e){this._canvas=e}bi.$inject=["canvas"];bi.prototype.execute=function(e){var t=e.shape,n=e.position,i=e.parent,a=e.parentIndex;if(!i)throw new Error("parent required");if(!n)throw new Error("position required");return n.width!==void 0?q(t,n):q(t,{x:n.x-pm(t.width/2),y:n.y-pm(t.height/2)}),this._canvas.addShape(t,i,a),t};bi.prototype.revert=function(e){var t=e.shape;return this._canvas.removeShape(t),t};function Ba(e){bi.call(this,e)}ye(Ba,bi);Ba.$inject=["canvas"];var KP=bi.prototype.execute;Ba.prototype.execute=function(e){var t=e.shape;return ZP(t),t.labelTarget=e.labelTarget,KP.call(this,e)};var XP=bi.prototype.revert;Ba.prototype.revert=function(e){return e.shape.labelTarget=null,XP.call(this,e)};function ZP(e){["width","height"].forEach(function(t){typeof e[t]>"u"&&(e[t]=0)})}function al(e,t){this._canvas=e,this._modeling=t}al.$inject=["canvas","modeling"];al.prototype.execute=function(e){var t=e.connection,n=t.parent;return e.parent=n,e.parentIndex=fp(n.children,t),e.source=t.source,e.target=t.target,this._canvas.removeConnection(t),t.source=null,t.target=null,t};al.prototype.revert=function(e){var t=e.connection,n=e.parent,i=e.parentIndex;return t.source=e.source,t.target=e.target,at(n.children,t,i),this._canvas.addConnection(t,n),t};function Sf(e,t){this._modeling=e,this._elementRegistry=t}Sf.$inject=["modeling","elementRegistry"];Sf.prototype.postExecute=function(e){var t=this._modeling,n=this._elementRegistry,i=e.elements;j(i,function(a){n.get(a.id)&&(a.waypoints?t.removeConnection(a):t.removeShape(a))})};function $a(e,t){this._canvas=e,this._modeling=t}$a.$inject=["canvas","modeling"];$a.prototype.preExecute=function(e){var t=this._modeling,n=e.shape;sr(n.incoming,function(i){t.removeConnection(i,{nested:!0})}),sr(n.outgoing,function(i){t.removeConnection(i,{nested:!0})}),sr(n.children,function(i){JP(i)?t.removeConnection(i,{nested:!0}):t.removeShape(i,{nested:!0})})};$a.prototype.execute=function(e){var t=this._canvas,n=e.shape,i=n.parent;return e.oldParent=i,e.oldParentIndex=fp(i.children,n),t.removeShape(n),n};$a.prototype.revert=function(e){var t=this._canvas,n=e.shape,i=e.oldParent,a=e.oldParentIndex;return at(i.children,n,a),t.addShape(n,i),n};function JP(e){return e.waypoints}function ol(e){this._modeling=e}ol.$inject=["modeling"];var fm={x:"y",y:"x"};ol.prototype.preExecute=function(e){var t=this._modeling,n=e.groups,i=e.axis,a=e.dimension;function r(b,M){b.range.min=Math.min(M[i],b.range.min),b.range.max=Math.max(M[i]+M[a],b.range.max)}function o(b){return b[i]+b[a]/2}function s(b){return b.length-1}function l(b){return b.max-b.min}function c(b,M){var P={y:0};P[i]=b-o(M),P[i]&&(P[fm[i]]=0,t.moveElements([M],P,M.parent))}var p=n[0],f=s(n),h=n[f],v,m,_=0;j(n,function(b,M){var P,S,w;if(b.elements.length<2){M&&M!==n.length-1&&(r(b,b.elements[0]),_+=l(b.range));return}P=nn(b.elements,i),S=P[0],M===f&&(S=P[s(P)]),w=o(S),b.range=null,j(P,function(T){if(c(w,T),b.range===null){b.range={min:T[i],max:T[i]+T[a]};return}r(b,T)}),M&&M!==n.length-1&&(_+=l(b.range))}),m=Math.abs(h.range.min-p.range.max),v=Math.round((m-_)/(n.length-1)),!(v<n.length-1)&&j(n,function(b,M){var P={},S;b===p||b===h||(S=n[M-1],b.range.max=0,j(b.elements,function(w,T){P[fm[i]]=0,P[i]=S.range.max-w[i]+v,b.range.min!==w[i]&&(P[i]+=w[i]-b.range.min),P[i]&&t.moveElements([w],P,w.parent),b.range.max=Math.max(w[i]+w[a],T?b.range.max:0)}))})};ol.prototype.postExecute=function(e){};function sl(e,t){this._layouter=e,this._canvas=t}sl.$inject=["layouter","canvas"];sl.prototype.execute=function(e){var t=e.connection,n=t.waypoints;return q(e,{oldWaypoints:n}),t.waypoints=this._layouter.layoutConnection(t,e.hints),t};sl.prototype.revert=function(e){var t=e.connection;return t.waypoints=e.oldWaypoints,t};function wf(){}wf.prototype.execute=function(e){var t=e.connection,n=e.delta,i=e.newParent||t.parent,a=e.newParentIndex,r=t.parent;return e.oldParent=r,e.oldParentIndex=rt(r.children,t),at(i.children,t,a),t.parent=i,j(t.waypoints,function(o){o.x+=n.x,o.y+=n.y,o.original&&(o.original.x+=n.x,o.original.y+=n.y)}),t};wf.prototype.revert=function(e){var t=e.connection,n=t.parent,i=e.oldParent,a=e.oldParentIndex,r=e.delta;return rt(n.children,t),at(i.children,t,a),t.parent=i,j(t.waypoints,function(o){o.x-=r.x,o.y-=r.y,o.original&&(o.original.x-=r.x,o.original.y-=r.y)}),t};function Tf(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}Tf.prototype.add=function(e,t){return this.addAll([e],t)};Tf.prototype.addAll=function(e,t){var n=s_(e,!!t,this);return q(this,n),this};function Va(e){this._modeling=e}Va.prototype.moveRecursive=function(e,t,n){return e?this.moveClosure(this.getClosure(e),t,n):[]};Va.prototype.moveClosure=function(e,t,n,i,a){var r=this._modeling,o=e.allShapes,s=e.allConnections,l=e.enclosedConnections,c=e.topLevel,p=!1;a&&a.parent===n&&(p=!0),j(o,function(f){r.moveShape(f,t,c[f.id]&&!p&&n,{recurse:!1,layout:!1})}),j(s,function(f){var h=!!o[f.source.id],v=!!o[f.target.id];l[f.id]&&h&&v?r.moveConnection(f,t,c[f.id]&&!p&&n):r.layoutConnection(f,{connectionStart:h&&rf(f,f.source,t),connectionEnd:v&&af(f,f.target,t)})})};Va.prototype.getClosure=function(e){return new Tf().addAll(e,!0)};function ll(e){this._helper=new Va(e)}ll.$inject=["modeling"];ll.prototype.preExecute=function(e){e.closure=this._helper.getClosure(e.shapes)};ll.prototype.postExecute=function(e){var t=e.hints,n;t&&t.primaryShape&&(n=t.primaryShape,t.oldParent=n.parent),this._helper.moveClosure(e.closure,e.delta,e.newParent,e.newHost,n)};function Wi(e){this._modeling=e,this._helper=new Va(e)}Wi.$inject=["modeling"];Wi.prototype.execute=function(e){var t=e.shape,n=e.delta,i=e.newParent||t.parent,a=e.newParentIndex,r=t.parent;return e.oldBounds=rn(t,["x","y","width","height"]),e.oldParent=r,e.oldParentIndex=rt(r.children,t),at(i.children,t,a),q(t,{parent:i,x:t.x+n.x,y:t.y+n.y}),t};Wi.prototype.postExecute=function(e){var t=e.shape,n=e.delta,i=e.hints,a=this._modeling;i.layout!==!1&&(j(t.incoming,function(r){a.layoutConnection(r,{connectionEnd:af(r,t,n)})}),j(t.outgoing,function(r){a.layoutConnection(r,{connectionStart:rf(r,t,n)})})),i.recurse!==!1&&this.moveChildren(e)};Wi.prototype.revert=function(e){var t=e.shape,n=e.oldParent,i=e.oldParentIndex,a=e.delta;return at(n.children,t,i),q(t,{parent:n,x:t.x-a.x,y:t.y-a.y}),t};Wi.prototype.moveChildren=function(e){var t=e.delta,n=e.shape;this._helper.moveRecursive(n.children,t,null)};Wi.prototype.getNewParent=function(e){return e.newParent||e.shape.parent};function Fa(e){this._modeling=e}Fa.$inject=["modeling"];Fa.prototype.execute=function(e){var t=e.newSource,n=e.newTarget,i=e.connection,a=e.dockingOrPoints;if(!t&&!n)throw new Error("newSource or newTarget required");return Oe(a)&&(e.oldWaypoints=i.waypoints,i.waypoints=a),t&&(e.oldSource=i.source,i.source=t),n&&(e.oldTarget=i.target,i.target=n),i};Fa.prototype.postExecute=function(e){var t=e.connection,n=e.newSource,i=e.newTarget,a=e.dockingOrPoints,r=e.hints||{},o={};r.connectionStart&&(o.connectionStart=r.connectionStart),r.connectionEnd&&(o.connectionEnd=r.connectionEnd),r.layoutConnection!==!1&&(n&&(!i||r.docking==="source")&&(o.connectionStart=o.connectionStart||dm(Oe(a)?a[0]:a)),i&&(!n||r.docking==="target")&&(o.connectionEnd=o.connectionEnd||dm(Oe(a)?a[a.length-1]:a)),r.newWaypoints&&(o.waypoints=r.newWaypoints),this._modeling.layoutConnection(t,o))};Fa.prototype.revert=function(e){var t=e.oldSource,n=e.oldTarget,i=e.oldWaypoints,a=e.connection;return t&&(a.source=t),n&&(a.target=n),i&&(a.waypoints=i),a};function dm(e){return e.original||e}function ti(e,t){this._modeling=e,this._rules=t}ti.$inject=["modeling","rules"];ti.prototype.preExecute=function(e){var t=this,n=this._modeling,i=this._rules,a=e.oldShape,r=e.newData,o=e.hints||{},s;function l(m,_,b){return i.allowed("connection.reconnect",{connection:b,source:m,target:_})}var c={x:r.x,y:r.y},p={x:a.x,y:a.y,width:a.width,height:a.height};s=e.newShape=e.newShape||t.createShape(r,c,a.parent,o),a.host&&n.updateAttachment(s,a.host);var f;o.moveChildren!==!1&&(f=a.children.slice(),n.moveElements(f,{x:0,y:0},s,o));var h=a.incoming.slice(),v=a.outgoing.slice();j(h,function(m){var _=m.source,b=l(_,s,m);b&&t.reconnectEnd(m,s,Zs(m,s,p),o)}),j(v,function(m){var _=m.target,b=l(s,_,m);b&&t.reconnectStart(m,s,Xs(m,s,p),o)})};ti.prototype.postExecute=function(e){var t=e.oldShape;this._modeling.removeShape(t)};ti.prototype.execute=function(e){};ti.prototype.revert=function(e){};ti.prototype.createShape=function(e,t,n,i){return this._modeling.createShape(e,t,n,i)};ti.prototype.reconnectStart=function(e,t,n,i){this._modeling.reconnectStart(e,t,n,i)};ti.prototype.reconnectEnd=function(e,t,n,i){this._modeling.reconnectEnd(e,t,n,i)};function ja(e){this._modeling=e}ja.$inject=["modeling"];ja.prototype.execute=function(e){var t=e.shape,n=e.newBounds,i=e.minBounds;if(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)throw new Error("newBounds must have {x, y, width, height} properties");if(i&&(n.width<i.width||n.height<i.height))throw new Error("width and height cannot be less than minimum height and width");if(!i&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return e.oldBounds={width:t.width,height:t.height,x:t.x,y:t.y},q(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};ja.prototype.postExecute=function(e){var t=this._modeling,n=e.shape,i=e.oldBounds,a=e.hints||{};a.layout!==!1&&(j(n.incoming,function(r){t.layoutConnection(r,{connectionEnd:Zs(r,n,i)})}),j(n.outgoing,function(r){t.layoutConnection(r,{connectionStart:Xs(r,n,i)})}))};ja.prototype.revert=function(e){var t=e.shape,n=e.oldBounds;return q(t,{width:n.width,height:n.height,x:n.x,y:n.y}),t};function xi(e){this._modeling=e}xi.$inject=["modeling"];xi.prototype.preExecute=function(e){var t=e.delta,n=e.direction,i=e.movingShapes,a=e.resizingShapes,r=e.start,o={};this.moveShapes(i,t),j(a,function(s){o[s.id]=eR(s)}),this.resizeShapes(a,t,n),this.updateConnectionWaypoints(VP(i,a),t,n,r,i,a,o)};xi.prototype.execute=function(){};xi.prototype.revert=function(){};xi.prototype.moveShapes=function(e,t){var n=this;j(e,function(i){n._modeling.moveShape(i,t,null,{autoResize:!1,layout:!1,recurse:!1})})};xi.prototype.resizeShapes=function(e,t,n){var i=this;j(e,function(a){var r=FP(a,n,t);i._modeling.resizeShape(a,r,null,{attachSupport:!1,autoResize:!1,layout:!1})})};xi.prototype.updateConnectionWaypoints=function(e,t,n,i,a,r,o){var s=this,l=a.concat(r);j(e,function(c){var p=c.source,f=c.target,h=QP(c),v=sb(n),m={labelBehavior:!1};ri(l,p)&&ri(l,f)?(h=ht(h,function(_){return mm(_,i,n)&&(_[v]=_[v]+t[v]),_.original&&mm(_.original,i,n)&&(_.original[v]=_.original[v]+t[v]),_}),s._modeling.updateWaypoints(c,h,{labelBehavior:!1})):(ri(l,p)||ri(l,f))&&(ri(a,p)?m.connectionStart=rf(c,p,t):ri(a,f)?m.connectionEnd=af(c,f,t):ri(r,p)?m.connectionStart=Xs(c,p,o[p.id]):ri(r,f)&&(m.connectionEnd=Zs(c,f,o[f.id])),s._modeling.layoutConnection(c,m))})};function hm(e){return q({},e)}function QP(e){return ht(e.waypoints,function(t){return t=hm(t),t.original&&(t.original=hm(t.original)),t})}function sb(e){switch(e){case"n":return"y";case"w":return"x";case"s":return"y";case"e":return"x"}}function mm(e,t,n){var i=sb(n);if(/e|s/.test(n))return e[i]>t;if(/n|w/.test(n))return e[i]<t}function ri(e,t){return e.indexOf(t)!==-1}function eR(e){return{x:e.x,y:e.y,height:e.height,width:e.width}}function ul(e){this._modeling=e}ul.$inject=["modeling"];ul.prototype.execute=function(e){var t=e.shape,n=t.children;e.oldChildrenVisibility=lb(n),t.collapsed=!t.collapsed;var i=ub(n,t.collapsed);return[t].concat(i)};ul.prototype.revert=function(e){var t=e.shape,n=e.oldChildrenVisibility,i=t.children,a=cb(i,n);return t.collapsed=!t.collapsed,[t].concat(a)};function lb(e){var t={};return j(e,function(n){t[n.id]=n.hidden,n.children&&(t=q({},t,lb(n.children)))}),t}function ub(e,t){var n=[];return j(e,function(i){i.hidden=t,n=n.concat(i),i.children&&(n=n.concat(ub(i.children,i.collapsed||t)))}),n}function cb(e,t){var n=[];return j(e,function(i){i.hidden=t[i.id],n=n.concat(i),i.children&&(n=n.concat(cb(i.children,t)))}),n}function cl(e){this._modeling=e}cl.$inject=["modeling"];cl.prototype.execute=function(e){var t=e.shape,n=e.newHost,i=t.host;return e.oldHost=i,e.attacherIdx=pb(i,t),fb(n,t),t.host=n,t};cl.prototype.revert=function(e){var t=e.shape,n=e.newHost,i=e.oldHost,a=e.attacherIdx;return t.host=i,pb(n,t),fb(i,t,a),t};function pb(e,t){return rt(e&&e.attachers,t)}function fb(e,t,n){if(e){var i=e.attachers;i||(e.attachers=i=[]),at(i,t,n)}}function Cf(){}Cf.prototype.execute=function(e){var t=e.connection,n=e.newWaypoints;return e.oldWaypoints=t.waypoints,t.waypoints=n,t};Cf.prototype.revert=function(e){var t=e.connection,n=e.oldWaypoints;return t.waypoints=n,t};function Ye(e,t,n){this._eventBus=e,this._elementFactory=t,this._commandStack=n;var i=this;e.on("diagram.init",function(){i.registerHandlers(n)})}Ye.$inject=["eventBus","elementFactory","commandStack"];Ye.prototype.getHandlers=function(){return{"shape.append":il,"shape.create":bi,"shape.delete":$a,"shape.move":Wi,"shape.resize":ja,"shape.replace":ti,"shape.toggleCollapse":ul,spaceTool:xi,"label.create":Ba,"connection.create":rl,"connection.delete":al,"connection.move":wf,"connection.layout":sl,"connection.updateWaypoints":Cf,"connection.reconnect":Fa,"elements.create":_f,"elements.move":ll,"elements.delete":Sf,"elements.distribute":ol,"elements.align":nl,"element.updateAttachment":cl}};Ye.prototype.registerHandlers=function(e){j(this.getHandlers(),function(t,n){e.registerHandler(n,t)})};Ye.prototype.moveShape=function(e,t,n,i,a){typeof i=="object"&&(a=i,i=null);var r={shape:e,delta:t,newParent:n,newParentIndex:i,hints:a||{}};this._commandStack.execute("shape.move",r)};Ye.prototype.updateAttachment=function(e,t){var n={shape:e,newHost:t};this._commandStack.execute("element.updateAttachment",n)};Ye.prototype.moveElements=function(e,t,n,i){i=i||{};var a=i.attach,r=n,o;a===!0?(o=n,r=n.parent):a===!1&&(o=null);var s={shapes:e,delta:t,newParent:r,newHost:o,hints:i};this._commandStack.execute("elements.move",s)};Ye.prototype.moveConnection=function(e,t,n,i,a){typeof i=="object"&&(a=i,i=void 0);var r={connection:e,delta:t,newParent:n,newParentIndex:i,hints:a||{}};this._commandStack.execute("connection.move",r)};Ye.prototype.layoutConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.layout",n)};Ye.prototype.createConnection=function(e,t,n,i,a,r){typeof n=="object"&&(r=a,a=i,i=n,n=void 0),i=this._create("connection",i);var o={source:e,target:t,parent:a,parentIndex:n,connection:i,hints:r};return this._commandStack.execute("connection.create",o),o.connection};Ye.prototype.createShape=function(e,t,n,i,a){typeof i!="number"&&(a=i,i=void 0),a=a||{};var r=a.attach,o,s;e=this._create("shape",e),r?(o=n.parent,s=n):o=n;var l={position:t,shape:e,parent:o,parentIndex:i,host:s,hints:a};return this._commandStack.execute("shape.create",l),l.shape};Ye.prototype.createElements=function(e,t,n,i,a){Oe(e)||(e=[e]),typeof i!="number"&&(a=i,i=void 0),a=a||{};var r={position:t,elements:e,parent:n,parentIndex:i,hints:a};return this._commandStack.execute("elements.create",r),r.elements};Ye.prototype.createLabel=function(e,t,n,i){n=this._create("label",n);var a={labelTarget:e,position:t,parent:i||e.parent,shape:n};return this._commandStack.execute("label.create",a),a.shape};Ye.prototype.appendShape=function(e,t,n,i,a){a=a||{},t=this._create("shape",t);var r={source:e,position:n,target:i,shape:t,connection:a.connection,connectionParent:a.connectionParent,hints:a};return this._commandStack.execute("shape.append",r),r.shape};Ye.prototype.removeElements=function(e){var t={elements:e};this._commandStack.execute("elements.delete",t)};Ye.prototype.distributeElements=function(e,t,n){var i={groups:e,axis:t,dimension:n};this._commandStack.execute("elements.distribute",i)};Ye.prototype.removeShape=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.delete",n)};Ye.prototype.removeConnection=function(e,t){var n={connection:e,hints:t||{}};this._commandStack.execute("connection.delete",n)};Ye.prototype.replaceShape=function(e,t,n){var i={oldShape:e,newData:t,hints:n||{}};return this._commandStack.execute("shape.replace",i),i.newShape};Ye.prototype.alignElements=function(e,t){var n={elements:e,alignment:t};this._commandStack.execute("elements.align",n)};Ye.prototype.resizeShape=function(e,t,n,i){var a={shape:e,newBounds:t,minBounds:n,hints:i};this._commandStack.execute("shape.resize",a)};Ye.prototype.createSpace=function(e,t,n,i,a){var r={delta:n,direction:i,movingShapes:e,resizingShapes:t,start:a};this._commandStack.execute("spaceTool",r)};Ye.prototype.updateWaypoints=function(e,t,n){var i={connection:e,newWaypoints:t,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",i)};Ye.prototype.reconnect=function(e,t,n,i,a){var r={connection:e,newSource:t,newTarget:n,dockingOrPoints:i,hints:a||{}};this._commandStack.execute("connection.reconnect",r)};Ye.prototype.reconnectStart=function(e,t,n,i){i||(i={}),this.reconnect(e,t,e.target,n,q(i,{docking:"source"}))};Ye.prototype.reconnectEnd=function(e,t,n,i){i||(i={}),this.reconnect(e,e.source,t,n,q(i,{docking:"target"}))};Ye.prototype.connect=function(e,t,n,i){return this.createConnection(e,t,n||{},e.parent,i)};Ye.prototype._create=function(e,t){return t instanceof xa?t:this._elementFactory.create(e,t)};Ye.prototype.toggleCollapse=function(e,t){var n={shape:e,hints:t||{}};this._commandStack.execute("shape.toggleCollapse",n)};function Ha(e){this._elementRegistry=e}Ha.$inject=["elementRegistry"];Ha.prototype.execute=function(e){var t=e.element,n=e.moddleElement,i=e.properties;if(!n)throw new Error("<moddleElement> required");var a=e.changed||this.getVisualReferences(n).concat(t),r=e.oldProperties||tR(n,pa(i));return db(n,i),e.oldProperties=r,e.changed=a,a};Ha.prototype.revert=function(e){var t=e.oldProperties,n=e.moddleElement,i=e.changed;return db(n,t),i};Ha.prototype.getVisualReferences=function(e){var t=this._elementRegistry;return A(e,"bpmn:DataObject")?nR(e,t):[]};function tR(e,t){return Vt(t,function(n,i){return n[i]=e.get(i),n},{})}function db(e,t){j(t,function(n,i){e.set(i,n)})}function nR(e,t){return t.filter(function(n){return A(n,"bpmn:DataObjectReference")&&he(n).dataObjectRef===e})}var ea="default",Gn="id",hb="di",iR={width:0,height:0};function Ga(e,t,n,i,a){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=i,this._textRenderer=a}Ga.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"];Ga.prototype.execute=function(e){var t=e.element,n=[t],i=this._translate;if(!t)throw new Error(i("element required"));var a=this._elementRegistry,r=this._moddle.ids,o=t.businessObject,s=lR(e.properties),l=e.oldProperties||rR(o,s);return mb(s,o)&&(r.unclaim(o[Gn]),a.updateId(t,s[Gn]),r.claim(s[Gn],o)),ea in s&&(s[ea]&&n.push(a.get(s[ea].id)),o[ea]&&n.push(a.get(o[ea].id))),vb(o,s),e.oldProperties=l,e.changed=n,n};Ga.prototype.postExecute=function(e){var t=e.element,n=t.label,i=n&&he(n).name;if(i){var a=this._textRenderer.getExternalLabelBounds(n,i);this._modeling.resizeShape(n,a,iR)}};Ga.prototype.revert=function(e){var t=e.element,n=e.properties,i=e.oldProperties,a=t.businessObject,r=this._elementRegistry,o=this._moddle.ids;return vb(a,i),mb(n,a)&&(o.unclaim(n[Gn]),r.updateId(t,i[Gn]),o.claim(i[Gn],a)),e.changed};function mb(e,t){return Gn in e&&e[Gn]!==t[Gn]}function rR(e,t){var n=pa(t);return Vt(n,function(i,a){return a!==hb?i[a]=e.get(a):i[a]=aR(e.di,pa(t.di)),i},{})}function aR(e,t){return Vt(t,function(n,i){return n[i]=e.get(i),n},{})}function vb(e,t){j(t,function(n,i){i!==hb?e.set(i,n):e.di&&oR(e.di,n)})}function oR(e,t){j(t,function(n,i){e.set(i,n)})}var sR=["default"];function lR(e){var t=q({},e);return sR.forEach(function(n){n in e&&(t[n]=he(t[n]))}),t}function pl(e,t){this._canvas=e,this._modeling=t}pl.$inject=["canvas","modeling"];pl.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=t.getRootElement(),r=a.businessObject,o=r.$parent,s=r.di;t.setRootElement(n,!0),at(o.rootElements,i),i.$parent=o,rt(o.rootElements,r),r.$parent=null,r.di=null,s.bpmnElement=i,i.di=s,e.oldRoot=a};pl.prototype.revert=function(e){var t=this._canvas,n=e.newRoot,i=n.businessObject,a=e.oldRoot,r=a.businessObject,o=i.$parent,s=i.di;t.setRootElement(a,!0),rt(o.rootElements,i),i.$parent=null,at(o.rootElements,r),r.$parent=o,i.di=null,s.bpmnElement=r,r.di=s};function Af(e,t){this._modeling=e,this._spaceTool=t}Af.$inject=["modeling","spaceTool"];Af.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,i=e.shape,a=e.location,r=vn(i),o=r===i,s=o?i:i.parent,l=zi(s);l.length||n.createShape({type:"bpmn:Lane"},{x:i.x+ar,y:i.y,width:i.width-ar,height:i.height},s);var c=[];ji(r,function(_){return c.push(_),_.label&&c.push(_.label),_===i?[]:Ie(_.children,function(b){return b!==i})});var p=a==="top"?-120:120,f=a==="top"?i.y:i.y+i.height,h=f+(a==="top"?10:-10),v=a==="top"?"n":"s",m=t.calculateAdjustments(c,"y",p,h);t.makeSpace(m.movingShapes,m.resizingShapes,{x:0,y:p},v,h),e.newLane=n.createShape({type:"bpmn:Lane"},{x:i.x+(o?ar:0),y:f-(a==="top"?120:0),width:i.width-(o?ar:0),height:120},s)};function Pf(e,t){this._modeling=e,this._translate=t}Pf.$inject=["modeling","translate"];Pf.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,i=e.shape,a=e.count,r=zi(i),o=r.length;if(o>a)throw new Error(n("more than {count} child lanes",{count:a}));var s=Math.round(i.height/a),l,c,p,f,h;for(h=0;h<a;h++)l=i.y+h*s,h===a-1?c=i.height-s*h:c=s,p={x:i.x+ar,y:l,width:i.width-ar,height:c},h<o?t.resizeShape(r[h],p):(f={type:"bpmn:Lane"},t.createShape(f,p,i))};function za(e,t){this._modeling=e,this._spaceTool=t}za.$inject=["modeling","spaceTool"];za.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds,i=e.balanced;i!==!1?this.resizeBalanced(t,n):this.resizeSpace(t,n)};za.prototype.resizeBalanced=function(e,t){var n=this._modeling,i=J1(e,t);n.resizeShape(e,t),i.forEach(function(a){n.resizeShape(a.shape,a.newBounds)})};za.prototype.resizeSpace=function(e,t){var n=this._spaceTool,i=_e(e),a=_e(t),r=uE(a,i),o=vn(e),s=[],l=[];ji(o,function(m){return s.push(m),(A(m,"bpmn:Lane")||A(m,"bpmn:Participant"))&&l.push(m),m.children});var c,p,f,h,v;(r.bottom||r.top)&&(c=r.bottom||r.top,p=e.y+(r.bottom?e.height:0)+(r.bottom?-10:10),f=r.bottom?"s":"n",h=r.top>0||r.bottom<0?-c:c,v=n.calculateAdjustments(s,"y",h,p),n.makeSpace(v.movingShapes,v.resizingShapes,{x:0,y:c},f)),(r.left||r.right)&&(c=r.right||r.left,p=e.x+(r.right?e.width:0)+(r.right?-10:100),f=r.right?"e":"w",h=r.left>0||r.right<0?-c:c,v=n.calculateAdjustments(l,"x",h,p),n.makeSpace(v.movingShapes,v.resizingShapes,{x:c,y:0},f))};var va="flowNodeRef",Rf="lanes";function Ua(e){this._elementRegistry=e}Ua.$inject=["elementRegistry"];Ua.prototype.computeUpdates=function(e,t){var n=[],i=[],a={},r=[];function o(p,f){var h=_e(f),v={x:p.x+p.width/2,y:p.y+p.height/2};return v.x>h.left&&v.x<h.right&&v.y>h.top&&v.y<h.bottom}function s(p){n.indexOf(p)===-1&&(r.push(p),n.push(p))}function l(p){var f=vn(p);return a[f.id]||(a[f.id]=Gs(f)),a[f.id]}function c(p){if(!p.parent)return[];var f=l(p);return f.filter(function(h){return o(p,h)}).map(function(h){return h.businessObject})}return t.forEach(function(p){var f=vn(p);if(!(!f||n.indexOf(f)!==-1)){var h=f.children.filter(function(v){return A(v,"bpmn:FlowNode")});h.forEach(s),n.push(f)}}),e.forEach(s),r.forEach(function(p){var f=p.businessObject,h=f.get(Rf),v=h.slice(),m=c(p);i.push({flowNode:f,remove:v,add:m})}),t.forEach(function(p){var f=p.businessObject;p.parent||f.get(va).forEach(function(h){i.push({flowNode:h,remove:[f],add:[]})})}),i};Ua.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach(function(n){var i=n.flowNode,a=i.get(Rf);n.remove.forEach(function(r){rt(a,r),rt(r.get(va),i)}),n.add.forEach(function(r){at(a,r),at(r.get(va),i)})})};Ua.prototype.revert=function(e){var t=e.updates;t.forEach(function(n){var i=n.flowNode,a=i.get(Rf);n.add.forEach(function(r){rt(a,r),rt(r.get(va),i)}),n.remove.forEach(function(r){at(a,r),at(r.get(va),i)})})};function fl(e){this._moddle=e}fl.$inject=["moddle"];fl.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,i=e.element,a=e.claiming;a?t.claim(n,i):t.unclaim(n)};fl.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,i=e.element,a=e.claiming;a?t.unclaim(n):t.claim(n,i)};var uR={fill:void 0,stroke:void 0};function If(e){this._commandStack=e,this._normalizeColor=function(t){if(t){if($t(t)){var n=cR(t);if(n)return n}throw new Error("invalid color value: "+t)}}}If.$inject=["commandStack"];If.prototype.postExecute=function(e){var t=e.elements,n=e.colors||uR,i=this,a={};"fill"in n&&q(a,{"background-color":this._normalizeColor(n.fill)}),"stroke"in n&&q(a,{"border-color":this._normalizeColor(n.stroke)}),j(t,function(r){var o=pR(r)?rn(a,["border-color"]):a;fR(o),r.labelTarget?i._commandStack.execute("element.updateModdleProperties",{element:r,moddleElement:r.businessObject.di.label,properties:{color:a["background-color"]}}):i._commandStack.execute("element.updateProperties",{element:r,properties:{di:o}})})};function cR(e){var t=document.createElement("canvas").getContext("2d");return t.fillStyle="transparent",t.fillStyle=e,/^#[0-9a-fA-F]{6}$/.test(t.fillStyle)?t.fillStyle:null}function pR(e){return!!e.waypoints}function fR(e){"border-color"in e&&(e.stroke=e["border-color"]),"background-color"in e&&(e.fill=e["background-color"])}var dR={width:0,height:0};function gb(e,t){function n(s,l){var c=s.label||s,p=s.labelTarget||s;return Sw(c,l),[c,p]}function i(s){var l=s.element,c=l.businessObject,p=s.newLabel;if(!_t(l)&&hr(l)&&!Ds(l)&&!vm(p)){var f=7,h=ks(l);h={x:h.x,y:h.y+f},e.createLabel(l,h,{id:c.id+"_label",businessObject:c})}}function a(s){return s.oldLabel=En(s.element),n(s.element,s.newLabel)}function r(s){return n(s.element,s.oldLabel)}function o(s){var l=s.element,c=l.label||l,p=s.newLabel,f=s.newBounds,h=s.hints||{};if(!(!_t(c)&&!A(c,"bpmn:TextAnnotation"))){if(_t(c)&&vm(p)){h.removeShape!==!1&&e.removeShape(c,{unsetLabel:!1});return}var v=En(c);typeof f>"u"&&(f=t.getExternalLabelBounds(c,v)),f&&e.resizeShape(c,f,dR)}}this.preExecute=i,this.execute=a,this.revert=r,this.postExecute=o}gb.$inject=["modeling","textRenderer"];function vm(e){return!e||!e.trim()}function Ct(e,t,n,i){Ye.call(this,e,t,n),this._bpmnRules=i}ye(Ct,Ye);Ct.$inject=["eventBus","elementFactory","commandStack","bpmnRules"];Ct.prototype.getHandlers=function(){var e=Ye.prototype.getHandlers.call(this);return e["element.updateModdleProperties"]=Ha,e["element.updateProperties"]=Ga,e["canvas.updateRoot"]=pl,e["lane.add"]=Af,e["lane.resize"]=za,e["lane.split"]=Pf,e["lane.updateRefs"]=Ua,e["id.updateClaim"]=fl,e["element.setColor"]=If,e["element.updateLabel"]=gb,e};Ct.prototype.updateLabel=function(e,t,n,i){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:i||{}})};Ct.prototype.connect=function(e,t,n,i){var a=this._bpmnRules;if(n||(n=a.canConnect(e,t)),!!n)return this.createConnection(e,t,n,e.parent,i)};Ct.prototype.updateModdleProperties=function(e,t,n){this._commandStack.execute("element.updateModdleProperties",{element:e,moddleElement:t,properties:n})};Ct.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})};Ct.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})};Ct.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane};Ct.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})};Ct.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e};Ct.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})};Ct.prototype.makeProcess=function(){var e=this._create("root",{type:"bpmn:Process"}),t={newRoot:e};this._commandStack.execute("canvas.updateRoot",t)};Ct.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})};Ct.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})};Ct.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};function yb(){}yb.prototype.layoutConnection=function(e,t){return t=t||{},[t.connectionStart||Me(t.source||e.source),t.connectionEnd||Me(t.target||e.target)]};var Vo=20,hR=5,vs=Math.round,gm=20,mR={"h:h":20,"v:v":20,"h:v":-10,"v:h":-10};function vR(e,t){return!{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/./,v:/./}[t].test(e)}function gR(e,t){return{t:/top/,r:/right/,b:/bottom/,l:/left/,h:/left|right/,v:/top|bottom/}[e].test(t)}function Eb(e,t,n){var i=wt(t,e,hR),a=n.split(":")[0],r=vs((t.x-e.x)/2+e.x),o=vs((t.y-e.y)/2+e.y),s,l,c=gR(a,i),p=/h|r|l/.test(a),f=!1,h=!1;return c?(s=p?{x:r,y:e.y}:{x:e.x,y:o},l=p?"h:h":"v:v"):(f=vR(i,a),l=p?"h:v":"v:h",f?p?(h=o===e.y,s={x:e.x+Vo*(/l/.test(a)?-1:1),y:h?o+Vo:o}):(h=r===e.x,s={x:h?r+Vo:r,y:e.y+Vo*(/t/.test(a)?-1:1)}):s={x:r,y:o}),{waypoints:Nf(e,s,l).concat(s),directions:l,turnNextDirections:h}}function yR(e,t,n){return Eb(e,t,n)}function ER(e,t,n){var i=Eb(t,e,ym(n));return{waypoints:i.waypoints.slice().reverse(),directions:ym(i.directions),turnNextDirections:i.turnNextDirections}}function bR(e,t){var n=e.directions.split(":")[1],i=t.directions.split(":")[0];e.turnNextDirections&&(n=n=="h"?"v":"h"),t.turnNextDirections&&(i=i=="h"?"v":"h");var a=n+":"+i,r=Nf(e.waypoints[e.waypoints.length-1],t.waypoints[0],a);return{waypoints:r,directions:a}}function ym(e){return e.split(":").reverse().join(":")}function xR(e,t,n){var i=vs((t.x-e.x)/2+e.x),a=vs((t.y-e.y)/2+e.y);if(n==="h:v")return[{x:t.x,y:e.y}];if(n==="v:h")return[{x:e.x,y:t.y}];if(n==="h:h")return[{x:i,y:e.y},{x:i,y:t.y}];if(n==="v:v")return[{x:e.x,y:a},{x:t.x,y:a}];throw new Error("invalid directions: can only handle varians of [hv]:[hv]")}function Nf(e,t,n){if(n=n||"h:h",!IR(n))throw new Error("unknown directions: <"+n+">: must be specified as <start>:<end> with start/end in { h,v,t,r,b,l }");if(bb(n)){var i=yR(e,t,n),a=ER(e,t,n),r=bR(i,a);return[].concat(i.waypoints,r.waypoints,a.waypoints)}return xR(e,t,n)}function _R(e,t,n){var i=Nf(e,t,n);return i.unshift(e),i.push(t),xb(i)}function SR(e,t,n,i,a){var r=a&&a.preferredLayouts||[],o=vg(r,"straight")[0]||"h:h",s=mR[o]||0,l=wt(e,t,s),c=RR(l,o);n=n||Me(e),i=i||Me(t);var p=c.split(":"),f=bm(n,e,p[0],NR(l)),h=bm(i,t,p[1],l);return _R(f,h,c)}function wR(e,t,n,i,a,r){Oe(n)&&(a=n,r=i,n=Me(e),i=Me(t)),r=q({preferredLayouts:[]},r),a=a||[];var o=r.preferredLayouts,s=o.indexOf("straight")!==-1,l;return l=s&&CR(e,t,n,i,r),l||(l=r.connectionEnd&&PR(t,e,i,a),l)||(l=r.connectionStart&&AR(e,t,n,a),l)?l:!r.connectionStart&&!r.connectionEnd&&a&&a.length?a:SR(e,t,n,i,r)}function TR(e,t,n){return e>=t&&e<=n}function Em(e,t,n){var i={x:"width",y:"height"};return TR(t[e],n[e],n[e]+n[i[e]])}function CR(e,t,n,i,a){var r={},o,s;return s=wt(e,t),/^(top|bottom|left|right)$/.test(s)?(/top|bottom/.test(s)&&(o="x"),/left|right/.test(s)&&(o="y"),a.preserveDocking==="target"?Em(o,i,e)?(r[o]=i[o],[{x:r.x!==void 0?r.x:n.x,y:r.y!==void 0?r.y:n.y,original:{x:r.x!==void 0?r.x:n.x,y:r.y!==void 0?r.y:n.y}},{x:i.x,y:i.y}]):null:Em(o,n,t)?(r[o]=n[o],[{x:n.x,y:n.y},{x:r.x!==void 0?r.x:i.x,y:r.y!==void 0?r.y:i.y,original:{x:r.x!==void 0?r.x:i.x,y:r.y!==void 0?r.y:i.y}}]):null):null}function AR(e,t,n,i){return Mf(e,t,n,i)}function PR(e,t,n,i){var a=i.slice().reverse();return a=Mf(e,t,n,a),a?a.reverse():null}function Mf(e,t,n,i){function a(p){return p.length<3?!0:p.length>4?!1:!!Ue(p,function(f,h){var v=p[h-1];return v&&ba(f,v)<3})}function r(p,f,h){var v=jn(f,p);switch(v){case"v":return{x:h.x,y:p.y};case"h":return{x:p.x,y:h.y}}return{x:p.x,y:p.y}}function o(p,f,h){var v;for(v=p.length-2;v!==0;v--)if(pd(p[v],f,gm)||pd(p[v],h,gm))return p.slice(v);return p}if(a(i))return null;var s=i[0],l=i.slice(),c;return l[0]=n,l[1]=r(l[1],s,n),c=o(l,e,t),c!==l&&(l=Mf(e,t,n,c)),l&&jn(l)?null:l}function RR(e,t){if(bb(t))return t;switch(e){case"intersect":return"t:t";case"top":case"bottom":return"v:v";case"left":case"right":return"h:h";default:return t}}function IR(e){return e&&/^h|v|t|r|b|l:h|v|t|r|b|l$/.test(e)}function bb(e){return e&&/t|r|b|l/.test(e)}function NR(e){return{top:"bottom",bottom:"top",left:"right",right:"left","top-left":"bottom-right","bottom-right":"top-left","top-right":"bottom-left","bottom-left":"top-right"}[e]}function bm(e,t,n,i){if(n==="h"&&(n=/left/.test(i)?"l":"r"),n==="v"&&(n=/top/.test(i)?"t":"b"),n==="t")return{original:e,x:e.x,y:t.y};if(n==="r")return{original:e,x:t.x+t.width,y:e.y};if(n==="b")return{original:e,x:e.x,y:t.y+t.height};if(n==="l")return{original:e,x:t.x,y:e.y};throw new Error("unexpected dockingDirection: <"+n+">")}function xb(e){return e.reduce(function(t,n,i){var a=t[t.length-1],r=e[i+1];return dp(a,r,n,0)||t.push(n),t},[])}var MR=-10,DR=40,Df={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},es={top:"t",right:"r",bottom:"b",left:"l"};function kf(){}ye(kf,yb);kf.prototype.layoutConnection=function(e,t){t||(t={});var n=t.source||e.source,i=t.target||e.target,a=t.waypoints||e.waypoints,r=t.connectionStart,o=t.connectionEnd,s,l;return r||(r=xm(a&&a[0],n)),o||(o=xm(a&&a[a.length-1],i)),(A(e,"bpmn:Association")||A(e,"bpmn:DataAssociation"))&&a&&!_m(n,i)?[].concat([r],a.slice(1,-1),[o]):(A(e,"bpmn:MessageFlow")?s=OR(n,i):(A(e,"bpmn:SequenceFlow")||_m(n,i))&&(n===i?s={preferredLayouts:GR(n,e)}:A(n,"bpmn:BoundaryEvent")?s={preferredLayouts:zR(n,i,o)}:ga(n)||ga(i)?s=BR(n):A(n,"bpmn:Gateway")?s={preferredLayouts:["v:h"]}:A(i,"bpmn:Gateway")?s={preferredLayouts:["h:v"]}:s={preferredLayouts:["h:h"]}),s&&(s=q(s,t),l=xb(wR(n,i,r,o,a,s))),l||[r,o])};function kR(e){var t=e.host;return wt(Me(e),t,MR)}function OR(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:LR(e,t)}}function LR(e,t){return A(t,"bpmn:Participant")?"source":A(e,"bpmn:Participant")?"target":ga(t)?"source":ga(e)||A(t,"bpmn:Event")?"target":A(e,"bpmn:Event")?"source":null}function BR(e){return{preferredLayouts:["straight","h:h"],preserveDocking:$R(e)}}function $R(e){return ga(e)?"target":"source"}function xm(e,t){return e?e.original||e:Me(t)}function _m(e,t){return A(t,"bpmn:Activity")&&A(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function ga(e){return A(e,"bpmn:SubProcess")&&We(e)}function sa(e,t){return e===t}function VR(e,t){return t.indexOf(e)!==-1}function la(e){var t=/right|left/.exec(e);return t&&t[0]}function Oi(e){var t=/top|bottom/.exec(e);return t&&t[0]}function FR(e,t){return Df[e]===t}function jR(e,t){var n=la(e),i=Df[n];return t.indexOf(i)!==-1}function HR(e,t){var n=Oi(e),i=Df[n];return t.indexOf(i)!==-1}function Jc(e){return e==="right"||e==="left"}function GR(e,t){var n=t.waypoints,i=n&&n.length&&wt(n[0],e);return i==="top"?["t:r"]:i==="right"?["r:b"]:i==="left"?["l:t"]:["b:l"]}function zR(e,t,n){var i=Me(e),a=Me(t),r=kR(e),o,s,l=sa(e.host,t),c=VR(r,["top","right","bottom","left"]),p=wt(a,i,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return l?UR(r,c,e,t,n):(o=qR(r,p,c),s=WR(r,p,c),[o+":"+s])}function UR(e,t,n,i,a){var r=t?e:Oi(e),o=es[r],s;return t?Jc(e)?s=Sm("y",n,i,a)?"h":"b":s=Sm("x",n,i,a)?"v":"l":s="v",[o+":"+s]}function Sm(e,t,n,i){var a=DR;return!(zl(e,i,n,a)||zl(e,i,{x:n.x+n.width,y:n.y+n.height},a)||zl(e,i,Me(t),a))}function zl(e,t,n,i){return Math.abs(t[e]-n[e])<i}function qR(e,t,n){return n?es[e]:sa(Oi(e),Oi(t))||FR(la(e),la(t))?es[Oi(e)]:es[la(e)]}function WR(e,t,n){return n?Jc(e)?jR(e,t)||sa(e,t)?"h":"v":HR(e,t)||sa(e,t)?"v":"h":Jc(t)||sa(Oi(e),Oi(t))&&la(t)?"h":"v"}function wm(e){return q({original:e.point.original||e.point},e.actual)}function _i(e,t){this._elementRegistry=e,this._graphicsFactory=t}_i.$inject=["elementRegistry","graphicsFactory"];_i.prototype.getCroppedWaypoints=function(e,t,n){t=t||e.source,n=n||e.target;var i=this.getDockingPoint(e,t,!0),a=this.getDockingPoint(e,n),r=e.waypoints.slice(i.idx+1,a.idx);return r.unshift(wm(i)),r.push(wm(a)),r};_i.prototype.getDockingPoint=function(e,t,n){var i=e.waypoints,a,r,o;return a=n?0:i.length-1,r=i[a],o=this._getIntersection(t,e,n),{point:r,actual:o||r,idx:a}};_i.prototype._getIntersection=function(e,t,n){var i=this._getShapePath(e),a=this._getConnectionPath(t);return Pc(i,a,n)};_i.prototype._getConnectionPath=function(e){return this._graphicsFactory.getConnectionPath(e)};_i.prototype._getShapePath=function(e){return this._graphicsFactory.getShapePath(e)};_i.prototype._getGfx=function(e){return this._elementRegistry.getGraphics(e)};const YR={__init__:["modeling","bpmnUpdater"],__depends__:[eP,EP,xP,_P,lE,SP,AP,RP,OP,Dn,EE,ab],bpmnFactory:["type",pn],bpmnUpdater:["type",jt],elementFactory:["type",Ei],modeling:["type",Ct],layouter:["type",kf],connectionDocking:["type",_i]};var KR=500,XR=1250,ZR=1500,gs=Math.round;function JR(e){return{x:e.x+gs(e.width/2),y:e.y+gs(e.height/2)}}function _b(e,t,n,i,a){function r(s,l,c,p){return a.allowed("elements.move",{shapes:s,delta:l,position:c,target:p})}e.on("shape.move.start",ZR,function(s){var l=s.context,c=s.shape,p=i.get().slice();p.indexOf(c)===-1&&(p=[c]),p=QR(p),q(l,{shapes:p,validatedShapes:p,shape:c})}),e.on("shape.move.start",XR,function(s){var l=s.context,c=l.validatedShapes,p;if(p=l.canExecute=r(c),!p)return!1}),e.on("shape.move.move",KR,function(s){var l=s.context,c=l.validatedShapes,p=s.hover,f={x:s.dx,y:s.dy},h={x:s.x,y:s.y},v;if(v=r(c,f,h,p),l.delta=f,l.canExecute=v,v===null){l.target=null;return}l.target=p}),e.on("shape.move.end",function(s){var l=s.context,c=l.delta,p=l.canExecute,f=p==="attach",h=l.shapes;if(p===!1)return!1;c.x=gs(c.x),c.y=gs(c.y),!(c.x===0&&c.y===0)&&n.moveElements(h,c,l.target,{primaryShape:l.shape,attach:f})}),e.on("element.mousedown",function(s){if(mi(s)){var l=Pr(s);if(!l)throw new Error("must supply DOM mousedown event");return o(l,s.element)}});function o(s,l,c,p){if(st(c)&&(p=c,c=!1),!(l.waypoints||!l.parent)){var f=JR(l);return t.init(s,f,"shape.move",{cursor:"grabbing",autoActivate:c,data:{shape:l,context:p||{}}}),!0}}this.start=o}_b.$inject=["eventBus","dragging","modeling","selection","rules"];function QR(e){var t=Vi(e,"id");return Ie(e,function(n){for(;n=n.parent;)if(t[n.id])return!1;return!0})}var Tm=499,Ul="djs-dragging",Cm="drop-ok",Am="drop-not-ok",Pm="new-parent",Rm="attach-ok";function Sb(e,t,n,i){function a(l){var c=r(l),p=eI(c);return p}function r(l){var c=Ss(l,!0),p=ht(c,function(f){return(f.incoming||[]).concat(f.outgoing||[])});return ua(c.concat(p))}function o(l,c){[Rm,Cm,Am,Pm].forEach(function(p){p===c?t.addMarker(l,p):t.removeMarker(l,p)})}function s(l,c,p){i.addDragger(c,l.dragGroup),p&&t.addMarker(c,Ul),l.allDraggedElements?l.allDraggedElements.push(c):l.allDraggedElements=[c]}e.on("shape.move.start",Tm,function(l){var c=l.context,p=c.shapes,f=c.allDraggedElements,h=a(p);if(!c.dragGroup){var v=be("g");ae(v,n.cls("djs-drag-group",["no-events"]));var m=t.getActiveLayer();Ce(m,v),c.dragGroup=v}h.forEach(function(_){i.addDragger(_,c.dragGroup)}),f?f=ua([f,r(p)]):f=r(p),j(f,function(_){t.addMarker(_,Ul)}),c.allDraggedElements=f,c.differentParents=tI(p)}),e.on("shape.move.move",Tm,function(l){var c=l.context,p=c.dragGroup,f=c.target,h=c.shape.parent,v=c.canExecute;f&&(v==="attach"?o(f,Rm):c.canExecute&&f&&f.id!==h.id?o(f,Pm):o(f,c.canExecute?Cm:Am)),Bt(p,l.dx,l.dy)}),e.on(["shape.move.out","shape.move.cleanup"],function(l){var c=l.context,p=c.target;p&&o(p,null)}),e.on("shape.move.cleanup",function(l){var c=l.context,p=c.allDraggedElements,f=c.dragGroup;j(p,function(h){t.removeMarker(h,Ul)}),f&&ot(f)}),this.makeDraggable=s}Sb.$inject=["eventBus","canvas","styles","previewSupport"];function eI(e){var t=Ie(e,function(n){return nI(n)?Ue(e,en({id:n.source.id}))&&Ue(e,en({id:n.target.id})):!0});return t}function tI(e){return cr(Vi(e,function(t){return t.parent&&t.parent.id}))!==1}function nI(e){return e.waypoints}const iI={__depends__:[Ca,Dn,gy,On,Zn,Ra],__init__:["move","movePreview"],move:["type",_b],movePreview:["type",Sb]};var wb=".djs-palette-toggle",Tb=".entry",rI=wb+", "+Tb,Qc="djs-palette-",aI="shown",ep="open",Im="two-column",oI=1e3;function lt(e,t){this._eventBus=e,this._canvas=t;var n=this;e.on("tool-manager.update",function(i){var a=i.tool;n.updateToolHighlight(a)}),e.on("i18n.changed",function(){n._update()}),e.on("diagram.init",function(){n._diagramInitialized=!0,n._rebuild()})}lt.$inject=["eventBus","canvas"];lt.prototype.registerProvider=function(e,t){t||(t=e,e=oI),this._eventBus.on("palette.getProviders",e,function(n){n.providers.push(t)}),this._rebuild()};lt.prototype.getEntries=function(){var e=this._getProviders();return e.reduce(lI,{})};lt.prototype._rebuild=function(){if(this._diagramInitialized){var e=this._getProviders();e.length&&(this._container||this._init(),this._update())}};lt.prototype._init=function(){var e=this,t=this._eventBus,n=this._getParentContainer(),i=this._container=Qe(lt.HTML_MARKUP);n.appendChild(i),dt(n).add(Qc+aI),Ht.bind(i,rI,"click",function(a){var r=a.delegateTarget;if(rs(r,wb))return e.toggle();e.trigger("click",a)}),Se.bind(i,"mousedown",function(a){a.stopPropagation()}),Ht.bind(i,Tb,"dragstart",function(a){e.trigger("dragstart",a)}),t.on("canvas.resized",this._layoutChanged,this),t.fire("palette.create",{container:i})};lt.prototype._getProviders=function(e){var t=this._eventBus.createEvent({type:"palette.getProviders",providers:[]});return this._eventBus.fire(t),t.providers};lt.prototype._toggleState=function(e){e=e||{};var t=this._getParentContainer(),n=this._container,i=this._eventBus,a,r=dt(n),o=dt(t);"twoColumn"in e?a=e.twoColumn:a=this._needsCollapse(t.clientHeight,this._entries||{}),r.toggle(Im,a),o.toggle(Qc+Im,a),"open"in e&&(r.toggle(ep,e.open),o.toggle(Qc+ep,e.open)),i.fire("palette.changed",{twoColumn:a,open:this.isOpen()})};lt.prototype._update=function(){var e=it(".djs-palette-entries",this._container),t=this._entries=this.getEntries();_s(e),j(t,function(n,i){var a=n.group||"default",r=it("[data-group="+a+"]",e);r||(r=Qe('<div class="group" data-group="'+a+'"></div>'),e.appendChild(r));var o=n.html||(n.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),s=Qe(o);r.appendChild(s),n.separator||(Ut(s,"data-action",i),n.title&&Ut(s,"title",n.title),n.className&&sI(s,n.className),n.imageUrl&&s.appendChild(Qe('<img src="'+n.imageUrl+'">')))}),this.open()};lt.prototype.trigger=function(e,t,n){var i=this._entries,a,r,o,s=t.delegateTarget||t.target;if(!s)return t.preventDefault();a=i[Ut(s,"data-action")],a&&(r=a.action,o=t.originalEvent||t,xt(r)?e==="click"&&r(o,n):r[e]&&r[e](o,n),t.preventDefault())};lt.prototype._layoutChanged=function(){this._toggleState({})};lt.prototype._needsCollapse=function(e,t){var n=50,i=Object.keys(t).length*46;return e<i+n};lt.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})};lt.prototype.open=function(){this._toggleState({open:!0})};lt.prototype.toggle=function(e){this.isOpen()?this.close():this.open()};lt.prototype.isActiveTool=function(e){return e&&this._activeTool===e};lt.prototype.updateToolHighlight=function(e){var t,n;this._toolsContainer||(t=it(".djs-palette-entries",this._container),this._toolsContainer=it("[data-group=tools]",t)),n=this._toolsContainer,j(n.children,function(i){var a=i.getAttribute("data-action");if(a){var r=dt(i);a=a.replace("-tool",""),r.contains("entry")&&a===e?r.add("highlighted-entry"):r.remove("highlighted-entry")}})};lt.prototype.isOpen=function(){return dt(this._container).has(ep)};lt.prototype._getParentContainer=function(){return this._canvas.getContainer()};lt.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';function sI(e,t){var n=dt(e),i=Oe(t)?t:t.split(/\s+/g);i.forEach(function(a){n.add(a)})}function lI(e,t){var n=t.getPaletteEntries();return xt(n)?n(e):(j(n,function(i,a){e[a]=i}),e)}const uI={__init__:["palette"],palette:["type",lt]};var Cb="crosshair";function Yi(e,t,n,i,a,r,o){this._selection=a,this._dragging=n,this._mouse=o;var s=this,l={create:function(c){var p=t.getActiveLayer(),f;f=c.frame=be("rect"),ae(f,{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),Ce(p,f)},update:function(c){var p=c.frame,f=c.bbox;ae(p,{x:f.x,y:f.y,width:f.width,height:f.height})},remove:function(c){c.frame&&ot(c.frame)}};r.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),e.on("lasso.selection.end",function(c){var p=c.originalEvent.target;!c.hover&&!(p instanceof SVGElement)||e.once("lasso.selection.ended",function(){s.activateLasso(c.originalEvent,!0)})}),e.on("lasso.end",function(c){var p=ql(c),f=i.filter(function(h){return h});s.select(f,p)}),e.on("lasso.start",function(c){var p=c.context;p.bbox=ql(c),l.create(p)}),e.on("lasso.move",function(c){var p=c.context;p.bbox=ql(c),l.update(p)}),e.on("lasso.cleanup",function(c){var p=c.context;l.remove(p)}),e.on("element.mousedown",1500,function(c){if(my(c))return s.activateLasso(c.originalEvent),!0})}Yi.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager","mouse"];Yi.prototype.activateLasso=function(e,t){this._dragging.init(e,"lasso",{autoActivate:t,cursor:Cb,data:{context:{}}})};Yi.prototype.activateSelection=function(e,t){this._dragging.init(e,"lasso.selection",{trapClick:!1,autoActivate:t,cursor:Cb,data:{context:{}}})};Yi.prototype.select=function(e,t){var n=l_(e,t);this._selection.select(xs(n))};Yi.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateSelection(e,!!e)};Yi.prototype.isActive=function(){var e=this._dragging.context();return e&&/^lasso/.test(e.prefix)};function ql(e){var t={x:e.x-e.dx,y:e.y-e.dy},n={x:e.x,y:e.y},i;return t.x<=n.x&&t.y<n.y||t.x<n.x&&t.y<=n.y?i={x:t.x,y:t.y,width:n.x-t.x,height:n.y-t.y}:t.x>=n.x&&t.y<n.y||t.x>n.x&&t.y<=n.y?i={x:n.x,y:t.y,width:t.x-n.x,height:n.y-t.y}:t.x<=n.x&&t.y>n.y||t.x<n.x&&t.y>=n.y?i={x:t.x,y:n.y,width:n.x-t.x,height:t.y-n.y}:t.x>=n.x&&t.y>n.y||t.x>n.x&&t.y>=n.y?i={x:n.x,y:n.y,width:t.x-n.x,height:t.y-n.y}:i={x:n.x,y:n.y,width:0,height:0},i}const cI={__depends__:[tl,Na],__init__:["lassoTool"],lassoTool:["type",Yi]};var Wl=1500,Ab="grab";function kr(e,t,n,i,a,r){this._dragging=n,this._mouse=r;var o=this,s=i.get("keyboard",!1);a.registerTool("hand",{tool:"hand",dragging:"hand.move"}),e.on("element.mousedown",Wl,function(l){if(mr(l))return o.activateMove(l.originalEvent,!0),!1}),s&&s.addListener(Wl,function(l){if(!(!Nm(l.keyEvent)||o.isActive())){var c=o._mouse.getLastMoveEvent();o.activateMove(c,!!c)}},"keyboard.keydown"),s&&s.addListener(Wl,function(l){!Nm(l.keyEvent)||!o.isActive()||o.toggle()},"keyboard.keyup"),e.on("hand.end",function(l){var c=l.originalEvent.target;if(!l.hover&&!(c instanceof SVGElement))return!1;e.once("hand.ended",function(){o.activateMove(l.originalEvent,{reactivate:!0})})}),e.on("hand.move.move",function(l){var c=t.viewbox().scale;t.scroll({dx:l.dx*c,dy:l.dy*c})}),e.on("hand.move.end",function(l){var c=l.context,p=c.reactivate;return!mr(l)&&p&&e.once("hand.move.ended",function(f){o.activateHand(f.originalEvent,!0,!0)}),!1})}kr.$inject=["eventBus","canvas","dragging","injector","toolManager","mouse"];kr.prototype.activateMove=function(e,t,n){typeof t=="object"&&(n=t,t=!1),this._dragging.init(e,"hand.move",{autoActivate:t,cursor:Ab,data:{context:n||{}}})};kr.prototype.activateHand=function(e,t,n){this._dragging.init(e,"hand",{trapClick:!1,autoActivate:t,cursor:Ab,data:{context:{reactivate:n}}})};kr.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();this.activateHand(e,!!e)};kr.prototype.isActive=function(){var e=this._dragging.context();return e?/^(hand|hand\.move)$/.test(e.prefix):!1};function Nm(e){return gn(" ",e)}const pI={__depends__:[tl,Na],__init__:["handTool"],handTool:["type",kr]};var Mm="connect-ok",Dm="connect-not-ok";function Or(e,t,n,i,a,r,o){var s=this;this._dragging=t,this._rules=r,this._mouse=o,a.registerTool("global-connect",{tool:"global-connect",dragging:"global-connect.drag"}),e.on("global-connect.hover",function(l){var c=l.context,p=l.hover,f=c.canStartConnect=s.canStartConnect(p);f!==null&&(c.startTarget=p,i.addMarker(p,f?Mm:Dm))}),e.on(["global-connect.out","global-connect.cleanup"],function(l){var c=l.context.startTarget,p=l.context.canStartConnect;c&&i.removeMarker(c,p?Mm:Dm)}),e.on(["global-connect.ended"],function(l){var c=l.context,p=c.startTarget,f={x:l.x,y:l.y},h=s.canStartConnect(p);if(h)return e.once("element.out",function(){e.once(["connect.ended","connect.canceled"],function(){e.fire("global-connect.drag.ended")}),n.start(null,p,f)}),!1})}Or.$inject=["eventBus","dragging","connect","canvas","toolManager","rules","mouse"];Or.prototype.start=function(e,t){this._dragging.init(e,"global-connect",{autoActivate:t,trapClick:!1,data:{context:{}}})};Or.prototype.toggle=function(){if(this.isActive())return this._dragging.cancel();var e=this._mouse.getLastMoveEvent();return this.start(e,!!e)};Or.prototype.isActive=function(){var e=this._dragging.context();return e&&/^global-connect/.test(e.prefix)};Or.prototype.canStartConnect=function(e){return this._rules.allowed("connection.start",{source:e})};const fI={__depends__:[kp,On,Zn,tl,Na],globalConnect:["type",Or]};function Of(e,t,n,i,a,r,o,s){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=i,this._lassoTool=a,this._handTool=r,this._globalConnect=o,this._translate=s,e.registerProvider(this)}Of.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"];Of.prototype.getPaletteEntries=function(e){var t={},n=this._create,i=this._elementFactory,a=this._spaceTool,r=this._lassoTool,o=this._handTool,s=this._globalConnect,l=this._translate;function c(h,v,m,_,b){function M(S){var w=i.createShape(q({type:h},b));n.start(S,w)}var P=h.replace(/^bpmn:/,"");return{group:v,className:m,title:_||l("Create {type}",{type:P}),action:{dragstart:M,click:M}}}function p(h){var v=i.createShape({type:"bpmn:SubProcess",x:0,y:0,isExpanded:!0}),m=i.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:v});n.start(h,[v,m],{hints:{autoSelect:[v]}})}function f(h){n.start(h,i.createParticipantShape())}return q(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:l("Activate the hand tool"),action:{click:function(h){o.activateHand(h)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:l("Activate the lasso tool"),action:{click:function(h){r.activateSelection(h)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:l("Activate the create/remove space tool"),action:{click:function(h){a.activateSelection(h)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:l("Activate the global connect tool"),action:{click:function(h){s.start(h)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":c("bpmn:StartEvent","event","bpmn-icon-start-event-none",l("Create StartEvent")),"create.intermediate-event":c("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",l("Create Intermediate/Boundary Event")),"create.end-event":c("bpmn:EndEvent","event","bpmn-icon-end-event-none",l("Create EndEvent")),"create.exclusive-gateway":c("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",l("Create Gateway")),"create.task":c("bpmn:Task","activity","bpmn-icon-task",l("Create Task")),"create.data-object":c("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",l("Create DataObjectReference")),"create.data-store":c("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",l("Create DataStoreReference")),"create.subprocess-expanded":{group:"activity",className:"bpmn-icon-subprocess-expanded",title:l("Create expanded SubProcess"),action:{dragstart:p,click:p}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:l("Create Pool/Participant"),action:{dragstart:f,click:f}},"create.group":c("bpmn:Group","artifact","bpmn-icon-group",l("Create Group"))}),t};const dI={__depends__:[uI,Fs,ab,cI,pI,fI,Ms],__init__:["paletteProvider"],paletteProvider:["type",Of]};var hI=250;function Lf(e,t,n,i,a){pe.call(this,e);function r(s){var l=s.canExecute.replacements;j(l,function(c){var p=c.oldElementId,f={type:c.newElementType};if(!s.visualReplacements[p]){var h=t.get(p);q(f,{x:h.x,y:h.y});var v=n.createShape(f);i.addShape(v,h.parent);var m=it('[data-element-id="'+Vc(h.id)+'"]',s.dragGroup);m&&ae(m,{display:"none"});var _=a.addDragger(v,s.dragGroup);s.visualReplacements[p]=_,i.removeShape(v)}})}function o(s){var l=s.visualReplacements;j(l,function(c,p){var f=it('[data-element-id="'+Vc(p)+'"]',s.dragGroup);f&&ae(f,{display:"inline"}),c.remove(),l[p]&&delete l[p]})}e.on("shape.move.move",hI,function(s){var l=s.context,c=l.canExecute;l.visualReplacements||(l.visualReplacements={}),c&&c.replacements?r(l):o(l)})}Lf.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"];ye(Lf,pe);const mI={__depends__:[Ra],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",Lf]};var vI=1250,Yl=40,gI=20,yI=10,km=20,Pb=["x","y"],EI=Math.abs;function Rb(e){e.on(["connect.hover","connect.move","connect.end"],vI,function(t){var n=t.context,i=n.canExecute,a=n.start,r=n.hover,o=n.source,s=n.target;t.originalEvent&&zt(t.originalEvent)||(n.initialConnectionStart||(n.initialConnectionStart=n.connectionStart),i&&r&&bI(t,r,wI(r)),r&&SI(i,["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"])?(n.connectionStart=Jt(a),je(r,["bpmn:Event","bpmn:Gateway"])&&Om(t,Jt(r)),je(r,["bpmn:Task","bpmn:SubProcess"])&&xI(t,r),A(o,"bpmn:BoundaryEvent")&&s===o.host&&_I(t)):Ib(i,"bpmn:MessageFlow")?(A(a,"bpmn:Event")&&(n.connectionStart=Jt(a)),A(r,"bpmn:Event")&&Om(t,Jt(r))):n.connectionStart=n.initialConnectionStart)})}Rb.$inject=["eventBus"];function bI(e,t,n){Pb.forEach(function(i){var a=Nb(i,t);e[i]<t[i]+n?ft(e,i,t[i]+n):e[i]>t[i]+a-n&&ft(e,i,t[i]+a-n)})}function xI(e,t){var n=Jt(t);Pb.forEach(function(i){TI(e,t,i)&&ft(e,i,n[i])})}function _I(e){var t=e.context,n=t.source,i=t.target;if(!CI(t)){var a=Jt(n),r=wt(a,i,-10),o=[];/top|bottom/.test(r)&&o.push("x"),/left|right/.test(r)&&o.push("y"),o.forEach(function(s){var l=e[s],c;EI(l-a[s])<Yl&&(l>a[s]?c=a[s]+Yl:c=a[s]-Yl,ft(e,s,c))})}}function Om(e,t){ft(e,"x",t.x),ft(e,"y",t.y)}function Ib(e,t){return e&&e.type===t}function SI(e,t){return fi(t,function(n){return Ib(e,n)})}function Nb(e,t){return e==="x"?t.width:t.height}function wI(e){return A(e,"bpmn:Task")?yI:gI}function TI(e,t,n){return e[n]>t[n]+km&&e[n]<t[n]+Nb(n,t)-km}function CI(e){var t=e.hover,n=e.source;return t&&n&&t===n}function Si(){this._targets={},this._snapOrigins={},this._snapLocations=[],this._defaultSnaps={}}Si.prototype.getSnapOrigin=function(e){return this._snapOrigins[e]};Si.prototype.setSnapOrigin=function(e,t){this._snapOrigins[e]=t,this._snapLocations.indexOf(e)===-1&&this._snapLocations.push(e)};Si.prototype.addDefaultSnap=function(e,t){var n=this._defaultSnaps[e];n||(n=this._defaultSnaps[e]=[]),n.push(t)};Si.prototype.getSnapLocations=function(){return this._snapLocations};Si.prototype.setSnapLocations=function(e){this._snapLocations=e};Si.prototype.pointsForTarget=function(e){var t=e.id||e,n=this._targets[t];return n||(n=this._targets[t]=new dl,n.initDefaults(this._defaultSnaps)),n};function dl(e){this._snapValues={}}dl.prototype.add=function(e,t){var n=this._snapValues[e];n||(n=this._snapValues[e]={x:[],y:[]}),n.x.indexOf(t.x)===-1&&n.x.push(t.x),n.y.indexOf(t.y)===-1&&n.y.push(t.y)};dl.prototype.snap=function(e,t,n,i){var a=this._snapValues[t];return a&&FT(e[n],a[n],i)};dl.prototype.initDefaults=function(e){var t=this;j(e||{},function(n,i){j(n,function(a){t.add(i,a)})})};var AI=1250;function Ln(e,t,n){var i=this;this._elementRegistry=e,t.on(["create.start","shape.move.start"],function(a){i.initSnap(a)}),t.on(["create.move","create.end","shape.move.move","shape.move.end"],AI,function(a){var r=a.context,o=r.shape,s=r.snapContext,l=r.target;if(!(a.originalEvent&&zt(a.originalEvent))&&!(vr(a)||!l)){var c=s.pointsForTarget(l);c.initialized||(c=i.addSnapTargetPoints(c,o,l),c.initialized=!0),n.snap(a,c)}}),t.on(["create.cleanup","shape.move.cleanup"],function(){n.hide()})}Ln.$inject=["elementRegistry","eventBus","snapping"];Ln.prototype.initSnap=function(e){var t=this._elementRegistry,n=e.context,i=n.shape,a=n.snapContext;a||(a=n.snapContext=new Si);var r;t.get(i.id)?r=Jt(i,e):r={x:e.x+Jt(i).x,y:e.y+Jt(i).y};var o={x:r.x-i.width/2,y:r.y-i.height/2},s={x:r.x+i.width/2,y:r.y+i.height/2};return a.setSnapOrigin("mid",{x:r.x-e.x,y:r.y-e.y}),tp(i)||(a.setSnapOrigin("top-left",{x:o.x-e.x,y:o.y-e.y}),a.setSnapOrigin("bottom-right",{x:s.x-e.x,y:s.y-e.y})),a};Ln.prototype.addSnapTargetPoints=function(e,t,n){var i=this.getSnapTargets(t,n);return j(i,function(a){if(tp(a)){tp(t)&&e.add("mid",Jt(a));return}if(PI(a)){if(a.waypoints.length<3)return;var r=a.waypoints.slice(1,-1);j(r,function(o){e.add("mid",o)});return}e.add("mid",Jt(a))}),!Re(t.x)||!Re(t.y)||this._elementRegistry.get(t.id)&&e.add("mid",Jt(t)),e};Ln.prototype.getSnapTargets=function(e,t){return Xy(t).filter(function(n){return!RI(n)})};function PI(e){return!!e.waypoints}function RI(e){return!!e.hidden}function tp(e){return!!e.labelTarget}var Lm=1500;function Lr(e,t){t.invoke(Ln,this),e.on(["create.move","create.end"],Lm,DI),e.on(["create.move","create.end","shape.move.move","shape.move.end"],Lm,function(n){var i=n.context,a=i.canExecute,r=i.target,o=a&&(a==="attach"||a.attach);o&&!vr(n)&&II(n,r)})}ye(Lr,Ln);Lr.$inject=["eventBus","injector"];Lr.prototype.initSnap=function(e){var t=Ln.prototype.initSnap.call(this,e),n=e.shape,i=!!this._elementRegistry.get(n.id);return j(n.outgoing,function(a){var r=a.waypoints[0];r=r.original||r,t.setSnapOrigin(a.id+"-docking",$m(r,i,e))}),j(n.incoming,function(a){var r=a.waypoints[a.waypoints.length-1];r=r.original||r,t.setSnapOrigin(a.id+"-docking",$m(r,i,e))}),A(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t};Lr.prototype.addSnapTargetPoints=function(e,t,n){Ln.prototype.addSnapTargetPoints.call(this,e,t,n);var i=this.getSnapTargets(t,n);j(i,function(r){(MI(r)||NI([t,r],"bpmn:TextAnnotation"))&&(e.add("top-left",Yy(r)),e.add("bottom-right",Ky(r)))});var a=this._elementRegistry;return j(t.incoming,function(r){if(a.get(t.id)){Bm(i,r.source)||e.add("mid",Me(r.source));var o=r.waypoints[0];e.add(r.id+"-docking",o.original||o)}}),j(t.outgoing,function(r){if(a.get(t.id)){Bm(i,r.target)||e.add("mid",Me(r.target));var o=r.waypoints[r.waypoints.length-1];e.add(r.id+"-docking",o.original||o)}}),A(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e};Lr.prototype.getSnapTargets=function(e,t){return Ln.prototype.getSnapTargets.call(this,e,t).filter(function(n){return!A(n,"bpmn:Lane")})};function II(e,t){var n=_e(t),i=GE(e,t),a=e.context,r=a.shape,o;r.parent?o={x:0,y:0}:o=Me(r),/top/.test(i)?ft(e,"y",n.top-o.y):/bottom/.test(i)&&ft(e,"y",n.bottom-o.y),/left/.test(i)?ft(e,"x",n.left-o.x):/right/.test(i)&&ft(e,"x",n.right-o.x)}function NI(e,t){return e.every(function(n){return A(n,t)})}function MI(e){return A(e,"bpmn:SubProcess")&&We(e)?!0:A(e,"bpmn:Participant")}function DI(e){var t=e.context,n=t.createConstraints;if(n){var i=n.top,a=n.right,r=n.bottom,o=n.left;(o&&o>=e.x||a&&a<=e.x)&&ft(e,"x",e.x),(i&&i>=e.y||r&&r<=e.y)&&ft(e,"y",e.y)}}function Bm(e,t){return e.indexOf(t)!==-1}function $m(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}var kI=1250;function qa(e,t){var n=this;e.on(["resize.start"],function(i){n.initSnap(i)}),e.on(["resize.move","resize.end"],kI,function(i){var a=i.context,r=a.shape,o=r.parent,s=a.direction,l=a.snapContext;if(!(i.originalEvent&&zt(i.originalEvent))&&!vr(i)){var c=l.pointsForTarget(o);c.initialized||(c=n.addSnapTargetPoints(c,r,o,s),c.initialized=!0),VI(s)&&ft(i,"x",i.x),FI(s)&&ft(i,"y",i.y),t.snap(i,c)}}),e.on(["resize.cleanup"],function(){t.hide()})}qa.prototype.initSnap=function(e){var t=e.context,n=t.shape,i=t.direction,a=t.snapContext;a||(a=t.snapContext=new Si);var r=Mb(n,i);return a.setSnapOrigin("corner",{x:r.x-e.x,y:r.y-e.y}),a};qa.prototype.addSnapTargetPoints=function(e,t,n,i){var a=this.getSnapTargets(t,n);return j(a,function(r){e.add("corner",Ky(r)),e.add("corner",Yy(r))}),e.add("corner",Mb(t,i)),e};qa.$inject=["eventBus","snapping"];qa.prototype.getSnapTargets=function(e,t){return Xy(t).filter(function(n){return!OI(n,e)&&!LI(n)&&!BI(n)&&!$I(n)})};function Mb(e,t){var n=Me(e),i=_e(e),a={x:n.x,y:n.y};return t.indexOf("n")!==-1?a.y=i.top:t.indexOf("s")!==-1&&(a.y=i.bottom),t.indexOf("e")!==-1?a.x=i.right:t.indexOf("w")!==-1&&(a.x=i.left),a}function OI(e,t){return e.host===t}function LI(e){return!!e.waypoints}function BI(e){return!!e.hidden}function $I(e){return!!e.labelTarget}function VI(e){return e==="n"||e==="s"}function FI(e){return e==="e"||e==="w"}var jI=7,HI=1e3;function wi(e){this._canvas=e,this._asyncHide=sp(Pt(this.hide,this),HI)}wi.$inject=["canvas"];wi.prototype.snap=function(e,t){var n=e.context,i=n.snapContext,a=i.getSnapLocations(),r={x:vr(e,"x"),y:vr(e,"y")};j(a,function(o){var s=i.getSnapOrigin(o),l={x:e.x+s.x,y:e.y+s.y};if(j(["x","y"],function(c){var p;r[c]||(p=t.snap(l,o,c,jI),p!==void 0&&(r[c]={value:p,originValue:p-s[c]}))}),r.x&&r.y)return!1}),this.showSnapLine("vertical",r.x&&r.x.value),this.showSnapLine("horizontal",r.y&&r.y.value),j(["x","y"],function(o){var s=r[o];st(s)&&ft(e,o,s.originValue)})};wi.prototype._createLine=function(e){var t=this._canvas.getLayer("snap"),n=be("path");return ae(n,{d:"M0,0 L0,0"}),Le(n).add("djs-snap-line"),Ce(t,n),{update:function(i){Re(i)?e==="horizontal"?ae(n,{d:"M-100000,"+i+" L+100000,"+i,display:""}):ae(n,{d:"M "+i+",-100000 L "+i+", +100000",display:""}):ae(n,{display:"none"})}}};wi.prototype._createSnapLines=function(){this._snapLines={horizontal:this._createLine("horizontal"),vertical:this._createLine("vertical")}};wi.prototype.showSnapLine=function(e,t){var n=this.getSnapLine(e);n&&n.update(t),this._asyncHide()};wi.prototype.getSnapLine=function(e){return this._snapLines||this._createSnapLines(),this._snapLines[e]};wi.prototype.hide=function(){j(this._snapLines,function(e){e.update()})};const GI={__init__:["createMoveSnapping","resizeSnapping","snapping"],createMoveSnapping:["type",Ln],resizeSnapping:["type",qa],snapping:["type",wi]},zI={__depends__:[GI],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",Rb],createMoveSnapping:["type",Lr]};function Ae(e,t,n,i){this._open=!1,this._results=[],this._eventMaps=[],this._canvas=e,this._eventBus=t,this._overlays=n,this._selection=i,this._container=Qe(Ae.BOX_HTML),this._searchInput=it(Ae.INPUT_SELECTOR,this._container),this._resultsContainer=it(Ae.RESULTS_CONTAINER_SELECTOR,this._container),this._canvas.getContainer().appendChild(this._container),t.on(["canvas.destroy","diagram.destroy"],this.close,this)}Ae.$inject=["canvas","eventBus","overlays","selection"];Ae.prototype._bindEvents=function(){var e=this;function t(n,i,a,r){e._eventMaps.push({el:n,type:a,listener:Ht.bind(n,i,a,r)})}t(document,"html","click",function(n){e.close()}),t(this._container,Ae.INPUT_SELECTOR,"click",function(n){n.stopPropagation(),n.delegateTarget.focus()}),t(this._container,Ae.RESULT_SELECTOR,"mouseover",function(n){n.stopPropagation(),e._scrollToNode(n.delegateTarget),e._preselect(n.delegateTarget)}),t(this._container,Ae.RESULT_SELECTOR,"click",function(n){n.stopPropagation(),e._select(n.delegateTarget)}),t(this._container,Ae.INPUT_SELECTOR,"keydown",function(n){n.keyCode===38&&n.preventDefault(),n.keyCode===40&&n.preventDefault()}),t(this._container,Ae.INPUT_SELECTOR,"keyup",function(n){if(n.keyCode===27)return e.close();if(n.keyCode===13){var i=e._getCurrentResult();return i?e._select(i):e.close()}if(n.keyCode===38)return e._scrollToDirection(!0);if(n.keyCode===40)return e._scrollToDirection();n.keyCode===37||n.keyCode===39||e._search(n.delegateTarget.value)})};Ae.prototype._unbindEvents=function(){this._eventMaps.forEach(function(e){Ht.unbind(e.el,e.type,e.listener)})};Ae.prototype._search=function(e){var t=this;if(this._clearResults(),!(!e||e==="")){var n=this._searchProvider.find(e);if(n.length){n.forEach(function(a){var r=a.element.id,o=t._createResultNode(a,r);t._results[r]={element:a.element,node:o}});var i=it(Ae.RESULT_SELECTOR,this._resultsContainer);this._scrollToNode(i),this._preselect(i)}}};Ae.prototype._scrollToDirection=function(e){var t=this._getCurrentResult();if(t){var n=e?t.previousElementSibling:t.nextElementSibling;n&&(this._scrollToNode(n),this._preselect(n))}};Ae.prototype._scrollToNode=function(e){if(!(!e||e===this._getCurrentResult())){var t=e.offsetTop,n=this._resultsContainer.scrollTop,i=t-this._resultsContainer.clientHeight+e.clientHeight;t<n?this._resultsContainer.scrollTop=t:n<i&&(this._resultsContainer.scrollTop=i)}};Ae.prototype._clearResults=function(){_s(this._resultsContainer),this._results=[],this._resetOverlay(),this._eventBus.fire("searchPad.cleared")};Ae.prototype._getCurrentResult=function(){return it(Ae.RESULT_SELECTED_SELECTOR,this._resultsContainer)};Ae.prototype._createResultNode=function(e,t){var n=Qe(Ae.RESULT_HTML);return e.primaryTokens.length>0&&Vm(n,e.primaryTokens,Ae.RESULT_PRIMARY_HTML),Vm(n,e.secondaryTokens,Ae.RESULT_SECONDARY_HTML),Ut(n,Ae.RESULT_ID_ATTRIBUTE,t),this._resultsContainer.appendChild(n),n};Ae.prototype.registerProvider=function(e){this._searchProvider=e};Ae.prototype.open=function(){if(!this._searchProvider)throw new Error("no search provider registered");this.isOpen()||(this._bindEvents(),this._open=!0,dt(this._container).add("open"),this._searchInput.focus(),this._eventBus.fire("searchPad.opened"))};Ae.prototype.close=function(){this.isOpen()&&(this._unbindEvents(),this._open=!1,dt(this._container).remove("open"),this._clearResults(),this._searchInput.value="",this._searchInput.blur(),this._resetOverlay(),this._eventBus.fire("searchPad.closed"))};Ae.prototype.toggle=function(){this.isOpen()?this.close():this.open()};Ae.prototype.isOpen=function(){return this._open};Ae.prototype._preselect=function(e){var t=this._getCurrentResult();if(e!==t){t&&dt(t).remove(Ae.RESULT_SELECTED_CLASS);var n=Ut(e,Ae.RESULT_ID_ATTRIBUTE),i=this._results[n].element;dt(e).add(Ae.RESULT_SELECTED_CLASS),this._resetOverlay(i),this._canvas.scrollToElement(i,{top:400}),this._selection.select(i),this._eventBus.fire("searchPad.preselected",i)}};Ae.prototype._select=function(e){var t=Ut(e,Ae.RESULT_ID_ATTRIBUTE),n=this._results[t].element;this.close(),this._resetOverlay(),this._canvas.scrollToElement(n,{top:400}),this._selection.select(n),this._eventBus.fire("searchPad.selected",n)};Ae.prototype._resetOverlay=function(e){if(this._overlayId&&this._overlays.remove(this._overlayId),e){var t=St(e),n=UI(t);this._overlayId=this._overlays.add(e,n)}};function UI(e){var t=6,n=e.width+t*2,i=e.height+t*2,a=["width: "+n+"px","height: "+i+"px"].join("; ");return{position:{bottom:i-t,right:n-t},show:!0,html:'<div style="'+a+'" class="'+Ae.OVERLAY_CLASS+'"></div>'}}function Vm(e,t,n){var i=qI(t),a=Qe(n);a.innerHTML=i,e.appendChild(a)}function qI(e){var t="";return e.forEach(function(n){n.matched?t+='<strong class="'+Ae.RESULT_HIGHLIGHT_CLASS+'">'+Vd(n.matched)+"</strong>":t+=Vd(n.normal)}),t!==""?t:null}Ae.CONTAINER_SELECTOR=".djs-search-container";Ae.INPUT_SELECTOR=".djs-search-input input";Ae.RESULTS_CONTAINER_SELECTOR=".djs-search-results";Ae.RESULT_SELECTOR=".djs-search-result";Ae.RESULT_SELECTED_CLASS="djs-search-result-selected";Ae.RESULT_SELECTED_SELECTOR="."+Ae.RESULT_SELECTED_CLASS;Ae.RESULT_ID_ATTRIBUTE="data-result-id";Ae.RESULT_HIGHLIGHT_CLASS="djs-search-highlight";Ae.OVERLAY_CLASS="djs-search-overlay";Ae.BOX_HTML='<div class="djs-search-container djs-draggable djs-scrollable"><div class="djs-search-input"><input type="text"/></div><div class="djs-search-results"></div></div>';Ae.RESULT_HTML='<div class="djs-search-result"></div>';Ae.RESULT_PRIMARY_HTML='<div class="djs-search-result-primary"></div>';Ae.RESULT_SECONDARY_HTML='<p class="djs-search-result-secondary"></p>';const WI={__depends__:[wp,Dn],searchPad:["type",Ae]};function Bf(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}Bf.$inject=["elementRegistry","searchPad","canvas"];Bf.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter(function(i){return!i.labelTarget});return n=Ie(n,function(i){return i!==t}),n=ht(n,function(i){return{primaryTokens:jm(En(i),e),secondaryTokens:jm(i.id,e),element:i}}),n=Ie(n,function(i){return Fm(i.primaryTokens)||Fm(i.secondaryTokens)}),n=nn(n,function(i){return En(i.element)+i.element.id}),n};function Fm(e){var t=Ie(e,function(n){return!!n.matched});return t.length>0}function jm(e,t){var n=[],i=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var a=e.indexOf(t);return a>-1?(a!==0&&n.push({normal:i.substr(0,a)}),n.push({matched:i.substr(a,t.length)}),t.length+a<e.length&&n.push({normal:i.substr(t.length+a,e.length)})):n.push({normal:i}),n}const YI={__depends__:[WI],__init__:["bpmnSearch"],bpmnSearch:["type",Bf]};var KI='<?xml version="1.0" encoding="UTF-8"?><bpmn:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" targetNamespace="http://bpmn.io/schema/bpmn" id="Definitions_1"><bpmn:process id="Process_1" isExecutable="false"><bpmn:startEvent id="StartEvent_1"/></bpmn:process><bpmndi:BPMNDiagram id="BPMNDiagram_1"><bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1"><bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1"><dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/></bpmndi:BPMNShape></bpmndi:BPMNPlane></bpmndi:BPMNDiagram></bpmn:definitions>';function Rn(e){Ta.call(this,e)}ye(Rn,Ta);Rn.Viewer=Kn;Rn.NavigatedViewer=ha;Rn.prototype.createDiagram=Ar(function(){return this.importXML(KI)});Rn.prototype._interactionModules=[wy,Py,q0,Ny];Rn.prototype._modelingModules=[Y0,cT,_T,vT,HT,kp,YT,Q1,oE,Fs,nC,aC,_C,TC,CC,NC,HC,YR,iI,dI,mI,_E,zI,YI];Rn.prototype._modules=[].concat(Kn.prototype._modules,Rn.prototype._interactionModules,Rn.prototype._modelingModules);const Db=(e,t,n)=>(n||(n="camunda"),`<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL"
  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"
  xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
  id="diagram_${e}"
  targetNamespace="${{activiti:"http://activiti.org/bpmn",camunda:"http://bpmn.io/schema/bpmn",flowable:"http://flowable.org/bpmn"}[n]}">
  <bpmn2:process id="${e}" name="${t}" isExecutable="true">
  </bpmn2:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="${e}">
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn2:definitions>`);function XI(e){return function(t,n){return n=n||{},t=e[t]||t,t.replace(/{([^}]+)}/g,function(i,a){let r=n[a];return e[n[a]]!==null&&e[n[a]]!==void 0&&(r=e[n[a]]),r||`{${a}}`})}}const ZI={"Append EndEvent":"追加结束事件","Append Gateway":"追加网关","Append Task":"追加任务","Append Intermediate/Boundary Event":"追加中间抛出事件/边界事件","Activate the global connect tool":"激活全局连接工具","Append {type}":"添加 {type}","Add Lane above":"在上面添加道","Divide into two Lanes":"分割成两个道","Divide into three Lanes":"分割成三个道","Add Lane below":"在下面添加道","Append compensation activity":"追加补偿活动","Change type":"修改类型","Connect using Association":"使用关联连接","Connect using Sequence/MessageFlow or Association":"使用顺序/消息流或者关联连接","Connect using DataInputAssociation":"使用数据输入关联连接",Remove:"移除","Activate the hand tool":"激活抓手工具","Activate the lasso tool":"激活套索工具","Activate the create/remove space tool":"激活创建/删除空间工具","Create expanded SubProcess":"创建扩展子过程","Create IntermediateThrowEvent/BoundaryEvent":"创建中间抛出事件/边界事件","Create Pool/Participant":"创建池/参与者","Parallel Multi Instance":"并行多重事件","Sequential Multi Instance":"时序多重事件",DataObjectReference:"数据对象参考",DataStoreReference:"数据存储参考",Loop:"循环","Ad-hoc":"即席","Create {type}":"创建 {type}",Task:"任务","Send Task":"发送任务","Receive Task":"接收任务","User Task":"用户任务","Manual Task":"手工任务","Business Rule Task":"业务规则任务","Service Task":"服务任务","Script Task":"脚本任务","Call Activity":"调用活动","Sub Process (collapsed)":"子流程（折叠的）","Sub Process (expanded)":"子流程（展开的）","Start Event":"开始事件",StartEvent:"开始事件","Intermediate Throw Event":"中间事件","End Event":"结束事件",EndEvent:"结束事件","Create StartEvent":"创建开始事件","Create EndEvent":"创建结束事件","Create Task":"创建任务","Create User Task":"创建用户任务","Create Gateway":"创建网关","Create DataObjectReference":"创建数据对象","Create DataStoreReference":"创建数据存储","Create Group":"创建分组","Create Intermediate/Boundary Event":"创建中间/边界事件","Message Start Event":"消息开始事件","Timer Start Event":"定时开始事件","Conditional Start Event":"条件开始事件","Signal Start Event":"信号开始事件","Error Start Event":"错误开始事件","Escalation Start Event":"升级开始事件","Compensation Start Event":"补偿开始事件","Message Start Event (non-interrupting)":"消息开始事件（非中断）","Timer Start Event (non-interrupting)":"定时开始事件（非中断）","Conditional Start Event (non-interrupting)":"条件开始事件（非中断）","Signal Start Event (non-interrupting)":"信号开始事件（非中断）","Escalation Start Event (non-interrupting)":"升级开始事件（非中断）","Message Intermediate Catch Event":"消息中间捕获事件","Message Intermediate Throw Event":"消息中间抛出事件","Timer Intermediate Catch Event":"定时中间捕获事件","Escalation Intermediate Throw Event":"升级中间抛出事件","Conditional Intermediate Catch Event":"条件中间捕获事件","Link Intermediate Catch Event":"链接中间捕获事件","Link Intermediate Throw Event":"链接中间抛出事件","Compensation Intermediate Throw Event":"补偿中间抛出事件","Signal Intermediate Catch Event":"信号中间捕获事件","Signal Intermediate Throw Event":"信号中间抛出事件","Message End Event":"消息结束事件","Escalation End Event":"定时结束事件","Error End Event":"错误结束事件","Cancel End Event":"取消结束事件","Compensation End Event":"补偿结束事件","Signal End Event":"信号结束事件","Terminate End Event":"终止结束事件","Message Boundary Event":"消息边界事件","Message Boundary Event (non-interrupting)":"消息边界事件（非中断）","Timer Boundary Event":"定时边界事件","Timer Boundary Event (non-interrupting)":"定时边界事件（非中断）","Escalation Boundary Event":"升级边界事件","Escalation Boundary Event (non-interrupting)":"升级边界事件（非中断）","Conditional Boundary Event":"条件边界事件","Conditional Boundary Event (non-interrupting)":"条件边界事件（非中断）","Error Boundary Event":"错误边界事件","Cancel Boundary Event":"取消边界事件","Signal Boundary Event":"信号边界事件","Signal Boundary Event (non-interrupting)":"信号边界事件（非中断）","Compensation Boundary Event":"补偿边界事件","Exclusive Gateway":"互斥网关","Parallel Gateway":"并行网关","Inclusive Gateway":"相容网关","Complex Gateway":"复杂网关","Event based Gateway":"事件网关",Transaction:"转运","Sub Process":"子流程","Event Sub Process":"事件子流程","Collapsed Pool":"折叠池","Expanded Pool":"展开池","no parent for {element} in {parent}":"在{parent}里，{element}没有父类","no shape type specified":"没有指定的形状类型","flow elements must be children of pools/participants":"流元素必须是池/参与者的子类","out of bounds release":"out of bounds release","more than {count} child lanes":"子道大于{count} ","element required":"元素不能为空","diagram not part of bpmn:Definitions":"流程图不符合bpmn规范","no diagram to display":"没有可展示的流程图","no process or collaboration to display":"没有可展示的流程/协作","element {element} referenced by {referenced}#{property} not yet drawn":"由{referenced}#{property}引用的{element}元素仍未绘制","already rendered {element}":"{element} 已被渲染","failed to import {element}":"导入{element}失败",Id:"编号",Name:"名称",General:"常规",Details:"详情","Message Name":"消息名称",Message:"消息",Initiator:"创建者","Asynchronous Continuations":"持续异步","Asynchronous Before":"异步前","Asynchronous After":"异步后","Job Configuration":"工作配置",Exclusive:"排除","Job Priority":"工作优先级","Retry Time Cycle":"重试时间周期",Documentation:"文档","Element Documentation":"元素文档","History Configuration":"历史配置","History Time To Live":"历史的生存时间",Forms:"表单","Form Key":"表单key","Form Fields":"表单字段","Business Key":"业务key","Form Field":"表单字段",ID:"编号",Type:"类型",Label:"名称","Default Value":"默认值","Default Flow":"默认流转路径","Conditional Flow":"条件流转路径","Sequence Flow":"普通流转路径",Validation:"校验","Add Constraint":"添加约束",Config:"配置",Properties:"属性","Add Property":"添加属性",Value:"值",Listeners:"监听器","Execution Listener":"执行监听","Event Type":"事件类型","Listener Type":"监听器类型","Java Class":"Java类",Expression:"表达式","Must provide a value":"必须提供一个值","Delegate Expression":"代理表达式",Script:"脚本","Script Format":"脚本格式","Script Type":"脚本类型","Inline Script":"内联脚本","External Script":"外部脚本",Resource:"资源","Field Injection":"字段注入",Extensions:"扩展","Input/Output":"输入/输出","Input Parameters":"输入参数","Output Parameters":"输出参数",Parameters:"参数","Output Parameter":"输出参数","Timer Definition Type":"定时器定义类型","Timer Definition":"定时器定义",Date:"日期",Duration:"持续",Cycle:"循环",Signal:"信号","Signal Name":"信号名称",Escalation:"升级",Error:"错误","Link Name":"链接名称",Condition:"条件名称","Variable Name":"变量名称","Variable Event":"变量事件","Specify more than one variable change event as a comma separated list.":"多个变量事件以逗号隔开","Wait for Completion":"等待完成","Activity Ref":"活动参考","Version Tag":"版本标签",Executable:"可执行文件","External Task Configuration":"扩展任务配置","Task Priority":"任务优先级",External:"外部",Connector:"连接器","Must configure Connector":"必须配置连接器","Connector Id":"连接器编号",Implementation:"实现方式","Field Injections":"字段注入",Fields:"字段","Result Variable":"结果变量",Topic:"主题","Configure Connector":"配置连接器","Input Parameter":"输入参数",Assignee:"代理人","Candidate Users":"候选用户","Candidate Groups":"候选组","Due Date":"到期时间","Follow Up Date":"跟踪日期",Priority:"优先级","The follow up date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00","The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)":"跟踪日期必须符合EL表达式，如： ${someDate} ,或者一个ISO标准日期，如：2015-06-26T09:54:00",Variables:"变量","Candidate Starter Configuration":"候选人起动器配置","Candidate Starter Groups":"候选人起动器组","This maps to the process definition key.":"这映射到流程定义键。","Candidate Starter Users":"候选人起动器的用户","Specify more than one user as a comma separated list.":"指定多个用户作为逗号分隔的列表。","Tasklist Configuration":"Tasklist配置",Startable:"启动","Specify more than one group as a comma separated list.":"指定多个组作为逗号分隔的列表。"};var ts={exports:{}};/*!
* svg.js - A lightweight library for manipulating and animating SVG.
* @version 2.7.1
* https://svgdotjs.github.io/
*
* @copyright Wout Fierens <wout@mick-wout.com>
* @license MIT
*
* BUILT: Fri Nov 30 2018 10:01:55 GMT+0100 (GMT+01:00)
*/var JI=ts.exports,Hm;function QI(){return Hm||(Hm=1,function(e,t){(function(n,i){e.exports=n.document?i(n,n.document):function(a){return i(a,a.document)}})(typeof window<"u"?window:JI,function(n,i){var a=typeof this<"u"?this:n,r=a.SVG=function(u){if(r.supported)return u=new r.Doc(u),r.parser.draw||r.prepare(),u};if(r.ns="http://www.w3.org/2000/svg",r.xmlns="http://www.w3.org/2000/xmlns/",r.xlink="http://www.w3.org/1999/xlink",r.svgjs="http://svgjs.com/svgjs",r.supported=function(){return!!i.createElementNS&&!!i.createElementNS(r.ns,"svg").createSVGRect}(),!r.supported)return!1;r.did=1e3,r.eid=function(u){return"Svgjs"+b(u)+r.did++},r.create=function(u){var d=i.createElementNS(this.ns,u);return d.setAttribute("id",this.eid(u)),d},r.extend=function(){var u,d,E,y;for(u=[].slice.call(arguments),d=u.pop(),y=u.length-1;y>=0;y--)if(u[y])for(E in d)u[y].prototype[E]=d[E];r.Set&&r.Set.inherit&&r.Set.inherit()},r.invent=function(u){var d=typeof u.create=="function"?u.create:function(){this.constructor.call(this,r.create(u.create))};return u.inherit&&(d.prototype=new u.inherit),u.extend&&r.extend(d,u.extend),u.construct&&r.extend(u.parent||r.Container,u.construct),d},r.adopt=function(u){if(!u)return null;if(u.instance)return u.instance;var d;return u.nodeName=="svg"?d=u.parentNode instanceof n.SVGElement?new r.Nested:new r.Doc:u.nodeName=="linearGradient"?d=new r.Gradient("linear"):u.nodeName=="radialGradient"?d=new r.Gradient("radial"):r[b(u.nodeName)]?d=new r[b(u.nodeName)]:d=new r.Element(u),d.type=u.nodeName,d.node=u,u.instance=d,d instanceof r.Doc&&d.namespace().defs(),d.setData(JSON.parse(u.getAttribute("svgjs:data"))||{}),d},r.prepare=function(){var u=i.getElementsByTagName("body")[0],d=(u?new r.Doc(u):r.adopt(i.documentElement).nested()).size(2,0);r.parser={body:u||i.documentElement,draw:d.style("opacity:0;position:absolute;left:-100%;top:-100%;overflow:hidden").attr("focusable","false").node,poly:d.polyline().node,path:d.path().node,native:r.create("svg")}},r.parser={native:r.create("svg")},i.addEventListener("DOMContentLoaded",function(){r.parser.draw||r.prepare()},!1),r.regex={numberAndUnit:/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,transforms:/\)\s*,?\s*/,whitespace:/\s/g,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,delimiter:/[\s,]+/,hyphen:/([^e])\-/gi,pathLetters:/[MLHVCSQTAZ]/gi,isPathLetter:/[MLHVCSQTAZ]/i,numbersWithDots:/((\d?\.\d+(?:e[+-]?\d+)?)((?:\.\d+(?:e[+-]?\d+)?)+))+/gi,dots:/\./g},r.utils={map:function(u,d){var E,y=u.length,g=[];for(E=0;E<y;E++)g.push(d(u[E]));return g},filter:function(u,d){var E,y=u.length,g=[];for(E=0;E<y;E++)d(u[E])&&g.push(u[E]);return g},radians:function(u){return u%360*Math.PI/180},degrees:function(u){return u*180/Math.PI%360},filterSVGElements:function(u){return this.filter(u,function(d){return d instanceof n.SVGElement})}},r.defaults={attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"}},r.Color=function(u){var d;this.r=0,this.g=0,this.b=0,u&&(typeof u=="string"?r.regex.isRgb.test(u)?(d=r.regex.rgb.exec(u.replace(r.regex.whitespace,"")),this.r=parseInt(d[1]),this.g=parseInt(d[2]),this.b=parseInt(d[3])):r.regex.isHex.test(u)&&(d=r.regex.hex.exec(M(u)),this.r=parseInt(d[1],16),this.g=parseInt(d[2],16),this.b=parseInt(d[3],16)):typeof u=="object"&&(this.r=u.r,this.g=u.g,this.b=u.b))},r.extend(r.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+P(this.r)+P(this.g)+P(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(u){return this.destination=new r.Color(u),this},at:function(u){return this.destination?(u=u<0?0:u>1?1:u,new r.Color({r:~~(this.r+(this.destination.r-this.r)*u),g:~~(this.g+(this.destination.g-this.g)*u),b:~~(this.b+(this.destination.b-this.b)*u)})):this}}),r.Color.test=function(u){return u+="",r.regex.isHex.test(u)||r.regex.isRgb.test(u)},r.Color.isRgb=function(u){return u&&typeof u.r=="number"&&typeof u.g=="number"&&typeof u.b=="number"},r.Color.isColor=function(u){return r.Color.isRgb(u)||r.Color.test(u)},r.Array=function(u,d){u=(u||[]).valueOf(),u.length==0&&d&&(u=d.valueOf()),this.value=this.parse(u)},r.extend(r.Array,{morph:function(u){if(this.destination=this.parse(u),this.value.length!=this.destination.length){for(var d=this.value[this.value.length-1],E=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(E);for(;this.value.length<this.destination.length;)this.value.push(d)}return this},settle:function(){for(var u=0,d=this.value.length,E=[];u<d;u++)E.indexOf(this.value[u])==-1&&E.push(this.value[u]);return this.value=E},at:function(u){if(!this.destination)return this;for(var d=0,E=this.value.length,y=[];d<E;d++)y.push(this.value[d]+(this.destination[d]-this.value[d])*u);return new r.Array(y)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(u){return u=u.valueOf(),Array.isArray(u)?u:this.split(u)},split:function(u){return u.trim().split(r.regex.delimiter).map(parseFloat)},reverse:function(){return this.value.reverse(),this},clone:function(){var u=new this.constructor;return u.value=h(this.value),u}}),r.PointArray=function(u,d){r.Array.call(this,u,d||[[0,0]])},r.PointArray.prototype=new r.Array,r.PointArray.prototype.constructor=r.PointArray,r.extend(r.PointArray,{toString:function(){for(var u=0,d=this.value.length,E=[];u<d;u++)E.push(this.value[u].join(","));return E.join(" ")},toLine:function(){return{x1:this.value[0][0],y1:this.value[0][1],x2:this.value[1][0],y2:this.value[1][1]}},at:function(u){if(!this.destination)return this;for(var d=0,E=this.value.length,y=[];d<E;d++)y.push([this.value[d][0]+(this.destination[d][0]-this.value[d][0])*u,this.value[d][1]+(this.destination[d][1]-this.value[d][1])*u]);return new r.PointArray(y)},parse:function(u){var d=[];if(u=u.valueOf(),Array.isArray(u)){if(Array.isArray(u[0]))return u.map(function(g){return g.slice()});if(u[0].x!=null)return u.map(function(g){return[g.x,g.y]})}else u=u.trim().split(r.regex.delimiter).map(parseFloat);u.length%2!==0&&u.pop();for(var E=0,y=u.length;E<y;E=E+2)d.push([u[E],u[E+1]]);return d},move:function(u,d){var E=this.bbox();if(u-=E.x,d-=E.y,!isNaN(u)&&!isNaN(d))for(var y=this.value.length-1;y>=0;y--)this.value[y]=[this.value[y][0]+u,this.value[y][1]+d];return this},size:function(u,d){var E,y=this.bbox();for(E=this.value.length-1;E>=0;E--)y.width&&(this.value[E][0]=(this.value[E][0]-y.x)*u/y.width+y.x),y.height&&(this.value[E][1]=(this.value[E][1]-y.y)*d/y.height+y.y);return this},bbox:function(){return r.parser.poly.setAttribute("points",this.toString()),r.parser.poly.getBBox()}});for(var o={M:function(u,d,E){return d.x=E.x=u[0],d.y=E.y=u[1],["M",d.x,d.y]},L:function(u,d){return d.x=u[0],d.y=u[1],["L",u[0],u[1]]},H:function(u,d){return d.x=u[0],["H",u[0]]},V:function(u,d){return d.y=u[0],["V",u[0]]},C:function(u,d){return d.x=u[4],d.y=u[5],["C",u[0],u[1],u[2],u[3],u[4],u[5]]},S:function(u,d){return d.x=u[2],d.y=u[3],["S",u[0],u[1],u[2],u[3]]},Q:function(u,d){return d.x=u[2],d.y=u[3],["Q",u[0],u[1],u[2],u[3]]},T:function(u,d){return d.x=u[0],d.y=u[1],["T",u[0],u[1]]},Z:function(u,d,E){return d.x=E.x,d.y=E.y,["Z"]},A:function(u,d){return d.x=u[5],d.y=u[6],["A",u[0],u[1],u[2],u[3],u[4],u[5],u[6]]}},s="mlhvqtcsaz".split(""),l=0,c=s.length;l<c;++l)o[s[l]]=function(u){return function(d,E,y){if(u=="H")d[0]=d[0]+E.x;else if(u=="V")d[0]=d[0]+E.y;else if(u=="A")d[5]=d[5]+E.x,d[6]=d[6]+E.y;else for(var g=0,C=d.length;g<C;++g)d[g]=d[g]+(g%2?E.y:E.x);return o[u](d,E,y)}}(s[l].toUpperCase());r.PathArray=function(u,d){r.Array.call(this,u,d||[["M",0,0]])},r.PathArray.prototype=new r.Array,r.PathArray.prototype.constructor=r.PathArray,r.extend(r.PathArray,{toString:function(){return $(this.value)},move:function(u,d){var E=this.bbox();if(u-=E.x,d-=E.y,!isNaN(u)&&!isNaN(d))for(var y,g=this.value.length-1;g>=0;g--)y=this.value[g][0],y=="M"||y=="L"||y=="T"?(this.value[g][1]+=u,this.value[g][2]+=d):y=="H"?this.value[g][1]+=u:y=="V"?this.value[g][1]+=d:y=="C"||y=="S"||y=="Q"?(this.value[g][1]+=u,this.value[g][2]+=d,this.value[g][3]+=u,this.value[g][4]+=d,y=="C"&&(this.value[g][5]+=u,this.value[g][6]+=d)):y=="A"&&(this.value[g][6]+=u,this.value[g][7]+=d);return this},size:function(u,d){var E,y,g=this.bbox();for(E=this.value.length-1;E>=0;E--)y=this.value[E][0],y=="M"||y=="L"||y=="T"?(this.value[E][1]=(this.value[E][1]-g.x)*u/g.width+g.x,this.value[E][2]=(this.value[E][2]-g.y)*d/g.height+g.y):y=="H"?this.value[E][1]=(this.value[E][1]-g.x)*u/g.width+g.x:y=="V"?this.value[E][1]=(this.value[E][1]-g.y)*d/g.height+g.y:y=="C"||y=="S"||y=="Q"?(this.value[E][1]=(this.value[E][1]-g.x)*u/g.width+g.x,this.value[E][2]=(this.value[E][2]-g.y)*d/g.height+g.y,this.value[E][3]=(this.value[E][3]-g.x)*u/g.width+g.x,this.value[E][4]=(this.value[E][4]-g.y)*d/g.height+g.y,y=="C"&&(this.value[E][5]=(this.value[E][5]-g.x)*u/g.width+g.x,this.value[E][6]=(this.value[E][6]-g.y)*d/g.height+g.y)):y=="A"&&(this.value[E][1]=this.value[E][1]*u/g.width,this.value[E][2]=this.value[E][2]*d/g.height,this.value[E][6]=(this.value[E][6]-g.x)*u/g.width+g.x,this.value[E][7]=(this.value[E][7]-g.y)*d/g.height+g.y);return this},equalCommands:function(u){var d,E,y;for(u=new r.PathArray(u),y=this.value.length===u.value.length,d=0,E=this.value.length;y&&d<E;d++)y=this.value[d][0]===u.value[d][0];return y},morph:function(u){return u=new r.PathArray(u),this.equalCommands(u)?this.destination=u:this.destination=null,this},at:function(u){if(!this.destination)return this;var d=this.value,E=this.destination.value,y=[],g=new r.PathArray,C,x,R,D;for(C=0,x=d.length;C<x;C++){for(y[C]=[d[C][0]],R=1,D=d[C].length;R<D;R++)y[C][R]=d[C][R]+(E[C][R]-d[C][R])*u;y[C][0]==="A"&&(y[C][4]=+(y[C][4]!=0),y[C][5]=+(y[C][5]!=0))}return g.value=y,g},parse:function(u){if(u instanceof r.PathArray)return u.valueOf();var d,y,E={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0};typeof u=="string"?u=u.replace(r.regex.numbersWithDots,f).replace(r.regex.pathLetters," $& ").replace(r.regex.hyphen,"$1 -").trim().split(r.regex.delimiter):u=u.reduce(function(D,L){return[].concat.call(D,L)},[]);var y=[],g=new r.Point,C=new r.Point,x=0,R=u.length;do r.regex.isPathLetter.test(u[x])?(d=u[x],++x):d=="M"?d="L":d=="m"&&(d="l"),y.push(o[d].call(null,u.slice(x,x=x+E[d.toUpperCase()]).map(parseFloat),g,C));while(R>x);return y},bbox:function(){return r.parser.path.setAttribute("d",this.toString()),r.parser.path.getBBox()}}),r.Number=r.invent({create:function(u,d){this.value=0,this.unit=d||"",typeof u=="number"?this.value=isNaN(u)?0:isFinite(u)?u:u<0?-34e37:34e37:typeof u=="string"?(d=u.match(r.regex.numberAndUnit),d&&(this.value=parseFloat(d[1]),d[5]=="%"?this.value/=100:d[5]=="s"&&(this.value*=1e3),this.unit=d[5])):u instanceof r.Number&&(this.value=u.valueOf(),this.unit=u.unit)},extend:{toString:function(){return(this.unit=="%"?~~(this.value*1e8)/1e6:this.unit=="s"?this.value/1e3:this.value)+this.unit},toJSON:function(){return this.toString()},valueOf:function(){return this.value},plus:function(u){return u=new r.Number(u),new r.Number(this+u,this.unit||u.unit)},minus:function(u){return u=new r.Number(u),new r.Number(this-u,this.unit||u.unit)},times:function(u){return u=new r.Number(u),new r.Number(this*u,this.unit||u.unit)},divide:function(u){return u=new r.Number(u),new r.Number(this/u,this.unit||u.unit)},to:function(u){var d=new r.Number(this);return typeof u=="string"&&(d.unit=u),d},morph:function(u){return this.destination=new r.Number(u),u.relative&&(this.destination.value+=this.value),this},at:function(u){return this.destination?new r.Number(this.destination).minus(this).times(u).plus(this):this}}}),r.Element=r.invent({create:function(u){this._stroke=r.defaults.attrs.stroke,this._event=null,this._events={},this.dom={},(this.node=u)&&(this.type=u.nodeName,this.node.instance=this,this._events=u._events||{},this._stroke=u.getAttribute("stroke")||this._stroke)},extend:{x:function(u){return this.attr("x",u)},y:function(u){return this.attr("y",u)},cx:function(u){return u==null?this.x()+this.width()/2:this.x(u-this.width()/2)},cy:function(u){return u==null?this.y()+this.height()/2:this.y(u-this.height()/2)},move:function(u,d){return this.x(u).y(d)},center:function(u,d){return this.cx(u).cy(d)},width:function(u){return this.attr("width",u)},height:function(u){return this.attr("height",u)},size:function(u,d){var E=S(this,u,d);return this.width(new r.Number(E.width)).height(new r.Number(E.height))},clone:function(u){this.writeDataToDom();var d=H(this.node.cloneNode(!0));return u?u.add(d):this.after(d),d},remove:function(){return this.parent()&&this.parent().removeElement(this),this},replace:function(u){return this.after(u).remove(),u},addTo:function(u){return u.put(this)},putIn:function(u){return u.add(this)},id:function(u){return this.attr("id",u)},inside:function(u,d){var E=this.bbox();return u>E.x&&d>E.y&&u<E.x+E.width&&d<E.y+E.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return this.style("display")!="none"},toString:function(){return this.attr("id")},classes:function(){var u=this.attr("class");return u==null?[]:u.trim().split(r.regex.delimiter)},hasClass:function(u){return this.classes().indexOf(u)!=-1},addClass:function(u){if(!this.hasClass(u)){var d=this.classes();d.push(u),this.attr("class",d.join(" "))}return this},removeClass:function(u){return this.hasClass(u)&&this.attr("class",this.classes().filter(function(d){return d!=u}).join(" ")),this},toggleClass:function(u){return this.hasClass(u)?this.removeClass(u):this.addClass(u)},reference:function(u){return r.get(this.attr(u))},parent:function(u){var d=this;if(!d.node.parentNode)return null;if(d=r.adopt(d.node.parentNode),!u)return d;for(;d&&d.node instanceof n.SVGElement;){if(typeof u=="string"?d.matches(u):d instanceof u)return d;if(!d.node.parentNode||d.node.parentNode.nodeName=="#document"||d.node.parentNode.nodeName=="#document-fragment")return null;d=r.adopt(d.node.parentNode)}},doc:function(){return this instanceof r.Doc?this:this.parent(r.Doc)},parents:function(u){var d=[],E=this;do{if(E=E.parent(u),!E||!E.node)break;d.push(E)}while(E.parent);return d},matches:function(u){return m(this.node,u)},native:function(){return this.node},svg:function(u){var d=i.createElement("svg");if(u&&this instanceof r.Parent){d.innerHTML="<svg>"+u.replace(/\n/,"").replace(/<([\w:-]+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var E=0,y=d.firstChild.childNodes.length;E<y;E++)this.node.appendChild(d.firstChild.firstChild)}else return d.appendChild(u=i.createElement("svg")),this.writeDataToDom(),u.appendChild(this.node.cloneNode(!0)),d.innerHTML.replace(/^<svg>/,"").replace(/<\/svg>$/,"");return this},writeDataToDom:function(){if(this.each||this.lines){var u=this.each?this:this.lines();u.each(function(){this.writeDataToDom()})}return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),this},setData:function(u){return this.dom=u,this},is:function(u){return v(this,u)}}}),r.easing={"-":function(u){return u},"<>":function(u){return-Math.cos(u*Math.PI)/2+.5},">":function(u){return Math.sin(u*Math.PI/2)},"<":function(u){return-Math.cos(u*Math.PI/2)+1}},r.morph=function(u){return function(d,E){return new r.MorphObj(d,E).at(u)}},r.Situation=r.invent({create:function(u){this.init=!1,this.reversed=!1,this.reversing=!1,this.duration=new r.Number(u.duration).valueOf(),this.delay=new r.Number(u.delay).valueOf(),this.start=+new Date+this.delay,this.finish=this.start+this.duration,this.ease=u.ease,this.loop=0,this.loops=!1,this.animations={},this.attrs={},this.styles={},this.transforms=[],this.once={}}}),r.FX=r.invent({create:function(u){this._target=u,this.situations=[],this.active=!1,this.situation=null,this.paused=!1,this.lastPos=0,this.pos=0,this.absPos=0,this._speed=1},extend:{animate:function(u,d,E){typeof u=="object"&&(d=u.ease,E=u.delay,u=u.duration);var y=new r.Situation({duration:u||1e3,delay:E||0,ease:r.easing[d||"-"]||d});return this.queue(y),this},delay:function(u){var d=new r.Situation({duration:u,delay:0,ease:r.easing["-"]});return this.queue(d)},target:function(u){return u&&u instanceof r.Element?(this._target=u,this):this._target},timeToAbsPos:function(u){return(u-this.situation.start)/(this.situation.duration/this._speed)},absPosToTime:function(u){return this.situation.duration/this._speed*u+this.situation.start},startAnimFrame:function(){this.stopAnimFrame(),this.animationFrame=n.requestAnimationFrame(function(){this.step()}.bind(this))},stopAnimFrame:function(){n.cancelAnimationFrame(this.animationFrame)},start:function(){return!this.active&&this.situation&&(this.active=!0,this.startCurrent()),this},startCurrent:function(){return this.situation.start=+new Date+this.situation.delay/this._speed,this.situation.finish=this.situation.start+this.situation.duration/this._speed,this.initAnimations().step()},queue:function(u){return(typeof u=="function"||u instanceof r.Situation)&&this.situations.push(u),this.situation||(this.situation=this.situations.shift()),this},dequeue:function(){return this.stop(),this.situation=this.situations.shift(),this.situation&&(this.situation instanceof r.Situation?this.start():this.situation.call(this)),this},initAnimations:function(){var u,d,E,y=this.situation;if(y.init)return this;for(u in y.animations)for(E=this.target()[u](),Array.isArray(E)||(E=[E]),Array.isArray(y.animations[u])||(y.animations[u]=[y.animations[u]]),d=E.length;d--;)y.animations[u][d]instanceof r.Number&&(E[d]=new r.Number(E[d])),y.animations[u][d]=E[d].morph(y.animations[u][d]);for(u in y.attrs)y.attrs[u]=new r.MorphObj(this.target().attr(u),y.attrs[u]);for(u in y.styles)y.styles[u]=new r.MorphObj(this.target().style(u),y.styles[u]);return y.initialTransformation=this.target().matrixify(),y.init=!0,this},clearQueue:function(){return this.situations=[],this},clearCurrent:function(){return this.situation=null,this},stop:function(u,d){var E=this.active;return this.active=!1,d&&this.clearQueue(),u&&this.situation&&(!E&&this.startCurrent(),this.atEnd()),this.stopAnimFrame(),this.clearCurrent()},reset:function(){if(this.situation){var u=this.situation;this.stop(),this.situation=u,this.atStart()}return this},finish:function(){for(this.stop(!0,!1);this.dequeue().situation&&this.stop(!0,!1););return this.clearQueue().clearCurrent(),this},atStart:function(){return this.at(0,!0)},atEnd:function(){return this.situation.loops===!0&&(this.situation.loops=this.situation.loop+1),typeof this.situation.loops=="number"?this.at(this.situation.loops,!0):this.at(1,!0)},at:function(u,d){var E=this.situation.duration/this._speed;return this.absPos=u,d||(this.situation.reversed&&(this.absPos=1-this.absPos),this.absPos+=this.situation.loop),this.situation.start=+new Date-this.absPos*E,this.situation.finish=this.situation.start+E,this.step(!0)},speed:function(u){return u===0?this.pause():u?(this._speed=u,this.at(this.absPos,!0)):this._speed},loop:function(u,d){var E=this.last();return E.loops=u??!0,E.loop=0,d&&(E.reversing=!0),this},pause:function(){return this.paused=!0,this.stopAnimFrame(),this},play:function(){return this.paused?(this.paused=!1,this.at(this.absPos,!0)):this},reverse:function(u){var d=this.last();return typeof u>"u"?d.reversed=!d.reversed:d.reversed=u,this},progress:function(u){return u?this.situation.ease(this.pos):this.pos},after:function(u){var d=this.last(),E=function y(g){g.detail.situation==d&&(u.call(this,d),this.off("finished.fx",y))};return this.target().on("finished.fx",E),this._callStart()},during:function(u){var d=this.last(),E=function(y){y.detail.situation==d&&u.call(this,y.detail.pos,r.morph(y.detail.pos),y.detail.eased,d)};return this.target().off("during.fx",E).on("during.fx",E),this.after(function(){this.off("during.fx",E)}),this._callStart()},afterAll:function(u){var d=function E(y){u.call(this),this.off("allfinished.fx",E)};return this.target().off("allfinished.fx",d).on("allfinished.fx",d),this._callStart()},duringAll:function(u){var d=function(E){u.call(this,E.detail.pos,r.morph(E.detail.pos),E.detail.eased,E.detail.situation)};return this.target().off("during.fx",d).on("during.fx",d),this.afterAll(function(){this.off("during.fx",d)}),this._callStart()},last:function(){return this.situations.length?this.situations[this.situations.length-1]:this.situation},add:function(u,d,E){return this.last()[E||"animations"][u]=d,this._callStart()},step:function(u){if(u||(this.absPos=this.timeToAbsPos(+new Date)),this.situation.loops!==!1){var d,E,y;d=Math.max(this.absPos,0),E=Math.floor(d),this.situation.loops===!0||E<this.situation.loops?(this.pos=d-E,y=this.situation.loop,this.situation.loop=E):(this.absPos=this.situation.loops,this.pos=1,y=this.situation.loop-1,this.situation.loop=this.situation.loops),this.situation.reversing&&(this.situation.reversed=this.situation.reversed!=!!((this.situation.loop-y)%2))}else this.absPos=Math.min(this.absPos,1),this.pos=this.absPos;this.pos<0&&(this.pos=0),this.situation.reversed&&(this.pos=1-this.pos);var g=this.situation.ease(this.pos);for(var C in this.situation.once)C>this.lastPos&&C<=g&&(this.situation.once[C].call(this.target(),this.pos,g),delete this.situation.once[C]);return this.active&&this.target().fire("during",{pos:this.pos,eased:g,fx:this,situation:this.situation}),this.situation?(this.eachAt(),this.pos==1&&!this.situation.reversed||this.situation.reversed&&this.pos==0?(this.stopAnimFrame(),this.target().fire("finished",{fx:this,situation:this.situation}),this.situations.length||(this.target().fire("allfinished"),this.situations.length||(this.target().off(".fx"),this.active=!1)),this.active?this.dequeue():this.clearCurrent()):!this.paused&&this.active&&this.startAnimFrame(),this.lastPos=g,this):this},eachAt:function(){var u,d,E,y=this,g=this.target(),C=this.situation;for(u in C.animations)E=[].concat(C.animations[u]).map(function(R){return typeof R!="string"&&R.at?R.at(C.ease(y.pos),y.pos):R}),g[u].apply(g,E);for(u in C.attrs)E=[u].concat(C.attrs[u]).map(function(R){return typeof R!="string"&&R.at?R.at(C.ease(y.pos),y.pos):R}),g.attr.apply(g,E);for(u in C.styles)E=[u].concat(C.styles[u]).map(function(R){return typeof R!="string"&&R.at?R.at(C.ease(y.pos),y.pos):R}),g.style.apply(g,E);if(C.transforms.length){for(E=C.initialTransformation,u=0,d=C.transforms.length;u<d;u++){var x=C.transforms[u];if(x instanceof r.Matrix){x.relative?E=E.multiply(new r.Matrix().morph(x).at(C.ease(this.pos))):E=E.morph(x).at(C.ease(this.pos));continue}x.relative||x.undo(E.extract()),E=E.multiply(x.at(C.ease(this.pos)))}g.matrix(E)}return this},once:function(u,d,E){var y=this.last();return E||(u=y.ease(u)),y.once[u]=d,this},_callStart:function(){return setTimeout(function(){this.start()}.bind(this),0),this}},parent:r.Element,construct:{animate:function(u,d,E){return(this.fx||(this.fx=new r.FX(this))).animate(u,d,E)},delay:function(u){return(this.fx||(this.fx=new r.FX(this))).delay(u)},stop:function(u,d){return this.fx&&this.fx.stop(u,d),this},finish:function(){return this.fx&&this.fx.finish(),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this},speed:function(u){if(this.fx){if(u==null)return this.fx.speed();this.fx.speed(u)}return this}}}),r.MorphObj=r.invent({create:function(u,d){if(r.Color.isColor(d))return new r.Color(u).morph(d);if(r.regex.delimiter.test(u))return r.regex.pathLetters.test(u)?new r.PathArray(u).morph(d):new r.Array(u).morph(d);if(r.regex.numberAndUnit.test(d))return new r.Number(u).morph(d);this.value=u,this.destination=d},extend:{at:function(u,d){return d<1?this.value:this.destination},valueOf:function(){return this.value}}}),r.extend(r.FX,{attr:function(u,d,E){if(typeof u=="object")for(var y in u)this.attr(y,u[y]);else this.add(u,d,"attrs");return this},style:function(u,d){if(typeof u=="object")for(var E in u)this.style(E,u[E]);else this.add(u,d,"styles");return this},x:function(u,d){if(this.target()instanceof r.G)return this.transform({x:u},d),this;var E=new r.Number(u);return E.relative=d,this.add("x",E)},y:function(u,d){if(this.target()instanceof r.G)return this.transform({y:u},d),this;var E=new r.Number(u);return E.relative=d,this.add("y",E)},cx:function(u){return this.add("cx",new r.Number(u))},cy:function(u){return this.add("cy",new r.Number(u))},move:function(u,d){return this.x(u).y(d)},center:function(u,d){return this.cx(u).cy(d)},size:function(u,d){if(this.target()instanceof r.Text)this.attr("font-size",u);else{var E;(!u||!d)&&(E=this.target().bbox()),u||(u=E.width/E.height*d),d||(d=E.height/E.width*u),this.add("width",new r.Number(u)).add("height",new r.Number(d))}return this},width:function(u){return this.add("width",new r.Number(u))},height:function(u){return this.add("height",new r.Number(u))},plot:function(u,d,E,y){return arguments.length==4?this.plot([u,d,E,y]):this.add("plot",new(this.target()).morphArray(u))},leading:function(u){return this.target().leading?this.add("leading",new r.Number(u)):this},viewbox:function(u,d,E,y){return this.target()instanceof r.Container&&this.add("viewbox",new r.ViewBox(u,d,E,y)),this},update:function(u){if(this.target()instanceof r.Stop){if(typeof u=="number"||u instanceof r.Number)return this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]});u.opacity!=null&&this.attr("stop-opacity",u.opacity),u.color!=null&&this.attr("stop-color",u.color),u.offset!=null&&this.attr("offset",u.offset)}return this}}),r.Box=r.invent({create:function(u,d,E,y){if(typeof u=="object"&&!(u instanceof r.Element))return r.Box.call(this,u.left!=null?u.left:u.x,u.top!=null?u.top:u.y,u.width,u.height);arguments.length==4&&(this.x=u,this.y=d,this.width=E,this.height=y),Z(this)},extend:{merge:function(u){var d=new this.constructor;return d.x=Math.min(this.x,u.x),d.y=Math.min(this.y,u.y),d.width=Math.max(this.x+this.width,u.x+u.width)-d.x,d.height=Math.max(this.y+this.height,u.y+u.height)-d.y,Z(d)},transform:function(u){var d=1/0,E=-1/0,y=1/0,g=-1/0,C,x=[new r.Point(this.x,this.y),new r.Point(this.x2,this.y),new r.Point(this.x,this.y2),new r.Point(this.x2,this.y2)];return x.forEach(function(R){R=R.transform(u),d=Math.min(d,R.x),E=Math.max(E,R.x),y=Math.min(y,R.y),g=Math.max(g,R.y)}),C=new this.constructor,C.x=d,C.width=E-d,C.y=y,C.height=g-y,Z(C),C}}}),r.BBox=r.invent({create:function(u){if(r.Box.apply(this,[].slice.call(arguments)),u instanceof r.Element){var d;try{if(i.documentElement.contains){if(!i.documentElement.contains(u.node))throw new Exception("Element not in the dom")}else{for(var E=u.node;E.parentNode;)E=E.parentNode;if(E!=i)throw new Exception("Element not in the dom")}d=u.node.getBBox()}catch{if(u instanceof r.Shape){var y=u.clone(r.parser.draw.instance).show();d=y.node.getBBox(),y.remove()}else d={x:u.node.clientLeft,y:u.node.clientTop,width:u.node.clientWidth,height:u.node.clientHeight}}r.Box.call(this,d)}},inherit:r.Box,parent:r.Element,construct:{bbox:function(){return new r.BBox(this)}}}),r.BBox.prototype.constructor=r.BBox,r.extend(r.Element,{tbox:function(){return console.warn("Use of TBox is deprecated and mapped to RBox. Use .rbox() instead."),this.rbox(this.doc())}}),r.RBox=r.invent({create:function(u){r.Box.apply(this,[].slice.call(arguments)),u instanceof r.Element&&r.Box.call(this,u.node.getBoundingClientRect())},inherit:r.Box,parent:r.Element,extend:{addOffset:function(){return this.x+=n.pageXOffset,this.y+=n.pageYOffset,this}},construct:{rbox:function(u){return u?new r.RBox(this).transform(u.screenCTM().inverse()):new r.RBox(this).addOffset()}}}),r.RBox.prototype.constructor=r.RBox,r.Matrix=r.invent({create:function(u){var d,E=T([1,0,0,1,0,0]);for(u=u instanceof r.Element?u.matrixify():typeof u=="string"?T(u.split(r.regex.delimiter).map(parseFloat)):arguments.length==6?T([].slice.call(arguments)):Array.isArray(u)?T(u):typeof u=="object"?u:E,d=G.length-1;d>=0;--d)this[G[d]]=u[G[d]]!=null?u[G[d]]:E[G[d]]},extend:{extract:function(){var u=w(this,0,1),d=w(this,1,0),E=180/Math.PI*Math.atan2(u.y,u.x)-90;return{x:this.e,y:this.f,transformedX:(this.e*Math.cos(E*Math.PI/180)+this.f*Math.sin(E*Math.PI/180))/Math.sqrt(this.a*this.a+this.b*this.b),transformedY:(this.f*Math.cos(E*Math.PI/180)+this.e*Math.sin(-E*Math.PI/180))/Math.sqrt(this.c*this.c+this.d*this.d),skewX:-E,skewY:180/Math.PI*Math.atan2(d.y,d.x),scaleX:Math.sqrt(this.a*this.a+this.b*this.b),scaleY:Math.sqrt(this.c*this.c+this.d*this.d),rotation:E,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f,matrix:new r.Matrix(this)}},clone:function(){return new r.Matrix(this)},morph:function(u){return this.destination=new r.Matrix(u),this},at:function(u){if(!this.destination)return this;var d=new r.Matrix({a:this.a+(this.destination.a-this.a)*u,b:this.b+(this.destination.b-this.b)*u,c:this.c+(this.destination.c-this.c)*u,d:this.d+(this.destination.d-this.d)*u,e:this.e+(this.destination.e-this.e)*u,f:this.f+(this.destination.f-this.f)*u});return d},multiply:function(u){return new r.Matrix(this.native().multiply(N(u).native()))},inverse:function(){return new r.Matrix(this.native().inverse())},translate:function(u,d){return new r.Matrix(this.native().translate(u||0,d||0))},scale:function(u,d,E,y){return arguments.length==1?d=u:arguments.length==3&&(y=E,E=d,d=u),this.around(E,y,new r.Matrix(u,0,0,d,0,0))},rotate:function(u,d,E){return u=r.utils.radians(u),this.around(d,E,new r.Matrix(Math.cos(u),Math.sin(u),-Math.sin(u),Math.cos(u),0,0))},flip:function(u,d){return u=="x"?this.scale(-1,1,d,0):u=="y"?this.scale(1,-1,0,d):this.scale(-1,-1,u,d??u)},skew:function(u,d,E,y){return arguments.length==1?d=u:arguments.length==3&&(y=E,E=d,d=u),u=r.utils.radians(u),d=r.utils.radians(d),this.around(E,y,new r.Matrix(1,Math.tan(d),Math.tan(u),1,0,0))},skewX:function(u,d,E){return this.skew(u,0,d,E)},skewY:function(u,d,E){return this.skew(0,u,d,E)},around:function(u,d,E){return this.multiply(new r.Matrix(1,0,0,1,u||0,d||0)).multiply(E).multiply(new r.Matrix(1,0,0,1,-u||0,-d||0))},native:function(){for(var u=r.parser.native.createSVGMatrix(),d=G.length-1;d>=0;d--)u[G[d]]=this[G[d]];return u},toString:function(){return"matrix("+z(this.a)+","+z(this.b)+","+z(this.c)+","+z(this.d)+","+z(this.e)+","+z(this.f)+")"}},parent:r.Element,construct:{ctm:function(){return new r.Matrix(this.node.getCTM())},screenCTM:function(){if(this instanceof r.Nested){var u=this.rect(1,1),d=u.node.getScreenCTM();return u.remove(),new r.Matrix(d)}return new r.Matrix(this.node.getScreenCTM())}}}),r.Point=r.invent({create:function(u,d){var E,y={x:0,y:0};E=Array.isArray(u)?{x:u[0],y:u[1]}:typeof u=="object"?{x:u.x,y:u.y}:u!=null?{x:u,y:d??u}:y,this.x=E.x,this.y=E.y},extend:{clone:function(){return new r.Point(this)},morph:function(u,d){return this.destination=new r.Point(u,d),this},at:function(u){if(!this.destination)return this;var d=new r.Point({x:this.x+(this.destination.x-this.x)*u,y:this.y+(this.destination.y-this.y)*u});return d},native:function(){var u=r.parser.native.createSVGPoint();return u.x=this.x,u.y=this.y,u},transform:function(u){return new r.Point(this.native().matrixTransform(u.native()))}}}),r.extend(r.Element,{point:function(u,d){return new r.Point(u,d).transform(this.screenCTM().inverse())}}),r.extend(r.Element,{attr:function(u,d,E){if(u==null){for(u={},d=this.node.attributes,E=d.length-1;E>=0;E--)u[d[E].nodeName]=r.regex.isNumber.test(d[E].nodeValue)?parseFloat(d[E].nodeValue):d[E].nodeValue;return u}else if(typeof u=="object")for(d in u)this.attr(d,u[d]);else if(d===null)this.node.removeAttribute(u);else{if(d==null)return d=this.node.getAttribute(u),d==null?r.defaults.attrs[u]:r.regex.isNumber.test(d)?parseFloat(d):d;u=="stroke-width"?this.attr("stroke",parseFloat(d)>0?this._stroke:null):u=="stroke"&&(this._stroke=d),(u=="fill"||u=="stroke")&&(r.regex.isImage.test(d)&&(d=this.doc().defs().image(d,0,0)),d instanceof r.Image&&(d=this.doc().defs().pattern(0,0,function(){this.add(d)}))),typeof d=="number"?d=new r.Number(d):r.Color.isColor(d)?d=new r.Color(d):Array.isArray(d)&&(d=new r.Array(d)),u=="leading"?this.leading&&this.leading(d):typeof E=="string"?this.node.setAttributeNS(E,u,d.toString()):this.node.setAttribute(u,d.toString()),this.rebuild&&(u=="font-size"||u=="x")&&this.rebuild(u,d)}return this}}),r.extend(r.Element,{transform:function(u,d){var E=this,y,g;if(typeof u!="object")return y=new r.Matrix(E).extract(),typeof u=="string"?y[u]:y;if(y=new r.Matrix(E),d=!!d||!!u.relative,u.a!=null)y=d?y.multiply(new r.Matrix(u)):new r.Matrix(u);else if(u.rotation!=null)B(u,E),y=d?y.rotate(u.rotation,u.cx,u.cy):y.rotate(u.rotation-y.extract().rotation,u.cx,u.cy);else if(u.scale!=null||u.scaleX!=null||u.scaleY!=null){if(B(u,E),u.scaleX=u.scale!=null?u.scale:u.scaleX!=null?u.scaleX:1,u.scaleY=u.scale!=null?u.scale:u.scaleY!=null?u.scaleY:1,!d){var C=y.extract();u.scaleX=u.scaleX*1/C.scaleX,u.scaleY=u.scaleY*1/C.scaleY}y=y.scale(u.scaleX,u.scaleY,u.cx,u.cy)}else if(u.skew!=null||u.skewX!=null||u.skewY!=null){if(B(u,E),u.skewX=u.skew!=null?u.skew:u.skewX!=null?u.skewX:0,u.skewY=u.skew!=null?u.skew:u.skewY!=null?u.skewY:0,!d){var C=y.extract();y=y.multiply(new r.Matrix().skew(C.skewX,C.skewY,u.cx,u.cy).inverse())}y=y.skew(u.skewX,u.skewY,u.cx,u.cy)}else u.flip?(u.flip=="x"||u.flip=="y"?u.offset=u.offset==null?E.bbox()["c"+u.flip]:u.offset:u.offset==null?(g=E.bbox(),u.flip=g.cx,u.offset=g.cy):u.flip=u.offset,y=new r.Matrix().flip(u.flip,u.offset)):(u.x!=null||u.y!=null)&&(d?y=y.translate(u.x,u.y):(u.x!=null&&(y.e=u.x),u.y!=null&&(y.f=u.y)));return this.attr("transform",y)}}),r.extend(r.FX,{transform:function(u,d){var E=this.target(),y,g;return typeof u!="object"?(y=new r.Matrix(E).extract(),typeof u=="string"?y[u]:y):(d=!!d||!!u.relative,u.a!=null?y=new r.Matrix(u):u.rotation!=null?(B(u,E),y=new r.Rotate(u.rotation,u.cx,u.cy)):u.scale!=null||u.scaleX!=null||u.scaleY!=null?(B(u,E),u.scaleX=u.scale!=null?u.scale:u.scaleX!=null?u.scaleX:1,u.scaleY=u.scale!=null?u.scale:u.scaleY!=null?u.scaleY:1,y=new r.Scale(u.scaleX,u.scaleY,u.cx,u.cy)):u.skewX!=null||u.skewY!=null?(B(u,E),u.skewX=u.skewX!=null?u.skewX:0,u.skewY=u.skewY!=null?u.skewY:0,y=new r.Skew(u.skewX,u.skewY,u.cx,u.cy)):u.flip?(u.flip=="x"||u.flip=="y"?u.offset=u.offset==null?E.bbox()["c"+u.flip]:u.offset:u.offset==null?(g=E.bbox(),u.flip=g.cx,u.offset=g.cy):u.flip=u.offset,y=new r.Matrix().flip(u.flip,u.offset)):(u.x!=null||u.y!=null)&&(y=new r.Translate(u.x,u.y)),y?(y.relative=d,this.last().transforms.push(y),this._callStart()):this)}}),r.extend(r.Element,{untransform:function(){return this.attr("transform",null)},matrixify:function(){var u=(this.attr("transform")||"").split(r.regex.transforms).slice(0,-1).map(function(d){var E=d.trim().split("(");return[E[0],E[1].split(r.regex.delimiter).map(function(y){return parseFloat(y)})]}).reduce(function(d,E){return E[0]=="matrix"?d.multiply(T(E[1])):d[E[0]].apply(d,E[1])},new r.Matrix);return u},toParent:function(u){if(this==u)return this;var d=this.screenCTM(),E=u.screenCTM().inverse();return this.addTo(u).untransform().transform(E.multiply(d)),this},toDoc:function(){return this.toParent(this.doc())}}),r.Transformation=r.invent({create:function(u,d){if(arguments.length>1&&typeof d!="boolean")return this.constructor.call(this,[].slice.call(arguments));if(Array.isArray(u))for(var E=0,y=this.arguments.length;E<y;++E)this[this.arguments[E]]=u[E];else if(typeof u=="object")for(var E=0,y=this.arguments.length;E<y;++E)this[this.arguments[E]]=u[this.arguments[E]];this.inversed=!1,d===!0&&(this.inversed=!0)},extend:{arguments:[],method:"",at:function(u){for(var d=[],E=0,y=this.arguments.length;E<y;++E)d.push(this[this.arguments[E]]);var g=this._undo||new r.Matrix;return g=new r.Matrix().morph(r.Matrix.prototype[this.method].apply(g,d)).at(u),this.inversed?g.inverse():g},undo:function(u){for(var d=0,E=this.arguments.length;d<E;++d)u[this.arguments[d]]=typeof this[this.arguments[d]]>"u"?0:u[this.arguments[d]];return u.cx=this.cx,u.cy=this.cy,this._undo=new r[b(this.method)](u,!0).at(1),this}}}),r.Translate=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(u,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["transformedX","transformedY"],method:"translate"}}),r.Rotate=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(u,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["rotation","cx","cy"],method:"rotate",at:function(u){var d=new r.Matrix().rotate(new r.Number().morph(this.rotation-(this._undo?this._undo.rotation:0)).at(u),this.cx,this.cy);return this.inversed?d.inverse():d},undo:function(u){return this._undo=u,this}}}),r.Scale=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(u,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["scaleX","scaleY","cx","cy"],method:"scale"}}),r.Skew=r.invent({parent:r.Matrix,inherit:r.Transformation,create:function(u,d){this.constructor.apply(this,[].slice.call(arguments))},extend:{arguments:["skewX","skewY","cx","cy"],method:"skew"}}),r.extend(r.Element,{style:function(u,d){if(arguments.length==0)return this.node.style.cssText||"";if(arguments.length<2)if(typeof u=="object")for(d in u)this.style(d,u[d]);else if(r.regex.isCss.test(u))for(u=u.split(/\s*;\s*/).filter(function(E){return!!E}).map(function(E){return E.split(/\s*:\s*/)});d=u.pop();)this.style(d[0],d[1]);else return this.node.style[_(u)];else this.node.style[_(u)]=d===null||r.regex.isBlank.test(d)?"":d;return this}}),r.Parent=r.invent({create:function(u){this.constructor.call(this,u)},inherit:r.Element,extend:{children:function(){return r.utils.map(r.utils.filterSVGElements(this.node.childNodes),function(u){return r.adopt(u)})},add:function(u,d){return d==null?this.node.appendChild(u.node):u.node!=this.node.childNodes[d]&&this.node.insertBefore(u.node,this.node.childNodes[d]),this},put:function(u,d){return this.add(u,d),u},has:function(u){return this.index(u)>=0},index:function(u){return[].slice.call(this.node.childNodes).indexOf(u.node)},get:function(u){return r.adopt(this.node.childNodes[u])},first:function(){return this.get(0)},last:function(){return this.get(this.node.childNodes.length-1)},each:function(u,d){var E,y,g=this.children();for(E=0,y=g.length;E<y;E++)g[E]instanceof r.Element&&u.apply(g[E],[E,g]),d&&g[E]instanceof r.Container&&g[E].each(u,d);return this},removeElement:function(u){return this.node.removeChild(u.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,this},defs:function(){return this.doc().defs()}}}),r.extend(r.Parent,{ungroup:function(u,d){return d===0||this instanceof r.Defs||this.node==r.parser.draw?this:(u=u||(this instanceof r.Doc?this:this.parent(r.Parent)),d=d||1/0,this.each(function(){return this instanceof r.Defs?this:this instanceof r.Parent?this.ungroup(u,d-1):this.toParent(u)}),this.node.firstChild||this.remove(),this)},flatten:function(u,d){return this.ungroup(u,d)}}),r.Container=r.invent({create:function(u){this.constructor.call(this,u)},inherit:r.Parent}),r.ViewBox=r.invent({create:function(u){var d=[0,0,0,0],E,y,g,C,x,R,D,L=1,X=1,K=/[+-]?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?/gi;if(u instanceof r.Element){for(R=u,D=u,x=(u.attr("viewBox")||"").match(K),u.bbox,g=new r.Number(u.width()),C=new r.Number(u.height());g.unit=="%";)L*=g.value,g=new r.Number(R instanceof r.Doc?R.parent().offsetWidth:R.parent().width()),R=R.parent();for(;C.unit=="%";)X*=C.value,C=new r.Number(D instanceof r.Doc?D.parent().offsetHeight:D.parent().height()),D=D.parent();this.x=0,this.y=0,this.width=g*L,this.height=C*X,this.zoom=1,x&&(E=parseFloat(x[0]),y=parseFloat(x[1]),g=parseFloat(x[2]),C=parseFloat(x[3]),this.zoom=this.width/this.height>g/C?this.height/C:this.width/g,this.x=E,this.y=y,this.width=g,this.height=C)}else u=typeof u=="string"?u.match(K).map(function(W){return parseFloat(W)}):Array.isArray(u)?u:typeof u=="object"?[u.x,u.y,u.width,u.height]:arguments.length==4?[].slice.call(arguments):d,this.x=u[0],this.y=u[1],this.width=u[2],this.height=u[3]},extend:{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height},morph:function(u,d,E,y){return this.destination=new r.ViewBox(u,d,E,y),this},at:function(u){return this.destination?new r.ViewBox([this.x+(this.destination.x-this.x)*u,this.y+(this.destination.y-this.y)*u,this.width+(this.destination.width-this.width)*u,this.height+(this.destination.height-this.height)*u]):this}},parent:r.Container,construct:{viewbox:function(u,d,E,y){return arguments.length==0?new r.ViewBox(this):this.attr("viewBox",new r.ViewBox(u,d,E,y))}}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(u){r.Element.prototype[u]=function(d){return d==null?r.off(this,u):r.on(this,u,d),this}}),r.listenerId=0,r.on=function(u,d,E,y,g){var C=E.bind(y||u),x=u instanceof r.Element?u.node:u;x.instance=x.instance||{_events:{}};var R=x.instance._events;E._svgjsListenerId||(E._svgjsListenerId=++r.listenerId),d.split(r.regex.delimiter).forEach(function(D){var L=D.split(".")[0],X=D.split(".")[1]||"*";R[L]=R[L]||{},R[L][X]=R[L][X]||{},R[L][X][E._svgjsListenerId]=C,x.addEventListener(L,C,g||!1)})},r.off=function(u,d,E,y){var g=u instanceof r.Element?u.node:u;if(g.instance&&!(typeof E=="function"&&(E=E._svgjsListenerId,!E))){var C=g.instance._events;(d||"").split(r.regex.delimiter).forEach(function(x){var R=x&&x.split(".")[0],D=x&&x.split(".")[1],L,X;if(E)C[R]&&C[R][D||"*"]&&(g.removeEventListener(R,C[R][D||"*"][E],y||!1),delete C[R][D||"*"][E]);else if(R&&D){if(C[R]&&C[R][D]){for(X in C[R][D])r.off(g,[R,D].join("."),X);delete C[R][D]}}else if(D)for(x in C)for(L in C[x])D===L&&r.off(g,[x,D].join("."));else if(R){if(C[R]){for(L in C[R])r.off(g,[R,L].join("."));delete C[R]}}else{for(x in C)r.off(g,x);g.instance._events={}}})}},r.extend(r.Element,{on:function(u,d,E,y){return r.on(this,u,d,E,y),this},off:function(u,d){return r.off(this.node,u,d),this},fire:function(u,d){return u instanceof n.Event?this.node.dispatchEvent(u):this.node.dispatchEvent(u=new r.CustomEvent(u,{detail:d,cancelable:!0})),this._event=u,this},event:function(){return this._event}}),r.Defs=r.invent({create:"defs",inherit:r.Container}),r.G=r.invent({create:"g",inherit:r.Container,extend:{x:function(u){return u==null?this.transform("x"):this.transform({x:u-this.x()},!0)},y:function(u){return u==null?this.transform("y"):this.transform({y:u-this.y()},!0)},cx:function(u){return u==null?this.gbox().cx:this.x(u-this.gbox().width/2)},cy:function(u){return u==null?this.gbox().cy:this.y(u-this.gbox().height/2)},gbox:function(){var u=this.bbox(),d=this.transform();return u.x+=d.x,u.x2+=d.x,u.cx+=d.x,u.y+=d.y,u.y2+=d.y,u.cy+=d.y,u}},construct:{group:function(){return this.put(new r.G)}}}),r.Doc=r.invent({create:function(u){u&&(u=typeof u=="string"?i.getElementById(u):u,u.nodeName=="svg"?this.constructor.call(this,u):(this.constructor.call(this,r.create("svg")),u.appendChild(this.node),this.size("100%","100%")),this.namespace().defs())},inherit:r.Container,extend:{namespace:function(){return this.attr({xmlns:r.ns,version:"1.1"}).attr("xmlns:xlink",r.xlink,r.xmlns).attr("xmlns:svgjs",r.svgjs,r.xmlns)},defs:function(){if(!this._defs){var u;(u=this.node.getElementsByTagName("defs")[0])?this._defs=r.adopt(u):this._defs=new r.Defs,this.node.appendChild(this._defs.node)}return this._defs},parent:function(){return!this.node.parentNode||this.node.parentNode.nodeName=="#document"||this.node.parentNode.nodeName=="#document-fragment"?null:this.node.parentNode},spof:function(){var u=this.node.getScreenCTM();return u&&this.style("left",-u.e%1+"px").style("top",-u.f%1+"px"),this},remove:function(){return this.parent()&&this.parent().removeChild(this.node),this},clear:function(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return delete this._defs,r.parser.draw.parentNode||this.node.appendChild(r.parser.draw),this},clone:function(u){this.writeDataToDom();var d=this.node,E=H(d.cloneNode(!0));return u?(u.node||u).appendChild(E.node):d.parentNode.insertBefore(E.node,d.nextSibling),E}}}),r.extend(r.Element,{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var u=this.position()+1,d=this.parent();return d.removeElement(this).add(this,u),d instanceof r.Doc&&d.node.appendChild(d.defs().node),this},backward:function(){var u=this.position();return u>0&&this.parent().removeElement(this).add(this,u-1),this},front:function(){var u=this.parent();return u.node.appendChild(this.node),u instanceof r.Doc&&u.node.appendChild(u.defs().node),this},back:function(){return this.position()>0&&this.parent().removeElement(this).add(this,0),this},before:function(u){u.remove();var d=this.position();return this.parent().add(u,d),this},after:function(u){u.remove();var d=this.position();return this.parent().add(u,d+1),this}}),r.Mask=r.invent({create:function(){this.constructor.call(this,r.create("mask")),this.targets=[]},inherit:r.Container,extend:{remove:function(){for(var u=this.targets.length-1;u>=0;u--)this.targets[u]&&this.targets[u].unmask();return this.targets=[],r.Element.prototype.remove.call(this),this}},construct:{mask:function(){return this.defs().put(new r.Mask)}}}),r.extend(r.Element,{maskWith:function(u){return this.masker=u instanceof r.Mask?u:this.parent().mask().add(u),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),r.ClipPath=r.invent({create:function(){this.constructor.call(this,r.create("clipPath")),this.targets=[]},inherit:r.Container,extend:{remove:function(){for(var u=this.targets.length-1;u>=0;u--)this.targets[u]&&this.targets[u].unclip();return this.targets=[],this.parent().removeElement(this),this}},construct:{clip:function(){return this.defs().put(new r.ClipPath)}}}),r.extend(r.Element,{clipWith:function(u){return this.clipper=u instanceof r.ClipPath?u:this.parent().clip().add(u),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),r.Gradient=r.invent({create:function(u){this.constructor.call(this,r.create(u+"Gradient")),this.type=u},inherit:r.Container,extend:{at:function(u,d,E){return this.put(new r.Stop).update(u,d,E)},update:function(u){return this.clear(),typeof u=="function"&&u.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()},attr:function(u,d,E){return u=="transform"&&(u="gradientTransform"),r.Container.prototype.attr.call(this,u,d,E)}},construct:{gradient:function(u,d){return this.defs().gradient(u,d)}}}),r.extend(r.Gradient,r.FX,{from:function(u,d){return(this._target||this).type=="radial"?this.attr({fx:new r.Number(u),fy:new r.Number(d)}):this.attr({x1:new r.Number(u),y1:new r.Number(d)})},to:function(u,d){return(this._target||this).type=="radial"?this.attr({cx:new r.Number(u),cy:new r.Number(d)}):this.attr({x2:new r.Number(u),y2:new r.Number(d)})}}),r.extend(r.Defs,{gradient:function(u,d){return this.put(new r.Gradient(u)).update(d)}}),r.Stop=r.invent({create:"stop",inherit:r.Element,extend:{update:function(u){return(typeof u=="number"||u instanceof r.Number)&&(u={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),u.opacity!=null&&this.attr("stop-opacity",u.opacity),u.color!=null&&this.attr("stop-color",u.color),u.offset!=null&&this.attr("offset",new r.Number(u.offset)),this}}}),r.Pattern=r.invent({create:"pattern",inherit:r.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(u){return this.clear(),typeof u=="function"&&u.call(this,this),this},toString:function(){return this.fill()},attr:function(u,d,E){return u=="transform"&&(u="patternTransform"),r.Container.prototype.attr.call(this,u,d,E)}},construct:{pattern:function(u,d,E){return this.defs().pattern(u,d,E)}}}),r.extend(r.Defs,{pattern:function(u,d,E){return this.put(new r.Pattern).update(E).attr({x:0,y:0,width:u,height:d,patternUnits:"userSpaceOnUse"})}}),r.Shape=r.invent({create:function(u){this.constructor.call(this,u)},inherit:r.Element}),r.Bare=r.invent({create:function(u,d){if(this.constructor.call(this,r.create(u)),d)for(var E in d.prototype)typeof d.prototype[E]=="function"&&(this[E]=d.prototype[E])},inherit:r.Element,extend:{words:function(u){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this.node.appendChild(i.createTextNode(u)),this}}}),r.extend(r.Parent,{element:function(u,d){return this.put(new r.Bare(u,d))}}),r.Symbol=r.invent({create:"symbol",inherit:r.Container,construct:{symbol:function(){return this.put(new r.Symbol)}}}),r.Use=r.invent({create:"use",inherit:r.Shape,extend:{element:function(u,d){return this.attr("href",(d||"")+"#"+u,r.xlink)}},construct:{use:function(u,d){return this.put(new r.Use).element(u,d)}}}),r.Rect=r.invent({create:"rect",inherit:r.Shape,construct:{rect:function(u,d){return this.put(new r.Rect).size(u,d)}}}),r.Circle=r.invent({create:"circle",inherit:r.Shape,construct:{circle:function(u){return this.put(new r.Circle).rx(new r.Number(u).divide(2)).move(0,0)}}}),r.extend(r.Circle,r.FX,{rx:function(u){return this.attr("r",u)},ry:function(u){return this.rx(u)}}),r.Ellipse=r.invent({create:"ellipse",inherit:r.Shape,construct:{ellipse:function(u,d){return this.put(new r.Ellipse).size(u,d).move(0,0)}}}),r.extend(r.Ellipse,r.Rect,r.FX,{rx:function(u){return this.attr("rx",u)},ry:function(u){return this.attr("ry",u)}}),r.extend(r.Circle,r.Ellipse,{x:function(u){return u==null?this.cx()-this.rx():this.cx(u+this.rx())},y:function(u){return u==null?this.cy()-this.ry():this.cy(u+this.ry())},cx:function(u){return u==null?this.attr("cx"):this.attr("cx",u)},cy:function(u){return u==null?this.attr("cy"):this.attr("cy",u)},width:function(u){return u==null?this.rx()*2:this.rx(new r.Number(u).divide(2))},height:function(u){return u==null?this.ry()*2:this.ry(new r.Number(u).divide(2))},size:function(u,d){var E=S(this,u,d);return this.rx(new r.Number(E.width).divide(2)).ry(new r.Number(E.height).divide(2))}}),r.Line=r.invent({create:"line",inherit:r.Shape,extend:{array:function(){return new r.PointArray([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])},plot:function(u,d,E,y){return u==null?this.array():(typeof d<"u"?u={x1:u,y1:d,x2:E,y2:y}:u=new r.PointArray(u).toLine(),this.attr(u))},move:function(u,d){return this.attr(this.array().move(u,d).toLine())},size:function(u,d){var E=S(this,u,d);return this.attr(this.array().size(E.width,E.height).toLine())}},construct:{line:function(u,d,E,y){return r.Line.prototype.plot.apply(this.put(new r.Line),u!=null?[u,d,E,y]:[0,0,0,0])}}}),r.Polyline=r.invent({create:"polyline",inherit:r.Shape,construct:{polyline:function(u){return this.put(new r.Polyline).plot(u||new r.PointArray)}}}),r.Polygon=r.invent({create:"polygon",inherit:r.Shape,construct:{polygon:function(u){return this.put(new r.Polygon).plot(u||new r.PointArray)}}}),r.extend(r.Polyline,r.Polygon,{array:function(){return this._array||(this._array=new r.PointArray(this.attr("points")))},plot:function(u){return u==null?this.array():this.clear().attr("points",typeof u=="string"?u:this._array=new r.PointArray(u))},clear:function(){return delete this._array,this},move:function(u,d){return this.attr("points",this.array().move(u,d))},size:function(u,d){var E=S(this,u,d);return this.attr("points",this.array().size(E.width,E.height))}}),r.extend(r.Line,r.Polyline,r.Polygon,{morphArray:r.PointArray,x:function(u){return u==null?this.bbox().x:this.move(u,this.bbox().y)},y:function(u){return u==null?this.bbox().y:this.move(this.bbox().x,u)},width:function(u){var d=this.bbox();return u==null?d.width:this.size(u,d.height)},height:function(u){var d=this.bbox();return u==null?d.height:this.size(d.width,u)}}),r.Path=r.invent({create:"path",inherit:r.Shape,extend:{morphArray:r.PathArray,array:function(){return this._array||(this._array=new r.PathArray(this.attr("d")))},plot:function(u){return u==null?this.array():this.clear().attr("d",typeof u=="string"?u:this._array=new r.PathArray(u))},clear:function(){return delete this._array,this},move:function(u,d){return this.attr("d",this.array().move(u,d))},x:function(u){return u==null?this.bbox().x:this.move(u,this.bbox().y)},y:function(u){return u==null?this.bbox().y:this.move(this.bbox().x,u)},size:function(u,d){var E=S(this,u,d);return this.attr("d",this.array().size(E.width,E.height))},width:function(u){return u==null?this.bbox().width:this.size(u,this.bbox().height)},height:function(u){return u==null?this.bbox().height:this.size(this.bbox().width,u)}},construct:{path:function(u){return this.put(new r.Path).plot(u||new r.PathArray)}}}),r.Image=r.invent({create:"image",inherit:r.Shape,extend:{load:function(u){if(!u)return this;var d=this,E=new n.Image;return r.on(E,"load",function(){r.off(E);var y=d.parent(r.Pattern);y!==null&&(d.width()==0&&d.height()==0&&d.size(E.width,E.height),y&&y.width()==0&&y.height()==0&&y.size(d.width(),d.height()),typeof d._loaded=="function"&&d._loaded.call(d,{width:E.width,height:E.height,ratio:E.width/E.height,url:u}))}),r.on(E,"error",function(y){r.off(E),typeof d._error=="function"&&d._error.call(d,y)}),this.attr("href",E.src=this.src=u,r.xlink)},loaded:function(u){return this._loaded=u,this},error:function(u){return this._error=u,this}},construct:{image:function(u,d,E){return this.put(new r.Image).load(u).size(d||0,E||d||0)}}}),r.Text=r.invent({create:function(){this.constructor.call(this,r.create("text")),this.dom.leading=new r.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",r.defaults.attrs["font-family"])},inherit:r.Shape,extend:{x:function(u){return u==null?this.attr("x"):this.attr("x",u)},y:function(u){var d=this.attr("y"),E=typeof d=="number"?d-this.bbox().y:0;return u==null?typeof d=="number"?d-E:d:this.attr("y",typeof u.valueOf()=="number"?u+E:u)},cx:function(u){return u==null?this.bbox().cx:this.x(u-this.bbox().width/2)},cy:function(u){return u==null?this.bbox().cy:this.y(u-this.bbox().height/2)},text:function(u){if(typeof u>"u"){for(var u="",d=this.node.childNodes,E=0,y=d.length;E<y;++E)E!=0&&d[E].nodeType!=3&&r.adopt(d[E]).dom.newLined==!0&&(u+=`
`),u+=d[E].textContent;return u}if(this.clear().build(!0),typeof u=="function")u.call(this,this);else{u=u.split(`
`);for(var E=0,g=u.length;E<g;E++)this.tspan(u[E]).newLine()}return this.build(!1).rebuild()},size:function(u){return this.attr("font-size",u).rebuild()},leading:function(u){return u==null?this.dom.leading:(this.dom.leading=new r.Number(u),this.rebuild())},lines:function(){var u=(this.textPath&&this.textPath()||this).node,d=r.utils.map(r.utils.filterSVGElements(u.childNodes),function(E){return r.adopt(E)});return new r.Set(d)},rebuild:function(u){if(typeof u=="boolean"&&(this._rebuild=u),this._rebuild){var d=this,E=0,y=this.dom.leading*new r.Number(this.attr("font-size"));this.lines().each(function(){this.dom.newLined&&(d.textPath()||this.attr("x",d.attr("x")),this.text()==`
`?E+=y:(this.attr("dy",y+E),E=0))}),this.fire("rebuild")}return this},build:function(u){return this._build=!!u,this},setData:function(u){return this.dom=u,this.dom.leading=new r.Number(u.leading||1.3),this}},construct:{text:function(u){return this.put(new r.Text).text(u)},plain:function(u){return this.put(new r.Text).plain(u)}}}),r.Tspan=r.invent({create:"tspan",inherit:r.Shape,extend:{text:function(u){return u==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof u=="function"?u.call(this,this):this.plain(u),this)},dx:function(u){return this.attr("dx",u)},dy:function(u){return this.attr("dy",u)},newLine:function(){var u=this.parent(r.Text);return this.dom.newLined=!0,this.dy(u.dom.leading*u.attr("font-size")).attr("x",u.x())}}}),r.extend(r.Text,r.Tspan,{plain:function(u){return this._build===!1&&this.clear(),this.node.appendChild(i.createTextNode(u)),this},tspan:function(u){var d=(this.textPath&&this.textPath()||this).node,E=new r.Tspan;return this._build===!1&&this.clear(),d.appendChild(E.node),E.text(u)},clear:function(){for(var u=(this.textPath&&this.textPath()||this).node;u.hasChildNodes();)u.removeChild(u.lastChild);return this},length:function(){return this.node.getComputedTextLength()}}),r.TextPath=r.invent({create:"textPath",inherit:r.Parent,parent:r.Text,construct:{morphArray:r.PathArray,path:function(u){for(var d=new r.TextPath,E=this.doc().defs().path(u);this.node.hasChildNodes();)d.node.appendChild(this.node.firstChild);return this.node.appendChild(d.node),d.attr("href","#"+E,r.xlink),this},array:function(){var u=this.track();return u?u.array():null},plot:function(u){var d=this.track(),E=null;return d&&(E=d.plot(u)),u==null?E:this},track:function(){var u=this.textPath();if(u)return u.reference("href")},textPath:function(){if(this.node.firstChild&&this.node.firstChild.nodeName=="textPath")return r.adopt(this.node.firstChild)}}}),r.Nested=r.invent({create:function(){this.constructor.call(this,r.create("svg")),this.style("overflow","visible")},inherit:r.Container,construct:{nested:function(){return this.put(new r.Nested)}}}),r.A=r.invent({create:"a",inherit:r.Container,extend:{to:function(u){return this.attr("href",u,r.xlink)},show:function(u){return this.attr("show",u,r.xlink)},target:function(u){return this.attr("target",u)}},construct:{link:function(u){return this.put(new r.A).to(u)}}}),r.extend(r.Element,{linkTo:function(u){var d=new r.A;return typeof u=="function"?u.call(d,d):d.to(u),this.parent().put(d).put(this)}}),r.Marker=r.invent({create:"marker",inherit:r.Container,extend:{width:function(u){return this.attr("markerWidth",u)},height:function(u){return this.attr("markerHeight",u)},ref:function(u,d){return this.attr("refX",u).attr("refY",d)},update:function(u){return this.clear(),typeof u=="function"&&u.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(u,d,E){return this.defs().marker(u,d,E)}}}),r.extend(r.Defs,{marker:function(u,d,E){return this.put(new r.Marker).size(u,d).ref(u/2,d/2).viewbox(0,0,u,d).attr("orient","auto").update(E)}}),r.extend(r.Line,r.Polyline,r.Polygon,r.Path,{marker:function(u,d,E,y){var g=["marker"];return u!="all"&&g.push(u),g=g.join("-"),u=arguments[1]instanceof r.Marker?arguments[1]:this.doc().marker(d,E,y),this.attr(g,u)}});var p={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(u,d){return d=="color"?u:u+"-"+d}};["fill","stroke"].forEach(function(u){var d,E={};E[u]=function(y){if(typeof y>"u")return this;if(typeof y=="string"||r.Color.isRgb(y)||y&&typeof y.fill=="function")this.attr(u,y);else for(d=p[u].length-1;d>=0;d--)y[p[u][d]]!=null&&this.attr(p.prefix(u,p[u][d]),y[p[u][d]]);return this},r.extend(r.Element,r.FX,E)}),r.extend(r.Element,r.FX,{rotate:function(u,d,E){return this.transform({rotation:u,cx:d,cy:E})},skew:function(u,d,E,y){return arguments.length==1||arguments.length==3?this.transform({skew:u,cx:d,cy:E}):this.transform({skewX:u,skewY:d,cx:E,cy:y})},scale:function(u,d,E,y){return arguments.length==1||arguments.length==3?this.transform({scale:u,cx:d,cy:E}):this.transform({scaleX:u,scaleY:d,cx:E,cy:y})},translate:function(u,d){return this.transform({x:u,y:d})},flip:function(u,d){return d=typeof u=="number"?u:d,this.transform({flip:u||"both",offset:d})},matrix:function(u){return this.attr("transform",new r.Matrix(arguments.length==6?[].slice.call(arguments):u))},opacity:function(u){return this.attr("opacity",u)},dx:function(u){return this.x(new r.Number(u).plus(this instanceof r.FX?0:this.x()),!0)},dy:function(u){return this.y(new r.Number(u).plus(this instanceof r.FX?0:this.y()),!0)},dmove:function(u,d){return this.dx(u).dy(d)}}),r.extend(r.Rect,r.Ellipse,r.Circle,r.Gradient,r.FX,{radius:function(u,d){var E=(this._target||this).type;return E=="radial"||E=="circle"?this.attr("r",new r.Number(u)):this.rx(u).ry(d??u)}}),r.extend(r.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(u){return this.node.getPointAtLength(u)}}),r.extend(r.Parent,r.Text,r.Tspan,r.FX,{font:function(u,d){if(typeof u=="object")for(d in u)this.font(d,u[d]);return u=="leading"?this.leading(d):u=="anchor"?this.attr("text-anchor",d):u=="size"||u=="family"||u=="weight"||u=="stretch"||u=="variant"||u=="style"?this.attr("font-"+u,d):this.attr(u,d)}}),r.Set=r.invent({create:function(u){u instanceof r.Set?this.members=u.members.slice():Array.isArray(u)?this.members=u:this.clear()},extend:{add:function(){var u,d,E=[].slice.call(arguments);for(u=0,d=E.length;u<d;u++)this.members.push(E[u]);return this},remove:function(u){var d=this.index(u);return d>-1&&this.members.splice(d,1),this},each:function(u){for(var d=0,E=this.members.length;d<E;d++)u.apply(this.members[d],[d,this.members]);return this},clear:function(){return this.members=[],this},length:function(){return this.members.length},has:function(u){return this.index(u)>=0},index:function(u){return this.members.indexOf(u)},get:function(u){return this.members[u]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){if(this.members.length==0)return new r.RBox;var u=this.members[0].rbox(this.members[0].doc());return this.each(function(){u=u.merge(this.rbox(this.doc()))}),u}},construct:{set:function(u){return new r.Set(u)}}}),r.FX.Set=r.invent({create:function(u){this.set=u}}),r.Set.inherit=function(){var u,d=[];for(var u in r.Shape.prototype)typeof r.Shape.prototype[u]=="function"&&typeof r.Set.prototype[u]!="function"&&d.push(u);d.forEach(function(E){r.Set.prototype[E]=function(){for(var y=0,g=this.members.length;y<g;y++)this.members[y]&&typeof this.members[y][E]=="function"&&this.members[y][E].apply(this.members[y],arguments);return E=="animate"?this.fx||(this.fx=new r.FX.Set(this)):this}}),d=[];for(var u in r.FX.prototype)typeof r.FX.prototype[u]=="function"&&typeof r.FX.Set.prototype[u]!="function"&&d.push(u);d.forEach(function(E){r.FX.Set.prototype[E]=function(){for(var y=0,g=this.set.members.length;y<g;y++)this.set.members[y].fx[E].apply(this.set.members[y].fx,arguments);return this}})},r.extend(r.Element,{data:function(u,d,E){if(typeof u=="object")for(d in u)this.data(d,u[d]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+u))}catch{return this.attr("data-"+u)}else this.attr("data-"+u,d===null?null:E===!0||typeof d=="string"||typeof d=="number"?d:JSON.stringify(d));return this}}),r.extend(r.Element,{remember:function(u,d){if(typeof arguments[0]=="object")for(var d in u)this.remember(d,u[d]);else{if(arguments.length==1)return this.memory()[u];this.memory()[u]=d}return this},forget:function(){if(arguments.length==0)this._memory={};else for(var u=arguments.length-1;u>=0;u--)delete this.memory()[arguments[u]];return this},memory:function(){return this._memory||(this._memory={})}}),r.get=function(u){var d=i.getElementById(Y(u)||u);return r.adopt(d)},r.select=function(u,d){return new r.Set(r.utils.map((d||i).querySelectorAll(u),function(E){return r.adopt(E)}))},r.extend(r.Parent,{select:function(u){return r.select(u,this.node)}});function f(u,d,E,y){return E+y.replace(r.regex.dots," .")}function h(u){for(var d=u.slice(0),E=d.length;E--;)Array.isArray(d[E])&&(d[E]=h(d[E]));return d}function v(u,d){return u instanceof d}function m(u,d){return(u.matches||u.matchesSelector||u.msMatchesSelector||u.mozMatchesSelector||u.webkitMatchesSelector||u.oMatchesSelector).call(u,d)}function _(u){return u.toLowerCase().replace(/-(.)/g,function(d,E){return E.toUpperCase()})}function b(u){return u.charAt(0).toUpperCase()+u.slice(1)}function M(u){return u.length==4?["#",u.substring(1,2),u.substring(1,2),u.substring(2,3),u.substring(2,3),u.substring(3,4),u.substring(3,4)].join(""):u}function P(u){var d=u.toString(16);return d.length==1?"0"+d:d}function S(u,d,E){if(d==null||E==null){var y=u.bbox();d==null?d=y.width/y.height*E:E==null&&(E=y.height/y.width*d)}return{width:d,height:E}}function w(u,d,E){return{x:d*u.a+E*u.c+0,y:d*u.b+E*u.d+0}}function T(u){return{a:u[0],b:u[1],c:u[2],d:u[3],e:u[4],f:u[5]}}function N(u){return u instanceof r.Matrix||(u=new r.Matrix(u)),u}function B(u,d){u.cx=u.cx==null?d.bbox().cx:u.cx,u.cy=u.cy==null?d.bbox().cy:u.cy}function $(u){for(var d=0,E=u.length,y="";d<E;d++)y+=u[d][0],u[d][1]!=null&&(y+=u[d][1],u[d][2]!=null&&(y+=" ",y+=u[d][2],u[d][3]!=null&&(y+=" ",y+=u[d][3],y+=" ",y+=u[d][4],u[d][5]!=null&&(y+=" ",y+=u[d][5],y+=" ",y+=u[d][6],u[d][7]!=null&&(y+=" ",y+=u[d][7])))));return y+" "}function H(u){for(var d=u.childNodes.length-1;d>=0;d--)u.childNodes[d]instanceof n.SVGElement&&H(u.childNodes[d]);return r.adopt(u).id(r.eid(u.nodeName))}function Z(u){return u.x==null&&(u.x=0,u.y=0,u.width=0,u.height=0),u.w=u.width,u.h=u.height,u.x2=u.x+u.width,u.y2=u.y+u.height,u.cx=u.x+u.width/2,u.cy=u.y+u.height/2,u}function Y(u){var d=(u||"").toString().match(r.regex.reference);if(d)return d[1]}function z(u){return Math.abs(u)>1e-37?u:0}var G="abcdef".split("");if(typeof n.CustomEvent!="function"){var se=function(u,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var E=i.createEvent("CustomEvent");return E.initCustomEvent(u,d.bubbles,d.cancelable,d.detail),E};se.prototype=n.Event.prototype,r.CustomEvent=se}else r.CustomEvent=n.CustomEvent;return function(u){for(var d=0,E=["moz","webkit"],y=0;y<E.length&&!n.requestAnimationFrame;++y)u.requestAnimationFrame=u[E[y]+"RequestAnimationFrame"],u.cancelAnimationFrame=u[E[y]+"CancelAnimationFrame"]||u[E[y]+"CancelRequestAnimationFrame"];u.requestAnimationFrame=u.requestAnimationFrame||function(g){var C=new Date().getTime(),x=Math.max(0,16-(C-d)),R=u.setTimeout(function(){g(C+x)},x);return d=C+x,R},u.cancelAnimationFrame=u.cancelAnimationFrame||u.clearTimeout}(n),r})}(ts)),ts.exports}var Fo={exports:{}},Gm;function eN(){return Gm||(Gm=1,function(e,t){function n(i,a){return a.querySelector(i)}t=e.exports=function(i,a){return a=a||document,n(i,a)},t.all=function(i,a){return a=a||document,a.querySelectorAll(i)},t.engine=function(i){if(!i.one)throw new Error(".one callback required");if(!i.all)throw new Error(".all callback required");return n=i.one,t.all=i.all,t}}(Fo,Fo.exports)),Fo.exports}var Kl,zm;function Wa(){return zm||(zm=1,Kl=eN()),Kl}var Xl,Um;function ze(){if(Um)return Xl;Um=1;var e="tokenSimulation";return Xl={TOGGLE_MODE_EVENT:e+".toggleMode",GENERATE_TOKEN_EVENT:e+".generateToken",CONSUME_TOKEN_EVENT:e+".consumeToken",PLAY_SIMULATION_EVENT:e+".playSimulation",PAUSE_SIMULATION_EVENT:e+".pauseSimulation",RESET_SIMULATION_EVENT:e+".resetSimulation",TERMINATE_EVENT:e+".terminateEvent",UPDATE_ELEMENTS_EVENT:e+".updateElements",UPDATE_ELEMENT_EVENT:e+".updateElement",PROCESS_INSTANCE_CREATED_EVENT:e+".processInstanceCreated",PROCESS_INSTANCE_FINISHED_EVENT:e+".processInstanceFinished",PROCESS_INSTANCE_SHOWN_EVENT:e+".processInstanceShown",PROCESS_INSTANCE_HIDDEN_EVENT:e+".processInstanceHidden",ANIMATION_CREATED_EVENT:e+".animationCreated"},Xl}var ai={};const qm=ix(Cx);var Wm;function ct(){if(Wm)return ai;Wm=1;var e=qm.every,t=qm.some;ai.is=function(i,a){if(i.type!=="label"){Array.isArray(a)||(a=[a]);var r=!1;return a.forEach(function(o){o===i.type&&(r=!0)}),r}},ai.isTypedEvent=function(i,a,r){function o(s,l){return e(l,function(c,p){return s[p]==c})}return t(i.eventDefinitions,function(s){return s.$type===a&&o(i,r)})},ai.getBusinessObject=function(i){return i&&i.businessObject||i};function n(i,a){for(var r=a.parent;r;){if(r===i)return!0;r=r.parent}return!1}return ai.isAncestor=n,ai.getDescendants=function(i,a){return i.filter(function(r){return n(a,r)})},ai.supportedElements=["bpmn:Association","bpmn:BoundaryEvent","bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:DataInputAssociation","bpmn:DataObjectReference","bpmn:DataOutputAssociation","bpmn:DataStoreReference","bpmn:EndEvent","bpmn:EventBasedGateway","bpmn:ExclusiveGateway","bpmn:IntermediateCatchEvent","bpmn:ManualTask","bpmn:ParallelGateway","bpmn:Process","bpmn:ScriptTask","bpmn:SequenceFlow","bpmn:ServiceTask","bpmn:StartEvent","bpmn:SubProcess","bpmn:Task","bpmn:TextAnnotation","bpmn:UserTask"],ai}var jo={},Ym;function tN(){return Ym||(Ym=1,jo.getMid=function(e){var t=e.bbox();return{x:t.x+t.width/2,y:t.y+t.height/2}},jo.distance=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}),jo}var Zl,Km;function nN(){if(Km)return Zl;Km=1;var e=QI(),t=Wa(),n=ze(),i=n.RESET_SIMULATION_EVENT,a=n.PLAY_SIMULATION_EVENT,r=n.PAUSE_SIMULATION_EVENT,o=n.TERMINATE_EVENT,s=n.PROCESS_INSTANCE_FINISHED_EVENT,l=n.ANIMATION_CREATED_EVENT,c=ct().isAncestor,p=tN(),f=p.distance,h=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-green-base-44");function v(N){return N===1}function m(N){return N.length==2}var _=0,b="-",M="<",P="<>",S=20;function w(N,B){var $=window.animation=this;this._eventBus=B,this.animations=[],this.hiddenAnimations=[],this.animationSpeed=1,B.on("import.done",function(){var H=e(N._svg),Z=t(".viewport",N._svg),Y=e.adopt(Z);$.group=H.group().attr("id","token-simulation"),Y.put($.group)}),B.on(o,function(H){var Z=H.element,Y=Z.parent;$.animations.forEach(function(z){c(Y,z.element)&&(z.animation.stop(),$.animations=$.animations.filter(function(G){return G!==z}))})}),B.on(s,function(H){var Z=H.parent;$.animations.forEach(function(Y){(H.processInstanceId===Y.processInstanceId||c(Z,Y.element))&&(Y.animation.stop(),$.animations=$.animations.filter(function(z){return z!==Y}))})}),B.on(i,function(){$.animations.forEach(function(H){H.animation.stop()}),$.animations=[],$.hiddenAnimations=[]}),B.on(r,function(){$.animations.forEach(function(H){H.animation.pause()})}),B.on(a,function(){$.animations.forEach(function(H){H.animation.play()})})}w.prototype.createAnimation=function(N,B,$){var H=this;if(this.group){var Z=this._createTokenGfx(B),Y;return Y=new T(Z,N.waypoints,function(){H.animations=H.animations.filter(function(z){return z.animation!==Y}),$&&$()}),this.hiddenAnimations.includes(B)&&Z.hide(),Z.fx._speed=this.animationSpeed,this.animations.push({tokenGfx:Z,animation:Y,element:N,processInstanceId:B}),this._eventBus.fire(l,{tokenGfx:Z,animation:Y,element:N,processInstanceId:B}),Y}},w.prototype.setAnimationSpeed=function(N){this.animations.forEach(function(B){B.tokenGfx.fx._speed=N}),this.animationSpeed=N},w.prototype._createTokenGfx=function(N){var B=this.group.group().attr("class","token").hide();return B.circle(S,S).attr("fill",h).attr("class","circle"),B.text(N.toString()).attr("transform","translate(10, -7)").attr("text-anchor","middle").attr("class","text"),B},w.prototype.showProcessInstanceAnimations=function(N){this.animations.forEach(function(B){B.processInstanceId===N&&B.tokenGfx.show()}),this.hiddenAnimations=this.hiddenAnimations.filter(function(B){return B!==N})},w.prototype.hideProcessInstanceAnimations=function(N){this.animations.forEach(function(B){B.processInstanceId===N&&B.tokenGfx.hide()}),this.hiddenAnimations.push(N)},w.$inject=["canvas","eventBus"],Zl=w;function T(N,B,$){this.gfx=this.fx=N,this.waypoints=B,this.done=$,this.create()}return T.prototype.create=function(){var N=this.gfx,B=this.waypoints,$=this.done,H=this.fx;N.show().move(B[0].x-S/2,B[0].y-S/2),B.forEach(function(Z,Y){if(Y>0){var z=Z.x-S/2,G=Z.y-S/2,se=v(Y)?M:b;m(B)&&(se=P);var u=f(B[Y-1],Z)*20;H=H.animate(u,se,_).move(z,G)}}),H.after(function(){N.remove(),$()})},T.prototype.play=function(){this.gfx.play()},T.prototype.pause=function(){this.gfx.pause()},T.prototype.stop=function(){this.fx.stop(),this.gfx.remove()},Zl}var Jl,Xm;function iN(){if(Xm)return Jl;Xm=1,Jl=i;var e=!1,t;typeof document<"u"&&(t=document.createElement("div"),t.innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',e=!t.getElementsByTagName("link").length,t=void 0);var n={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:e?[1,"X<div>","</div>"]:[0,"",""]};n.td=n.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],n.option=n.optgroup=[1,'<select multiple="multiple">',"</select>"],n.thead=n.tbody=n.colgroup=n.caption=n.tfoot=[1,"<table>","</table>"],n.polyline=n.ellipse=n.polygon=n.circle=n.text=n.line=n.path=n.rect=n.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];function i(a,r){if(typeof a!="string")throw new TypeError("String expected");r||(r=document);var o=/<([\w:]+)/.exec(a);if(!o)return r.createTextNode(a);a=a.replace(/^\s+|\s+$/g,"");var s=o[1];if(s=="body"){var h=r.createElement("html");return h.innerHTML=a,h.removeChild(h.lastChild)}var l=Object.prototype.hasOwnProperty.call(n,s)?n[s]:n._default,c=l[0],p=l[1],f=l[2],h=r.createElement("div");for(h.innerHTML=p+a+f;c--;)h=h.lastChild;if(h.firstChild==h.lastChild)return h.removeChild(h.firstChild);for(var v=r.createDocumentFragment();h.firstChild;)v.appendChild(h.removeChild(h.firstChild));return v}return Jl}var Ql,Zm;function kt(){return Zm||(Zm=1,Ql=iN()),Ql}var Ho={},Jm;function rN(){if(Jm)return Ho;Jm=1;var e=window.addEventListener?"addEventListener":"attachEvent",t=window.removeEventListener?"removeEventListener":"detachEvent",n=e!=="addEventListener"?"on":"";return Ho.bind=function(i,a,r,o){return i[e](n+a,r,o||!1),r},Ho.unbind=function(i,a,r,o){return i[t](n+a,r,o||!1),r},Ho}var eu,Qm;function _n(){return Qm||(Qm=1,eu=rN()),eu}var tu,ev;function aN(){if(ev)return tu;ev=1;var e=kt(),t=_n(),n=ct().is,i=ze(),a=i.GENERATE_TOKEN_EVENT,r=i.UPDATE_ELEMENT_EVENT;function o(s,l,c){this._eventBus=s,this._processInstances=l,this._processInstanceSettings=c}return o.prototype.createContextPads=function(s){if(s.attachers.length&&this._processInstances.getProcessInstances(s).length){var l=s.incoming.filter(function(f){return n(f,"bpmn:SequenceFlow")}),c=this,p=[];return s.attachers.forEach(function(f){var h=f.outgoing.filter(function(m){return n(m,"bpmn:SequenceFlow")});if(!(!l.length||!h.length)){var v=e('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>');p.push({element:f,html:v}),t.bind(v,"click",function(){c._processInstances.getProcessInstances(s).forEach(function(m){var _=m.parentProcessInstanceId;f.businessObject.cancelActivity&&(s.children.forEach(function(b){b.tokenCount&&b.tokenCount[m.processInstanceId]&&b.tokenCount[m.processInstanceId]--}),c._processInstances.finish(m.processInstanceId),c._eventBus.fire(r,{element:s})),c._eventBus.fire(a,{element:f,processInstanceId:_})})})}}),p}},o.$inject=["eventBus","processInstances","processInstanceSettings"],tu=o,tu}var nu,tv;function oN(){if(tv)return nu;tv=1;var e=ct().is,t=kt(),n=_n();function i(a){this._exclusiveGatewaySettings=a}return i.prototype.createContextPads=function(a){var r=this,o=a.outgoing.filter(function(l){return e(l,"bpmn:SequenceFlow")});if(!(o.length<2)){var s=t('<div class="context-pad" title="Set Sequence Flow"><i class="fa fa-code-fork"></i></div>');return n.bind(s,"click",function(){r._exclusiveGatewaySettings.setSequenceFlow(a)}),[{element:a,html:s}]}},i.$inject=["exclusiveGatewaySettings"],nu=i,nu}var iu,nv;function sN(){if(nv)return iu;nv=1;var e=kt(),t=_n(),n=ct().is,i=ze(),a=i.GENERATE_TOKEN_EVENT;function r(o){this._eventBus=o}return r.prototype.createContextPads=function(o){var s=o.parent.shownProcessInstance,l=o.incoming.filter(function(v){return n(v,"bpmn:SequenceFlow")}),c=[];l.forEach(function(v){var m=v.source;n(m,"bpmn:EventBasedGateway")&&m.tokenCount&&m.tokenCount[s]&&c.push(m)});var p=o.outgoing.filter(function(v){return n(v,"bpmn:SequenceFlow")});if(!(!l.length||!p.length)){var f=this,h;if(o.tokenCount&&o.tokenCount[s])h=e('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>'),t.bind(h,"click",function(){o.tokenCount[s]--,f._eventBus.fire(a,{element:o,processInstanceId:s})});else if(c.length)h=e('<div class="context-pad" title="Trigger Event"><i class="fa fa-play"></i></div>'),t.bind(h,"click",function(){c.forEach(function(v){v.tokenCount[s]--}),f._eventBus.fire(a,{element:o,processInstanceId:s})});else return;return[{element:o,html:h}]}},r.$inject=["eventBus"],iu=r,iu}var ru,iv;function lN(){if(iv)return ru;iv=1;var e=kt(),t=_n();function n(i,a){this._processInstances=i,this._processInstanceSettings=a}return n.prototype.createContextPads=function(i){var a=this,r=this._processInstances.getProcessInstances(i).filter(function(s){return!s.isFinished});if(!(r.length<2)){var o=e('<div class="context-pad" title="View Process Instances"><i class="fa fa-list-ol"></i></div>');return t.bind(o,"click",function(){a._processInstanceSettings.showNext(i)}),[{element:i,html:o}]}},n.$inject=["processInstances","processInstanceSettings"],ru=n,ru}var au,rv;function uN(){if(rv)return au;rv=1;var e=kt(),t=_n(),n=ct().is,i=ze(),a=i.GENERATE_TOKEN_EVENT;function r(o,s,l){this._eventBus=o,this._elementRegistry=s,this._animation=l}return r.prototype.createContextPads=function(o){var s=!1;if(this._elementRegistry.forEach(function(p){p.tokenCount&&Object.values(p.tokenCount).forEach(function(f){f&&(s=!0)})}),!(n(o.parent,"bpmn:SubProcess")||s||this._animation.animations.length)){var l=this,c=e('<div class="context-pad"><i class="fa fa-play"></i></div>');return t.bind(c,"click",function(){l._eventBus.fire(a,{element:o})}),[{element:o,html:c}]}},r.$inject=["eventBus","elementRegistry","animation"],au=r,au}var ou,av;function cN(){if(av)return ou;av=1;var e=ct(),t=e.isAncestor,n=ze(),i=n.TOGGLE_MODE_EVENT,a=n.RESET_SIMULATION_EVENT,r=n.TERMINATE_EVENT,o=n.UPDATE_ELEMENTS_EVENT,s=n.UPDATE_ELEMENT_EVENT,l=n.PROCESS_INSTANCE_SHOWN_EVENT,c=aN(),p=oN(),f=sN(),h=lN(),v=uN(),m=500,_=-15,b=-15;function M(P,S,w,T,N,B){var $=this;this._elementRegistry=S,this._overlays=w,this._injector=T,this._canvas=N,this._processInstances=B,this.overlayIds={},this.handlers={},this.registerHandler("bpmn:ExclusiveGateway",p),this.registerHandler("bpmn:IntermediateCatchEvent",f),this.registerHandler("bpmn:SubProcess",h),this.registerHandler("bpmn:SubProcess",c),this.registerHandler("bpmn:StartEvent",v),P.on(i,m,function(H){var Z=H.simulationModeActive;Z?$.openContextPads():$.closeContextPads()}),P.on(a,m,function(){$.closeContextPads(),$.openContextPads()}),P.on(r,m,function(H){var Z=H.element,Y=Z.parent;$.closeContextPads(Y)}),P.on(o,m,function(H){var Z=H.elements;Z.forEach(function(Y){$.closeElementContextPads(Y),$.openElementContextPads(Y)})}),P.on(s,m,function(H){var Z=H.element;$.closeElementContextPads(Z),$.openElementContextPads(Z)}),P.on(l,function(H){var Z=H.processInstanceId,Y=B.getProcessInstance(Z),z=Y.parent;$.closeContextPads(z),$.openContextPads(z)})}return M.prototype.registerHandler=function(P,S){var w=this._injector.instantiate(S);this.handlers[P]||(this.handlers[P]=[]),this.handlers[P].push(w)},M.prototype.openContextPads=function(P){var S=this;P||(P=this._canvas.getRootElement()),this._elementRegistry.forEach(function(w){S.handlers[w.type]&&t(P,w)&&S.openElementContextPads(w)})},M.prototype.openElementContextPads=function(P){if(this.handlers[P.type]){var S=[];this.handlers[P.type].forEach(function(T){var N=T.createContextPads(P);N&&N.forEach(function(B){B&&S.push(B)})});var w=this;S.forEach(function(T){var N={top:_,left:b},B=w._overlays.add(T.element,"context-menu",{position:N,html:T.html,show:{minZoom:.5}});w.overlayIds[T.element.id]=B})}},M.prototype.closeContextPads=function(P){var S=this;P||(P=this._canvas.getRootElement()),this._elementRegistry.forEach(function(w){t(P,w)&&S.closeElementContextPads(w)})},M.prototype.closeElementContextPads=function(P){var S=this;P.attachers&&P.attachers.length>0&&P.attachers.forEach(function(T){S.closeElementContextPads(T)}),P.children&&P.children.length>0&&P.children.forEach(function(T){S.closeElementContextPads(T)});var w=this.overlayIds[P.id];w&&(this._overlays.remove(w),delete this.overlayIds[P.id])},M.$inject=["eventBus","elementRegistry","overlays","injector","canvas","processInstances"],ou=M,ou}var su,ov;function pN(){return ov||(ov=1,su=cN()),su}var lu,sv;function fN(){if(sv)return lu;sv=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=10001;function i(r,o,s,l,c,p,f,h){var v=this;this._eventBus=r,this.modelingDisabled=!1,r.on(t,n,function(M){var P=M.simulationModeActive;v.modelingDisabled=P,v.modelingDisabled&&(l.cancel(),o.close(),s.cancel()),f._update()});function m(M,P,S){var w=M[P];M[P]=function(){return S.call(this,w,arguments)}}function _(M,P){m(M,P,function(S,w){if(!v.modelingDisabled)return S.apply(this,w)})}function b(M,P){m(M,P,function(S,w){if(v.modelingDisabled)throw new Error("model is read-only");return S.apply(this,w)})}_(o,"open"),_(s,"init"),_(l,"activate"),_(s,"init"),_(l,"activate"),b(p,"moveShape"),b(p,"updateAttachment"),b(p,"moveElements"),b(p,"moveConnection"),b(p,"layoutConnection"),b(p,"createConnection"),b(p,"createShape"),b(p,"createLabel"),b(p,"appendShape"),b(p,"removeElements"),b(p,"distributeElements"),b(p,"removeShape"),b(p,"removeConnection"),b(p,"replaceShape"),b(p,"pasteElements"),b(p,"alignElements"),b(p,"resizeShape"),b(p,"createSpace"),b(p,"updateWaypoints"),b(p,"reconnectStart"),b(p,"reconnectEnd"),m(c,"trigger",function(M,P){var S=P[0];if(!(v.modelingDisabled&&a(["undo","redo","copy","paste","removeSelection","spaceTool","lassoTool","globalConnectTool","distributeElements","alignElements","directEditing"],S)))return M.apply(this,P)})}i.$inject=["eventBus","contextPad","dragging","directEditing","editorActions","modeling","palette","paletteProvider"],lu=i;function a(r,o){return r.indexOf(o)>-1}return lu}var uu,lv;function dN(){return lv||(lv=1,uu=fN()),uu}var cu,uv;function hN(){if(uv)return cu;uv=1;var e=kt(),t=ze(),n=t.TOGGLE_MODE_EVENT,i=t.RESET_SIMULATION_EVENT,a=t.GENERATE_TOKEN_EVENT,r=-15,o=15;function s(l,c){var p=this;this._overlays=l,c.on(n,function(f){var h=f.simulationModeActive;h||p.removeElementNotifications()}),c.on([i,a],function(){p.removeElementNotifications()})}return s.prototype.addElementNotifications=function(l,c){var p=this;l.forEach(function(f){p.addElementNotification(f,c)})},s.prototype.addElementNotification=function(l,c){var p={top:r,right:o},f='<div class="element-notification '+(c.type||"")+'">'+(c.icon?'<i class="fa '+c.icon+'"></i>':"")+('<span class="text">'+c.text+"</span>"||"")+"</div>",h=e(f);this._overlays.add(l,"element-notification",{position:p,html:h,show:{minZoom:.5}})},s.prototype.removeElementNotifications=function(l){var c=this;l?l.forEach(function(p){c.removeElementNotification(p)}):this._overlays.remove({type:"element-notification"})},s.prototype.removeElementNotification=function(l){this._overlays.remove({element:l})},s.$inject=["overlays","eventBus"],cu=s,cu}var pu,cv;function mN(){return cv||(cv=1,pu=hN()),pu}var fu,pv;function fv(){return pv||(pv=1,fu=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}),fu}var du,dv;function vN(){if(dv)return du;dv=1;try{var e=fv()}catch{var e=fv()}var t=/\s+/,n=Object.prototype.toString;du=function(a){return new i(a)};function i(a){if(!a||!a.nodeType)throw new Error("A DOM element reference is required");this.el=a,this.list=a.classList}return i.prototype.add=function(a){if(this.list)return this.list.add(a),this;var r=this.array(),o=e(r,a);return~o||r.push(a),this.el.className=r.join(" "),this},i.prototype.remove=function(a){if(n.call(a)=="[object RegExp]")return this.removeMatching(a);if(this.list)return this.list.remove(a),this;var r=this.array(),o=e(r,a);return~o&&r.splice(o,1),this.el.className=r.join(" "),this},i.prototype.removeMatching=function(a){for(var r=this.array(),o=0;o<r.length;o++)a.test(r[o])&&this.remove(r[o]);return this},i.prototype.toggle=function(a,r){return this.list?(typeof r<"u"?r!==this.list.toggle(a,r)&&this.list.toggle(a):this.list.toggle(a),this):(typeof r<"u"?r?this.add(a):this.remove(a):this.has(a)?this.remove(a):this.add(a),this)},i.prototype.array=function(){var a=this.el.getAttribute("class")||"",r=a.replace(/^\s+|\s+$/g,""),o=r.split(t);return o[0]===""&&o.shift(),o},i.prototype.has=i.prototype.contains=function(a){return this.list?this.list.contains(a):!!~e(this.array(),a)},du}var hu,hv;function Ti(){return hv||(hv=1,hu=vN()),hu}var mu,mv;function gN(){if(mv)return mu;mv=1;var e=Ti(),t=ct(),n=t.is,i=t.supportedElements,a=ze(),r=a.TOGGLE_MODE_EVENT,o=a.GENERATE_TOKEN_EVENT,s=["bpmn:Process","bpmn:Collaboration","bpmn:Participant","bpmn:Lane","bpmn:TextAnnotation"];function l(p){return p.labelTarget}function c(p,f,h,v,m){var _=this;this._eventBus=p,this._elementRegistry=f,this._elementNotifications=m,this._notifications=v,this.canvasParent=h.getContainer().parentNode,p.on(o,2e4,function(b){var M=b.element;if(n(M,"bpmn:StartEvent")&&!_.allElementsSupported())return _.showWarnings(),e(_.canvasParent).add("warning"),!0}),p.on(r,function(b){var M=b.simulationModeActive;M||e(_.canvasParent).remove("warning")})}return c.prototype.allElementsSupported=function(){var p=!0;return this._elementRegistry.forEach(function(f){!n(f,s)&&!n(f,i)&&!l(f)&&(p=!1)}),p},c.prototype.showWarnings=function(p){var f=this,h=[];this._elementRegistry.forEach(function(v){!n(v,s)&&!n(v,i)&&!l(v)&&(f.showWarning(v),h.indexOf(v.type)&&(f._notifications.showNotification(v.type+" not supported","warning"),h.push(v.type)))})},c.prototype.showWarning=function(p){this._elementNotifications.addElementNotification(p,{type:"warning",icon:"fa-exclamation-triangle",text:"Not supported"})},c.$inject=["eventBus","elementRegistry","canvas","notifications","elementNotifications"],mu=c,mu}var vu,vv;function yN(){return vv||(vv=1,vu=gN()),vu}var gu,gv;function EN(){if(gv)return gu;gv=1;var e=ct().is,t=ze(),n=t.TOGGLE_MODE_EVENT,i=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-grey-lighten-56"),a=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-grey-darken-30");function r(l){var c=l.outgoing.filter(o),p=c.indexOf(l.sequenceFlow);return c[p+1]?c[p+1]:c[0]}function o(l){return e(l,"bpmn:SequenceFlow")}function s(l,c,p){var f=this;this._elementRegistry=c,this._graphicsFactory=p,l.on(n,function(h){var v=h.simulationModeActive;v?f.setSequenceFlowsDefault():f.resetSequenceFlows()})}return s.prototype.setSequenceFlowsDefault=function(){var l=this,c=this._elementRegistry.filter(function(p){return e(p,"bpmn:ExclusiveGateway")});c.forEach(function(p){p.outgoing.filter(o).length&&l.setSequenceFlow(p,p.outgoing.filter(o)[0])})},s.prototype.resetSequenceFlows=function(){var l=this,c=this._elementRegistry.filter(function(p){return e(p,"bpmn:ExclusiveGateway")});c.forEach(function(p){p.outgoing.filter(o).length&&l.resetSequenceFlow(p)})},s.prototype.resetSequenceFlow=function(l){l.sequenceFlow&&delete l.sequenceFlow},s.prototype.setSequenceFlow=function(l){var c=this,p=l.outgoing.filter(o);if(p.length){var f=l.sequenceFlow;f?l.sequenceFlow=r(l):l.sequenceFlow=p[0],l.outgoing.forEach(function(h){h===l.sequenceFlow?c.setColor(h,a):c.setColor(h,i)})}},s.prototype.setColor=function(l,c){var p=l.businessObject;p.di.set("stroke",c);var f=this._elementRegistry.getGraphics(l);this._graphicsFactory.update("connection",l,f)},s.$inject=["eventBus","elementRegistry","graphicsFactory"],gu=s,gu}var yu,yv;function bN(){return yv||(yv=1,yu=EN()),yu}var Eu,Ev;function xN(){if(Ev)return Eu;Ev=1;var e=kt(),t=Ti(),n=_n(),i=Wa(),a=ct(),r=a.getBusinessObject,o=a.is,s=a.isTypedEvent,l=ze(),c=l.GENERATE_TOKEN_EVENT,p=l.CONSUME_TOKEN_EVENT,f=l.TOGGLE_MODE_EVENT,h=l.RESET_SIMULATION_EVENT,v=l.PROCESS_INSTANCE_CREATED_EVENT;function m(b){return b&&b.businessObject.name}function _(b,M,P,S){var w=this;this._notifications=M,this._tokenSimulationPalette=P,this._canvas=S,this._init(),b.on(c,function(T){var N=T.element,B=m(N);if(o(N,"bpmn:BusinessRuleTask"))w.log(B||"Business Rule Task","info","bpmn-icon-business-rule");else if(o(N,"bpmn:CallActivity"))w.log(B||"Call Activity","info","bpmn-icon-call-activity");else if(o(N,["bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent"]))w.log(B||"Intermediate Event","info","bpmn-icon-intermediate-event-none");else if(o(N,"bpmn:ManualTask"))w.log(B||"Manual Task","info","bpmn-icon-manual");else if(o(N,"bpmn:ScriptTask"))w.log(B||"Script Task","info","bpmn-icon-script");else if(o(N,"bpmn:ServiceTask"))w.log(B||"Service Task","info","bpmn-icon-service");else if(o(N,"bpmn:StartEvent"))w.log(B||"Start Event","info","bpmn-icon-start-event-none");else if(o(N,"bpmn:Task"))w.log(B||"Task","info","bpmn-icon-task");else if(o(N,"bpmn:UserTask"))w.log(B||"User Task","info","bpmn-icon-user");else if(o(N,"bpmn:ExclusiveGateway")){if(N.outgoing.length<2)return;var $=m(N.sequenceFlow),H=B||"Gateway";$&&(H=H.concat(' <i class="fa fa-angle-right" aria-hidden="true"></i> '+$)),w.log(H,"info","bpmn-icon-gateway-xor")}}),b.on(p,function(T){var N=T.element,B=m(N);o(N,"bpmn:EndEvent")&&(s(r(N),"bpmn:TerminateEventDefinition")?w.log(B||"Terminate End Event","info","bpmn-icon-end-event-terminate"):w.log(B||"End Event","info","bpmn-icon-end-event-none"))}),b.on(v,function(T){var N=T.processInstanceId,B=T.parent;o(B,"bpmn:Process")?w.log("Process "+N+" started","success","fa-check"):w.log("Subprocess "+N+" started","info","fa-check")}),b.on(f,function(T){var N=T.simulationModeActive;N||(w.emptyLog(),t(w.container).add("hidden"))}),b.on(h,function(T){w.emptyLog(),t(w.container).add("hidden")})}return _.prototype._init=function(){var b=this;this.container=e('<div class="token-simulation-log hidden"><div class="header"><i class="fa fa-align-left"></i><button class="close"><i class="fa fa-times" aria-hidden="true"></i></button></div><div class="content"><p class="entry placeholder">No Entries</p></div></div>'),this.placeholder=i(".placeholder",this.container),this.content=i(".content",this.container),n.bind(this.content,"wheel",function(M){M.stopPropagation()}),n.bind(this.content,"mousedown",function(M){M.stopPropagation()}),this.close=i(".close",this.container),n.bind(this.close,"click",function(){t(b.container).add("hidden")}),this.icon=i(".fa-align-left",this.container),n.bind(this.icon,"click",function(){t(b.container).add("hidden")}),this._canvas.getContainer().appendChild(this.container),this.paletteEntry=e('<div class="entry" title="Show Simulation Log"><i class="fa fa-align-left"></i></div>'),n.bind(this.paletteEntry,"click",function(){t(b.container).remove("hidden")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,3)},_.prototype.toggle=function(){var b=this.container;t(b).has("hidden")?t(b).remove("hidden"):t(b).add("hidden")},_.prototype.log=function(b,M,P){t(this.placeholder).add("hidden");var S=new Date,w=S.toLocaleTimeString()+":"+S.getUTCMilliseconds();this._notifications.showNotification(b,M,P);var T;P||(P="fa-info"),P.includes("bpmn")?T='<span class="icon '+P+'">':T='<i class="icon fa '+P+'"></i>';var N=e('<p class="entry '+M+'"><span class="date">'+w+"</span>"+T+"</span>"+b+"</p>");this.content.appendChild(N),this.content.scrollTop=this.content.scrollHeight},_.prototype.emptyLog=function(){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);this.placeholder=e('<p class="entry placeholder">No Entries</p>'),this.content.appendChild(this.placeholder)},_.$inject=["eventBus","notifications","tokenSimulationPalette","canvas"],Eu=_,Eu}var bu,bv;function _N(){return bv||(bv=1,bu=xN()),bu}var xu,xv;function SN(){if(xv)return xu;xv=1;var e=kt(),t=ze(),n=t.TOGGLE_MODE_EVENT,i=2e3;function a(r,o){var s=this;this._eventBus=r,this._canvas=o,this._init(),r.on(n,function(l){var c=l.simulationModeActive;c||s.removeAll()})}return a.prototype._init=function(){this.container=e('<div class="notifications"></div>'),this._canvas.getContainer().appendChild(this.container)},a.prototype.showNotification=function(r,o,s){var l;s||(s="fa-info"),s.includes("bpmn")?l='<i class="'+s+'"></i>':l='<i class="fa '+s+'"></i>';var c=e('<div class="notification '+o+'"><span class="icon">'+l+"</span>"+r+"</div>");for(this.container.appendChild(c);this.container.children.length>5;)this.container.children[0].remove();setTimeout(function(){c.remove()},i)},a.prototype.removeAll=function(){for(;this.container.children.length;)this.container.children[0].remove()},a.$inject=["eventBus","canvas"],xu=a,xu}var _u,_v;function wN(){return _v||(_v=1,_u=SN()),_u}var Su,Sv;function TN(){if(Sv)return Su;Sv=1;var e=kt(),t=Ti(),n=_n(),i=ze(),a=i.TOGGLE_MODE_EVENT,r=i.PLAY_SIMULATION_EVENT,o=i.PAUSE_SIMULATION_EVENT,s=i.RESET_SIMULATION_EVENT,l=i.ANIMATION_CREATED_EVENT,c=i.PROCESS_INSTANCE_CREATED_EVENT,p='<i class="fa fa-play"></i>',f='<i class="fa fa-pause"></i>';function h(v,m,_,b){var M=this;this._eventBus=v,this._tokenSimulationPalette=m,this._notifications=_,this.canvasParent=b.getContainer().parentNode,this.isActive=!1,this.isPaused=!1,this._init(),v.on(c,function(P){var S=P.parent;S.parent||(M.activate(),M.unpause(),_.showNotification("Start Simulation","info"))}),v.on([s,a],function(){M.deactivate(),M.unpause()}),v.on(l,function(P){var S=P.animation;M.isPaused&&S.pause()})}return h.prototype._init=function(){this.paletteEntry=e('<div class="entry disabled" title="Play/Pause Simulation">'+p+"</div>"),n.bind(this.paletteEntry,"click",this.toggle.bind(this)),this._tokenSimulationPalette.addEntry(this.paletteEntry,1)},h.prototype.toggle=function(){this.isActive&&(this.isPaused?this.unpause():this.pause())},h.prototype.pause=function(){this.isActive&&(t(this.paletteEntry).remove("active"),t(this.canvasParent).add("paused"),this.paletteEntry.innerHTML=p,this._eventBus.fire(o),this._notifications.showNotification("Pause Simulation","info"),this.isPaused=!0)},h.prototype.unpause=function(){this.isActive&&(t(this.paletteEntry).add("active"),t(this.canvasParent).remove("paused"),this.paletteEntry.innerHTML=f,this._eventBus.fire(r),this._notifications.showNotification("Play Simulation","info"),this.isPaused=!1)},h.prototype.activate=function(){this.isActive=!0,t(this.paletteEntry).remove("disabled")},h.prototype.deactivate=function(){this.isActive=!1,t(this.paletteEntry).remove("active"),t(this.paletteEntry).add("disabled")},h.$inject=["eventBus","tokenSimulationPalette","notifications","canvas"],Su=h,Su}var wu,wv;function CN(){return wv||(wv=1,wu=TN()),wu}var Tu,Tv;function AN(){if(Tv)return Tu;Tv=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=5e4;function i(a,r,o){var s=this;this._elementRegistry=r,this._graphicsFactory=o,this.elementColors={},a.on(t,n,function(l){var c=l.simulationModeActive;c?s.preserveColors():s.resetColors()})}return i.prototype.preserveColors=function(){var a=this;this._elementRegistry.forEach(function(r){a.elementColors[r.id]={stroke:r.businessObject.di.get("stroke"),fill:r.businessObject.di.get("fill")},a.setColor(r,"#000","#fff")})},i.prototype.resetColors=function(){var a=this;this._elementRegistry.forEach(function(r){a.elementColors[r.id]&&a.setColor(r,a.elementColors[r.id].stroke,a.elementColors[r.id].fill)}),this.elementColors={}},i.prototype.setColor=function(a,r,o){var s=a.businessObject;s.di.set("stroke",r),s.di.set("fill",o);var l=this._elementRegistry.getGraphics(a),c=a.waypoints?"connection":"shape";this._graphicsFactory.update(c,a,l)},i.$inject=["eventBus","elementRegistry","graphicsFactory"],Tu=i,Tu}var Cu,Cv;function PN(){return Cv||(Cv=1,Cu=AN()),Cu}var Au,Av;function RN(){if(Av)return Au;Av=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=e.RESET_SIMULATION_EVENT;function i(a){this.nextProcessInstanceId=1,a.on(t,this.reset.bind(this)),a.on(n,this.reset.bind(this))}return i.prototype.getNext=function(){var a=this.nextProcessInstanceId;return this.nextProcessInstanceId++,a},i.prototype.reset=function(){this.nextProcessInstanceId=1},i.$inject=["eventBus"],Au=i,Au}var Pu,Pv;function IN(){return Pv||(Pv=1,Pu=RN()),Pu}var Ru,Rv;function NN(){if(Rv)return Ru;Rv=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=e.PROCESS_INSTANCE_CREATED_EVENT,i=e.PROCESS_INSTANCE_FINISHED_EVENT,a=e.PROCESS_INSTANCE_SHOWN_EVENT,r=e.PROCESS_INSTANCE_HIDDEN_EVENT,o=500;function s(l,c,p,f){var h=this;this._animation=l,this._eventBus=c,this._processInstances=p,this._elementRegistry=f,this._eventBus.on(n,o,function(v){var m=v.parent,_=v.processInstanceId,b=p.getProcessInstances(m).filter(function(M){return!M.isFinished});b.length===1?h.showProcessInstance(_,m):b.length>1&&h.hideProcessInstance(_)}),this._eventBus.on(i,o,function(v){var m=v.parent,_=v.processInstanceId,b=p.getProcessInstances(m).filter(function(M){return _!==M.processInstanceId&&!M.isFinished});b.length&&_===m.shownProcessInstance?h.showProcessInstance(b[0].processInstanceId,m):delete m.shownProcessInstance,m.parent||f.forEach(function(M){delete M.shownProcessInstance})}),c.on(t,function(){f.forEach(function(v){delete v.shownProcessInstance})})}return s.prototype.showProcessInstance=function(l,c){this._animation.showProcessInstanceAnimations(l),c.shownProcessInstance=l,this._eventBus.fire(a,{processInstanceId:l})},s.prototype.hideProcessInstance=function(l){this._animation.hideProcessInstanceAnimations(l),this._eventBus.fire(r,{processInstanceId:l})},s.prototype.showNext=function(l){var c=this,p=this._processInstances.getProcessInstances(l),f=l.shownProcessInstance,h=0;for(let v=0;v<p.length&&p[v].processInstanceId!==f;v++)h++;p.forEach(function(v){c.hideProcessInstance(v.processInstanceId)}),h===p.length-1?this.showProcessInstance(p[0].processInstanceId,l):this.showProcessInstance(p[h+1].processInstanceId,l)},s.$inject=["animation","eventBus","processInstances","elementRegistry"],Ru=s,Ru}var Iu,Iv;function MN(){return Iv||(Iv=1,Iu=NN()),Iu}var Nu,Nv;function DN(){if(Nv)return Nu;Nv=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=e.RESET_SIMULATION_EVENT,i=e.PROCESS_INSTANCE_CREATED_EVENT,a=e.PROCESS_INSTANCE_FINISHED_EVENT;function r(o,s){var l=this;this._eventBus=o,this._processInstanceIds=s,this.processInstances=[],o.on([t,n],function(){l.processInstances=[]})}return r.prototype.create=function(o,s){var l=this._processInstanceIds.getNext(),c={parent:o,processInstanceId:l,parentProcessInstanceId:s};return this.processInstances.push(c),this._eventBus.fire(i,c),l},r.prototype.remove=function(o){this.processInstances=this.processInstances.filter(function(s){return s.processInstanceId!==o})},r.prototype.finish=function(o){var s=this.processInstances.find(function(l){return l.processInstanceId===o});this._eventBus.fire(a,s),s.isFinished=!0},r.prototype.getProcessInstances=function(o,s){if(!o)return this.processInstances;var l=this.processInstances.filter(function(c){return c.parent===o});return s&&s.includeFinished!==!0&&(l=l.filter(function(c){return!c.isFinished})),l},r.prototype.getProcessInstance=function(o){return this.processInstances.find(function(s){return s.processInstanceId===o})},r.$inject=["eventBus","processInstanceIds"],Nu=r,Nu}var Mu,Mv;function kN(){return Mv||(Mv=1,Mu=DN()),Mu}var Du,Dv;function ON(){if(Dv)return Du;Dv=1;var e=kt(),t=Ti(),n=_n(),i=ct().is,a=ze(),r=a.TOGGLE_MODE_EVENT,o=a.GENERATE_TOKEN_EVENT,s=a.RESET_SIMULATION_EVENT;function l(c,p,f,h){var v=this;this._eventBus=c,this._tokenSimulationPalette=p,this._notifications=f,this._elementRegistry=h,this._init(),c.on(o,function(m){i(m.element,"bpmn:StartEvent")&&t(v.paletteEntry).remove("disabled")}),c.on(r,function(m){var _=m.simulationModeActive;_||v.resetSimulation()})}return l.prototype._init=function(){var c=this;this.paletteEntry=e('<div class="entry disabled" title="Reset Simulation"><i class="fa fa-refresh"></i></div>'),n.bind(this.paletteEntry,"click",function(){c.resetSimulation(),c._notifications.showNotification("Reset Simulation","info")}),this._tokenSimulationPalette.addEntry(this.paletteEntry,2)},l.prototype.resetSimulation=function(){t(this.paletteEntry).add("disabled"),this._elementRegistry.forEach(function(c){c.tokenCount!==void 0&&delete c.tokenCount}),this._eventBus.fire(s)},l.$inject=["eventBus","tokenSimulationPalette","notifications","elementRegistry"],Du=l,Du}var ku,kv;function LN(){return kv||(kv=1,ku=ON()),ku}var Ou,Ov;function BN(){if(Ov)return Ou;Ov=1;var e=kt(),t=Ti(),n=_n(),i=Wa(),a=ze(),r=a.TOGGLE_MODE_EVENT;function o(s,l,c){var p=this;this._canvas=s,this._animation=l,this._eventBus=c,this._init(),c.on(r,function(f){var h=f.simulationModeActive;h?t(p.container).remove("hidden"):t(p.container).add("hidden")})}return o.prototype._init=function(){var s=this;this.container=e('<div class="set-animation-speed hidden"><i title="Set Animation Speed" class="fa fa-tachometer" aria-hidden="true"></i><div class="animation-speed-buttons"><div title="Slow" id="animation-speed-1" class="animation-speed-button"><i class="fa fa-angle-right" aria-hidden="true"></i></div><div title="Normal" id="animation-speed-2" class="animation-speed-button active"><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i></div><div title="Fast" id="animation-speed-3" class="animation-speed-button"><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-angle-right" aria-hidden="true"></i></div></div></div>');var l=i("#animation-speed-1",this.container),c=i("#animation-speed-2",this.container),p=i("#animation-speed-3",this.container);n.bind(l,"click",function(){s.setActive(l),s._animation.setAnimationSpeed(.5)}),n.bind(c,"click",function(){s.setActive(c),s._animation.setAnimationSpeed(1)}),n.bind(p,"click",function(){s.setActive(p),s._animation.setAnimationSpeed(1.5)}),this._canvas.getContainer().appendChild(this.container)},o.prototype.setActive=function(s){i.all(".animation-speed-button",this.container).forEach(function(l){t(l).remove("active")}),t(s).add("active")},o.$inject=["canvas","animation","eventBus"],Ou=o,Ou}var Lu,Lv;function $N(){return Lv||(Lv=1,Lu=BN()),Lu}var Bu,Bv;function VN(){return Bv||(Bv=1,Bu=function(e){for(var t;e.childNodes.length;)t=e.childNodes[0],e.removeChild(t);return e}),Bu}var $u,$v;function FN(){if($v)return $u;$v=1;var e=kt(),t=Ti(),n=_n(),i=Wa(),a=VN(),r=ze(),o=r.TOGGLE_MODE_EVENT,s=r.PROCESS_INSTANCE_CREATED_EVENT,l=r.PROCESS_INSTANCE_FINISHED_EVENT,c=r.PROCESS_INSTANCE_SHOWN_EVENT,p=r.PROCESS_INSTANCE_HIDDEN_EVENT,f=r.RESET_SIMULATION_EVENT,h=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-silver-base-97"),v=getComputedStyle(document.documentElement).getPropertyValue("--token-simulation-green-base-44");function m(b){return b===null}function _(b,M,P,S,w,T){var N=this;this._eventBus=b,this._canvas=M,this._processInstanceSettings=P,this._processInstances=S,this._graphicsFactory=w,this._elementRegistry=T,this.highlightedElement=null,this._init(),b.on(o,function(B){var $=B.simulationModeActive;$?t(N.container).remove("hidden"):(t(N.container).add("hidden"),a(N.container),m(N.highlightedElement)||(N.removeHighlightFromProcess(N.highlightedElement.element),N.highlightedElement=null))}),b.on(s,function(B){N.addInstance(B)}),b.on(l,function(B){N.removeInstance(B)}),b.on(c,function(B){N.setInstanceShown(B.processInstanceId)}),b.on(p,function(B){N.setInstanceHidden(B.processInstanceId)}),b.on(f,function(){N.removeAllInstances()})}return _.prototype._init=function(){this.container=e('<div class="process-instances hidden"></div>'),this._canvas.getContainer().appendChild(this.container)},_.prototype.addInstance=function(b){var M=this,P=b.processInstanceId,S=b.parent,w=e('<div id="instance-'+P+'" class="process-instance" title="View Process Instance '+P+'">'+P+"</div>");n.bind(w,"click",function(){var T=M._processInstances.getProcessInstances(S);T.forEach(function(N){M._processInstanceSettings.hideProcessInstance(N.processInstanceId)}),M._processInstanceSettings.showProcessInstance(P,S)}),n.bind(w,"mouseenter",function(){M.highlightedElement={element:S,stroke:S.businessObject.di.get("stroke"),fill:S.businessObject.di.get("fill")},M.addHighlightToProcess(S)}),n.bind(w,"mouseleave",function(){M.removeHighlightFromProcess(S),M.highlightedElement=null}),this.container.appendChild(w)},_.prototype.removeInstance=function(b){var M=b.processInstanceId,P=i("#instance-"+M,this.container);P&&P.remove()},_.prototype.removeAllInstances=function(){this.container.innerHTML=""},_.prototype.setInstanceShown=function(b){var M=i("#instance-"+b,this.container);M&&t(M).add("active")},_.prototype.setInstanceHidden=function(b){var M=i("#instance-"+b,this.container);M&&t(M).remove("active")},_.prototype.addHighlightToProcess=function(b){this.setColor(b,v,h),b.parent||t(this._canvas.getContainer()).add("highlight")},_.prototype.removeHighlightFromProcess=function(b){m(this.highlightedElement)||(this.setColor(b,this.highlightedElement.stroke,this.highlightedElement.fill),b.parent||t(this._canvas.getContainer()).remove("highlight"))},_.prototype.setColor=function(b,M,P){var S=b.businessObject;S.di.set("stroke",M),S.di.set("fill",P);var w=this._elementRegistry.getGraphics(b);this._graphicsFactory.update("connection",b,w)},_.$inject=["eventBus","canvas","processInstanceSettings","processInstances","graphicsFactory","elementRegistry"],$u=_,$u}var Vu,Vv;function jN(){return Vv||(Vv=1,Vu=FN()),Vu}var Fu,Fv;function HN(){if(Fv)return Fu;Fv=1;var e=ct(),t=e.getBusinessObject,n=e.is,i=e.isAncestor,a=e.isTypedEvent,r=ze(),o=r.CONSUME_TOKEN_EVENT,s=250;function l(c,p,f,h,v,m,_){this._animation=p,this._elementRegistry=f,this._log=h,this._elementNotifications=v,this._canvas=m,this._processInstances=_,c.on(o,s,function(){})}return l.prototype.isDeadlock=function(){var c=this,p=[];this._elementRegistry.forEach(function(v){v.tokenCount&&p.push(v)});var f=[],h=[];p.forEach(function(v){var m=v.outgoing.filter(function(P){return n(P,"bpmn:SequenceFlow")});if(m.length||f.push(v),n(v,"bpmn:ParallelGateway")){var _=v.incoming.filter(function(P){return n(P,"bpmn:SequenceFlow")});_.length>v.tokenCount&&f.push(v)}var b=[];function M(P){P.outgoing.forEach(function(S){if(b.indexOf(S.target)===-1){b.push(S.target);var w=a(t(S.target),"bpmn:TerminateEventDefinition");w&&h.push(P),M(S.target)}})}M(v)}),p.length&&!h.length&&f.length&&!this._animation.animations.length&&(c._log.log("Deadlock","warning","fa-exclamation-triangle"),f.forEach(function(v){c._elementNotifications.addElementNotification(v,{type:"warning",icon:"fa-exclamation-triangle",text:"Deadlock"})}))},l.prototype.isFinished=function(c,p){var f=this._processInstances.getProcessInstance(p),h=f.parent,v=!1;h||(h=this._canvas.getRootElement()),h.children.forEach(function(_){_.tokenCount&&_.tokenCount[p]&&_.tokenCount[p].length&&(v=!0)});var m=!1;if(this._animation.animations.forEach(function(_){i(h,_.element)&&_.processInstanceId===p&&(m=!0)}),!v&&!m)return n(h,"bpmn:SubProcess")?this._log.log("Subprocess "+p+" finished","info","fa-check-circle"):(this._log.log("Process "+p+" finished","success","fa-check-circle"),this._elementNotifications.addElementNotification(c,{type:"success",icon:"fa-check-circle",text:"Finished"})),!0},l.$inject=["eventBus","animation","elementRegistry","log","elementNotifications","canvas","processInstances"],Fu=l,Fu}var ju,jv;function GN(){return jv||(jv=1,ju=HN()),ju}var Hu,Hv;function zN(){if(Hv)return Hu;Hv=1;var e=kt(),t=Ti(),n=_n(),i=Wa(),a=ze(),r=a.TOGGLE_MODE_EVENT;function o(s,l,c,p){var f=this;this._eventBus=s,this._canvas=l,this._selection=c,this._contextPad=p,this.simulationModeActive=!1,s.on("import.done",function(){f.canvasParent=f._canvas.getContainer().parentNode,f.palette=i(".djs-palette",f._canvas.getContainer()),f._init()})}return o.prototype._init=function(){this.container=e(`
    <div class="toggle-mode">
      Token Simulation <span class="toggle"><i class="fa fa-toggle-off"></i></span>
    </div>
  `),n.bind(this.container,"click",this.toggleMode.bind(this)),this._canvas.getContainer().appendChild(this.container)},o.prototype.toggleMode=function(){if(this.simulationModeActive){this.container.innerHTML='Token Simulation <span class="toggle"><i class="fa fa-toggle-off"></i></span>',t(this.canvasParent).remove("simulation"),t(this.palette).remove("hidden"),this._eventBus.fire(r,{simulationModeActive:!1});var s=this._selection.get();s.length===1&&this._contextPad.open(s[0])}else this.container.innerHTML='Token Simulation <span class="toggle"><i class="fa fa-toggle-on"></i></span>',t(this.canvasParent).add("simulation"),t(this.palette).add("hidden"),this._eventBus.fire(r,{simulationModeActive:!0});this.simulationModeActive=!this.simulationModeActive},o.$inject=["eventBus","canvas","selection","contextPad"],Hu=o,Hu}var Gu,Gv;function UN(){return Gv||(Gv=1,Gu=zN()),Gu}var zu,zv;function qN(){if(zv)return zu;zv=1;var e=kt(),t=ct(),n=t.isAncestor,i=ze(),a=i.TOGGLE_MODE_EVENT,r=i.GENERATE_TOKEN_EVENT,o=i.CONSUME_TOKEN_EVENT,s=i.RESET_SIMULATION_EVENT,l=i.TERMINATE_EVENT,c=i.PROCESS_INSTANCE_SHOWN_EVENT,p=10,f=-15,h=500;function v(m,_,b,M,P){var S=this;this._overlays=_,this._elementRegistry=b,this._canvas=M,this._processInstances=P,this.overlayIds={},m.on(a,function(w){var T=w.simulationModeActive;T||S.removeTokenCounts()}),m.on(s,function(){S.removeTokenCounts()}),m.on(l,function(w){var T=w.element,N=T.parent;S.removeTokenCounts(N)}),m.on([r,o],h,function(w){var T=w.element,N=T.parent;S.removeTokenCounts(N),S.addTokenCounts(N)}),m.on(c,function(w){var T=w.processInstanceId,N=P.getProcessInstance(T),B=N.parent;S.removeTokenCounts(B),S.addTokenCounts(B)})}return v.prototype.addTokenCounts=function(m){var _=this;m||(m=this._canvas.getRootElement());var b=m.shownProcessInstance;if(!b){var M=this._processInstances.getProcessInstances(m);if(!M.length)return;b=M[0].processInstanceId}this._elementRegistry.forEach(function(P){n(m,P)&&_.addTokenCount(P,b)})},v.prototype.addTokenCount=function(m,_){var b=m.tokenCount&&m.tokenCount[_];if(b){var M=this.createTokenCount(b),P={bottom:p,left:f},S=this._overlays.add(m,"token-count",{position:P,html:M,show:{minZoom:.5}});this.overlayIds[m.id]=S}},v.prototype.createTokenCount=function(m){return e('<div class="token-count waiting">'+m+"</div>")},v.prototype.removeTokenCounts=function(m){var _=this;m||(m=this._canvas.getRootElement()),this._elementRegistry.forEach(function(b){n(m,b)&&_.removeTokenCount(b)})},v.prototype.removeTokenCount=function(m){var _=this.overlayIds[m.id];_&&(this._overlays.remove(_),delete this.overlayIds[m.id])},v.$inject=["eventBus","overlays","elementRegistry","canvas","processInstances"],zu=v,zu}var Uu,Uv;function WN(){return Uv||(Uv=1,Uu=qN()),Uu}var qu,qv;function YN(){if(qv)return qu;qv=1;var e=ct(),t=e.getBusinessObject,n=e.is,i=e.isAncestor,a=e.getDescendants,r=e.isTypedEvent,o=ze(),s=o.GENERATE_TOKEN_EVENT,l=o.TERMINATE_EVENT,c=o.UPDATE_ELEMENTS_EVENT;function p(f,h,v,m,_,b){this._animation=f,this._eventBus=h,this._log=v,this._simulationState=m,this._elementRegistry=_,this._processInstances=b}return p.prototype.consume=function(f){var h=f.element,v=f.processInstanceId,m=r(t(h),"bpmn:TerminateEventDefinition"),_=n(h.parent,"bpmn:SubProcess");m&&(this._eventBus.fire(l,f),this._elementRegistry.forEach(function(P){i(h.parent,P)&&P.tokenCount&&P.tokenCount[v]&&delete P.tokenCount[v]}),this._processInstances.finish(v));var b=this._simulationState.isFinished(h,v);if(b&&this._processInstances.finish(v),(b||m)&&_){var M=this._processInstances.getProcessInstance(v);this._eventBus.fire(s,{element:h.parent,processInstanceId:M.parentProcessInstanceId})}this._eventBus.fire(c,{elements:a(this._elementRegistry.getAll(),h.parent)})},p.prototype.generate=function(f){},p.$inject=["animation","eventBus","log","simulationState","elementRegistry","processInstances"],qu=p,qu}var Wu,Wv;function KN(){if(Wv)return Wu;Wv=1;var e=ct().is,t=ze(),n=t.UPDATE_ELEMENTS_EVENT;function i(a,r){this._eventBus=a,this._animation=r}return i.prototype.consume=function(a){var r=a.element,o=a.processInstanceId;r.tokenCount||(r.tokenCount={}),r.tokenCount[o]||(r.tokenCount[o]=0),r.tokenCount[o]++;var s=r.outgoing,l=[];s.forEach(function(c){var p=c.target;e(p,"bpmn:IntermediateCatchEvent")&&l.push(p)}),this._eventBus.fire(n,{elements:l})},i.prototype.generate=function(){},i.$inject=["eventBus","animation"],Wu=i,Wu}var Yu,Yv;function XN(){if(Yv)return Yu;Yv=1;var e=ze(),t=e.CONSUME_TOKEN_EVENT,n=e.GENERATE_TOKEN_EVENT;function i(a,r,o){this._eventBus=a,this._animation=r,this._elementRegistry=o}return i.prototype.consume=function(a){var r=a.element;if(!r.sequenceFlow)throw new Error("no sequence flow configured for element "+r.id);this._eventBus.fire(n,a)},i.prototype.generate=function(a){var r=a.element,o=a.processInstanceId;if(!r.sequenceFlow)throw new Error("no sequence flow configured for element "+r.id);var s=this,l=this._elementRegistry.get(r.sequenceFlow.id);this._animation.createAnimation(l,o,function(){s._eventBus.fire(t,{element:l.target,processInstanceId:o})})},i.$inject=["eventBus","animation","elementRegistry"],Yu=i,Yu}var Ku,Kv;function ZN(){if(Kv)return Ku;Kv=1;var e=ct(),t=e.is,n=ze(),i=n.CONSUME_TOKEN_EVENT,a=n.UPDATE_ELEMENT_EVENT,r=n.UPDATE_ELEMENTS_EVENT;function o(s,l,c){this._animation=s,this._eventBus=l,this._elementRegistry=c}return o.prototype.consume=function(s){var l=s.element,c=s.processInstanceId;l.tokenCount||(l.tokenCount={}),l.tokenCount[c]||(l.tokenCount[c]=0),l.tokenCount[c]++,this._eventBus.fire(a,{element:l})},o.prototype.generate=function(s){var l=this,c=s.element,p=s.processInstanceId,f=c.outgoing.filter(function(m){return t(m,"bpmn:SequenceFlow")});f.forEach(function(m){l._animation.createAnimation(m,p,function(){l._eventBus.fire(i,{element:m.target,processInstanceId:p})})});var h=c.parent,v=this._elementRegistry.filter(function(m){return t(m,"bpmn:IntermediateCatchEvent")&&m.parent===h});this._eventBus.fire(r,{elements:v})},o.$inject=["animation","eventBus","elementRegistry"],Ku=o,Ku}var Xu,Xv;function JN(){if(Xv)return Xu;Xv=1;var e=ct().is,t=ze(),n=t.CONSUME_TOKEN_EVENT,i=t.GENERATE_TOKEN_EVENT;function a(r,o){this._animation=r,this._eventBus=o}return a.prototype.consume=function(r){this._eventBus.fire(i,{element:r})},a.prototype.generate=function(r){var o=this,s=r.outgoing.filter(function(l){return e(l,"bpmn:SequenceFlow")});s.forEach(function(l){o._animation.createAnimation(l,function(){o._eventBus.fire(n,{element:l.target})})})},a.$inject=["animation","eventBus"],Xu=a,Xu}var Zu,Zv;function QN(){if(Zv)return Zu;Zv=1;var e=ct().is,t=ze(),n=t.CONSUME_TOKEN_EVENT,i=t.GENERATE_TOKEN_EVENT;function a(r,o){this._animation=r,this._eventBus=o}return a.prototype.consume=function(r){var o=r.element,s=r.processInstanceId;o.tokenCount||(o.tokenCount={}),o.tokenCount[s]||(o.tokenCount[s]=0),o.tokenCount[s]++;var l=o.incoming;l.length===o.tokenCount[s]&&(this._eventBus.fire(i,r),o.tokenCount[s]=0)},a.prototype.generate=function(r){var o=this,s=r.element,l=r.processInstanceId,c=s.outgoing.filter(function(p){return e(p,"bpmn:SequenceFlow")});c.forEach(function(p){o._animation.createAnimation(p,l,function(){o._eventBus.fire(n,{element:p.target,processInstanceId:l})})})},a.$inject=["animation","eventBus"],Zu=a,Zu}var Ju,Jv;function eM(){if(Jv)return Ju;Jv=1;var e=ct().is,t=ze(),n=t.CONSUME_TOKEN_EVENT,i=t.UPDATE_ELEMENTS_EVENT;function a(r,o,s,l){this._animation=r,this._eventBus=o,this._elementRegistry=s,this._processInstances=l}return a.prototype.consume=function(){},a.prototype.generate=function(r){var o=this,s=r.element,l=r.parentProcessInstanceId,c=s.outgoing.filter(function(v){return e(v,"bpmn:SequenceFlow")}),p=s.parent,f=this._processInstances.create(p,l);if(c.forEach(function(v){o._animation.createAnimation(v,f,function(){o._eventBus.fire(n,{element:v.target,processInstanceId:f})})}),!e(s.parent,"bpmn:SubProcess")){var h=this._elementRegistry.filter(function(v){return e(v,"bpmn:StartEvent")});this._eventBus.fire(i,{elements:h})}},a.$inject=["animation","eventBus","elementRegistry","processInstances"],Ju=a,Ju}var Qu,Qv;function tM(){if(Qv)return Qu;Qv=1;var e=ct().is,t=ze(),n=t.CONSUME_TOKEN_EVENT,i=t.GENERATE_TOKEN_EVENT,a=t.UPDATE_ELEMENT_EVENT;function r(o,s,l){this._animation=o,this._eventBus=s,this._log=l}return r.prototype.consume=function(o){var s=o.element,l=o.processInstanceId,c=s.children.filter(function(p){return e(p,"bpmn:StartEvent")})[0];c?(this._log.log("Starting Subprocess","info","fa-sign-in"),this._eventBus.fire(i,{element:c,parentProcessInstanceId:l})):(this._log.log("Skipping Subprocess","info","fa-angle-double-right"),this._eventBus.fire(i,o)),this._eventBus.fire(a,{element:s})},r.prototype.generate=function(o){var s=this,l=o.element,c=o.processInstanceId,p=l.outgoing.filter(function(f){return e(f,"bpmn:SequenceFlow")});p.forEach(function(f){s._animation.createAnimation(f,c,function(){s._eventBus.fire(n,{element:f.target,processInstanceId:c})})}),this._eventBus.fire(a,{element:l})},r.$inject=["animation","eventBus","log"],Qu=r,Qu}var ec,eg;function nM(){if(eg)return ec;eg=1;var e=ct(),t=e.is,n=ze(),i=n.CONSUME_TOKEN_EVENT,a=n.UPDATE_ELEMENT_EVENT;function r(o,s,l){this._animation=o,this._eventBus=s,this._elementRegistry=l}return r.prototype.consume=function(o){var s=o.element,l=o.processInstanceId;s.tokenCount||(s.tokenCount={}),s.tokenCount[l]||(s.tokenCount[l]=0),s.tokenCount[l]++,this._eventBus.fire(a,{element:s})},r.prototype.generate=function(o){var s=this,l=o.element,c=o.processInstanceId,p=l.outgoing.filter(function(f){return t(f,"bpmn:SequenceFlow")});p.forEach(function(f){s._animation.createAnimation(f,c,function(){s._eventBus.fire(i,{element:f.target,processInstanceId:c})})})},r.$inject=["animation","eventBus","elementRegistry"],ec=r,ec}var tc,tg;function iM(){if(tg)return tc;tg=1;var e=ct().is,t=ze(),n=t.CONSUME_TOKEN_EVENT,i=t.GENERATE_TOKEN_EVENT;function a(r,o){this._animation=r,this._eventBus=o}return a.prototype.consume=function(r){this._eventBus.fire(i,r)},a.prototype.generate=function(r){var o=this,s=r.element,l=r.processInstanceId,c=s.outgoing.filter(function(p){return e(p,"bpmn:SequenceFlow")});c.forEach(function(p){o._animation.createAnimation(p,l,function(){o._eventBus.fire(n,{element:p.target,processInstanceId:l})})})},a.$inject=["animation","eventBus"],tc=a,tc}var nc,ng;function rM(){if(ng)return nc;ng=1;var e=YN(),t=KN(),n=XN(),i=ZN(),a=JN(),r=QN(),o=eM(),s=tM(),l=nM(),c=iM(),p=ze(),f=p.GENERATE_TOKEN_EVENT,h=p.CONSUME_TOKEN_EVENT;function v(m,_,b){var M=this;this._injector=b,this.handlers={},this.registerHandler("bpmn:EndEvent",e),this.registerHandler("bpmn:EventBasedGateway",t),this.registerHandler("bpmn:ExclusiveGateway",n),this.registerHandler("bpmn:IntermediateCatchEvent",i),this.registerHandler("bpmn:IntermediateThrowEvent",a),this.registerHandler("bpmn:ParallelGateway",r),this.registerHandler("bpmn:StartEvent",o),this.registerHandler("bpmn:SubProcess",s),this.registerHandler("bpmn:BoundaryEvent",l),this.registerHandler(["bpmn:BusinessRuleTask","bpmn:CallActivity","bpmn:ManualTask","bpmn:ScriptTask","bpmn:ServiceTask","bpmn:Task","bpmn:UserTask"],c),m.on(f,function(P){var S=P.element;if(!M.handlers[S.type])throw new Error("no handler for type "+S.type);M.handlers[S.type].generate(P)}),m.on(h,function(P){var S=P.element;if(!M.handlers[S.type])throw new Error("no handler for type "+S.type);M.handlers[S.type].consume(P)})}return v.prototype.registerHandler=function(m,_){var b=this,M=this._injector.instantiate(_);Array.isArray(m)||(m=[m]),m.forEach(function(P){b.handlers[P]=M})},v.$inject=["eventBus","animation","injector"],nc=v,nc}var ic,ig;function aM(){return ig||(ig=1,ic=rM()),ic}var rc,rg;function oM(){if(rg)return rc;rg=1;function e(t,n,i,a,r,o){o.register({toggleTokenSimulation:function(){n.toggleMode()}}),o.register({togglePauseTokenSimulation:function(){i.toggle()}}),o.register({resetTokenSimulation:function(){r.resetSimulation()}}),o.register({toggleTokenSimulationLog:function(){a.toggle()}})}return e.$inject=["eventBus","toggleMode","pauseSimulation","log","resetSimulation","editorActions"],rc=e,rc}var ac,ag;function sM(){return ag||(ag=1,ac=oM()),ac}var oc,og;function lM(){if(og)return oc;og=1;var e=ze(),t=e.TOGGLE_MODE_EVENT,n=1e4;function i(r,o){var s=o.get("editorActions",!1),l=o.get("keyboard",!1);if(!l||!s)return;var c=!1;function p(f){if(a(["t","T"],f))return s.trigger("toggleTokenSimulation"),!0;if(c){if(a(["l","L"],f))return s.trigger("toggleTokenSimulationLog"),!0;if(a([" ","Spacebar"],f))return s.trigger("togglePauseTokenSimulation"),!0;if(a(["r","R"],f))return s.trigger("resetTokenSimulation"),!0}}r.on("keyboard.init",function(){l.addListener(n,function(f){var h=f.keyEvent;p(h)})}),r.on(t,function(f){var h=f.simulationModeActive;h?c=!0:c=!1})}i.$inject=["eventBus","injector"],oc=i;function a(r,o){return r.indexOf(o.key)>-1}return oc}var sc,sg;function uM(){return sg||(sg=1,sc=lM()),sc}var lc,lg;function cM(){if(lg)return lc;lg=1;var e=kt(),t=Ti(),n=ze(),i=n.TOGGLE_MODE_EVENT;function a(r,o){var s=this;this._canvas=o,this.entries=[],this._init(),r.on(i,function(l){var c=l.simulationModeActive;c?t(s.container).remove("hidden"):t(s.container).add("hidden")})}return a.prototype._init=function(){this.container=e('<div class="token-simulation-palette hidden"></div>'),this._canvas.getContainer().appendChild(this.container)},a.prototype.addEntry=function(r,o){var s=0;this.entries.forEach(function(l){o>=l.index&&s++}),this.container.insertBefore(r,this.container.childNodes[s]),this.entries.push({entry:r,index:o})},a.$inject=["eventBus","canvas"],lc=a,lc}var uc,ug;function pM(){return ug||(ug=1,uc=cM()),uc}var cc,cg;function fM(){return cg||(cg=1,cc={__init__:["animation","contextPads","disableModeling","elementNotifications","elementSupport","exclusiveGatewaySettings","log","notifications","pauseSimulation","preserveElementColors","processInstanceIds","processInstanceSettings","processInstances","resetSimulation","setAnimationSpeed","showProcessInstance","simulationState","toggleMode","tokenCount","tokenSimulationBehavior","tokenSimulationEditorActions","tokenSimulationKeyboardBindings","tokenSimulationPalette"],animation:["type",nN()],contextPads:["type",pN()],disableModeling:["type",dN()],elementNotifications:["type",mN()],elementSupport:["type",yN()],exclusiveGatewaySettings:["type",bN()],log:["type",_N()],notifications:["type",wN()],pauseSimulation:["type",CN()],preserveElementColors:["type",PN()],processInstanceIds:["type",IN()],processInstanceSettings:["type",MN()],processInstances:["type",kN()],resetSimulation:["type",LN()],setAnimationSpeed:["type",$N()],showProcessInstance:["type",jN()],simulationState:["type",GN()],toggleMode:["type",UN()],tokenCount:["type",WN()],tokenSimulationBehavior:["type",aM()],tokenSimulationEditorActions:["type",sM()],tokenSimulationKeyboardBindings:["type",uM()],tokenSimulationPalette:["type",pM()]}),cc}var pc,pg;function dM(){return pg||(pg=1,pc=fM()),pc}var hM=dM();const mM=Er(hM),vM="Activiti",gM="http://activiti.org/bpmn",yM="activiti",EM={tagAlias:"lowerCase"},bM=[],xM=JSON.parse('[{"name":"Definitions","isAbstract":true,"extends":["bpmn:Definitions"],"properties":[{"name":"diagramRelationId","isAttr":true,"type":"String"}]},{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","activiti:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"activiti:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true},{"name":"executionListener","isAbstract":true,"type":"Expression"}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"multiinstance_type","superClass":["Element"]},{"name":"multiinstance_condition","superClass":["Element"]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"},{"name":"multiinstance_condition","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["activiti:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","activiti:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["activiti:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","activiti:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["activiti:ServiceTaskLike","activiti:ExecutionListener","activiti:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["activiti:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["activiti:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvent","isAttr":true,"type":"String"}]}]'),_M=[],SM={name:vM,uri:gM,prefix:yM,xml:EM,associations:bM,types:xM,emumerations:_M},wM="Camunda",TM="http://camunda.org/schema/1.0/bpmn",CM="camunda",AM={tagAlias:"lowerCase"},PM=[],RM=JSON.parse('[{"name":"Definitions","isAbstract":true,"extends":["bpmn:Definitions"],"properties":[{"name":"diagramRelationId","isAttr":true,"type":"String"}]},{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity","bpmn:SignalEventDefinition"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","camunda:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"camunda:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"},{"name":"modelerTemplateVersion","isAttr":true,"type":"Integer"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["camunda:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","camunda:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["camunda:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","camunda:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["camunda:ServiceTaskLike","camunda:ExecutionListener","camunda:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["camunda:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["camunda:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true},{"name":"id","type":"String","isAttr":true},{"name":"eventDefinitions","type":"bpmn:TimerEventDefinition","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"FormData","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"fields","type":"FormField","isMany":true},{"name":"businessKey","type":"String","isAttr":true}]},{"name":"FormField","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvents","isAttr":true,"type":"String"}]}]'),IM=[],NM={name:wM,uri:TM,prefix:CM,xml:AM,associations:PM,types:RM,emumerations:IM},MM="Flowable",DM="http://flowable.org/bpmn",kM="flowable",OM={tagAlias:"lowerCase"},LM=[],BM=JSON.parse('[{"name":"InOutBinding","superClass":["Element"],"isAbstract":true,"properties":[{"name":"source","isAttr":true,"type":"String"},{"name":"sourceExpression","isAttr":true,"type":"String"},{"name":"target","isAttr":true,"type":"String"},{"name":"businessKey","isAttr":true,"type":"String"},{"name":"local","isAttr":true,"type":"Boolean","default":false},{"name":"variables","isAttr":true,"type":"String"}]},{"name":"In","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"Out","superClass":["InOutBinding"],"meta":{"allowedIn":["bpmn:CallActivity"]}},{"name":"AsyncCapable","isAbstract":true,"extends":["bpmn:Activity","bpmn:Gateway","bpmn:Event"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false},{"name":"asyncBefore","isAttr":true,"type":"Boolean","default":false},{"name":"asyncAfter","isAttr":true,"type":"Boolean","default":false},{"name":"exclusive","isAttr":true,"type":"Boolean","default":true}]},{"name":"JobPriorized","isAbstract":true,"extends":["bpmn:Process","flowable:AsyncCapable"],"properties":[{"name":"jobPriority","isAttr":true,"type":"String"}]},{"name":"SignalEventDefinition","isAbstract":true,"extends":["bpmn:SignalEventDefinition"],"properties":[{"name":"async","isAttr":true,"type":"Boolean","default":false}]},{"name":"ErrorEventDefinition","isAbstract":true,"extends":["bpmn:ErrorEventDefinition"],"properties":[{"name":"errorCodeVariable","isAttr":true,"type":"String"},{"name":"errorMessageVariable","isAttr":true,"type":"String"}]},{"name":"Error","isAbstract":true,"extends":["bpmn:Error"],"properties":[{"name":"flowable:errorMessage","isAttr":true,"type":"String"}]},{"name":"PotentialStarter","superClass":["Element"],"properties":[{"name":"resourceAssignmentExpression","type":"bpmn:ResourceAssignmentExpression"}]},{"name":"FormSupported","isAbstract":true,"extends":["bpmn:StartEvent","bpmn:UserTask"],"properties":[{"name":"formHandlerClass","isAttr":true,"type":"String"},{"name":"formKey","isAttr":true,"type":"String"},{"name":"formType","isAttr":true,"type":"String"},{"name":"formReadOnly","isAttr":true,"type":"Boolean","default":false},{"name":"formInit","isAttr":true,"type":"Boolean","default":true}]},{"name":"TemplateSupported","isAbstract":true,"extends":["bpmn:Process","bpmn:FlowElement"],"properties":[{"name":"modelerTemplate","isAttr":true,"type":"String"}]},{"name":"Initiator","isAbstract":true,"extends":["bpmn:StartEvent"],"properties":[{"name":"initiator","isAttr":true,"type":"String"}]},{"name":"ScriptTask","isAbstract":true,"extends":["bpmn:ScriptTask"],"properties":[{"name":"resultVariable","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Process","isAbstract":true,"extends":["bpmn:Process"],"properties":[{"name":"candidateStarterGroups","isAttr":true,"type":"String"},{"name":"candidateStarterUsers","isAttr":true,"type":"String"},{"name":"versionTag","isAttr":true,"type":"String"},{"name":"historyTimeToLive","isAttr":true,"type":"String"},{"name":"isStartableInTasklist","isAttr":true,"type":"Boolean","default":true}]},{"name":"EscalationEventDefinition","isAbstract":true,"extends":["bpmn:EscalationEventDefinition"],"properties":[{"name":"escalationCodeVariable","isAttr":true,"type":"String"}]},{"name":"FormalExpression","isAbstract":true,"extends":["bpmn:FormalExpression"],"properties":[{"name":"resource","isAttr":true,"type":"String"}]},{"name":"Assignable","extends":["bpmn:UserTask"],"properties":[{"name":"assignee","isAttr":true,"type":"String"},{"name":"candidateUsers","isAttr":true,"type":"String"},{"name":"candidateGroups","isAttr":true,"type":"String"},{"name":"dueDate","isAttr":true,"type":"String"},{"name":"followUpDate","isAttr":true,"type":"String"},{"name":"priority","isAttr":true,"type":"String"}]},{"name":"Assignee","supperClass":"Element","meta":{"allowedIn":["*"]},"properties":[{"name":"label","type":"String","isAttr":true},{"name":"viewId","type":"Number","isAttr":true}]},{"name":"CallActivity","extends":["bpmn:CallActivity"],"properties":[{"name":"calledElementBinding","isAttr":true,"type":"String","default":"latest"},{"name":"calledElementVersion","isAttr":true,"type":"String"},{"name":"calledElementVersionTag","isAttr":true,"type":"String"},{"name":"calledElementTenantId","isAttr":true,"type":"String"},{"name":"caseRef","isAttr":true,"type":"String"},{"name":"caseBinding","isAttr":true,"type":"String","default":"latest"},{"name":"caseVersion","isAttr":true,"type":"String"},{"name":"caseTenantId","isAttr":true,"type":"String"},{"name":"variableMappingClass","isAttr":true,"type":"String"},{"name":"variableMappingDelegateExpression","isAttr":true,"type":"String"}]},{"name":"ServiceTaskLike","extends":["bpmn:ServiceTask","bpmn:BusinessRuleTask","bpmn:SendTask","bpmn:MessageEventDefinition"],"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"resultVariable","isAttr":true,"type":"String"}]},{"name":"DmnCapable","extends":["bpmn:BusinessRuleTask"],"properties":[{"name":"decisionRef","isAttr":true,"type":"String"},{"name":"decisionRefBinding","isAttr":true,"type":"String","default":"latest"},{"name":"decisionRefVersion","isAttr":true,"type":"String"},{"name":"mapDecisionResult","isAttr":true,"type":"String","default":"resultList"},{"name":"decisionRefTenantId","isAttr":true,"type":"String"}]},{"name":"ExternalCapable","extends":["flowable:ServiceTaskLike"],"properties":[{"name":"type","isAttr":true,"type":"String"},{"name":"topic","isAttr":true,"type":"String"}]},{"name":"TaskPriorized","extends":["bpmn:Process","flowable:ExternalCapable"],"properties":[{"name":"taskPriority","isAttr":true,"type":"String"}]},{"name":"Properties","superClass":["Element"],"meta":{"allowedIn":["*"]},"properties":[{"name":"values","type":"Property","isMany":true}]},{"name":"Property","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true}]},{"name":"Button","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"code","type":"String","isAttr":true},{"name":"isHide","type":"String","isAttr":true},{"name":"next","type":"String","isAttr":true},{"name":"sort","type":"Integer","isAttr":true}]},{"name":"Assignee","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true},{"name":"condition","type":"String","isAttr":true},{"name":"operationType","type":"String","isAttr":true},{"name":"sort","type":"Integer","isAttr":true}]},{"name":"Connector","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"}]},{"name":"InputOutput","superClass":["Element"],"meta":{"allowedIn":["bpmn:FlowNode","flowable:Connector"]},"properties":[{"name":"inputOutput","type":"InputOutput"},{"name":"connectorId","type":"String"},{"name":"inputParameters","isMany":true,"type":"InputParameter"},{"name":"outputParameters","isMany":true,"type":"OutputParameter"}]},{"name":"InputOutputParameter","properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"InputOutputParameterDefinition","isAbstract":true},{"name":"List","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"items","isMany":true,"type":"InputOutputParameterDefinition"}]},{"name":"Map","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"entries","isMany":true,"type":"Entry"}]},{"name":"Entry","properties":[{"name":"key","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"},{"name":"definition","type":"InputOutputParameterDefinition"}]},{"name":"Value","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"id","isAttr":true,"type":"String"},{"name":"name","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Script","superClass":["InputOutputParameterDefinition"],"properties":[{"name":"scriptFormat","isAttr":true,"type":"String"},{"name":"resource","isAttr":true,"type":"String"},{"name":"value","isBody":true,"type":"String"}]},{"name":"Field","superClass":["Element"],"meta":{"allowedIn":["flowable:ServiceTaskLike","flowable:ExecutionListener","flowable:TaskListener"]},"properties":[{"name":"name","isAttr":true,"type":"String"},{"name":"expression","type":"String"},{"name":"stringValue","isAttr":true,"type":"String"},{"name":"string","type":"String"}]},{"name":"ChildField","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true}]},{"name":"InputParameter","superClass":["InputOutputParameter"]},{"name":"OutputParameter","superClass":["InputOutputParameter"]},{"name":"Collectable","isAbstract":true,"extends":["bpmn:MultiInstanceLoopCharacteristics"],"superClass":["flowable:AsyncCapable"],"properties":[{"name":"collection","isAttr":true,"type":"String"},{"name":"elementVariable","isAttr":true,"type":"String"}]},{"name":"FailedJobRetryTimeCycle","superClass":["Element"],"meta":{"allowedIn":["flowable:AsyncCapable","bpmn:MultiInstanceLoopCharacteristics"]},"properties":[{"name":"body","isBody":true,"type":"String"}]},{"name":"ExecutionListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:Task","bpmn:ServiceTask","bpmn:UserTask","bpmn:BusinessRuleTask","bpmn:ScriptTask","bpmn:ReceiveTask","bpmn:ManualTask","bpmn:ExclusiveGateway","bpmn:SequenceFlow","bpmn:ParallelGateway","bpmn:InclusiveGateway","bpmn:EventBasedGateway","bpmn:StartEvent","bpmn:IntermediateCatchEvent","bpmn:IntermediateThrowEvent","bpmn:EndEvent","bpmn:BoundaryEvent","bpmn:CallActivity","bpmn:SubProcess","bpmn:Process"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"TaskListener","superClass":["Element"],"meta":{"allowedIn":["bpmn:UserTask"]},"properties":[{"name":"expression","isAttr":true,"type":"String"},{"name":"class","isAttr":true,"type":"String"},{"name":"delegateExpression","isAttr":true,"type":"String"},{"name":"event","isAttr":true,"type":"String"},{"name":"script","type":"Script"},{"name":"fields","type":"Field","isMany":true}]},{"name":"FormProperty","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"name","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"required","type":"String","isAttr":true},{"name":"readable","type":"String","isAttr":true},{"name":"writable","type":"String","isAttr":true},{"name":"variable","type":"String","isAttr":true},{"name":"expression","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"default","type":"String","isAttr":true},{"name":"values","type":"Value","isMany":true},{"name":"children","type":"ChildField","isMany":true},{"name":"extensionElements","type":"bpmn:ExtensionElements","isMany":true}]},{"name":"FormData","superClass":["Element"],"meta":{"allowedIn":["bpmn:StartEvent","bpmn:UserTask"]},"properties":[{"name":"fields","type":"FormField","isMany":true},{"name":"businessKey","type":"String","isAttr":true}]},{"name":"FormField","superClass":["Element"],"properties":[{"name":"id","type":"String","isAttr":true},{"name":"label","type":"String","isAttr":true},{"name":"type","type":"String","isAttr":true},{"name":"datePattern","type":"String","isAttr":true},{"name":"defaultValue","type":"String","isAttr":true},{"name":"properties","type":"Properties"},{"name":"validation","type":"Validation"},{"name":"values","type":"Value","isMany":true}]},{"name":"Validation","superClass":["Element"],"properties":[{"name":"constraints","type":"Constraint","isMany":true}]},{"name":"Constraint","superClass":["Element"],"properties":[{"name":"name","type":"String","isAttr":true},{"name":"config","type":"String","isAttr":true}]},{"name":"ConditionalEventDefinition","isAbstract":true,"extends":["bpmn:ConditionalEventDefinition"],"properties":[{"name":"variableName","isAttr":true,"type":"String"},{"name":"variableEvent","isAttr":true,"type":"String"}]},{"name":"Condition","superClass":["Element"],"meta":{"allowedIn":["bpmn:SequenceFlow"]},"properties":[{"name":"id","type":"String","isAttr":true},{"name":"field","type":"String","isAttr":true},{"name":"compare","type":"String","isAttr":true},{"name":"value","type":"String","isAttr":true},{"name":"logic","type":"String","isAttr":true},{"name":"sort","type":"Integer","isAttr":true}]}]'),$M=[],VM={name:MM,uri:DM,prefix:kM,xml:OM,associations:LM,types:BM,emumerations:$M},$f=Object.prototype.toString,FM=Object.prototype.hasOwnProperty;function jM(e){return e===void 0}function HM(e){return e==null}function GM(e){return $f.call(e)==="[object Array]"}function zM(e){return $f.call(e)==="[object Object]"}function kb(e){const t=$f.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"||t==="[object Proxy]"}function UM(e,t){return!HM(e)&&FM.call(e,t)}function qM(e,t){const n=YM(t);let i;return WM(e,function(a,r){if(n(a,r))return i=a,!1}),i}function WM(e,t){let n,i;if(jM(e))return;const a=GM(e)?XM:KM;for(let r in e)if(UM(e,r)&&(n=e[r],i=t(n,a(r)),i===!1))return n}function Br(e,t){return!!qM(e,t)}function YM(e){return kb(e)?e:t=>t===e}function KM(e){return e}function XM(e){return Number(e)}function vk(e,...t){return Object.assign(e,...t)}const ZM={FailedJobRetryTimeCycle:["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent","bpmn:Activity"],Connector:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],Field:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"]};function Vf(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}function JM(e){return e&&e.length}function Go(e,t){return JM(e)&&Br(e,function(n){return Vf(n,t)})}function QM(e,t){return Br(t,function(n){return Vf(e,n)})}function fc(e,t,n){const i=t.name,a=ZM[i.replace(/activiti:/,"")];return i===e&&QM(n,a)}function Ff(e){e.on("property.clone",function(t){const n=t.newElement,i=t.propertyDescriptor;this.canCloneProperty(n,i)},this)}Ff.$inject=["eventBus"];Ff.prototype.canCloneProperty=function(e,t){if(fc("activiti:FailedJobRetryTimeCycle",t,e))return Go(e.eventDefinitions,"bpmn:TimerEventDefinition")||Go(e.eventDefinitions,"bpmn:SignalEventDefinition")||Vf(e.loopCharacteristics,"bpmn:MultiInstanceLoopCharacteristics");if(fc("activiti:Connector",t,e)||fc("activiti:Field",t,e))return Go(e.eventDefinitions,"bpmn:MessageEventDefinition")};const eD={__init__:["ActivitiModdleExtension"],ActivitiModdleExtension:["type",Ff]},tD="*";function $r(e){const t=this;e.on("moddleCopy.canCopyProperty",function(n){const i=n.property,a=n.parent;return t.canCopyProperty(i,a)})}$r.$inject=["eventBus"];$r.prototype.canCopyProperty=function(e,t){if(zM(e)&&!nD(e,t)||yr(e,"camunda:InputOutput")&&!this.canHostInputOutput(t)||Ob(e,["camunda:Connector","camunda:Field"])&&!this.canHostConnector(t)||yr(e,"camunda:In")&&!this.canHostIn(t))return!1};$r.prototype.canHostInputOutput=function(e){if(yn(e,"camunda:Connector"))return!0;const n=yn(e,"bpmn:FlowNode");return!n||Ob(n,["bpmn:StartEvent","bpmn:Gateway","bpmn:BoundaryEvent"])?!1:!(yr(n,"bpmn:SubProcess")&&n.get("triggeredByEvent"))};$r.prototype.canHostConnector=function(e){const t=yn(e,"camunda:ServiceTaskLike");return yr(t,"bpmn:MessageEventDefinition")?yn(e,"bpmn:IntermediateThrowEvent")||yn(e,"bpmn:EndEvent"):!0};$r.prototype.canHostIn=function(e){return yn(e,"bpmn:CallActivity")?!0:yn(e,"bpmn:SignalEventDefinition")?yn(e,"bpmn:IntermediateThrowEvent")||yn(e,"bpmn:EndEvent"):!0};function yr(e,t){return e&&kb(e.$instanceOf)&&e.$instanceOf(t)}function Ob(e,t){return Br(t,function(n){return yr(e,n)})}function yn(e,t){if(!t)return e.$parent;if(yr(e,t))return e;if(e.$parent)return yn(e.$parent,t)}function nD(e,t){const n=e.$type&&e.$model.getTypeDescriptor(e.$type),i=n&&n.meta&&n.meta.allowedIn;return!i||iD(i)?!0:Br(i,function(a){return yn(t,a)})}function iD(e){return e.indexOf(tD)!==-1}const rD={__init__:["camundaModdleExtension"],camundaModdleExtension:["type",$r]},aD={FailedJobRetryTimeCycle:["bpmn:StartEvent","bpmn:BoundaryEvent","bpmn:IntermediateCatchEvent","bpmn:Activity"],Connector:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"],Field:["bpmn:EndEvent","bpmn:IntermediateThrowEvent"]};function jf(e,t){return e&&typeof e.$instanceOf=="function"&&e.$instanceOf(t)}function oD(e){return e&&e.length}function zo(e,t){return oD(e)&&Br(e,function(n){return jf(n,t)})}function sD(e,t){return Br(t,function(n){return jf(e,n)})}function dc(e,t,n){const i=t.name,a=aD[i.replace(/flowable:/,"")];return i===e&&sD(n,a)}function Hf(e){e.on("property.clone",function(t){const n=t.newElement,i=t.propertyDescriptor;this.canCloneProperty(n,i)},this)}Hf.$inject=["eventBus"];Hf.prototype.canCloneProperty=function(e,t){if(dc("flowable:FailedJobRetryTimeCycle",t,e))return zo(e.eventDefinitions,"bpmn:TimerEventDefinition")||zo(e.eventDefinitions,"bpmn:SignalEventDefinition")||jf(e.loopCharacteristics,"bpmn:MultiInstanceLoopCharacteristics");if(dc("flowable:Connector",t,e)||dc("flowable:Field",t,e))return zo(e.eventDefinitions,"bpmn:MessageEventDefinition")};const lD={__init__:["FlowableModdleExtension"],FlowableModdleExtension:["type",Hf]};var uD=Object.defineProperty,ys=Object.getOwnPropertySymbols,Lb=Object.prototype.hasOwnProperty,Bb=Object.prototype.propertyIsEnumerable,np=(e,t,n)=>t in e?uD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,$b=(e,t)=>{for(var n in t||(t={}))Lb.call(t,n)&&np(e,n,t[n]);if(ys)for(var n of ys(t))Bb.call(t,n)&&np(e,n,t[n]);return e},cD=(e,t)=>{var n={};for(var i in e)Lb.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&ys)for(var i of ys(e))t.indexOf(i)<0&&Bb.call(e,i)&&(n[i]=e[i]);return n},oi=(e,t,n)=>(np(e,typeof t!="symbol"?t+"":t,n),n);function mn(e){return e==null}function Gf(e){return typeof e=="string"}function pD(e){return typeof e=="boolean"}var He;(function(e){e.Root="Root",e.Declaration="Declaration",e.Comment="Comment",e.DocumentType="DocumentType",e.Element="Element",e.Text="Text",e.Instruction="Instruction",e.CDATA="CDATA"})(He||(He={}));var Xt=class{constructor(e,t=null,n=null){oi(this,"name"),oi(this,"type"),oi(this,"parent"),oi(this,"children"),oi(this,"attributes"),oi(this,"value"),oi(this,"selfClosing"),oi(this,"prefix"),this.name="",this.type=e,this.parent=t,this.value=n,this.children=null,this.attributes={},this.selfClosing=!1,this.prefix=""}setName(e){return this.name=e,this}setType(e){return this.type=e,this}setParent(e){return this.parent=e,this}setChildren(e){return this.children=e&&Array.from(e),this}setAttributes(e){return this.attributes=$b({},e),this}setValue(e){return this.value=e,this}setSelfClosing(e){return this.selfClosing=e,this}setPrefix(e){return this.prefix=e,this}addAttribute(e,t){return this.attributes[e]=t,this}removeAttribute(e){return delete this.attributes[e],this}addChild(e){return e===this?this:(this.children||(this.children=[]),this.children.push(e),e.parent!==this&&(e.parent=this),this)}removeChild(e){if(this.children&&this.children.length){const t=this.children.findIndex(n=>n===e);~t&&(this.children.splice(t,1),e.parent=null)}return this}toJsObject(){return{name:this.name||void 0,prefix:this.prefix||void 0,type:this.type,attributes:Object.keys(this.attributes).length?this.attributes:void 0,value:mn(this.value)?void 0:this.value,selfClosing:this.selfClosing||void 0,children:(this.type===He.Element||this.type===He.Root)&&this.children&&this.children.length?this.children.map(e=>e.toJSON()):void 0}}toXmlString(e="  ",t=`
`,n=0){const i=e.repeat(n);let a="";switch(this.type){case He.Root:{a+=this.children&&this.children.length?this.children.map(r=>r.toXmlString(e,t,n)).join(t):"";break}case He.Element:{if(!this.name)return"";const r=this.prefix?`${this.prefix}:${this.name}`:this.name;a+=`${i}<${r}`;const o=fg(this.attributes||{});o&&(a+=` ${o}`),this.children&&this.children.length?a+=`>${t}${this.children.map(s=>s.toXmlString(e,t,n+1)).join(t)}${t}${i}</${r}>`:a+=this.selfClosing?" />":`></${r}>`;break}case He.CDATA:{a+=`${i}<![CDATA[${mn(this.value)?"":this.value}]]>`;break}case He.Text:{a+=mn(this.value)?"":`${i}${this.value}`;break}case He.DocumentType:{a+=mn(this.value)?"":`${i}<!DOCTYPE ${this.value}>`;break}case He.Comment:{a+=`${i}<!-- ${mn(this.value)?"":this.value+" "}-->`;break}case He.Declaration:{if(a+=`${i}<?xml `,!this.attributes||mn(this.attributes.version))a+='version="1.0" ';else{const r=parseFloat(this.attributes.version);a+=`version="${Number.isNaN(r)?"1.0":r.toFixed(1)}" `}if(this.attributes){const r=this.attributes,{version:o}=r,s=cD(r,["version"]);s&&(a+=fg(s))}a+="?>";break}case He.Instruction:{a+=mn(this.value)?"":`${i}<?${this.value}?>`;break}}return a}toJSON(){return this.toJsObject()}toString(){return this.toXmlString("","")}};function fg(e){return Object.keys(e).map(t=>{const n=e[t];return mn(n)?null:pD(n)?n?t:null:`${t}="${n}"`}).filter(Boolean).join(" ")}var dg=e=>e,Vb={ignoreAttributes:!1,parseNodeValue:!0,trimValues:!0,prefixInName:!1,valueProcessor:dg,attributeProcessor:dg},fD=Object.keys(Vb);function dD(e={}){const t=$b({},e);return fD.forEach(n=>{mn(t[n])&&(t[n]=Vb[n])}),t}var Ii="Tag is not closed.";function hD(e,t={}){const n=e.replace(/\r\n?/g,`
`),i=dD(t),a=n.length,r=new Xt(He.Root);let o=r,s="";for(let l=0;l<a;l++){const c=n[l];if(c!=="<")s+=c;else if(n[l+1]==="/"){const p=rr(n,">",l,`Element End ${Ii}`);let f=n.substring(l+2,p),h="";if(!i.prefixInName){const v=f.indexOf(":");~v&&(h=f.substring(0,v),f=f.substring(v+1))}if(o.prefix!==h||o.name!==f)throw new Error("End Tag is incorrect.");if(s){const v=hc(Ni("",He.Text,s,i));v&&o.addChild(new Xt(He.Text,o,v))}o=o.parent,s="",l=p}else if(n[l+1]==="?"){const p=rr(n,"?>",l,`Processing Instruction ${Ii}`),f=n.substring(l+2,p-1);if(o)if(f.startsWith("xml ")&&f.includes("version=")&&o.type===He.Root){const h=new Xt(He.Declaration,o);h.attributes=mc(f.substr(4),He.Declaration,i),o.addChild(h)}else o.addChild(new Xt(He.Instruction,o,Ni("",He.Instruction,f,i)));l=p}else if(n.substr(l+1,3)==="!--"){const p=rr(n,"-->",l,`Comment ${Ii}`),f=n.substring(l+4,p-2);o&&o.addChild(new Xt(He.Comment,o,Ni("",He.Comment,f,i))),l=p}else if(n.substr(l+1,8)==="!DOCTYPE"){let p=rr(n,">",l,`Document Type ${Ii}`),f=n.substring(l+9,p);f.includes("[")&&(p=rr(n,"]>",l,`Document Type ${Ii}`),f=n.substring(l+9,p)),o&&o.addChild(new Xt(He.DocumentType,o,Ni("",He.DocumentType,f,i))),l=p}else if(n.substr(l+1,8)==="![CDATA["){const p=rr(n,"]]>",l,`CDATA Section ${Ii}`),f=n.substring(l+9,p-2);if(o&&s){const h=hc(Ni("",He.Text,s,i));h&&o.addChild(new Xt(He.Text,o,h))}o.addChild(new Xt(He.CDATA,o,Ni("",He.CDATA,f,i))),s="",l=p}else{let p="",f="",h=l+1;for(;h<=a;){let b=n[h];if(p)b===p&&(p="");else if(b==='"'||b==="'")p=b;else if(b==="	")b=" ";else if(b===">")break;f+=b,h++}if(h>a)throw new Error(`Element ${Ii}`);f=f.trim();const v=f.indexOf(" ");let m=f,_="";if(~v?(m=f.substr(0,v),f=f.substr(v+1)):f="",!i.prefixInName){const b=m.indexOf(":");~b&&(_=m.substring(0,b),m=m.substring(b+1))}if(o&&s){const b=hc(Ni("",He.Text,s,i));b&&o.addChild(new Xt(He.Text,o,b))}if(f.length&&f.lastIndexOf("/")===f.length-1){m[m.length-1]==="/"?(m=m.substr(0,m.length-1),f=""):f=f.substr(0,f.length-1);const b=new Xt(He.Element,o);b.name=m,b.selfClosing=!0,b.prefix=_,f&&!i.ignoreAttributes&&(b.attributes=mc(f,He.Element,i)),o.addChild(b)}else{const b=new Xt(He.Element,o);f&&!i.ignoreAttributes&&(b.attributes=mc(f,He.Element,i)),b.name=m,b.prefix=_,o.addChild(b),o=b}s="",l=h}}return r}function rr(e,t,n,i){const a=e.indexOf(t,n);if(!~a)throw new Error(i);return a+t.length-1}function Ni(e,t,n,i){return n?(i.trimValues&&(n=n.trim()),Fb(i.valueProcessor(n,t,e),i.parseNodeValue)):null}function Fb(e,t){return t&&Gf(e)?(e=e.trim(),e==="true"?!0:e==="false"?!1:mD(e)):mn(e)?null:e}function mD(e){const t=parseFloat(e);return Number.isNaN(t)?e:t}function hc(e){return mn(e)?"":Gf(e)?e:String(e)}var vD=/[^\s=]+\s*(=\s*['"][\s\S]*?['"])?/g;function mc(e,t,n){e=e.replace(/\r?\n/g," ");const i=e.match(vD)||[],a={};for(let r=0;r<i.length;r++){const o=i[r];let[s,l]=o.split("=");s=s.trim(),Gf(l)?(l=l.substring(1,l.length-1),n.trimValues&&(l=l.trim()),a[s]=Fb(n.attributeProcessor(l,s,t),n.parseNodeValue)):a[s]=!0}return a}const gD={class:"my-process-designer"},yD={class:"my-process-designer__header",style:{"z-index":"999",display:"table-row-group"}},ED={style:{color:"#409eff"}},bD={class:"my-process-designer__container"},xD={class:"hljs"},vc=Mt({name:"MyProcessDesigner",__name:"ProcessDesigner",props:{value:String,processId:String,processName:String,formId:Number,translations:{type:Object,default:()=>{}},additionalModel:[Object,Array],moddleExtension:{type:Object,default:()=>{}},onlyCustomizeAddi:{type:Boolean,default:!1},onlyCustomizeModdle:{type:Boolean,default:!1},simulation:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},prefix:{type:String,default:"camunda"},events:{type:Array,default:()=>["element.click"]},headerButtonSize:{type:String,default:"small",validator:e=>["default","medium","small","mini"].indexOf(e)!==-1},headerButtonType:{type:String,default:"primary",validator:e=>["default","primary","success","warning","danger","info"].indexOf(e)!==-1}},emits:["destroy","init-finished","save","commandStack-changed","input","change","canvas-viewbox-changed","element-click"],setup(e,{emit:t}){const n=ie(),i=ie(),a=t,r=e;is("configGlobal",r);let o=null;const s=ie(1),l=ie(!1),c=ie(!1),p=ie(""),f=ie("xml"),h=ie(!1),v=ie(!1),m=Ec(()=>{console.log(r.additionalModel,"additionalModel");const C=[];if(r.onlyCustomizeAddi)return Object.prototype.toString.call(r.additionalModel)=="[object Array]"?r.additionalModel||[]:[r.additionalModel];Object.prototype.toString.call(r.additionalModel)=="[object Array]"?C.push(...r.additionalModel):r.additionalModel&&C.push(r.additionalModel);const x={translate:["value",XI(r.translations||ZI)]};return C.push(x),r.simulation&&C.push(mM),console.log(r.prefix,"props.prefix "),r.prefix==="camunda"&&C.push(rD),r.prefix==="flowable"&&C.push(lD),r.prefix==="activiti"&&C.push(eD),C}),_=Ec(()=>{console.log(r.onlyCustomizeModdle,"props.onlyCustomizeModdle"),console.log(r.moddleExtension,"props.moddleExtension"),console.log(r.prefix,"props.prefix");const C={};if(r.onlyCustomizeModdle)return r.moddleExtension||null;if(r.moddleExtension)for(const x in r.moddleExtension)C[x]=r.moddleExtension[x];return r.prefix==="activiti"&&(C.activiti=SM),r.prefix==="flowable"&&(C.flowable=VM),r.prefix==="camunda"&&(C.camunda=NM),C});console.log(m,"additionalModules()"),console.log(_,"moddleExtensions()");const b=()=>{if(o)return;const C=document.getElementById("bpmnCanvas");console.log(C,"data"),console.log(r.keyboard,"props.keyboard"),console.log(m,"additionalModules()"),console.log(_,"moddleExtensions()"),o=new Rn({container:C,keyboard:r.keyboard?{bindTo:document}:null,additionalModules:m.value,moddleExtensions:_.value}),console.log(o,"bpmnModeler111111"),a("init-finished",o),M()},M=()=>{const C=o.get("eventBus");console.log(C,"EventBus"),r.events.forEach(x=>{C.on(x,function(R){const D=x.replace(/\./g,"-"),L=R?R.element:null;console.log(D,"eventName"),console.log(L,"element"),a("element-click",L,R)})}),C.on("commandStack.changed",async x=>{try{h.value=o.get("commandStack").canRedo(),v.value=o.get("commandStack").canUndo();const{xml:R}=await o.saveXML({format:!0});a("commandStack-changed",x),a("input",R),a("change",R)}catch(R){console.error(`[Process Designer Warn]: ${R.message||R}`)}}),o.on("canvas.viewbox.changed",({viewbox:x})=>{a("canvas-viewbox-changed",{viewbox:x});const{scale:R}=x;s.value=Math.floor(R*100)/100})},P=async C=>{console.log(C,"xml");const x=r.processId||`Process_${new Date().getTime()}`,R=r.processName||`业务流程_${new Date().getTime()}`,D=C||Db(x,R,r.prefix);try{const{warnings:L}=await o.importXML(D);console.log(L,"warnings"),L&&L.length&&L.forEach(X=>console.warn(X))}catch(L){console.error(`[Process Designer Warn]: ${L.message||L}`)}},S=async C=>{try{if(C==="xml"||C==="bpmn"){const{err:R,xml:D}=await o.saveXML();R&&console.error(`[Process Designer Warn ]: ${R.message||R}`);const{href:L,filename:X}=w(C.toUpperCase(),D);x(L,X)}else{const{err:R,svg:D}=await o.saveSVG();if(R)return console.error(R);const{href:L,filename:X}=w("SVG",D);x(L,X)}}catch(R){console.error(`[Process Designer Warn ]: ${R.message||R}`)}function x(R,D){if(R&&D){const L=document.createElement("a");L.download=D,L.href=R,L.click(),URL.revokeObjectURL(L.href)}}},w=(C,x)=>{const R="diagram",D=encodeURIComponent(x);return{filename:`${R}.${C}`,href:`data:application/${C==="svg"?"text/xml":"bpmn20-xml"};charset=UTF-8,${D}`,data:x}},T=()=>{const C=i.value.files[0],x=new FileReader;x.readAsText(C),x.onload=function(){const R=this.result;P(R)}},N=()=>{S("xml")},B=()=>{S("bpmn")},$=()=>{S("svg")},H=()=>{c.value=!c.value,console.log(o.get("toggleMode","strict"),"bpmnModeler.get('toggleMode')"),r.simulation&&o.get("toggleMode","strict").toggleMode()},Z=()=>{o.get("commandStack").redo()},Y=()=>{o.get("commandStack").undo()},z=(C=.1)=>{const x=Math.floor(s.value*100+C*100)/100;if(x>4)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be greater than 4");s.value=x,o.get("canvas").zoom(s.value)},G=(C=.1)=>{const x=Math.floor(s.value*100-C*100)/100;if(x<.2)throw new Error("[Process Designer Warn ]: The zoom ratio cannot be less than 0.2");s.value=x,o.get("canvas").zoom(s.value)},se=()=>{s.value=1,o.get("canvas").zoom("fit-viewport","auto")},u=()=>{h.value=!1,v.value=!1,P(null)},d=C=>{const x=o.get("alignElements"),D=o.get("selection").get();if(!D||D.length<=1){lx.warning("请按住 Shift 键选择多个元素对齐");return}lr.confirm("自动对齐可能造成图形变形，是否继续？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{x.trigger(D,C)})},E=()=>{console.log(o.saveXML,"bpmnModeler"),o.saveXML({format:!0}).then(({xml:C})=>{p.value=C,f.value="xml",l.value=!0})},y=()=>{o.saveXML({format:!0}).then(({xml:C})=>{const x=new Xt(He.Root,hD(C));p.value=x.parent?.toJSON(),f.value="json",l.value=!0})},g=async()=>{console.log(o,"bpmnModelerbpmnModelerbpmnModelerbpmnModeler");const{err:C,xml:x}=await o.saveXML();if(console.log(C,"errerrerrerrerr"),console.log(x,"xmlxmlxmlxmlxml"),C){alert("保存模型失败，请重试！");return}a("save",x)};return rx(()=>{console.log(r,"propspropspropsprops")}),ya(()=>{b(),P(r.value)}),Mn(()=>{o&&o.destroy(),a("destroy",o),o=null}),(C,x)=>{const R=br,D=mx,L=ce("el-tooltip"),X=ce("el-button-group"),K=ce("el-button"),W=sx,oe=ax("highlight");return ve(),Xe("div",gD,[Je("div",yD,[ox(C.$slots,"control-header"),C.$slots["control-header"]?Ge("",!0):(ve(),Xe(Zt,{key:0},[O(X,{key:"file-control"},{default:U(()=>[O(R,{"pre-icon":"ep:folder-opened",title:"打开文件",onClick:x[0]||(x[0]=ee=>V(i).click())}),O(L,{effect:"light",placement:"bottom"},{content:U(()=>[Je("div",ED,[O(D,{title:"下载为XML文件",onClick:x[1]||(x[1]=ee=>N())}),x[17]||(x[17]=Je("br",null,null,-1)),O(D,{title:"下载为SVG文件",onClick:x[2]||(x[2]=ee=>$())}),x[18]||(x[18]=Je("br",null,null,-1)),O(D,{title:"下载为BPMN文件",onClick:x[3]||(x[3]=ee=>B())})])]),default:U(()=>[O(R,{"pre-icon":"ep:download",title:"下载文件"})]),_:1}),O(L,{effect:"light"},{content:U(()=>[O(D,{title:"预览XML",onClick:E}),x[19]||(x[19]=Je("br",null,null,-1)),O(D,{title:"预览JSON",onClick:y})]),default:U(()=>[O(R,{"pre-icon":"ep:view",title:"浏览"})]),_:1}),r.simulation?(ve(),Fe(L,{key:0,content:V(c)?"退出模拟":"开启模拟",effect:"light"},{default:U(()=>[O(R,{"pre-icon":"ep:cpu",title:"模拟",onClick:H})]),_:1},8,["content"])):Ge("",!0)]),_:1}),O(X,{key:"align-control"},{default:U(()=>[O(L,{content:"向左对齐",effect:"light"},{default:U(()=>[O(R,{class:"align align-bottom","pre-icon":"fa:align-left",onClick:x[4]||(x[4]=ee=>d("left"))})]),_:1}),O(L,{content:"向右对齐",effect:"light"},{default:U(()=>[O(R,{class:"align align-top","pre-icon":"fa:align-left",onClick:x[5]||(x[5]=ee=>d("right"))})]),_:1}),O(L,{content:"向上对齐",effect:"light"},{default:U(()=>[O(R,{class:"align align-left","pre-icon":"fa:align-left",onClick:x[6]||(x[6]=ee=>d("top"))})]),_:1}),O(L,{content:"向下对齐",effect:"light"},{default:U(()=>[O(R,{class:"align align-right","pre-icon":"fa:align-left",onClick:x[7]||(x[7]=ee=>d("bottom"))})]),_:1}),O(L,{content:"水平居中",effect:"light"},{default:U(()=>[O(R,{class:"align align-center","pre-icon":"fa:align-left",onClick:x[8]||(x[8]=ee=>d("center"))})]),_:1}),O(L,{content:"垂直居中",effect:"light"},{default:U(()=>[O(R,{class:"align align-middle","pre-icon":"fa:align-left",onClick:x[9]||(x[9]=ee=>d("middle"))})]),_:1})]),_:1}),O(X,{key:"scale-control"},{default:U(()=>[O(L,{content:"缩小视图",effect:"light"},{default:U(()=>[O(R,{disabled:V(s)<.2,"pre-icon":"ep:zoom-out",onClick:x[10]||(x[10]=ee=>G())},null,8,["disabled"])]),_:1}),O(K,null,{default:U(()=>[Ne(td(Math.floor(V(s)*10*10)+"%"),1)]),_:1}),O(L,{content:"放大视图",effect:"light"},{default:U(()=>[O(R,{disabled:V(s)>4,"pre-icon":"ep:zoom-in",onClick:x[11]||(x[11]=ee=>z())},null,8,["disabled"])]),_:1}),O(L,{content:"重置视图并居中",effect:"light"},{default:U(()=>[O(R,{"pre-icon":"ep:scale-to-original",onClick:x[12]||(x[12]=ee=>se())})]),_:1})]),_:1}),O(X,{key:"stack-control"},{default:U(()=>[O(L,{content:"撤销",effect:"light"},{default:U(()=>[O(R,{disabled:!V(v),"pre-icon":"ep:refresh-left",onClick:x[13]||(x[13]=ee=>Y())},null,8,["disabled"])]),_:1}),O(L,{content:"恢复",effect:"light"},{default:U(()=>[O(R,{disabled:!V(h),"pre-icon":"ep:refresh-right",onClick:x[14]||(x[14]=ee=>Z())},null,8,["disabled"])]),_:1}),O(L,{content:"重新绘制",effect:"light"},{default:U(()=>[O(R,{"pre-icon":"ep:refresh",onClick:x[15]||(x[15]=ee=>u())})]),_:1})]),_:1}),O(R,{disabled:V(c),"pre-icon":"ep:plus",title:"保存模型",type:r.headerButtonType,onClick:g},null,8,["disabled","type"])],64)),Je("input",{id:"files",ref_key:"refFile",ref:i,accept:".xml, .bpmn",style:{display:"none"},type:"file",onChange:T},null,544)]),Je("div",bD,[Je("div",{id:"bpmnCanvas",ref_key:"bpmnCanvas",ref:n,class:"my-process-designer__canvas",style:{width:"1680px",height:"800px"}},null,512)]),O(W,{modelValue:V(l),"onUpdate:modelValue":x[16]||(x[16]=ee=>tn(l)?l.value=ee:null),"max-height":"600px",scroll:!0,title:"预览",width:"80%"},{default:U(()=>[ns((ve(),Xe("div",null,[Je("code",xD,td(V(p)),1)])),[[oe]])]),_:1},8,["modelValue"])])}}}),_D={class:"my-process-designer"},SD={class:"my-process-designer__container"},gc=Mt({name:"MyProcessViewer",__name:"ProcessViewer",props:{value:{type:String,default:""},prefix:{type:String,default:"camunda"},activityData:{type:Array,default:()=>[]},processInstanceData:{type:Object,default:()=>{}},taskData:{type:Array,default:()=>[]}},emits:["destroy"],setup(e,{emit:t}){const n=e;is("configGlobal",n);const i=t;let a;const r=ie(""),o=ie([]),s=ie(void 0),l=ie([]),c=ie(),p=ie(null),f=ie(null),h=()=>{a||(a=new Kn({container:c.value,bpmnRenderer:{}}))},v=async T=>{const N=`Process_${new Date().getTime()}`,B=`业务流程_${new Date().getTime()}`,$=T||Db(N,B,n.prefix);try{const{warnings:H}=await a.importXML($);H&&H.length&&H.forEach(Y=>console.warn(Y)),await m(),a.get("canvas").zoom("fit-viewport","auto")}catch(H){console.error(H)}},m=async()=>{const T=o.value;if(T.length===0)return;const N=a.get("canvas"),B=T.find(Y=>!Y.endTime),$=T[T.length-1];let H=!1;const Z=[];a.getDefinitions().rootElements[0].flowElements?.forEach(Y=>{const z=T.find(G=>G.key===Y.id);if(z)if(Y.$type==="bpmn:UserTask"){const G=l.value.find(u=>u.id===z.taskId);if(!G)return;if(H){Z.push(Y.id);return}if(N.addMarker(Y.id,b(G.result)),G.result===1&&(H=!0),G.result!==2)return;M(z)?.forEach(u=>{const d=T.find(E=>E.key===u.targetRef.id);d?N.addMarker(u.id,d.endTime?"highlight":"highlight-todo"):u.targetRef.$type==="bpmn:ExclusiveGateway"?(N.addMarker(u.id,z.endTime?"highlight":"highlight-todo"),N.addMarker(u.targetRef.id,z.endTime?"highlight":"highlight-todo")):u.targetRef.$type==="bpmn:EndEvent"&&(!B&&$.key===Y.id&&(N.addMarker(u.id,"highlight"),N.addMarker(u.targetRef.id,"highlight")),z.endTime||(N.addMarker(u.id,"highlight-todo"),N.addMarker(u.targetRef.id,"highlight-todo")))})}else if(Y.$type==="bpmn:ExclusiveGateway"){N.addMarker(Y.id,_(z));let G,se;Y.outgoing?.forEach(u=>{const d=T.find(E=>E.key===u.targetRef.id);d&&(!se||se.type==="endEvent")&&(G=u,se=d)}),G&&se&&N.addMarker(G.id,_(se))}else if(Y.$type==="bpmn:ParallelGateway")N.addMarker(Y.id,_(z)),Y.outgoing?.forEach(G=>{const se=T.find(u=>u.key===G.targetRef.id);se&&(N.addMarker(G.id,_(se)),N.addMarker(G.targetRef.id,_(se)))});else if(Y.$type==="bpmn:StartEvent")Y.outgoing?.forEach(G=>{T.find(u=>u.key===G.targetRef.id)&&(N.addMarker(G.id,"highlight"),N.addMarker(Y.id,"highlight"))});else if(Y.$type==="bpmn:EndEvent"){if(!s.value||s.value.result===1)return;N.addMarker(Y.id,b(s.value.result))}else Y.$type==="bpmn:ServiceTask"&&(z.startTime>0&&z.endTime===0&&N.addMarker(Y.id,b(1)),z.endTime>0&&(N.addMarker(Y.id,b(2)),M(z)?.forEach(se=>{N.addMarker(se.id,b(2))})))}),ux(Z)||(l.value=l.value.filter(Y=>!Z.includes(Y.definitionKey)))},_=T=>T.endTime?"highlight":"highlight-todo",b=T=>T===1?"highlight-todo":T===2?"highlight":T===3?"highlight-reject":T===4?"highlight-cancel":T===5||T===6||T===7||T===8||T===9?"highlight-return":"",M=T=>{if(T.outgoing&&T.outgoing.length>0)return T.outgoing;const N=a.getDefinitions().rootElements[0].flowElements,B=[];return N.forEach($=>{$.$type==="bpmn:SequenceFlow"&&$.sourceRef.id===T.key&&B.push($)}),B},P=()=>{const T=a.get("eventBus");T.on("element.hover",function(N){const B=N?N.element:null;S(B)}),T.on("element.out",function(N){const B=N?N.element:null;w(B)})},S=T=>{T.value=T,!p.value&&(p.value={}),!f.value&&(f.value=a.get("overlays")),console.log(o.value,"activityLists.value"),console.log(T.value,"element.value");const N=o.value.find(B=>B.key===T.value.id);if(console.log(N,"activityactivityactivityactivity"),!!N&&!p.value[T.value.id]&&T.value.type!=="bpmn:Process"){let B=`<div class="element-overlays">
            <p>Elemet id: ${T.value.id}</p>
            <p>Elemet type: ${T.value.type}</p>
          </div>`;if(T.value.type==="bpmn:StartEvent"&&s.value)B=`<p>发起人：${s.value.startUser.nickname}</p>
                  <p>部门：${s.value.startUser.deptName}</p>
                  <p>创建时间：${Ji(s.value.createTime)}`;else if(T.value.type==="bpmn:UserTask"){const $=l.value.find(Y=>Y.id===N.taskId);if(!$)return;const H=nd(id.BPM_PROCESS_INSTANCE_RESULT);let Z="";H.forEach(Y=>{Y.value==$.result&&(Z=Y.label)}),B=`<p>审批人：${$.assigneeUser.nickname}</p>
                  <p>部门：${$.assigneeUser.deptName}</p>
                  <p>结果：${Z}</p>
                  <p>创建时间：${Ji($.createTime)}</p>`,$.endTime&&(B+=`<p>结束时间：${Ji($.endTime)}</p>`),$.reason&&(B+=`<p>审批建议：${$.reason}</p>`)}else if(T.value.type==="bpmn:ServiceTask"&&s.value)N.startTime>0&&(B=`<p>创建时间：${Ji(N.startTime)}</p>`),N.endTime>0&&(B+=`<p>结束时间：${Ji(N.endTime)}</p>`),console.log(B);else if(T.value.type==="bpmn:EndEvent"&&s.value){const $=nd(id.BPM_PROCESS_INSTANCE_RESULT);let H="";$.forEach(Z=>{Z.value==s.value.result&&(H=Z.label)}),B=`<p>结果：${H}</p>`,s.value.endTime&&(B+=`<p>结束时间：${Ji(s.value.endTime)}</p>`)}console.log(B,"html111111111111111"),p.value[T.value.id]=Ke(f.value)?.add(T.value,{position:{left:0,bottom:0},html:`<div class="element-overlays">${B}</div>`})}},w=T=>{Ke(f.value).remove({element:T}),p.value[T.id]=null};return ya(()=>{r.value=n.value,o.value=n.activityData,h(),v(r.value),P()}),Mn(()=>{a&&a.destroy(),i("destroy",a),a=null}),vt(()=>n.value,T=>{r.value=T,v(r.value)}),vt(()=>n.activityData,T=>{o.value=T,v(r.value)}),vt(()=>n.processInstanceData,T=>{s.value=T,v(r.value)}),vt(()=>n.taskData,T=>{l.value=T,v(r.value)}),(T,N)=>(ve(),Xe("div",_D,[Je("div",SD,[Je("div",{ref_key:"bpmnCanvas",ref:c,class:"my-process-designer__canvas",style:{height:"760px"}},null,512)])]))}}),wD={class:"panel-tab__content"},TD={key:0},CD={key:1},AD=Mt({name:"ElementBaseInfo",__name:"ElementBaseInfo",props:{businessObject:{type:Object,default:()=>{}},model:{type:Object,default:()=>{}}},setup(e){const t=e,n=ie({}),i=ie(),a=ie({}),r=cx({id:[{required:!0,message:"流程标识不能为空",trigger:"blur"}],name:[{required:!0,message:"流程名称不能为空",trigger:"blur"}]}),o=()=>window?.bpmnInstances,s=()=>{console.log(window,"window"),console.log(i.value,"bpmnElement"),i.value=o()?.bpmnElement,console.log(i.value,"resetBaseInfo11111111111"),a.value=i.value.businessObject,n.value.type=i.value.businessObject.$type,console.log(a.value,"elementBaseInfo22222222222")},l=f=>{if(f){if(!f.match(/[a-zA-Z_][-_.0-9a-zA-Z$]*/)){console.log("key 不满足 XML NCName 规则，所以不进行赋值");return}console.log("key 满足 XML NCName 规则，所以进行赋值"),a.value.id=f,setTimeout(()=>{p("id")},100)}},c=f=>{console.log(a,"elementBaseInfo"),f&&(a.value.name=f,setTimeout(()=>{p("name")},100))},p=f=>{console.log(f,"key");const h=Object.create(null);h[f]=a.value[f],console.log(a,"elementBaseInfo11111111111"),n.value={...a.value,...n.value},f==="id"?(console.log("jinru"),console.log(window,"window"),console.log(i.value,"bpmnElement"),console.log(Ke(i.value),"bpmnElement"),o().modeling.updateProperties(Ke(i.value),{id:a.value[f],di:{id:`${a.value[f]}_di`}})):(console.log(h,"attrObj"),o().modeling.updateProperties(Ke(i.value),h))};return ya(()=>{setTimeout(()=>{console.log(t.model,"props.model"),l(t.model.key),c(t.model.name),console.log(t,"propsssssssssssssssssssss")},1e3)}),vt(()=>t.businessObject,f=>{console.log(f,"val11111111111111111111"),f&&s()}),Mn(()=>{i.value=null}),(f,h)=>{const v=ce("el-link"),m=ce("el-input"),_=ce("el-form-item"),b=ce("el-form");return ve(),Xe("div",wD,[O(b,{"label-width":"90px",model:V(n),rules:V(r)},{default:U(()=>[V(n).type=="bpmn:Process"?(ve(),Xe("div",TD,[O(v,{href:"https://doc.iocoder.cn/bpm/#_3-%E6%B5%81%E7%A8%8B%E5%9B%BE%E7%A4%BA%E4%BE%8B",target:"_blank",type:"danger"},{default:U(()=>h[6]||(h[6]=[Ne(" 如何实现实现会签、或签？ ")])),_:1}),O(_,{label:"流程标识",prop:"id"},{default:U(()=>[O(m,{modelValue:V(n).id,"onUpdate:modelValue":h[0]||(h[0]=M=>V(n).id=M),disabled:V(n).id!==void 0&&V(n).id.length>0,placeholder:"请输入流标标识",onChange:l},null,8,["modelValue","disabled"])]),_:1}),O(_,{label:"流程名称",prop:"name"},{default:U(()=>[O(m,{modelValue:V(n).name,"onUpdate:modelValue":h[1]||(h[1]=M=>V(n).name=M),clearable:"",placeholder:"请输入流程名称",onChange:c},null,8,["modelValue"])]),_:1})])):(ve(),Xe("div",CD,[O(_,{label:"ID"},{default:U(()=>[O(m,{modelValue:V(a).id,"onUpdate:modelValue":h[2]||(h[2]=M=>V(a).id=M),clearable:"",onChange:h[3]||(h[3]=M=>p("id"))},null,8,["modelValue"])]),_:1}),O(_,{label:"名称"},{default:U(()=>[O(m,{modelValue:V(a).name,"onUpdate:modelValue":h[4]||(h[4]=M=>V(a).name=M),clearable:"",onChange:h[5]||(h[5]=M=>p("name"))},null,8,["modelValue"])]),_:1})]))]),_:1},8,["model","rules"])])}}}),PD={class:"panel-tab__content"},RD={class:"element-property input-property"},ID={class:"element-property__value"},ND=Mt({name:"ElementOtherConfig",__name:"ElementOtherConfig",props:{id:String},setup(e){const t=e,n=ie(""),i=ie(),a=()=>window.bpmnInstances,r=()=>{i.value&&i.value.id===t.id||(i.value=a().elementRegistry.get(t.id));const o=a().bpmnFactory.create("bpmn:Documentation",{text:n.value});a().modeling.updateProperties(Ke(i.value),{documentation:[o]})};return Mn(()=>{i.value=null}),vt(()=>t.id,o=>{o&&o.length?Lt(()=>{const s=a().bpmnElement.businessObject?.documentation;n.value=s&&s.length?s[0].text:""}):n.value=""},{immediate:!0}),(o,s)=>{const l=ce("el-input");return ve(),Xe("div",PD,[Je("div",RD,[s[1]||(s[1]=Je("div",{class:"element-property__label"},"元素文档：",-1)),Je("div",ID,[O(l,{modelValue:V(n),"onUpdate:modelValue":s[0]||(s[0]=c=>tn(n)?n.value=c:null),autosize:{minRows:2,maxRows:4},resize:"vertical",type:"textarea",onBlur:r,onInput:r},null,8,["modelValue"])])])])}}}),MD={style:{"margin-top":"16px"}},DD=Mt({name:"UserTask",__name:"UserTask",props:{id:String,type:String},setup(e){const t=e,n=ie({assignee:"",candidateUsers:[],candidateGroups:[],dueDate:"",followUpDate:"",priority:""}),i=ie({}),a=ie(),r=()=>window?.bpmnInstances,o=()=>{for(const l in n.value){let c;l==="candidateUsers"||l==="candidateGroups"?c=a.value?.businessObject[l]?a.value.businessObject[l].split(","):[]:c=a.value?.businessObject[l]||n.value[l],i.value[l]=c}},s=l=>{const c=Object.create(null);l==="candidateUsers"||l==="candidateGroups"?c[l]=i.value[l]&&i.value[l].length?i.value[l].join():null:c[l]=i.value[l]||null,r().modeling.updateProperties(Ke(a.value),c)};return vt(()=>t.id,()=>{a.value=r().bpmnElement,Lt(()=>{o()})},{immediate:!0}),Mn(()=>{a.value=null}),(l,c)=>{const p=ce("el-input"),f=ce("el-form-item"),h=ce("el-link"),v=ce("router-link");return ve(),Xe("div",MD,[O(f,{label:"到期时间"},{default:U(()=>[O(p,{modelValue:V(i).dueDate,"onUpdate:modelValue":c[0]||(c[0]=m=>V(i).dueDate=m),clearable:"",onChange:c[1]||(c[1]=m=>s("dueDate"))},null,8,["modelValue"])]),_:1}),O(f,{label:"跟踪时间"},{default:U(()=>[O(p,{modelValue:V(i).followUpDate,"onUpdate:modelValue":c[2]||(c[2]=m=>V(i).followUpDate=m),clearable:"",onChange:c[3]||(c[3]=m=>s("followUpDate"))},null,8,["modelValue"])]),_:1}),O(f,{label:"优先级"},{default:U(()=>[O(p,{modelValue:V(i).priority,"onUpdate:modelValue":c[4]||(c[4]=m=>V(i).priority=m),clearable:"",onChange:c[5]||(c[5]=m=>s("priority"))},null,8,["modelValue"])]),_:1}),c[7]||(c[7]=Ne(" 友情提示：任务的分配规则，使用 ")),O(v,{target:"_blank",to:{path:"/bpm/manager/model"}},{default:U(()=>[O(h,{type:"danger"},{default:U(()=>c[6]||(c[6]=[Ne("流程模型")])),_:1})]),_:1}),c[8]||(c[8]=Ne(" 下的【分配规则】替代，提供指定角色、部门负责人、部门成员、岗位、工作组、自定义脚本等 7 种维护的任务分配维度，更加灵活！ "))])}}}),kD={style:{"margin-top":"16px"}},OD=Mt({name:"ScriptTask",__name:"ScriptTask",props:{id:String,type:String},setup(e){const t=e,n=ie({scriptFormat:"",script:"",resource:"",resultVariable:""}),i=ie({}),a=ie(),r=()=>window?.bpmnInstances,o=()=>{for(const l in n.value){const c=a.value?.businessObject[l]||n.value[l];i.value[l]=c}i.value.scriptType=i.value.script?"inline":"external"},s=()=>{const l=Object.create(null);l.scriptFormat=i.value.scriptFormat||null,l.resultVariable=i.value.resultVariable||null,i.value.scriptType==="inline"?(l.script=i.value.script||null,l.resource=null):(l.resource=i.value.resource||null,l.script=null),r().modeling.updateProperties(Ke(a.value),l)};return Mn(()=>{a.value=null}),vt(()=>t.id,()=>{a.value=r().bpmnElement,Lt(()=>{o()})},{immediate:!0}),(l,c)=>{const p=ce("el-input"),f=ce("el-form-item"),h=ce("el-option"),v=ce("el-select");return ve(),Xe("div",kD,[O(f,{label:"脚本格式"},{default:U(()=>[O(p,{modelValue:V(i).scriptFormat,"onUpdate:modelValue":c[0]||(c[0]=m=>V(i).scriptFormat=m),clearable:"",onChange:c[1]||(c[1]=m=>s()),onInput:c[2]||(c[2]=m=>s())},null,8,["modelValue"])]),_:1}),O(f,{label:"脚本类型"},{default:U(()=>[O(v,{modelValue:V(i).scriptType,"onUpdate:modelValue":c[3]||(c[3]=m=>V(i).scriptType=m)},{default:U(()=>[O(h,{label:"内联脚本",value:"inline"}),O(h,{label:"外部资源",value:"external"})]),_:1},8,["modelValue"])]),_:1}),ns(O(f,{label:"脚本"},{default:U(()=>[O(p,{modelValue:V(i).script,"onUpdate:modelValue":c[4]||(c[4]=m=>V(i).script=m),autosize:{minRows:2,maxRows:4},clearable:"",resize:"vertical",type:"textarea",onChange:c[5]||(c[5]=m=>s()),onInput:c[6]||(c[6]=m=>s())},null,8,["modelValue"])]),_:1},512),[[bc,V(i).scriptType==="inline"]]),ns(O(f,{label:"资源地址"},{default:U(()=>[O(p,{modelValue:V(i).resource,"onUpdate:modelValue":c[7]||(c[7]=m=>V(i).resource=m),clearable:"",onChange:c[8]||(c[8]=m=>s()),onInput:c[9]||(c[9]=m=>s())},null,8,["modelValue"])]),_:1},512),[[bc,V(i).scriptType==="external"]]),O(f,{label:"结果变量"},{default:U(()=>[O(p,{modelValue:V(i).resultVariable,"onUpdate:modelValue":c[10]||(c[10]=m=>V(i).resultVariable=m),clearable:"",onChange:c[11]||(c[11]=m=>s()),onInput:c[12]||(c[12]=m=>s())},null,8,["modelValue"])]),_:1})])}}}),LD={style:{"margin-top":"16px"}},BD={style:{display:"flex","align-items":"center","justify-content":"space-between","flex-wrap":"nowrap"}},$D=Mt({name:"ReceiveTask",__name:"ReceiveTask",props:{id:String,type:String},setup(e){const t=e,n=hg(),i=ie(""),a=ie({}),r=ie({}),o=ie(!1),s=ie(),l=ie(),c=ie(),p=()=>window.bpmnInstances,f=()=>{s.value=p().bpmnElement,i.value=s.value.businessObject?.messageRef?.id||"-1"},h=()=>{o.value=!0,a.value={}},v=()=>{if(r.value[a.value.id]){n.error("该消息已存在，请修改id后重新保存");return}const _=p().moddle.create("bpmn:Message",a.value);c.value.push(_),r.value[a.value.id]=a.value.name,l.value[a.value.id]=_,o.value=!1},m=_=>{_==="-1"?p().modeling.updateProperties(Ke(s.value),{messageRef:null}):p().modeling.updateProperties(Ke(s.value),{messageRef:l.value[_]})};return ya(()=>{l.value=Object.create(null),c.value=p().modeler.getDefinitions().rootElements,c.value.filter(_=>_.$type==="bpmn:Message").forEach(_=>{l.value[_.id]=_,r.value[_.id]=_.name}),r.value[-1]="无"}),Mn(()=>{s.value=null}),vt(()=>t.id,()=>{Lt(()=>{f()})},{immediate:!0}),(_,b)=>{const M=ce("el-option"),P=ce("el-select"),S=br,w=ce("el-form-item"),T=ce("el-input"),N=ce("el-form"),B=ce("el-button"),$=ce("el-dialog");return ve(),Xe("div",LD,[O(w,{label:"消息实例"},{default:U(()=>[Je("div",BD,[O(P,{modelValue:V(i),"onUpdate:modelValue":b[0]||(b[0]=H=>tn(i)?i.value=H:null),onChange:m},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(r)),H=>(ve(),Fe(M,{key:H,label:V(r)[H],value:H},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),O(S,{"pre-icon":"ep:plus",style:{"margin-left":"8px"},type:"primary",onClick:h})])]),_:1}),O($,{modelValue:V(o),"onUpdate:modelValue":b[3]||(b[3]=H=>tn(o)?o.value=H:null),"append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",title:"创建新消息",width:"400px"},{footer:U(()=>[O(B,{size:"small",type:"primary",onClick:v},{default:U(()=>b[4]||(b[4]=[Ne("确 认")])),_:1})]),default:U(()=>[O(N,{"label-width":"90px",model:V(a),size:"small"},{default:U(()=>[O(w,{label:"消息ID"},{default:U(()=>[O(T,{modelValue:V(a).id,"onUpdate:modelValue":b[1]||(b[1]=H=>V(a).id=H),clearable:""},null,8,["modelValue"])]),_:1}),O(w,{label:"消息名称"},{default:U(()=>[O(T,{modelValue:V(a).name,"onUpdate:modelValue":b[2]||(b[2]=H=>V(a).name=H),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),VD={class:"panel-tab__content"},FD=Mt({name:"ElementTaskConfig",__name:"ElementTask",props:{id:String,type:String},setup(e){const t=e,n=ie({asyncAfter:!1,asyncBefore:!1,exclusive:!1}),i=ie(),a=ie({UserTask:"UserTask",ScriptTask:"ScriptTask",ReceiveTask:"ReceiveTask"}),r=ie(),o=()=>window.bpmnInstances,s=()=>{!n.value.asyncBefore&&!n.value.asyncAfter&&(n.value.exclusive=!1),o().modeling.updateProperties(o().bpmnElement,{...n.value})};return vt(()=>t.id,()=>{r.value=o().bpmnElement,n.value.asyncBefore=r.value?.businessObject?.asyncBefore,n.value.asyncAfter=r.value?.businessObject?.asyncAfter,n.value.exclusive=r.value?.businessObject?.exclusive},{immediate:!0}),vt(()=>t.type,()=>{t.type==a.value.UserTask&&(i.value=DD),t.type==a.value.ScriptTask&&(i.value=OD),t.type==a.value.ReceiveTask&&(i.value=$D)},{immediate:!0}),(l,c)=>{const p=ce("el-checkbox"),f=ce("el-form-item"),h=ce("el-form");return ve(),Xe("div",VD,[O(h,{"label-width":"90px",size:"small"},{default:U(()=>[O(f,{label:"异步延续"},{default:U(()=>[O(p,{modelValue:V(n).asyncBefore,"onUpdate:modelValue":c[0]||(c[0]=v=>V(n).asyncBefore=v),label:"异步前",onChange:s},null,8,["modelValue"]),O(p,{modelValue:V(n).asyncAfter,"onUpdate:modelValue":c[1]||(c[1]=v=>V(n).asyncAfter=v),label:"异步后",onChange:s},null,8,["modelValue"]),V(n).asyncAfter||V(n).asyncBefore?(ve(),Fe(p,{key:0,modelValue:V(n).exclusive,"onUpdate:modelValue":c[2]||(c[2]=v=>V(n).exclusive=v),label:"排除",onChange:s},null,8,["modelValue"])):Ge("",!0)]),_:1}),(ve(),Fe(px(V(i)),fx(dx(l.$props)),null,16))]),_:1})])}}}),jD={class:"panel-tab__content"},HD=Mt({name:"ElementMultiInstance",__name:"ElementMultiInstance",props:{businessObject:Object,type:String},setup(e){const t=e,n=ur("prefix"),i=ie(""),a=ie({completionCondition:"",loopCardinality:"",extensionElements:[],asyncAfter:!1,asyncBefore:!1,exclusive:!1}),r=ie({}),o=ie(null),s=ie(null),l=()=>window?.bpmnInstances,c=b=>{if(!b.loopCharacteristics){i.value="Null",r.value={};return}if(b.loopCharacteristics.$type==="bpmn:StandardLoopCharacteristics"){i.value="StandardLoop",r.value={};return}b.loopCharacteristics.isSequential?i.value="SequentialMultiInstance":i.value="ParallelMultiInstance",r.value={...a.value,...b.loopCharacteristics,completionCondition:b.loopCharacteristics?.completionCondition?.body??"",loopCardinality:b.loopCharacteristics?.loopCardinality?.body??""},s.value=l().bpmnElement.businessObject.loopCharacteristics,b.loopCharacteristics.extensionElements&&b.loopCharacteristics.extensionElements.values&&b.loopCharacteristics.extensionElements.values.length&&(r.value.timeCycle=b.loopCharacteristics.extensionElements.values[0].body)},p=b=>{if(b==="Null"){l().modeling.updateProperties(Ke(o.value),{loopCharacteristics:null});return}if(b==="StandardLoop"){const M=l().moddle.create("bpmn:StandardLoopCharacteristics");l().modeling.updateProperties(Ke(o.value),{loopCharacteristics:M}),s.value=null;return}b==="SequentialMultiInstance"?s.value=l().moddle.create("bpmn:MultiInstanceLoopCharacteristics",{isSequential:!0}):s.value=l().moddle.create("bpmn:MultiInstanceLoopCharacteristics",{collection:"${coll_userList}"}),l().modeling.updateProperties(Ke(o.value),{loopCharacteristics:Ke(s.value)})},f=b=>{let M=null;b&&b.length&&(M=l().moddle.create("bpmn:FormalExpression",{body:b})),l().modeling.updateModdleProperties(Ke(o.value),s.value,{loopCardinality:M})},h=b=>{let M=null;b&&b.length&&(M=l().moddle.create("bpmn:FormalExpression",{body:b})),l().modeling.updateModdleProperties(Ke(o.value),s.value,{completionCondition:M})},v=b=>{const M=l().moddle.create("bpmn:ExtensionElements",{values:[l().moddle.create(`${n}:FailedJobRetryTimeCycle`,{body:b})]});l().modeling.updateModdleProperties(Ke(o.value),s.value,{extensionElements:M})},m=()=>{l().modeling.updateModdleProperties(Ke(o.value),s.value,{collection:r.value.collection||null,elementVariable:r.value.elementVariable||null})},_=b=>{const{asyncBefore:M,asyncAfter:P}=r.value;let S=Object.create(null);!M&&!P?(r.value.exclusive=!1,S={asyncBefore:!1,asyncAfter:!1,exclusive:!1,extensionElements:null}):S[b]=r.value[b],l().modeling.updateModdleProperties(Ke(o.value),s.value,S)};return Mn(()=>{s.value=null,o.value=null}),vt(()=>t.businessObject,b=>{o.value=l().bpmnElement,c(b)},{immediate:!0}),(b,M)=>{const P=ce("el-option"),S=ce("el-select"),w=ce("el-form-item"),T=ce("el-input"),N=ce("el-checkbox"),B=ce("el-form");return ve(),Xe("div",jD,[O(B,{"label-width":"90px"},{default:U(()=>[O(w,{label:"回路特性"},{default:U(()=>[O(S,{modelValue:V(i),"onUpdate:modelValue":M[0]||(M[0]=$=>tn(i)?i.value=$:null),onChange:p},{default:U(()=>[O(P,{label:"并行多重事件",value:"ParallelMultiInstance"}),O(P,{label:"时序多重事件",value:"SequentialMultiInstance"}),O(P,{label:"循环事件",value:"StandardLoop"}),O(P,{label:"无",value:"Null"})]),_:1},8,["modelValue"])]),_:1}),V(i)==="ParallelMultiInstance"||V(i)==="SequentialMultiInstance"?(ve(),Xe(Zt,{key:0},[O(w,{key:"loopCardinality",label:"循环基数"},{default:U(()=>[O(T,{modelValue:V(r).loopCardinality,"onUpdate:modelValue":M[1]||(M[1]=$=>V(r).loopCardinality=$),clearable:"",onChange:f},null,8,["modelValue"])]),_:1}),ns(O(w,{key:"collection",label:"集合"},{default:U(()=>[O(T,{modelValue:V(r).collection,"onUpdate:modelValue":M[2]||(M[2]=$=>V(r).collection=$),clearable:"",onChange:m},null,8,["modelValue"])]),_:1},512),[[bc,!1]]),O(w,{key:"elementVariable",label:"元素变量"},{default:U(()=>[O(T,{modelValue:V(r).elementVariable,"onUpdate:modelValue":M[3]||(M[3]=$=>V(r).elementVariable=$),clearable:"",onChange:m},null,8,["modelValue"])]),_:1}),O(w,{key:"completionCondition",label:"完成条件"},{default:U(()=>[O(T,{modelValue:V(r).completionCondition,"onUpdate:modelValue":M[4]||(M[4]=$=>V(r).completionCondition=$),clearable:"",onChange:h},null,8,["modelValue"])]),_:1}),O(w,{key:"async",label:"异步状态"},{default:U(()=>[O(N,{modelValue:V(r).asyncBefore,"onUpdate:modelValue":M[5]||(M[5]=$=>V(r).asyncBefore=$),label:"异步前",onChange:M[6]||(M[6]=$=>_("asyncBefore"))},null,8,["modelValue"]),O(N,{modelValue:V(r).asyncAfter,"onUpdate:modelValue":M[7]||(M[7]=$=>V(r).asyncAfter=$),label:"异步后",onChange:M[8]||(M[8]=$=>_("asyncAfter"))},null,8,["modelValue"]),V(r).asyncAfter||V(r).asyncBefore?(ve(),Fe(N,{key:0,modelValue:V(r).exclusive,"onUpdate:modelValue":M[9]||(M[9]=$=>V(r).exclusive=$),label:"排除",onChange:M[10]||(M[10]=$=>_("exclusive"))},null,8,["modelValue"])):Ge("",!0)]),_:1}),V(r).asyncAfter||V(r).asyncBefore?(ve(),Fe(w,{key:"timeCycle",label:"重试周期",prop:"timeCycle"},{default:U(()=>[O(T,{modelValue:V(r).timeCycle,"onUpdate:modelValue":M[11]||(M[11]=$=>V(r).timeCycle=$),clearable:"",onChange:v},null,8,["modelValue"])]),_:1})):Ge("",!0)],64)):Ge("",!0)]),_:1})])}}}),GD={class:"panel-tab__content"},zD=Mt({name:"FlowCondition",__name:"FlowCondition",props:{businessObject:Object,type:String},setup(e){const t=e,n=ie({}),i=ie(),a=ie(),r=ie(),o=ie(),s=()=>window?.bpmnInstances,l=()=>{if(i.value=s().bpmnElement,a.value=i.value.source,r.value=i.value.businessObject.sourceRef,r.value&&r.value.default&&r.value.default.id===i.value.id&&n.value.type=="default")n.value={type:"default"};else if(!i.value.businessObject.conditionExpression)n.value={type:"normal"};else{const f=i.value.businessObject.conditionExpression;if(n.value={...f,type:"condition"},n.value.resource){n.value.conditionType="script",n.value.scriptType="externalScript";return}if(f.language){n.value.conditionType="script",n.value.scriptType="inlineScript";return}n.value.conditionType="expression"}},c=f=>{if(f==="condition"){o.value=s().moddle.create("bpmn:FormalExpression"),s().modeling.updateProperties(Ke(i.value),{conditionExpression:o.value});return}if(f==="default"){s().modeling.updateProperties(Ke(i.value),{conditionExpression:null}),s().modeling.updateProperties(Ke(a.value),{default:i.value});return}r.value.default&&r.value.default.id===i.value.id&&s().modeling.updateProperties(Ke(a.value),{default:null}),s().modeling.updateProperties(Ke(i.value),{conditionExpression:null})},p=()=>{const{conditionType:f,scriptType:h,body:v,resource:m,language:_}=n.value;let b;f==="expression"?b=s().moddle.create("bpmn:FormalExpression",{body:v}):h==="inlineScript"?(b=s().moddle.create("bpmn:FormalExpression",{body:v,language:_}),n.value.resource=""):(n.value.body="",b=s().moddle.create("bpmn:FormalExpression",{resource:m,language:_})),s().modeling.updateProperties(Ke(i.value),{conditionExpression:b})};return Mn(()=>{i.value=null,a.value=null,r.value=null}),vt(()=>t.businessObject,f=>{console.log(f,"val"),Lt(()=>{l()})},{immediate:!0}),(f,h)=>{const v=ce("el-option"),m=ce("el-select"),_=ce("el-form-item"),b=ce("el-input"),M=ce("el-form");return ve(),Xe("div",GD,[O(M,{"label-width":"90px",model:V(n),size:"small"},{default:U(()=>[O(_,{label:"流转类型"},{default:U(()=>[O(m,{modelValue:V(n).type,"onUpdate:modelValue":h[0]||(h[0]=P=>V(n).type=P),onChange:c},{default:U(()=>[O(v,{label:"普通流转路径",value:"normal"}),O(v,{label:"默认流转路径",value:"default"}),O(v,{label:"条件流转路径",value:"condition"})]),_:1},8,["modelValue"])]),_:1}),V(n).type==="condition"?(ve(),Fe(_,{key:"condition",label:"条件格式"},{default:U(()=>[O(m,{modelValue:V(n).conditionType,"onUpdate:modelValue":h[1]||(h[1]=P=>V(n).conditionType=P)},{default:U(()=>[O(v,{label:"表达式",value:"expression"}),O(v,{label:"脚本",value:"script"})]),_:1},8,["modelValue"])]),_:1})):Ge("",!0),V(n).conditionType&&V(n).conditionType==="expression"?(ve(),Fe(_,{key:"express",label:"表达式"},{default:U(()=>[O(b,{modelValue:V(n).body,"onUpdate:modelValue":h[2]||(h[2]=P=>V(n).body=P),clearable:"",style:{width:"192px"},onChange:p},null,8,["modelValue"])]),_:1})):Ge("",!0),V(n).conditionType&&V(n).conditionType==="script"?(ve(),Xe(Zt,{key:2},[O(_,{key:"language",label:"脚本语言"},{default:U(()=>[O(b,{modelValue:V(n).language,"onUpdate:modelValue":h[3]||(h[3]=P=>V(n).language=P),clearable:"",onChange:p},null,8,["modelValue"])]),_:1}),O(_,{key:"scriptType",label:"脚本类型"},{default:U(()=>[O(m,{modelValue:V(n).scriptType,"onUpdate:modelValue":h[4]||(h[4]=P=>V(n).scriptType=P)},{default:U(()=>[O(v,{label:"内联脚本",value:"inlineScript"}),O(v,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),V(n).scriptType==="inlineScript"?(ve(),Fe(_,{key:"body",label:"脚本"},{default:U(()=>[O(b,{modelValue:V(n).body,"onUpdate:modelValue":h[5]||(h[5]=P=>V(n).body=P),clearable:"",type:"textarea",onChange:p},null,8,["modelValue"])]),_:1})):Ge("",!0),V(n).scriptType==="externalScript"?(ve(),Fe(_,{key:"resource",label:"资源地址"},{default:U(()=>[O(b,{modelValue:V(n).resource,"onUpdate:modelValue":h[6]||(h[6]=P=>V(n).resource=P),clearable:"",onChange:p},null,8,["modelValue"])]),_:1})):Ge("",!0)],64)):Ge("",!0)]),_:1},8,["model"])])}}}),UD={class:"panel-tab__content"},qD={class:"panel-tab__content--title"},WD={class:"panel-tab__content--title",style:{"padding-top":"8px","margin-top":"8px","border-top":"1px solid #eee"}},YD=Mt({name:"SignalAndMassage",__name:"SignalAndMessage",setup(e){const t=hg(),n=ie([]),i=ie([]),a=ie(!1),r=ie(""),o=ie({}),s=ie(),l=ie(),c=ie(),p=Ec(()=>r.value==="message"?{title:"创建消息",idLabel:"消息ID",nameLabel:"消息名称"}:{title:"创建信号",idLabel:"信号ID",nameLabel:"信号名称"}),f=()=>window?.bpmnInstances,h=()=>{console.log(window,"window"),s.value=f().modeler.getDefinitions().rootElements,l.value={},c.value={},i.value=[],n.value=[],s.value.forEach(_=>{_.$type==="bpmn:Message"&&(l.value[_.id]=!0,i.value.push({..._})),_.$type==="bpmn:Signal"&&(c.value[_.id]=!0,n.value.push({..._}))})},v=_=>{r.value=_,o.value={},a.value=!0},m=()=>{if(r.value==="message"){l.value[o.value.id]&&t.error("该消息已存在，请修改id后重新保存");const _=f().moddle.create("bpmn:Message",o.value);s.value.push(_)}else{c.value[o.value.id]&&t.error("该信号已存在，请修改id后重新保存");const _=f().moddle.create("bpmn:Signal",o.value);s.value.push(_)}a.value=!1,h()};return ya(()=>{h()}),(_,b)=>{const M=bs,P=br,S=ce("el-table-column"),w=ce("el-table"),T=ce("el-input"),N=ce("el-form-item"),B=ce("el-form"),$=ce("el-button"),H=ce("el-dialog");return ve(),Xe("div",UD,[Je("div",qD,[Je("span",null,[O(M,{icon:"ep:menu",style:{"margin-right":"8px",color:"#555"}}),b[6]||(b[6]=Ne(" 消息列表 "))]),O(P,{"pre-icon":"ep:plus",title:"创建新消息",type:"primary",onClick:b[0]||(b[0]=Z=>v("message"))})]),O(w,{border:"",data:V(i)},{default:U(()=>[O(S,{label:"序号",type:"index",width:"60px"}),O(S,{label:"消息ID","max-width":"300px",prop:"id","show-overflow-tooltip":""}),O(S,{label:"消息名称","max-width":"300px",prop:"name","show-overflow-tooltip":""})]),_:1},8,["data"]),Je("div",WD,[Je("span",null,[O(M,{icon:"ep:menu",style:{"margin-right":"8px",color:"#555"}}),b[7]||(b[7]=Ne(" 信号列表 "))]),O(P,{"pre-icon":"ep:plus",title:"创建新信号",type:"primary",onClick:b[1]||(b[1]=Z=>v("signal"))})]),O(w,{border:"",data:V(n)},{default:U(()=>[O(S,{label:"序号",type:"index",width:"60px"}),O(S,{label:"信号ID","max-width":"300px",prop:"id","show-overflow-tooltip":""}),O(S,{label:"信号名称","max-width":"300px",prop:"name","show-overflow-tooltip":""})]),_:1},8,["data"]),O(H,{modelValue:V(a),"onUpdate:modelValue":b[5]||(b[5]=Z=>tn(a)?a.value=Z:null),"append-to-body":"","close-on-click-modal":!1,"destroy-on-close":"",title:V(p).title,width:"400px"},{footer:U(()=>[O($,{onClick:b[4]||(b[4]=Z=>a.value=!1)},{default:U(()=>b[8]||(b[8]=[Ne("取 消")])),_:1}),O($,{type:"primary",onClick:m},{default:U(()=>b[9]||(b[9]=[Ne("保 存")])),_:1})]),default:U(()=>[O(B,{"label-width":"90px",model:V(o)},{default:U(()=>[O(N,{label:V(p).idLabel},{default:U(()=>[O(T,{modelValue:V(o).id,"onUpdate:modelValue":b[2]||(b[2]=Z=>V(o).id=Z),clearable:""},null,8,["modelValue"])]),_:1},8,["label"]),O(N,{label:V(p).nameLabel},{default:U(()=>[O(T,{modelValue:V(o).name,"onUpdate:modelValue":b[3]||(b[3]=Z=>V(o).name=Z),clearable:""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Li=()=>window?.bpmnInstances;function jb(e,t,n){const i=Object.create(null);switch(i.event=e.event,t&&(i.id=e.id),e.listenerType){case"scriptListener":i.script=XD(e,n);break;case"expressionListener":i.expression=e.expression;break;case"delegateExpressionListener":i.delegateExpression=e.delegateExpression;break;default:i.class=e.class}if(e.fields&&(i.fields=e.fields.map(a=>KD(a,n))),t&&e.event==="timeout"&&e.eventDefinitionType){const a=Li().moddle.create("bpmn:FormalExpression",{body:e.eventTimeDefinitions}),r=Li().moddle.create("bpmn:TimerEventDefinition",{id:`TimerEventDefinition_${ZD(8)}`,[`time${e.eventDefinitionType.replace(/^\S/,o=>o.toUpperCase())}`]:a});i.eventDefinitions=[r]}return Li().moddle.create(`${n}:${t?"TaskListener":"ExecutionListener"}`,i)}function KD(e,t){const{name:n,fieldType:i,string:a,expression:r}=e,o=i==="string"?{name:n,string:a}:{name:n,expression:r};return Li().moddle.create(`${t}:Field`,o)}function XD(e,t){const{scriptType:n,scriptFormat:i,value:a,resource:r}=e,o=n==="inlineScript"?{scriptFormat:i,value:a}:{scriptFormat:i,resource:r};return Li().moddle.create(`${t}:Script`,o)}function Es(e,t){const n=Li().moddle.create("bpmn:ExtensionElements",{values:t});Li().modeling.updateProperties(Ke(e),{extensionElements:n})}function ZD(e=8,t){let n="";const i="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let a=e;a>0;--a)n+=i[Math.floor(Math.random()*i.length)];return n}function Hb(e){let t={...e};if(e.script&&(t={...e,...e.script,scriptType:e.script.resource?"externalScript":"inlineScript"}),e.event==="timeout"&&e.eventDefinitions&&e.eventDefinitions.length){let n="";for(const i in e.eventDefinitions[0])console.log(e.eventDefinitions,i),i.indexOf("time")!==-1&&(n=i,t.eventDefinitionType=i.replace("time","").toLowerCase());console.log(n),t.eventTimeDefinitions=e.eventDefinitions[0][n].body}return t}function Gb(e){let t;return e.class&&(t="classListener"),e.expression&&(t="expressionListener"),e.delegateExpression&&(t="delegateExpressionListener"),e.script&&(t="scriptListener"),{...JSON.parse(JSON.stringify(e)),...e.script??{},listenerType:t}}const zb={classListener:"Java 类",expressionListener:"表达式",delegateExpressionListener:"代理表达式",scriptListener:"脚本"},JD={create:"创建",assignment:"指派",complete:"完成",delete:"删除",update:"更新",timeout:"超时"},Ub={string:"字符串",expression:"表达式"},QD={class:"panel-tab__content"},ek={class:"element-drawer__button"},tk={class:"listener-filed__title"},nk={class:"element-drawer__button"},ik=Mt({name:"ElementListeners",__name:"ElementListeners",props:{id:String,type:String},setup(e){const t=e,n=ur("prefix"),i=ur("width"),a=ie([]),r=ie({}),o=ie(!1),s=ie([]),l=ie({}),c=ie(!1),p=ie(-1),f=ie(-1),h=ie(zb),v=ie(Ub),m=ie(),_=ie(),b=ie(),M=ie(),P=ie(),S=()=>window?.bpmnInstances,w=()=>{m.value=S().bpmnElement,_.value=[],b.value=m.value.businessObject?.extensionElements?.values?.filter(Y=>Y.$type===`${n}:ExecutionListener`)??[],a.value=b.value.map(Y=>Gb(Y))},T=(Y,z)=>{Y?(r.value=Hb(Y),p.value=z):(r.value={},p.value=-1),Y&&Y.fields?s.value=Y.fields.map(G=>({...G,fieldType:G.string?"string":"expression"})):(s.value=[],r.value.fields=[]),o.value=!0,Lt(()=>{M.value&&M.value.clearValidate()})},N=(Y,z)=>{l.value=Y?JSON.parse(JSON.stringify(Y)):{},f.value=Y?z:-1,c.value=!0,Lt(()=>{P.value&&P.value.clearValidate()})},B=async()=>{await P.value.validate()&&(f.value===-1?(s.value.push(l.value),r.value.fields.push(l.value)):(s.value.splice(f.value,1,l.value),r.value.fields.splice(f.value,1,l.value)),c.value=!1,Lt(()=>{l.value={}}))},$=Y=>{lr.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{s.value.splice(Y,1),r.value.fields.splice(Y,1)}).catch(()=>console.info("操作取消"))},H=Y=>{lr.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{b.value.splice(Y,1),a.value.splice(Y,1),Es(m.value,_.value.concat(b.value))}).catch(()=>console.info("操作取消"))},Z=async()=>{if(!await M.value.validate())return;const z=jb(r.value,!1,n);p.value===-1?(b.value.push(z),a.value.push(r.value)):(b.value.splice(p.value,1,z),a.value.splice(p.value,1,r.value)),_.value=m.value.businessObject?.extensionElements?.values?.filter(G=>G.$type!==`${n}:ExecutionListener`)??[],Es(m.value,_.value.concat(b.value)),o.value=!1,r.value={}};return vt(()=>t.id,Y=>{Y&&Y.length&&Lt(()=>{w()})},{immediate:!0}),(Y,z)=>{const G=ce("el-table-column"),se=ce("el-button"),u=ce("el-divider"),d=ce("el-table"),E=br,y=ce("el-option"),g=ce("el-select"),C=ce("el-form-item"),x=ce("el-input"),R=ce("el-form"),D=bs,L=ce("el-drawer"),X=ce("el-dialog");return ve(),Xe("div",QD,[O(d,{border:"",data:V(a),size:"small"},{default:U(()=>[O(G,{label:"序号",type:"index",width:"50px"}),O(G,{label:"事件类型","min-width":"100px",prop:"event"}),O(G,{formatter:K=>V(h)[K.listenerType],label:"监听器类型","min-width":"100px","show-overflow-tooltip":""},null,8,["formatter"]),O(G,{label:"操作",width:"100px"},{default:U(K=>[O(se,{link:"",size:"small",onClick:W=>T(K.row,K.$index)},{default:U(()=>z[19]||(z[19]=[Ne("编辑")])),_:2},1032,["onClick"]),O(u,{direction:"vertical"}),O(se,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:W=>H(K.$index)},{default:U(()=>z[20]||(z[20]=[Ne("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Je("div",ek,[O(E,{"pre-icon":"ep:plus",title:"添加监听器",type:"primary",onClick:z[0]||(z[0]=K=>T(null))})]),O(L,{modelValue:V(o),"onUpdate:modelValue":z[12]||(z[12]=K=>tn(o)?o.value=K:null),"append-to-body":"","destroy-on-close":"",size:`${V(i)}px`,title:"执行监听器"},{default:U(()=>[O(R,{ref_key:"listenerFormRef",ref:M,"label-width":"96px",model:V(r)},{default:U(()=>[O(C,{label:"事件类型",prop:"event",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(g,{modelValue:V(r).event,"onUpdate:modelValue":z[1]||(z[1]=K=>V(r).event=K)},{default:U(()=>[O(y,{label:"start",value:"start"}),O(y,{label:"end",value:"end"})]),_:1},8,["modelValue"])]),_:1}),O(C,{label:"监听器类型",prop:"listenerType",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(g,{modelValue:V(r).listenerType,"onUpdate:modelValue":z[2]||(z[2]=K=>V(r).listenerType=K)},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(h)),K=>(ve(),Fe(y,{key:K,label:V(h)[K],value:K},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),V(r).listenerType==="classListener"?(ve(),Fe(C,{key:"listener-class",label:"Java类",prop:"class",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(r).class,"onUpdate:modelValue":z[3]||(z[3]=K=>V(r).class=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(r).listenerType==="expressionListener"?(ve(),Fe(C,{key:"listener-expression",label:"表达式",prop:"expression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(r).expression,"onUpdate:modelValue":z[4]||(z[4]=K=>V(r).expression=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(r).listenerType==="delegateExpressionListener"?(ve(),Fe(C,{key:"listener-delegate",label:"代理表达式",prop:"delegateExpression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(r).delegateExpression,"onUpdate:modelValue":z[5]||(z[5]=K=>V(r).delegateExpression=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(r).listenerType==="scriptListener"?(ve(),Xe(Zt,{key:3},[O(C,{key:"listener-script-format",label:"脚本格式",prop:"scriptFormat",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:U(()=>[O(x,{modelValue:V(r).scriptFormat,"onUpdate:modelValue":z[6]||(z[6]=K=>V(r).scriptFormat=K),clearable:""},null,8,["modelValue"])]),_:1}),O(C,{key:"listener-script-type",label:"脚本类型",prop:"scriptType",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:U(()=>[O(g,{modelValue:V(r).scriptType,"onUpdate:modelValue":z[7]||(z[7]=K=>V(r).scriptType=K)},{default:U(()=>[O(y,{label:"内联脚本",value:"inlineScript"}),O(y,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),V(r).scriptType==="inlineScript"?(ve(),Fe(C,{key:"listener-script",label:"脚本内容",prop:"value",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:U(()=>[O(x,{modelValue:V(r).value,"onUpdate:modelValue":z[8]||(z[8]=K=>V(r).value=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(r).scriptType==="externalScript"?(ve(),Fe(C,{key:"listener-resource",label:"资源地址",prop:"resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:U(()=>[O(x,{modelValue:V(r).resource,"onUpdate:modelValue":z[9]||(z[9]=K=>V(r).resource=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0)],64)):Ge("",!0)]),_:1},8,["model"]),O(u),Je("p",tk,[Je("span",null,[O(D,{icon:"ep:menu"}),z[21]||(z[21]=Ne(" 注入字段： "))]),O(E,{title:"添加字段",type:"primary",onClick:z[10]||(z[10]=K=>N(null))})]),O(d,{border:"",data:V(s),fit:"","max-height":"240",size:"small",style:{flex:"none"}},{default:U(()=>[O(G,{label:"序号",type:"index",width:"50px"}),O(G,{label:"字段名称","min-width":"100px",prop:"name"}),O(G,{formatter:K=>V(v)[K.fieldType],label:"字段类型","min-width":"80px","show-overflow-tooltip":""},null,8,["formatter"]),O(G,{formatter:K=>K.string||K.expression,label:"字段值/表达式","min-width":"100px","show-overflow-tooltip":""},null,8,["formatter"]),O(G,{label:"操作",width:"130px"},{default:U(K=>[O(se,{link:"",size:"small",onClick:W=>N(K.row,K.$index)},{default:U(()=>z[22]||(z[22]=[Ne("编辑")])),_:2},1032,["onClick"]),O(u,{direction:"vertical"}),O(se,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:W=>$(K.$index)},{default:U(()=>z[23]||(z[23]=[Ne("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Je("div",nk,[O(se,{onClick:z[11]||(z[11]=K=>o.value=!1)},{default:U(()=>z[24]||(z[24]=[Ne("取 消")])),_:1}),O(se,{type:"primary",onClick:Z},{default:U(()=>z[25]||(z[25]=[Ne("保 存")])),_:1})])]),_:1},8,["modelValue","size"]),O(X,{modelValue:V(c),"onUpdate:modelValue":z[18]||(z[18]=K=>tn(c)?c.value=K:null),"append-to-body":"","destroy-on-close":"",title:"字段配置",width:"600px"},{footer:U(()=>[O(se,{size:"small",onClick:z[17]||(z[17]=K=>c.value=!1)},{default:U(()=>z[26]||(z[26]=[Ne("取 消")])),_:1}),O(se,{size:"small",type:"primary",onClick:B},{default:U(()=>z[27]||(z[27]=[Ne("确 定")])),_:1})]),default:U(()=>[O(R,{ref_key:"listenerFieldFormRef",ref:P,"label-width":"96spx",model:V(l),style:{height:"136px"}},{default:U(()=>[O(C,{label:"字段名称：",prop:"name",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(l).name,"onUpdate:modelValue":z[13]||(z[13]=K=>V(l).name=K),clearable:""},null,8,["modelValue"])]),_:1}),O(C,{label:"字段类型：",prop:"fieldType",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(g,{modelValue:V(l).fieldType,"onUpdate:modelValue":z[14]||(z[14]=K=>V(l).fieldType=K)},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(v)),K=>(ve(),Fe(y,{key:K,label:V(v)[K],value:K},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),V(l).fieldType==="string"?(ve(),Fe(C,{key:"field-string",label:"字段值：",prop:"string",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(l).string,"onUpdate:modelValue":z[15]||(z[15]=K=>V(l).string=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(l).fieldType==="expression"?(ve(),Fe(C,{key:"field-expression",label:"表达式：",prop:"expression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(x,{modelValue:V(l).expression,"onUpdate:modelValue":z[16]||(z[16]=K=>V(l).expression=K),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),rk={class:"panel-tab__content"},ak={class:"element-drawer__button"},ok=Mt({name:"ElementProperties",__name:"ElementProperties",props:{id:String,type:String},setup(e){const t=e,n=ur("prefix"),i=ie([]),a=ie({}),r=ie(-1),o=ie(!1),s=ie(),l=ie(),c=ie(),p=ie(),f=ie(),h=()=>window?.bpmnInstances,v=()=>{console.log(window,"windowwindowwindowwindowwindowwindowwindow"),s.value=h().bpmnElement,l.value=[],c.value=s.value.businessObject?.extensionElements?.values.filter(P=>(P.$type!==`${n}:Properties`&&l.value.push(P),P.$type===`${n}:Properties`))??[],p.value=c.value.reduce((P,S)=>P.concat(S.values),[]),i.value=JSON.parse(JSON.stringify(p.value??[]))},m=(P,S)=>{r.value=S,a.value=S===-1?{}:JSON.parse(JSON.stringify(P)),o.value=!0,Lt(()=>{f.value&&f.value.clearValidate()})},_=(P,S)=>{console.log(P,"attr"),lr.confirm("确认移除该属性吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{i.value.splice(S,1),p.value.splice(S,1);const w=h().moddle.create(`${n}:Properties`,{values:p.value});M(w),v()}).catch(()=>console.info("操作取消"))},b=()=>{console.log(a.value,"propertyForm.value");const{name:P,value:S}=a.value;if(r.value!==-1)h().modeling.updateModdleProperties(Ke(s.value),Ke(p.value)[Ke(r.value)],{name:P,value:S});else{const w=h().moddle.create(`${n}:Property`,{name:P,value:S}),T=h().moddle.create(`${n}:Properties`,{values:p.value.concat([w])});M(T)}o.value=!1,v()},M=P=>{const S=h().moddle.create("bpmn:ExtensionElements",{values:l.value.concat([P])});h().modeling.updateProperties(Ke(s.value),{extensionElements:S})};return vt(()=>t.id,P=>{P&&P&&P.length&&v()},{immediate:!0}),(P,S)=>{const w=ce("el-table-column"),T=ce("el-button"),N=ce("el-divider"),B=ce("el-table"),$=br,H=ce("el-input"),Z=ce("el-form-item"),Y=ce("el-form"),z=ce("el-dialog");return ve(),Xe("div",rk,[O(B,{border:"",data:V(i),fit:"","max-height":"240"},{default:U(()=>[O(w,{label:"序号",type:"index",width:"50px"}),O(w,{label:"属性名","min-width":"100px",prop:"name","show-overflow-tooltip":""}),O(w,{label:"属性值","min-width":"100px",prop:"value","show-overflow-tooltip":""}),O(w,{label:"操作",width:"110px"},{default:U(G=>[O(T,{link:"",size:"small",onClick:se=>m(G.row,G.$index)},{default:U(()=>S[5]||(S[5]=[Ne("编辑")])),_:2},1032,["onClick"]),O(N,{direction:"vertical"}),O(T,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:se=>_(G.row,G.$index)},{default:U(()=>S[6]||(S[6]=[Ne("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Je("div",ak,[O($,{"pre-icon":"ep:plus",title:"添加属性",type:"primary",onClick:S[0]||(S[0]=G=>m(null,-1))})]),O(z,{modelValue:V(o),"onUpdate:modelValue":S[4]||(S[4]=G=>tn(o)?o.value=G:null),"append-to-body":"","destroy-on-close":"",title:"属性配置",width:"600px"},{footer:U(()=>[O(T,{onClick:S[3]||(S[3]=G=>o.value=!1)},{default:U(()=>S[7]||(S[7]=[Ne("取 消")])),_:1}),O(T,{type:"primary",onClick:b},{default:U(()=>S[8]||(S[8]=[Ne("确 定")])),_:1})]),default:U(()=>[O(Y,{ref_key:"attributeFormRef",ref:f,"label-width":"80px",model:V(a)},{default:U(()=>[O(Z,{label:"属性名：",prop:"name"},{default:U(()=>[O(H,{modelValue:V(a).name,"onUpdate:modelValue":S[1]||(S[1]=G=>V(a).name=G),clearable:""},null,8,["modelValue"])]),_:1}),O(Z,{label:"属性值：",prop:"value"},{default:U(()=>[O(H,{modelValue:V(a).value,"onUpdate:modelValue":S[2]||(S[2]=G=>V(a).value=G),clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),sk={class:"panel-tab__content"},lk={class:"element-drawer__button"},uk={class:"listener-filed__title"},ck={class:"element-drawer__button"},pk=Mt({name:"UserTaskListeners",__name:"UserTaskListeners",props:{id:String,type:String},setup(e){const t=e,n=ur("prefix"),i=ur("width"),a=ie([]),r=ie(JD),o=ie(zb),s=ie(!1),l=ie({}),c=ie(Ub),p=ie([]),f=ie(!1),h=ie(-1),v=ie(-1),m=ie({}),_=ie(),b=ie(),M=ie(),P=ie(),S=ie(),w=()=>window?.bpmnInstances,T=()=>{console.log(w().bpmnElement,"window.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElementwindow.bpmnInstances.bpmnElement"),_.value=w().bpmnElement,M.value=[],b.value=_.value.businessObject?.extensionElements?.values.filter(z=>z.$type===`${n}:TaskListener`)??[],a.value=b.value.map(z=>Gb(z))},N=(z,G)=>{z?(l.value=Hb(z),h.value=G):(l.value={},h.value=-1),z&&z.fields?p.value=z.fields.map(se=>({...se,fieldType:se.string?"string":"expression"})):(p.value=[],l.value.fields=[]),s.value=!0,Lt(()=>{P.value&&P.value.clearValidate()})},B=(z,G)=>{console.log(z,"listener"),lr.confirm("确认移除该监听器吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{b.value.splice(G,1),a.value.splice(G,1),Es(_.value,M.value.concat(b.value))}).catch(()=>console.info("操作取消"))},$=async()=>{if(!await P.value.validate())return;const G=jb(l.value,!0,n);h.value===-1?(b.value.push(G),a.value.push(l.value)):(b.value.splice(h.value,1,G),a.value.splice(h.value,1,l.value)),M.value=_.value.businessObject?.extensionElements?.values?.filter(se=>se.$type!==`${n}:TaskListener`)??[],Es(_.value,M.value.concat(b.value)),s.value=!1,l.value={}},H=(z,G)=>{m.value=z?JSON.parse(JSON.stringify(z)):{},v.value=z?G:-1,f.value=!0,Lt(()=>{S.value&&S.value.clearValidate()})},Z=async()=>{await S.value.validate()&&(v.value===-1?(p.value.push(m.value),l.value.fields.push(m.value)):(p.value.splice(v.value,1,m.value),l.value.fields.splice(v.value,1,m.value)),f.value=!1,Lt(()=>{m.value={}}))},Y=(z,G)=>{console.log(z,"field"),lr.confirm("确认移除该字段吗？","提示",{confirmButtonText:"确 认",cancelButtonText:"取 消"}).then(()=>{p.value.splice(G,1),l.value.fields.splice(G,1)}).catch(()=>console.info("操作取消"))};return vt(()=>t.id,z=>{z&&z.length&&Lt(()=>{T()})},{immediate:!0}),(z,G)=>{const se=ce("el-table-column"),u=ce("el-button"),d=ce("el-divider"),E=ce("el-table"),y=br,g=ce("el-option"),C=ce("el-select"),x=ce("el-form-item"),R=ce("el-input"),D=ce("el-form"),L=bs,X=ce("el-drawer"),K=ce("el-dialog");return ve(),Xe("div",sk,[O(E,{border:"",data:V(a),size:"small"},{default:U(()=>[O(se,{label:"序号",type:"index",width:"50px"}),O(se,{formatter:W=>V(r)[W.event],label:"事件类型","min-width":"80px","show-overflow-tooltip":""},null,8,["formatter"]),O(se,{label:"事件id","min-width":"80px",prop:"id","show-overflow-tooltip":""}),O(se,{formatter:W=>V(o)[W.listenerType],label:"监听器类型","min-width":"80px","show-overflow-tooltip":""},null,8,["formatter"]),O(se,{label:"操作",width:"90px"},{default:U(W=>[O(u,{link:"",size:"small",onClick:oe=>N(W.row,W.$index)},{default:U(()=>G[22]||(G[22]=[Ne("编辑")])),_:2},1032,["onClick"]),O(d,{direction:"vertical"}),O(u,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:oe=>B(W.row,W.$index)},{default:U(()=>G[23]||(G[23]=[Ne("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Je("div",lk,[O(y,{"pre-icon":"ep:plus",size:"small",title:"添加监听器",type:"primary",onClick:G[0]||(G[0]=W=>N(null))})]),O(X,{modelValue:V(s),"onUpdate:modelValue":G[15]||(G[15]=W=>tn(s)?s.value=W:null),"append-to-body":"","destroy-on-close":"",size:`${V(i)}px`,title:"任务监听器"},{default:U(()=>[O(D,{ref_key:"listenerFormRef",ref:P,"label-width":"96px",model:V(l),size:"small"},{default:U(()=>[O(x,{label:"事件类型",prop:"event",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(C,{modelValue:V(l).event,"onUpdate:modelValue":G[1]||(G[1]=W=>V(l).event=W)},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(r)),W=>(ve(),Fe(g,{key:W,label:V(r)[W],value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),O(x,{label:"监听器ID",prop:"id",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(l).id,"onUpdate:modelValue":G[2]||(G[2]=W=>V(l).id=W),clearable:""},null,8,["modelValue"])]),_:1}),O(x,{label:"监听器类型",prop:"listenerType",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(C,{modelValue:V(l).listenerType,"onUpdate:modelValue":G[3]||(G[3]=W=>V(l).listenerType=W)},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(o)),W=>(ve(),Fe(g,{key:W,label:V(o)[W],value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),V(l).listenerType==="classListener"?(ve(),Fe(x,{key:"listener-class",label:"Java类",prop:"class",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(l).class,"onUpdate:modelValue":G[4]||(G[4]=W=>V(l).class=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(l).listenerType==="expressionListener"?(ve(),Fe(x,{key:"listener-expression",label:"表达式",prop:"expression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(l).expression,"onUpdate:modelValue":G[5]||(G[5]=W=>V(l).expression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(l).listenerType==="delegateExpressionListener"?(ve(),Fe(x,{key:"listener-delegate",label:"代理表达式",prop:"delegateExpression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(l).delegateExpression,"onUpdate:modelValue":G[6]||(G[6]=W=>V(l).delegateExpression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(l).listenerType==="scriptListener"?(ve(),Xe(Zt,{key:3},[O(x,{key:"listener-script-format",label:"脚本格式",prop:"scriptFormat",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本格式"}},{default:U(()=>[O(R,{modelValue:V(l).scriptFormat,"onUpdate:modelValue":G[7]||(G[7]=W=>V(l).scriptFormat=W),clearable:""},null,8,["modelValue"])]),_:1}),O(x,{key:"listener-script-type",label:"脚本类型",prop:"scriptType",rules:{required:!0,trigger:["blur","change"],message:"请选择脚本类型"}},{default:U(()=>[O(C,{modelValue:V(l).scriptType,"onUpdate:modelValue":G[8]||(G[8]=W=>V(l).scriptType=W)},{default:U(()=>[O(g,{label:"内联脚本",value:"inlineScript"}),O(g,{label:"外部脚本",value:"externalScript"})]),_:1},8,["modelValue"])]),_:1}),V(l).scriptType==="inlineScript"?(ve(),Fe(x,{key:"listener-script",label:"脚本内容",prop:"value",rules:{required:!0,trigger:["blur","change"],message:"请填写脚本内容"}},{default:U(()=>[O(R,{modelValue:V(l).value,"onUpdate:modelValue":G[9]||(G[9]=W=>V(l).value=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(l).scriptType==="externalScript"?(ve(),Fe(x,{key:"listener-resource",label:"资源地址",prop:"resource",rules:{required:!0,trigger:["blur","change"],message:"请填写资源地址"}},{default:U(()=>[O(R,{modelValue:V(l).resource,"onUpdate:modelValue":G[10]||(G[10]=W=>V(l).resource=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0)],64)):Ge("",!0),V(l).event==="timeout"?(ve(),Xe(Zt,{key:4},[O(x,{key:"eventDefinitionType",label:"定时器类型",prop:"eventDefinitionType"},{default:U(()=>[O(C,{modelValue:V(l).eventDefinitionType,"onUpdate:modelValue":G[11]||(G[11]=W=>V(l).eventDefinitionType=W)},{default:U(()=>[O(g,{label:"日期",value:"date"}),O(g,{label:"持续时长",value:"duration"}),O(g,{label:"循环",value:"cycle"}),O(g,{label:"无",value:"null"})]),_:1},8,["modelValue"])]),_:1}),V(l).eventDefinitionType&&V(l).eventDefinitionType!=="null"?(ve(),Fe(x,{key:"eventTimeDefinitions",label:"定时器",prop:"eventTimeDefinitions",rules:{required:!0,trigger:["blur","change"],message:"请填写定时器配置"}},{default:U(()=>[O(R,{modelValue:V(l).eventTimeDefinitions,"onUpdate:modelValue":G[12]||(G[12]=W=>V(l).eventTimeDefinitions=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0)],64)):Ge("",!0)]),_:1},8,["model"]),O(d),Je("p",uk,[Je("span",null,[O(L,{icon:"ep:menu"}),G[24]||(G[24]=Ne(" 注入字段： "))]),O(u,{size:"small",type:"primary",onClick:G[13]||(G[13]=W=>H(null))},{default:U(()=>G[25]||(G[25]=[Ne("添加字段")])),_:1})]),O(E,{border:"",data:V(p),fit:"","max-height":"240",size:"small",style:{flex:"none"}},{default:U(()=>[O(se,{label:"序号",type:"index",width:"50px"}),O(se,{label:"字段名称","min-width":"100px",prop:"name"}),O(se,{formatter:W=>V(c)[W.fieldType],label:"字段类型","min-width":"80px","show-overflow-tooltip":""},null,8,["formatter"]),O(se,{formatter:W=>W.string||W.expression,label:"字段值/表达式","min-width":"100px","show-overflow-tooltip":""},null,8,["formatter"]),O(se,{label:"操作",width:"100px"},{default:U(W=>[O(u,{link:"",size:"small",onClick:oe=>H(W.row,W.$index)},{default:U(()=>G[26]||(G[26]=[Ne("编辑")])),_:2},1032,["onClick"]),O(d,{direction:"vertical"}),O(u,{link:"",size:"small",style:{color:"#ff4d4f"},onClick:oe=>Y(W.row,W.$index)},{default:U(()=>G[27]||(G[27]=[Ne("移除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Je("div",ck,[O(u,{size:"small",onClick:G[14]||(G[14]=W=>s.value=!1)},{default:U(()=>G[28]||(G[28]=[Ne("取 消")])),_:1}),O(u,{size:"small",type:"primary",onClick:$},{default:U(()=>G[29]||(G[29]=[Ne("保 存")])),_:1})])]),_:1},8,["modelValue","size"]),O(K,{modelValue:V(f),"onUpdate:modelValue":G[21]||(G[21]=W=>tn(f)?f.value=W:null),"append-to-body":"","destroy-on-close":"",title:"字段配置",width:"600px"},{footer:U(()=>[O(u,{size:"small",onClick:G[20]||(G[20]=W=>f.value=!1)},{default:U(()=>G[30]||(G[30]=[Ne("取 消")])),_:1}),O(u,{size:"small",type:"primary",onClick:Z},{default:U(()=>G[31]||(G[31]=[Ne("确 定")])),_:1})]),default:U(()=>[O(D,{ref_key:"listenerFieldFormRef",ref:S,"label-width":"96px",model:V(m),size:"small",style:{height:"136px"}},{default:U(()=>[O(x,{label:"字段名称：",prop:"name",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(m).name,"onUpdate:modelValue":G[16]||(G[16]=W=>V(m).name=W),clearable:""},null,8,["modelValue"])]),_:1}),O(x,{label:"字段类型：",prop:"fieldType",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(C,{modelValue:V(m).fieldType,"onUpdate:modelValue":G[17]||(G[17]=W=>V(m).fieldType=W)},{default:U(()=>[(ve(!0),Xe(Zt,null,or(Object.keys(V(c)),W=>(ve(),Fe(g,{key:W,label:V(c)[W],value:W},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),V(m).fieldType==="string"?(ve(),Fe(x,{key:"field-string",label:"字段值：",prop:"string",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(m).string,"onUpdate:modelValue":G[18]||(G[18]=W=>V(m).string=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0),V(m).fieldType==="expression"?(ve(),Fe(x,{key:"field-expression",label:"表达式：",prop:"expression",rules:{required:!0,trigger:["blur","change"]}},{default:U(()=>[O(R,{modelValue:V(m).expression,"onUpdate:modelValue":G[19]||(G[19]=W=>V(m).expression=W),clearable:""},null,8,["modelValue"])]),_:1})):Ge("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),yc=Mt({name:"MyPropertiesPanel",__name:"PropertiesPanel",props:{bpmnModeler:{type:Object,default:()=>{}},prefix:{type:String,default:"camunda"},width:{type:Number,default:480},idEditDisabled:{type:Boolean,default:!1},model:Object},setup(e){const t=e,n=ie("base"),i=ie(""),a=ie(""),r=ie({}),o=ie(!1),s=ie(!1),l=ie();is("prefix",t.prefix),is("width",t.width);const c=()=>window?.bpmnInstances,p=vt(()=>t.bpmnModeler,()=>{if(!t.bpmnModeler){console.log("缺少props.bpmnModeler");return}console.log("props.bpmnModeler 有值了！！！");const v=window;v.bpmnInstances={modeler:t.bpmnModeler,modeling:t.bpmnModeler.get("modeling"),moddle:t.bpmnModeler.get("moddle"),eventBus:t.bpmnModeler.get("eventBus"),bpmnFactory:t.bpmnModeler.get("bpmnFactory"),elementFactory:t.bpmnModeler.get("elementFactory"),elementRegistry:t.bpmnModeler.get("elementRegistry"),replace:t.bpmnModeler.get("replace"),selection:t.bpmnModeler.get("selection")},console.log(c(),"window.bpmnInstances"),f(),p()},{immediate:!0}),f=()=>{h(null),t.bpmnModeler.on("import.done",v=>{console.log(v,"eeeee"),h(null)}),t.bpmnModeler.on("selection.changed",({newSelection:v})=>{h(v[0]||null)}),t.bpmnModeler.on("element.changed",({element:v})=>{v&&v.id===i.value&&h(v)})},h=v=>{let m=v;m||(m=c().elementRegistry.find(_=>_.type==="bpmn:Process")??c().elementRegistry.find(_=>_.type==="bpmn:Collaboration")),m&&(console.log(`
              ----------
      select element changed:
                id:  ${m.id}
              type:  ${m.businessObject.$type}
              ----------
              `),console.log("businessObject: ",m.businessObject),c().bpmnElement=m,l.value=m,i.value=m.id,a.value=m.type.split(":")[1]||"",r.value=JSON.parse(JSON.stringify(m.businessObject)),o.value=!!(a.value==="SequenceFlow"&&m.source&&m.source.type.indexOf("StartEvent")===-1),s.value=a.value==="UserTask"||a.value==="StartEvent")};return Mn(()=>{const v=window;v.bpmnInstances=null,console.log(t,"props1"),console.log(t.bpmnModeler,"props.bpmnModeler1")}),vt(()=>i.value,()=>{n.value="base"}),(v,m)=>{const _=bs,b=ce("el-collapse-item"),M=ce("el-link"),P=ce("router-link"),S=ce("el-collapse");return ve(),Xe("div",{class:"process-panel__container",style:hx({width:`${e.width}px`})},[O(S,{modelValue:V(n),"onUpdate:modelValue":m[0]||(m[0]=w=>tn(n)?n.value=w:null)},{default:U(()=>[O(b,{name:"base"},{title:U(()=>[O(_,{icon:"ep:info-filled"}),m[1]||(m[1]=Ne(" 常规 "))]),default:U(()=>[O(AD,{"business-object":V(r),"id-edit-disabled":e.idEditDisabled,model:e.model,type:V(a)},null,8,["business-object","id-edit-disabled","model","type"])]),_:1}),V(a)==="Process"?(ve(),Fe(b,{key:"message",name:"condition"},{title:U(()=>[O(_,{icon:"ep:comment"}),m[2]||(m[2]=Ne(" 消息与信号 "))]),default:U(()=>[O(YD)]),_:1})):Ge("",!0),V(o)?(ve(),Fe(b,{key:"condition",name:"condition"},{title:U(()=>[O(_,{icon:"ep:promotion"}),m[3]||(m[3]=Ne(" 流转条件 "))]),default:U(()=>[O(zD,{"business-object":V(r),type:V(a)},null,8,["business-object","type"])]),_:1})):Ge("",!0),V(s)?(ve(),Fe(b,{key:"form",name:"condition"},{title:U(()=>[O(_,{icon:"ep:list"}),m[4]||(m[4]=Ne(" 表单 "))]),default:U(()=>[m[6]||(m[6]=Ne(" 友情提示：使用 ")),O(P,{to:{path:"/bpm/manager/form"}},{default:U(()=>[O(M,{type:"danger"},{default:U(()=>m[5]||(m[5]=[Ne("流程表单")])),_:1})]),_:1}),m[7]||(m[7]=Ne(" 替代，提供更好的表单设计功能 "))]),_:1})):Ge("",!0),V(a).indexOf("Task")!==-1?(ve(),Fe(b,{key:"task",name:"task"},{title:U(()=>[O(_,{icon:"ep:checked"}),m[8]||(m[8]=Ne(" 任务 "))]),default:U(()=>[O(FD,{id:V(i),type:V(a)},null,8,["id","type"])]),_:1})):Ge("",!0),V(a).indexOf("Task")!==-1?(ve(),Fe(b,{key:"multiInstance",name:"multiInstance"},{title:U(()=>[O(_,{icon:"ep:help-filled"}),m[9]||(m[9]=Ne(" 多实例 "))]),default:U(()=>[O(HD,{"business-object":V(r),type:V(a)},null,8,["business-object","type"])]),_:1})):Ge("",!0),O(b,{key:"listeners",name:"listeners"},{title:U(()=>[O(_,{icon:"ep:bell-filled"}),m[10]||(m[10]=Ne(" 执行监听器 "))]),default:U(()=>[O(ik,{id:V(i),type:V(a)},null,8,["id","type"])]),_:1}),V(a)==="UserTask"?(ve(),Fe(b,{key:"taskListeners",name:"taskListeners"},{title:U(()=>[O(_,{icon:"ep:bell-filled"}),m[11]||(m[11]=Ne(" 任务监听器 "))]),default:U(()=>[O(pk,{id:V(i),type:V(a)},null,8,["id","type"])]),_:1})):Ge("",!0),O(b,{key:"extensions",name:"extensions"},{title:U(()=>[O(_,{icon:"ep:circle-plus-filled"}),m[12]||(m[12]=Ne(" 扩展属性 "))]),default:U(()=>[O(ok,{id:V(i),type:V(a)},null,8,["id","type"])]),_:1}),O(b,{key:"other",name:"other"},{title:U(()=>[O(_,{icon:"ep:promotion"}),m[13]||(m[13]=Ne(" 其他 "))]),default:U(()=>[O(ND,{id:V(i)},null,8,["id"])]),_:1})]),_:1},8,["modelValue"])],4)}}});vc.install=function(e){e.component(vc.name,vc)};yc.install=function(e){e.component(yc.name,yc)};gc.install=function(e){e.component(gc.name,gc)};export{Of as P,vc as _,We as a,vk as b,A as c,Gt as d,GM as e,WM as f,zi as g,yc as h,je as i,gc as j};
